(self.webpackChunkdigram=self.webpackChunkdigram||[]).push([[179],{255:e=>{function t(e){return Promise.resolve().then(()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=()=>[],t.resolve=t,t.id=255,e.exports=t},884:(e,t,i)=>{"use strict";function n(e){return"function"==typeof e}let s=!1;const r={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else s&&console.log("RxJS: Back to a better error behavior. Thank you. <3");s=e},get useDeprecatedSynchronousErrorHandling(){return s}};function o(e){setTimeout(()=>{throw e},0)}const a={closed:!0,next(e){},error(e){if(r.useDeprecatedSynchronousErrorHandling)throw e;o(e)},complete(){}},l=(()=>Array.isArray||(e=>e&&"number"==typeof e.length))();function h(e){return null!==e&&"object"==typeof e}const c=(()=>{function e(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((e,t)=>`${t+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e})();let d=(()=>{class e{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let t;if(this.closed)return;let{_parentOrParents:i,_ctorUnsubscribe:s,_unsubscribe:r,_subscriptions:o}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,i instanceof e)i.remove(this);else if(null!==i)for(let e=0;e<i.length;++e)i[e].remove(this);if(n(r)){s&&(this._unsubscribe=void 0);try{r.call(this)}catch(a){t=a instanceof c?p(a.errors):[a]}}if(l(o)){let e=-1,i=o.length;for(;++e<i;){const i=o[e];if(h(i))try{i.unsubscribe()}catch(a){t=t||[],a instanceof c?t=t.concat(p(a.errors)):t.push(a)}}}if(t)throw new c(t)}add(t){let i=t;if(!t)return e.EMPTY;switch(typeof t){case"function":i=new e(t);case"object":if(i===this||i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;if(!(i instanceof e)){const t=i;i=new e,i._subscriptions=[t]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}let{_parentOrParents:n}=i;if(null===n)i._parentOrParents=this;else if(n instanceof e){if(n===this)return i;i._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return i;n.push(this)}const s=this._subscriptions;return null===s?this._subscriptions=[i]:s.push(i),i}remove(e){const t=this._subscriptions;if(t){const i=t.indexOf(e);-1!==i&&t.splice(i,1)}}}return e.EMPTY=function(e){return e.closed=!0,e}(new e),e})();function p(e){return e.reduce((e,t)=>e.concat(t instanceof c?t.errors:t),[])}const u=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class g extends d{constructor(e,t,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a;break;case 1:if(!e){this.destination=a;break}if("object"==typeof e){e instanceof g?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new m(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new m(this,e,t,i)}}[u](){return this}static create(e,t,i){const n=new g(e,t,i);return n.syncErrorThrowable=!1,n}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class m extends g{constructor(e,t,i,s){let r;super(),this._parentSubscriber=e;let o=this;n(t)?r=t:t&&(r=t.next,i=t.error,s=t.complete,t!==a&&(o=Object.create(t),n(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=r,this._error=i,this._complete=s}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;r.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:i}=r;if(this._error)i&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)i?(t.syncErrorValue=e,t.syncErrorThrown=!0):o(e),this.unsubscribe();else{if(this.unsubscribe(),i)throw e;o(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);r.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(i){if(this.unsubscribe(),r.useDeprecatedSynchronousErrorHandling)throw i;o(i)}}__tryOrSetError(e,t,i){if(!r.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,i)}catch(n){return r.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=n,e.syncErrorThrown=!0,!0):(o(n),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const f=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function y(e){return e}let b=(()=>{class e{constructor(e){this._isScalar=!1,e&&(this._subscribe=e)}lift(t){const i=new e;return i.source=this,i.operator=t,i}subscribe(e,t,i){const{operator:n}=this,s=function(e,t,i){if(e){if(e instanceof g)return e;if(e[u])return e[u]()}return e||t||i?new g(e,t,i):new g(a)}(e,t,i);if(s.add(n?n.call(s,this.source):this.source||r.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),r.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s}_trySubscribe(e){try{return this._subscribe(e)}catch(t){r.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){const{closed:t,destination:i,isStopped:n}=e;if(t||n)return!1;e=i&&i instanceof g?i:null}return!0}(e)?e.error(t):console.warn(t)}}forEach(e,t){return new(t=v(t))((t,i)=>{let n;n=this.subscribe(t=>{try{e(t)}catch(s){i(s),n&&n.unsubscribe()}},i,t)})}_subscribe(e){const{source:t}=this;return t&&t.subscribe(e)}[f](){return this}pipe(...e){return 0===e.length?this:(0===(t=e).length?y:1===t.length?t[0]:function(e){return t.reduce((e,t)=>t(e),e)})(this);var t}toPromise(e){return new(e=v(e))((e,t)=>{let i;this.subscribe(e=>i=e,e=>t(e),()=>e(i))})}}return e.create=t=>new e(t),e})();function v(e){if(e||(e=r.Promise||Promise),!e)throw new Error("no Promise impl found");return e}const w=(()=>{function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e})();class x extends d{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const i=t.indexOf(this.subscriber);-1!==i&&t.splice(i,1)}}class S extends g{constructor(e){super(e),this.destination=e}}let C=(()=>{class e extends b{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[u](){return new S(this)}lift(e){const t=new P(this,this);return t.operator=e,t}next(e){if(this.closed)throw new w;if(!this.isStopped){const{observers:t}=this,i=t.length,n=t.slice();for(let s=0;s<i;s++)n[s].next(e)}}error(e){if(this.closed)throw new w;this.hasError=!0,this.thrownError=e,this.isStopped=!0;const{observers:t}=this,i=t.length,n=t.slice();for(let s=0;s<i;s++)n[s].error(e);this.observers.length=0}complete(){if(this.closed)throw new w;this.isStopped=!0;const{observers:e}=this,t=e.length,i=e.slice();for(let n=0;n<t;n++)i[n].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(e){if(this.closed)throw new w;return super._trySubscribe(e)}_subscribe(e){if(this.closed)throw new w;return this.hasError?(e.error(this.thrownError),d.EMPTY):this.isStopped?(e.complete(),d.EMPTY):(this.observers.push(e),new x(this,e))}asObservable(){const e=new b;return e.source=this,e}}return e.create=(e,t)=>new P(e,t),e})();class P extends C{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):d.EMPTY}}function O(e){return e&&"function"==typeof e.schedule}function T(e,t){return function(i){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new E(e,t))}}class E{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new A(e,this.project,this.thisArg))}}class A extends g{constructor(e,t,i){super(e),this.project=t,this.count=0,this.thisArg=i||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const I=e=>t=>{for(let i=0,n=e.length;i<n&&!t.closed;i++)t.next(e[i]);t.complete()};function D(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const M=D(),R=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function z(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}const L=e=>{if(e&&"function"==typeof e[f])return i=e,e=>{const t=i[f]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(R(e))return I(e);if(z(e))return(e=>t=>(e.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,o),t))(e);if(e&&"function"==typeof e[M])return t=e,e=>{const i=t[M]();for(;;){let t;try{t=i.next()}catch(n){return e.error(n),e}if(t.done){e.complete();break}if(e.next(t.value),e.closed)break}return"function"==typeof i.return&&e.add(()=>{i.return&&i.return()}),e};{const t=h(e)?"an invalid object":`'${e}'`;throw new TypeError(`You provided ${t} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var t,i};function k(e,t){return new b(i=>{const n=new d;let s=0;return n.add(t.schedule(function(){s!==e.length?(i.next(e[s++]),i.closed||n.add(this.schedule())):i.complete()})),n})}function j(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[f]}(e))return function(e,t){return new b(i=>{const n=new d;return n.add(t.schedule(()=>{const s=e[f]();n.add(s.subscribe({next(e){n.add(t.schedule(()=>i.next(e)))},error(e){n.add(t.schedule(()=>i.error(e)))},complete(){n.add(t.schedule(()=>i.complete()))}}))})),n})}(e,t);if(z(e))return function(e,t){return new b(i=>{const n=new d;return n.add(t.schedule(()=>e.then(e=>{n.add(t.schedule(()=>{i.next(e),n.add(t.schedule(()=>i.complete()))}))},e=>{n.add(t.schedule(()=>i.error(e)))}))),n})}(e,t);if(R(e))return k(e,t);if(function(e){return e&&"function"==typeof e[M]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new b(i=>{const n=new d;let s;return n.add(()=>{s&&"function"==typeof s.return&&s.return()}),n.add(t.schedule(()=>{s=e[M](),n.add(t.schedule(function(){if(i.closed)return;let e,t;try{const i=s.next();e=i.value,t=i.done}catch(n){return void i.error(n)}t?i.complete():(i.next(e),this.schedule())}))})),n})}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof b?e:new b(L(e))}class H extends g{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class _ extends g{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function N(e,t){if(t.closed)return;if(e instanceof b)return e.subscribe(t);let i;try{i=L(e)(t)}catch(n){t.error(n)}return i}function B(e,t,i=Number.POSITIVE_INFINITY){return"function"==typeof t?n=>n.pipe(B((i,n)=>j(e(i,n)).pipe(T((e,s)=>t(i,e,n,s))),i)):("number"==typeof t&&(i=t),t=>t.lift(new W(e,i)))}class W{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new U(e,this.project,this.concurrent))}}class U extends _{constructor(e,t,i=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(n){return void this.destination.error(n)}this.active++,this._innerSub(t)}_innerSub(e){const t=new H(this),i=this.destination;i.add(t);const n=N(e,t);n!==t&&i.add(n)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function F(e=Number.POSITIVE_INFINITY){return B(y,e)}function V(e,t){return t?k(e,t):new b(I(e))}function Y(){return function(e){return e.lift(new X(e))}}class X{constructor(e){this.connectable=e}call(e,t){const{connectable:i}=this;i._refCount++;const n=new G(e,i),s=t.subscribe(n);return n.closed||(n.connection=i.connect()),s}}class G extends g{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:i}=this,n=e._connection;this.connection=null,!n||i&&n!==i||n.unsubscribe()}}class q extends b{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new d,e.add(this.source.subscribe(new $(this.getSubject(),this))),e.closed&&(this._connection=null,e=d.EMPTY)),e}refCount(){return Y()(this)}}const Z=(()=>{const e=q.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}})();class $ extends S{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}function Q(){return new C}function J(e){for(let t in e)if(e[t]===J)return t;throw Error("Could not find renamed property on target object.")}function K(e,t){for(const i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i])}function ee(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(ee).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const i=t.indexOf("\n");return-1===i?t:t.substring(0,i)}function te(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const ie=J({__forward_ref__:J});function ne(e){return e.__forward_ref__=ne,e.toString=function(){return ee(this())},e}function se(e){return"function"==typeof(t=e)&&t.hasOwnProperty(ie)&&t.__forward_ref__===ne?e():e;var t}class re extends Error{constructor(e,t){super(function(e,t){return`${e?`NG0${e}: `:""}${t}`}(e,t)),this.code=e}}function oe(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():function(e){return"string"==typeof e?e:null==e?"":String(e)}(e)}function ae(e,t){const i=t?` in ${t}`:"";throw new re("201",`No provider for ${oe(e)} found${i}`)}function le(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function he(e){return{providers:e.providers||[],imports:e.imports||[]}}function ce(e){return de(e,ue)||de(e,me)}function de(e,t){return e.hasOwnProperty(t)?e[t]:null}function pe(e){return e&&(e.hasOwnProperty(ge)||e.hasOwnProperty(fe))?e[ge]:null}const ue=J({"\u0275prov":J}),ge=J({"\u0275inj":J}),me=J({ngInjectableDef:J}),fe=J({ngInjectorDef:J});var ye=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});let be;function ve(e){const t=be;return be=e,t}function we(e,t,i){const n=ce(e);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:i&ye.Optional?null:void 0!==t?t:void ae(ee(e),"Injector")}function xe(e){return{toString:e}.toString()}var Se=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}({}),Ce=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}({});const Pe="undefined"!=typeof globalThis&&globalThis,Oe="undefined"!=typeof window&&window,Te="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Ee="undefined"!=typeof global&&global,Ae=Pe||Ee||Oe||Te,Ie={},De=[],Me=J({"\u0275cmp":J}),Re=J({"\u0275dir":J}),ze=J({"\u0275pipe":J}),Le=J({"\u0275mod":J}),ke=J({"\u0275loc":J}),je=J({"\u0275fac":J}),He=J({__NG_ELEMENT_ID__:J});let _e=0;function Ne(e){return xe(()=>{const t={},i={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Se.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||De,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Ce.Emulated,id:"c",styles:e.styles||De,_:null,setInput:null,schemas:e.schemas||null,tView:null},n=e.directives,s=e.features,r=e.pipes;return i.id+=_e++,i.inputs=Ve(e.inputs,t),i.outputs=Ve(e.outputs),s&&s.forEach(e=>e(i)),i.directiveDefs=n?()=>("function"==typeof n?n():n).map(Be):null,i.pipeDefs=r?()=>("function"==typeof r?r():r).map(We):null,i})}function Be(e){return Xe(e)||function(e){return e[Re]||null}(e)}function We(e){return function(e){return e[ze]||null}(e)}const Ue={};function Fe(e){return xe(()=>{const t={type:e.type,bootstrap:e.bootstrap||De,declarations:e.declarations||De,imports:e.imports||De,exports:e.exports||De,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(Ue[e.id]=e.type),t})}function Ve(e,t){if(null==e)return Ie;const i={};for(const n in e)if(e.hasOwnProperty(n)){let s=e[n],r=s;Array.isArray(s)&&(r=s[1],s=s[0]),i[s]=n,t&&(t[s]=r)}return i}const Ye=Ne;function Xe(e){return e[Me]||null}function Ge(e,t){const i=e[Le]||null;if(!i&&!0===t)throw new Error(`Type ${ee(e)} does not have '\u0275mod' property.`);return i}const qe=20,Ze=10;function $e(e){return Array.isArray(e)&&"object"==typeof e[1]}function Qe(e){return Array.isArray(e)&&!0===e[1]}function Je(e){return 0!=(8&e.flags)}function Ke(e){return 2==(2&e.flags)}function et(e){return 1==(1&e.flags)}function tt(e){return null!==e.template}function it(e,t){return e.hasOwnProperty(je)?e[je]:null}class nt{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function st(){const e=ot(this),t=null==e?void 0:e.current;if(t){const i=e.previous;if(i===Ie)e.previous=t;else for(let e in t)i[e]=t[e];e.current=null,this.ngOnChanges(t)}}function rt(e,t,i,n){const s=ot(e)||function(e,t){return e.__ngSimpleChanges__=t}(e,{previous:Ie,current:null}),r=s.current||(s.current={}),o=s.previous,a=this.declaredInputs[i],l=o[a];r[a]=new nt(l&&l.currentValue,t,o===Ie),e[n]=t}function ot(e){return e.__ngSimpleChanges__||null}const at="http://www.w3.org/2000/svg";let lt;function ht(e){return!!e.listen}const ct={createRenderer:(e,t)=>void 0!==lt?lt:"undefined"!=typeof document?document:void 0};function dt(e){for(;Array.isArray(e);)e=e[0];return e}function pt(e,t){return dt(t[e.index])}function ut(e,t){return e.data[t]}function gt(e,t){const i=t[e];return $e(i)?i:i[0]}function mt(e){return 4==(4&e[2])}function ft(e){return 128==(128&e[2])}function yt(e,t){return null==t?null:e[t]}function bt(e){e[18]=0}function vt(e,t){e[5]+=t;let i=e,n=e[3];for(;null!==n&&(1===t&&1===i[5]||-1===t&&0===i[5]);)n[5]+=t,i=n,n=n[3]}const wt={lFrame:_t(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function xt(){return wt.bindingsEnabled}function St(){return wt.lFrame.lView}function Ct(){return wt.lFrame.tView}function Pt(){let e=Ot();for(;null!==e&&64===e.type;)e=e.parent;return e}function Ot(){return wt.lFrame.currentTNode}function Tt(e,t){const i=wt.lFrame;i.currentTNode=e,i.isParent=t}function Et(){return wt.lFrame.isParent}function At(){return wt.isInCheckNoChangesMode}function It(e){wt.isInCheckNoChangesMode=e}function Dt(e,t){const i=wt.lFrame;i.bindingIndex=i.bindingRootIndex=e,Mt(t)}function Mt(e){wt.lFrame.currentDirectiveIndex=e}function Rt(){return wt.lFrame.currentQueryIndex}function zt(e){wt.lFrame.currentQueryIndex=e}function Lt(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function kt(e,t,i){if(i&ye.SkipSelf){let n=t,s=e;for(;n=n.parent,!(null!==n||i&ye.Host||(n=Lt(s),null===n)||(s=s[15],10&n.type)););if(null===n)return!1;t=n,e=s}const n=wt.lFrame=Ht();return n.currentTNode=t,n.lView=e,!0}function jt(e){const t=Ht(),i=e[1];wt.lFrame=t,t.currentTNode=i.firstChild,t.lView=e,t.tView=i,t.contextLView=e,t.bindingIndex=i.bindingStartIndex,t.inI18n=!1}function Ht(){const e=wt.lFrame,t=null===e?null:e.child;return null===t?_t(e):t}function _t(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function Nt(){const e=wt.lFrame;return wt.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const Bt=Nt;function Wt(){const e=Nt();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function Ut(){return wt.lFrame.selectedIndex}function Ft(e){wt.lFrame.selectedIndex=e}function Vt(){wt.lFrame.currentNamespace=at}function Yt(){wt.lFrame.currentNamespace=null}function Xt(e,t){for(let i=t.directiveStart,n=t.directiveEnd;i<n;i++){const t=e.data[i].type.prototype,{ngAfterContentInit:n,ngAfterContentChecked:s,ngAfterViewInit:r,ngAfterViewChecked:o,ngOnDestroy:a}=t;n&&(e.contentHooks||(e.contentHooks=[])).push(-i,n),s&&((e.contentHooks||(e.contentHooks=[])).push(i,s),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(i,s)),r&&(e.viewHooks||(e.viewHooks=[])).push(-i,r),o&&((e.viewHooks||(e.viewHooks=[])).push(i,o),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(i,o)),null!=a&&(e.destroyHooks||(e.destroyHooks=[])).push(i,a)}}function Gt(e,t,i){$t(e,t,3,i)}function qt(e,t,i,n){(3&e[2])===i&&$t(e,t,i,n)}function Zt(e,t){let i=e[2];(3&i)===t&&(i&=2047,i+=1,e[2]=i)}function $t(e,t,i,n){const s=null!=n?n:-1,r=t.length-1;let o=0;for(let a=void 0!==n?65535&e[18]:0;a<r;a++)if("number"==typeof t[a+1]){if(o=t[a],null!=n&&o>=n)break}else t[a]<0&&(e[18]+=65536),(o<s||-1==s)&&(Qt(e,i,t,a),e[18]=(4294901760&e[18])+a+2),a++}function Qt(e,t,i,n){const s=i[n]<0,r=i[n+1],o=e[s?-i[n]:i[n]];if(s){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{r.call(o)}finally{}}}else try{r.call(o)}finally{}}const Jt=-1;class Kt{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function ei(e,t,i){const n=ht(e);let s=0;for(;s<i.length;){const r=i[s];if("number"==typeof r){if(0!==r)break;s++;const o=i[s++],a=i[s++],l=i[s++];n?e.setAttribute(t,a,l,o):t.setAttributeNS(o,a,l)}else{const o=r,a=i[++s];ii(o)?n&&e.setProperty(t,o,a):n?e.setAttribute(t,o,a):t.setAttribute(o,a),s++}}return s}function ti(e){return 3===e||4===e||6===e}function ii(e){return 64===e.charCodeAt(0)}function ni(e,t){if(null===t||0===t.length);else if(null===e||0===e.length)e=t.slice();else{let i=-1;for(let n=0;n<t.length;n++){const s=t[n];"number"==typeof s?i=s:0===i||si(e,i,s,null,-1===i||2===i?t[++n]:null)}}return e}function si(e,t,i,n,s){let r=0,o=e.length;if(-1===t)o=-1;else for(;r<e.length;){const i=e[r++];if("number"==typeof i){if(i===t){o=-1;break}if(i>t){o=r-1;break}}}for(;r<e.length;){const t=e[r];if("number"==typeof t)break;if(t===i){if(null===n)return void(null!==s&&(e[r+1]=s));if(n===e[r+1])return void(e[r+2]=s)}r++,null!==n&&r++,null!==s&&r++}-1!==o&&(e.splice(o,0,t),r=o+1),e.splice(r++,0,i),null!==n&&e.splice(r++,0,n),null!==s&&e.splice(r++,0,s)}function ri(e){return e!==Jt}function oi(e){return 32767&e}function ai(e,t){let i=e>>16,n=t;for(;i>0;)n=n[15],i--;return n}let li=!0;function hi(e){const t=li;return li=e,t}let ci=0;function di(e,t){const i=ui(e,t);if(-1!==i)return i;const n=t[1];n.firstCreatePass&&(e.injectorIndex=t.length,pi(n.data,e),pi(t,null),pi(n.blueprint,null));const s=gi(e,t),r=e.injectorIndex;if(ri(s)){const e=oi(s),i=ai(s,t),n=i[1].data;for(let s=0;s<8;s++)t[r+s]=i[e+s]|n[e+s]}return t[r+8]=s,r}function pi(e,t){e.push(0,0,0,0,0,0,0,0,t)}function ui(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function gi(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let i=0,n=null,s=t;for(;null!==s;){const e=s[1],t=e.type;if(n=2===t?e.declTNode:1===t?s[6]:null,null===n)return Jt;if(i++,s=s[15],-1!==n.injectorIndex)return n.injectorIndex|i<<16}return Jt}function mi(e,t,i){!function(e,t,i){let n;"string"==typeof i?n=i.charCodeAt(0)||0:i.hasOwnProperty(He)&&(n=i[He]),null==n&&(n=i[He]=ci++);const s=255&n;t.data[e+(s>>5)]|=1<<s}(e,t,i)}function fi(e,t,i){if(i&ye.Optional)return e;ae(t,"NodeInjector")}function yi(e,t,i,n){if(i&ye.Optional&&void 0===n&&(n=null),0==(i&(ye.Self|ye.Host))){const s=e[9],r=ve(void 0);try{return s?s.get(t,n,i&ye.Optional):we(t,n,i&ye.Optional)}finally{ve(r)}}return fi(n,t,i)}function bi(e,t,i,n=ye.Default,s){if(null!==e){const r=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(He)?e[He]:void 0;return"number"==typeof t?t>=0?255&t:wi:t}(i);if("function"==typeof r){if(!kt(t,e,n))return n&ye.Host?fi(s,i,n):yi(t,i,n,s);try{const e=r(n);if(null!=e||n&ye.Optional)return e;ae(i)}finally{Bt()}}else if("number"==typeof r){let s=null,o=ui(e,t),a=Jt,l=n&ye.Host?t[16][6]:null;for((-1===o||n&ye.SkipSelf)&&(a=-1===o?gi(e,t):t[o+8],a!==Jt&&Oi(n,!1)?(s=t[1],o=oi(a),t=ai(a,t)):o=-1);-1!==o;){const e=t[1];if(Pi(r,o,e.data)){const e=xi(o,t,i,s,n,l);if(e!==vi)return e}a=t[o+8],a!==Jt&&Oi(n,t[1].data[o+8]===l)&&Pi(r,o,t)?(s=e,o=oi(a),t=ai(a,t)):o=-1}}}return yi(t,i,n,s)}const vi={};function wi(){return new Ti(Pt(),St())}function xi(e,t,i,n,s,r){const o=t[1],a=o.data[e+8],l=Si(a,o,i,null==n?Ke(a)&&li:n!=o&&0!=(3&a.type),s&ye.Host&&r===a);return null!==l?Ci(t,o,l,a):vi}function Si(e,t,i,n,s){const r=e.providerIndexes,o=t.data,a=1048575&r,l=e.directiveStart,h=r>>20,c=s?a+h:e.directiveEnd;for(let d=n?a:a+h;d<c;d++){const e=o[d];if(d<l&&i===e||d>=l&&e.type===i)return d}if(s){const e=o[l];if(e&&tt(e)&&e.type===i)return l}return null}function Ci(e,t,i,n){let s=e[i];const r=t.data;if(s instanceof Kt){const o=s;o.resolving&&function(e,t){throw new re("200",`Circular dependency in DI detected for ${e}`)}(oe(r[i]));const a=hi(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?ve(o.injectImpl):null;kt(e,n,ye.Default);try{s=e[i]=o.factory(void 0,r,e,n),t.firstCreatePass&&i>=n.directiveStart&&function(e,t,i){const{ngOnChanges:n,ngOnInit:s,ngDoCheck:r}=t.type.prototype;if(n){const n=((o=t).type.prototype.ngOnChanges&&(o.setInput=rt),st);(i.preOrderHooks||(i.preOrderHooks=[])).push(e,n),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(e,n)}var o;s&&(i.preOrderHooks||(i.preOrderHooks=[])).push(0-e,s),r&&((i.preOrderHooks||(i.preOrderHooks=[])).push(e,r),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(e,r))}(i,r[i],t)}finally{null!==l&&ve(l),hi(a),o.resolving=!1,Bt()}}return s}function Pi(e,t,i){return!!(i[t+(e>>5)]&1<<e)}function Oi(e,t){return!(e&ye.Self||e&ye.Host&&t)}class Ti{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return bi(this._tNode,this._lView,e,void 0,t)}}const Ei="__parameters__";function Ai(e,t,i){return xe(()=>{const n=function(e){return function(...t){if(e){const i=e(...t);for(const e in i)this[e]=i[e]}}}(t);function s(...e){if(this instanceof s)return n.apply(this,e),this;const t=new s(...e);return i.annotation=t,i;function i(e,i,n){const s=e.hasOwnProperty(Ei)?e[Ei]:Object.defineProperty(e,Ei,{value:[]})[Ei];for(;s.length<=n;)s.push(null);return(s[n]=s[n]||[]).push(t),e}}return i&&(s.prototype=Object.create(i.prototype)),s.prototype.ngMetadataName=e,s.annotationCls=s,s})}class Ii{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=le({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Di=new Ii("AnalyzeForEntryComponents"),Mi=Function;function Ri(e,t){void 0===t&&(t=e);for(let i=0;i<e.length;i++){let n=e[i];Array.isArray(n)?(t===e&&(t=e.slice(0,i)),Ri(n,t)):t!==e&&t.push(n)}return t}function zi(e,t){e.forEach(e=>Array.isArray(e)?zi(e,t):t(e))}function Li(e,t,i){t>=e.length?e.push(i):e.splice(t,0,i)}function ki(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}const ji={},Hi=/\n/gm,_i="__source",Ni=J({provide:String,useValue:J});let Bi;function Wi(e){const t=Bi;return Bi=e,t}function Ui(e,t=ye.Default){if(void 0===Bi)throw new Error("inject() must be called from an injection context");return null===Bi?we(e,void 0,t):Bi.get(e,t&ye.Optional?null:void 0,t)}function Fi(e,t=ye.Default){return(be||Ui)(se(e),t)}function Vi(e){const t=[];for(let i=0;i<e.length;i++){const n=se(e[i]);if(Array.isArray(n)){if(0===n.length)throw new Error("Arguments array must have arguments.");let e,i=ye.Default;for(let t=0;t<n.length;t++){const s=n[t],r=s.__NG_DI_FLAG__;"number"==typeof r?-1===r?e=s.token:i|=r:e=s}t.push(Fi(e,i))}else t.push(Fi(n))}return t}function Yi(e,t){return e.__NG_DI_FLAG__=t,e.prototype.__NG_DI_FLAG__=t,e}const Xi=Yi(Ai("Inject",e=>({token:e})),-1),Gi=Yi(Ai("Optional"),8),qi=Yi(Ai("SkipSelf"),4);function Zi(e,t){e.__ngContext__=t}function $i(e){const t=function(e){return e.__ngContext__||null}(e);return t?Array.isArray(t)?t:t.lView:null}function Qi(e){return e.ngDebugContext}function Ji(e){return e.ngOriginalError}function Ki(e,...t){e.error(...t)}class en{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=this._findContext(e),n=function(e){return e.ngErrorLogger||Ki}(e);n(this._console,"ERROR",e),t&&n(this._console,"ORIGINAL ERROR",t),i&&n(this._console,"ERROR CONTEXT",i)}_findContext(e){return e?Qi(e)?Qi(e):this._findContext(Ji(e)):null}_findOriginalError(e){let t=Ji(e);for(;t&&Ji(t);)t=Ji(t);return t}}const tn=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Ae))();function nn(e){return e instanceof Function?e():e}var sn=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}({});function rn(e,t){return(void 0)(e,t)}function on(e){const t=e[3];return Qe(t)?t[3]:t}function an(e){return hn(e[13])}function ln(e){return hn(e[4])}function hn(e){for(;null!==e&&!Qe(e);)e=e[4];return e}function cn(e,t,i,n,s){if(null!=n){let r,o=!1;Qe(n)?r=n:$e(n)&&(o=!0,n=n[0]);const a=dt(n);0===e&&null!==i?null==s?yn(t,i,a):fn(t,i,a,s||null,!0):1===e&&null!==i?fn(t,i,a,s||null,!0):2===e?function(e,t,i){const n=vn(e,t);n&&function(e,t,i,n){ht(e)?e.removeChild(t,i,n):t.removeChild(i)}(e,n,t,i)}(t,a,o):3===e&&t.destroyNode(a),null!=r&&function(e,t,i,n,s){const r=i[7];r!==dt(i)&&cn(t,e,n,r,s);for(let o=Ze;o<i.length;o++){const s=i[o];On(s[1],s,e,t,n,r)}}(t,e,r,i,s)}}function dn(e,t,i){return ht(e)?e.createElement(t,i):null===i?e.createElement(t):e.createElementNS(i,t)}function pn(e,t){const i=e[9],n=i.indexOf(t),s=t[3];1024&t[2]&&(t[2]&=-1025,vt(s,-1)),i.splice(n,1)}function un(e,t){if(e.length<=Ze)return;const i=Ze+t,n=e[i];if(n){const r=n[17];null!==r&&r!==e&&pn(r,n),t>0&&(e[i-1][4]=n[4]);const o=ki(e,Ze+t);On(n[1],s=n,s[11],2,null,null),s[0]=null,s[6]=null;const a=o[19];null!==a&&a.detachView(o[1]),n[3]=null,n[4]=null,n[2]&=-129}var s;return n}function gn(e,t){if(!(256&t[2])){const i=t[11];ht(i)&&i.destroyNode&&On(e,t,i,3,null,null),function(e){let t=e[13];if(!t)return mn(e[1],e);for(;t;){let i=null;if($e(t))i=t[13];else{const e=t[10];e&&(i=e)}if(!i){for(;t&&!t[4]&&t!==e;)$e(t)&&mn(t[1],t),t=t[3];null===t&&(t=e),$e(t)&&mn(t[1],t),i=t&&t[4]}t=i}}(t)}}function mn(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){let i;if(null!=e&&null!=(i=e.destroyHooks))for(let n=0;n<i.length;n+=2){const e=t[i[n]];if(!(e instanceof Kt)){const t=i[n+1];if(Array.isArray(t))for(let i=0;i<t.length;i+=2){const n=e[t[i]],s=t[i+1];try{s.call(n)}finally{}}else try{t.call(e)}finally{}}}}(e,t),function(e,t){const i=e.cleanup,n=t[7];let s=-1;if(null!==i)for(let r=0;r<i.length-1;r+=2)if("string"==typeof i[r]){const e=i[r+1],o="function"==typeof e?e(t):dt(t[e]),a=n[s=i[r+2]],l=i[r+3];"boolean"==typeof l?o.removeEventListener(i[r],a,l):l>=0?n[s=l]():n[s=-l].unsubscribe(),r+=2}else{const e=n[s=i[r+1]];i[r].call(e)}if(null!==n){for(let e=s+1;e<n.length;e++)(0,n[e])();t[7]=null}}(e,t),1===t[1].type&&ht(t[11])&&t[11].destroy();const i=t[17];if(null!==i&&Qe(t[3])){i!==t[3]&&pn(i,t);const n=t[19];null!==n&&n.detachView(e)}}}function fn(e,t,i,n,s){ht(e)?e.insertBefore(t,i,n,s):t.insertBefore(i,n,s)}function yn(e,t,i){ht(e)?e.appendChild(t,i):t.appendChild(i)}function bn(e,t,i,n,s){null!==n?fn(e,t,i,n,s):yn(e,t,i)}function vn(e,t){return ht(e)?e.parentNode(t):t.parentNode}function wn(e,t,i,n){const s=function(e,t,i){return function(e,t,i){let n=t;for(;null!==n&&40&n.type;)n=(t=n).parent;if(null===n)return i[0];if(2&n.flags){const t=e.data[n.directiveStart].encapsulation;if(t===Ce.None||t===Ce.Emulated)return null}return pt(n,i)}(e,t.parent,i)}(e,n,t),r=t[11],o=function(e,t,i){return function(e,t,i){return 40&e.type?pt(e,i):null}(e,0,i)}(n.parent||t[6],0,t);if(null!=s)if(Array.isArray(i))for(let a=0;a<i.length;a++)bn(r,s,i[a],o,!1);else bn(r,s,i,o,!1)}function xn(e,t){if(null!==t){const i=t.type;if(3&i)return pt(t,e);if(4&i)return Cn(-1,e[t.index]);if(8&i){const i=t.child;if(null!==i)return xn(e,i);{const i=e[t.index];return Qe(i)?Cn(-1,i):dt(i)}}if(32&i)return rn(t,e)()||dt(e[t.index]);{const i=Sn(e,t);return null!==i?Array.isArray(i)?i[0]:xn(on(e[16]),i):xn(e,t.next)}}return null}function Sn(e,t){return null!==t?e[16][6].projection[t.projection]:null}function Cn(e,t){const i=Ze+e+1;if(i<t.length){const e=t[i],n=e[1].firstChild;if(null!==n)return xn(e,n)}return t[7]}function Pn(e,t,i,n,s,r,o){for(;null!=i;){const a=n[i.index],l=i.type;if(o&&0===t&&(a&&Zi(dt(a),n),i.flags|=4),64!=(64&i.flags))if(8&l)Pn(e,t,i.child,n,s,r,!1),cn(t,e,s,a,r);else if(32&l){const o=rn(i,n);let l;for(;l=o();)cn(t,e,s,l,r);cn(t,e,s,a,r)}else 16&l?Tn(e,t,n,i,s,r):cn(t,e,s,a,r);i=o?i.projectionNext:i.next}}function On(e,t,i,n,s,r){Pn(i,n,e.firstChild,t,s,r,!1)}function Tn(e,t,i,n,s,r){const o=i[16],a=o[6].projection[n.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)cn(t,e,s,a[l],r);else Pn(e,t,a,o[3],s,r,!0)}function En(e,t,i){ht(e)?e.setAttribute(t,"style",i):t.style.cssText=i}function An(e,t,i){ht(e)?""===i?e.removeAttribute(t,"class"):e.setAttribute(t,"class",i):t.className=i}function In(e,t,i){let n=e.length;for(;;){const s=e.indexOf(t,i);if(-1===s)return s;if(0===s||e.charCodeAt(s-1)<=32){const i=t.length;if(s+i===n||e.charCodeAt(s+i)<=32)return s}i=s+1}}const Dn="ng-template";function Mn(e,t,i){let n=0;for(;n<e.length;){let s=e[n++];if(i&&"class"===s){if(s=e[n],-1!==In(s.toLowerCase(),t,0))return!0}else if(1===s){for(;n<e.length&&"string"==typeof(s=e[n++]);)if(s.toLowerCase()===t)return!0;return!1}}return!1}function Rn(e){return 4===e.type&&e.value!==Dn}function zn(e,t,i){return t===(4!==e.type||i?e.value:Dn)}function Ln(e,t,i){let n=4;const s=e.attrs||[],r=function(e){for(let t=0;t<e.length;t++)if(ti(e[t]))return t;return e.length}(s);let o=!1;for(let a=0;a<t.length;a++){const l=t[a];if("number"!=typeof l){if(!o)if(4&n){if(n=2|1&n,""!==l&&!zn(e,l,i)||""===l&&1===t.length){if(kn(n))return!1;o=!0}}else{const h=8&n?l:t[++a];if(8&n&&null!==e.attrs){if(!Mn(e.attrs,h,i)){if(kn(n))return!1;o=!0}continue}const c=jn(8&n?"class":l,s,Rn(e),i);if(-1===c){if(kn(n))return!1;o=!0;continue}if(""!==h){let e;e=c>r?"":s[c+1].toLowerCase();const t=8&n?e:null;if(t&&-1!==In(t,h,0)||2&n&&h!==e){if(kn(n))return!1;o=!0}}}}else{if(!o&&!kn(n)&&!kn(l))return!1;if(o&&kn(l))continue;o=!1,n=l|1&n}}return kn(n)||o}function kn(e){return 0==(1&e)}function jn(e,t,i,n){if(null===t)return-1;let s=0;if(n||!i){let i=!1;for(;s<t.length;){const n=t[s];if(n===e)return s;if(3===n||6===n)i=!0;else{if(1===n||2===n){let e=t[++s];for(;"string"==typeof e;)e=t[++s];continue}if(4===n)break;if(0===n){s+=4;continue}}s+=i?1:2}return-1}return function(e,t){let i=e.indexOf(4);if(i>-1)for(i++;i<e.length;){const n=e[i];if("number"==typeof n)return-1;if(n===t)return i;i++}return-1}(t,e)}function Hn(e,t,i=!1){for(let n=0;n<t.length;n++)if(Ln(e,t[n],i))return!0;return!1}function _n(e,t){return e?":not("+t.trim()+")":t}function Nn(e){let t=e[0],i=1,n=2,s="",r=!1;for(;i<e.length;){let o=e[i];if("string"==typeof o)if(2&n){const t=e[++i];s+="["+o+(t.length>0?'="'+t+'"':"")+"]"}else 8&n?s+="."+o:4&n&&(s+=" "+o);else""===s||kn(o)||(t+=_n(r,s),s=""),n=o,r=r||!kn(n);i++}return""!==s&&(t+=_n(r,s)),t}const Bn={};function Wn(e,t,i,n){if(!n)if(3==(3&t[2])){const n=e.preOrderCheckHooks;null!==n&&Gt(t,n,i)}else{const n=e.preOrderHooks;null!==n&&qt(t,n,0,i)}Ft(i)}function Un(e,t){const i=e.contentQueries;if(null!==i)for(let n=0;n<i.length;n+=2){const s=i[n],r=i[n+1];if(-1!==r){const i=e.data[r];zt(s),i.contentQueries(2,t[r],r)}}}function Fn(e,t,i,n,s,r,o,a,l,h){const c=t.blueprint.slice();return c[0]=s,c[2]=140|n,bt(c),c[3]=c[15]=e,c[8]=i,c[10]=o||e&&e[10],c[11]=a||e&&e[11],c[12]=l||e&&e[12]||null,c[9]=h||e&&e[9]||null,c[6]=r,c[16]=2==t.type?e[16]:c,c}function Vn(e,t,i,n,s){let r=e.data[t];if(null===r)r=function(e,t,i,n,s){const r=Ot(),o=Et(),a=e.data[t]=function(e,t,i,n,s,r){return{type:i,index:n,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:r,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?r:r&&r.parent,i,t,n,s);return null===e.firstChild&&(e.firstChild=a),null!==r&&(o?null==r.child&&null!==a.parent&&(r.child=a):null===r.next&&(r.next=a)),a}(e,t,i,n,s),wt.lFrame.inI18n&&(r.flags|=64);else if(64&r.type){r.type=i,r.value=n,r.attrs=s;const e=function(){const e=wt.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();r.injectorIndex=null===e?-1:e.injectorIndex}return Tt(r,!0),r}function Yn(e,t,i,n){if(0===i)return-1;const s=t.length;for(let r=0;r<i;r++)t.push(n),e.blueprint.push(n),e.data.push(null);return s}function Xn(e,t,i){jt(t);try{const n=e.viewQuery;null!==n&&fs(1,n,i);const s=e.template;null!==s&&Zn(e,t,s,1,i),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Un(e,t),e.staticViewQueries&&fs(2,e.viewQuery,i);const r=e.components;null!==r&&function(e,t){for(let i=0;i<t.length;i++)ds(e,t[i])}(t,r)}catch(n){throw e.firstCreatePass&&(e.incompleteFirstPass=!0),n}finally{t[2]&=-5,Wt()}}function Gn(e,t,i,n){const s=t[2];if(256==(256&s))return;jt(t);const r=At();try{bt(t),wt.lFrame.bindingIndex=e.bindingStartIndex,null!==i&&Zn(e,t,i,2,n);const o=3==(3&s);if(!r)if(o){const i=e.preOrderCheckHooks;null!==i&&Gt(t,i,null)}else{const i=e.preOrderHooks;null!==i&&qt(t,i,0,null),Zt(t,0)}if(function(e){for(let t=an(e);null!==t;t=ln(t)){if(!t[2])continue;const e=t[9];for(let t=0;t<e.length;t++){const i=e[t],n=i[3];0==(1024&i[2])&&vt(n,1),i[2]|=1024}}}(t),function(e){for(let t=an(e);null!==t;t=ln(t))for(let e=Ze;e<t.length;e++){const i=t[e],n=i[1];ft(i)&&Gn(n,i,n.template,i[8])}}(t),null!==e.contentQueries&&Un(e,t),!r)if(o){const i=e.contentCheckHooks;null!==i&&Gt(t,i)}else{const i=e.contentHooks;null!==i&&qt(t,i,1),Zt(t,1)}!function(e,t){const i=e.hostBindingOpCodes;if(null!==i)try{for(let e=0;e<i.length;e++){const n=i[e];if(n<0)Ft(~n);else{const s=n,r=i[++e],o=i[++e];Dt(r,s),o(2,t[s])}}}finally{Ft(-1)}}(e,t);const a=e.components;null!==a&&function(e,t){for(let i=0;i<t.length;i++)hs(e,t[i])}(t,a);const l=e.viewQuery;if(null!==l&&fs(2,l,n),!r)if(o){const i=e.viewCheckHooks;null!==i&&Gt(t,i)}else{const i=e.viewHooks;null!==i&&qt(t,i,2),Zt(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),r||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,vt(t[3],-1))}finally{Wt()}}function qn(e,t,i,n){const s=t[10],r=!At(),o=mt(t);try{r&&!o&&s.begin&&s.begin(),o&&Xn(e,t,n),Gn(e,t,i,n)}finally{r&&!o&&s.end&&s.end()}}function Zn(e,t,i,n,s){const r=Ut(),o=2&n;try{Ft(-1),o&&t.length>qe&&Wn(e,t,qe,At()),i(n,s)}finally{Ft(r)}}function $n(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Qn(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Qn(e,t,i,n,s,r,o,a,l,h){const c=qe+n,d=c+s,p=function(e,t){const i=[];for(let n=0;n<t;n++)i.push(n<e?null:Bn);return i}(c,d),u="function"==typeof h?h():h;return p[1]={type:e,blueprint:p,template:i,queries:null,viewQuery:a,declTNode:t,data:p.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof r?r():r,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:u,incompleteFirstPass:!1}}function Jn(e,t,i,n){const s=bs(t);null===i?s.push(n):(s.push(i),e.firstCreatePass&&vs(e).push(n,s.length-1))}function Kn(e,t,i){for(let n in e)if(e.hasOwnProperty(n)){const s=e[n];(i=null===i?{}:i).hasOwnProperty(n)?i[n].push(t,s):i[n]=[t,s]}return i}function es(e,t,i,n,s,r){const o=r.hostBindings;if(o){let i=e.hostBindingOpCodes;null===i&&(i=e.hostBindingOpCodes=[]);const r=~t.index;(function(e){let t=e.length;for(;t>0;){const i=e[--t];if("number"==typeof i&&i<0)return i}return 0})(i)!=r&&i.push(r),i.push(n,s,o)}}function ts(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function is(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function ns(e,t,i){if(i){if(t.exportAs)for(let n=0;n<t.exportAs.length;n++)i[t.exportAs[n]]=e;tt(t)&&(i[""]=e)}}function ss(e,t,i){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+i,e.providerIndexes=t}function rs(e,t,i,n,s){e.data[n]=s;const r=s.factory||(s.factory=it(s.type)),o=new Kt(r,tt(s),null);e.blueprint[n]=o,i[n]=o,es(e,t,0,n,Yn(e,i,s.hostVars,Bn),s)}function os(e,t,i){const n=pt(t,e),s=$n(i),r=e[10],o=ps(e,Fn(e,s,null,i.onPush?64:16,n,t,r,r.createRenderer(n,i),null,null));e[t.index]=o}function as(e,t,i,n,s,r){const o=r[t];if(null!==o){const e=n.setInput;for(let t=0;t<o.length;){const s=o[t++],r=o[t++],a=o[t++];null!==e?n.setInput(i,a,s,r):i[r]=a}}}function ls(e,t){let i=null,n=0;for(;n<t.length;){const s=t[n];if(0!==s)if(5!==s){if("number"==typeof s)break;e.hasOwnProperty(s)&&(null===i&&(i=[]),i.push(s,e[s],t[n+1])),n+=2}else n+=2;else n+=4}return i}function hs(e,t){const i=gt(t,e);if(ft(i)){const e=i[1];80&i[2]?Gn(e,i,e.template,i[8]):i[5]>0&&cs(i)}}function cs(e){for(let i=an(e);null!==i;i=ln(i))for(let e=Ze;e<i.length;e++){const t=i[e];if(1024&t[2]){const e=t[1];Gn(e,t,e.template,t[8])}else t[5]>0&&cs(t)}const t=e[1].components;if(null!==t)for(let i=0;i<t.length;i++){const n=gt(t[i],e);ft(n)&&n[5]>0&&cs(n)}}function ds(e,t){const i=gt(t,e),n=i[1];!function(e,t){for(let i=t.length;i<e.blueprint.length;i++)t.push(e.blueprint[i])}(n,i),Xn(n,i,i[8])}function ps(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function us(e){for(;e;){e[2]|=64;const t=on(e);if(0!=(512&e[2])&&!t)return e;e=t}return null}function gs(e,t,i){const n=t[10];n.begin&&n.begin();try{Gn(e,t,e.template,i)}catch(s){throw ws(t,s),s}finally{n.end&&n.end()}}function ms(e){!function(e){for(let t=0;t<e.components.length;t++){const i=e.components[t],n=$i(i),s=n[1];qn(s,n,s.template,i)}}(e[8])}function fs(e,t,i){zt(0),t(e,i)}const ys=(()=>Promise.resolve(null))();function bs(e){return e[7]||(e[7]=[])}function vs(e){return e.cleanup||(e.cleanup=[])}function ws(e,t){const i=e[9],n=i?i.get(en,null):null;n&&n.handleError(t)}function xs(e,t,i,n,s){for(let r=0;r<i.length;){const o=i[r++],a=i[r++],l=t[o],h=e.data[o];null!==h.setInput?h.setInput(l,s,n,a):l[a]=s}}function Ss(e,t,i){let n=i?e.styles:null,s=i?e.classes:null,r=0;if(null!==t)for(let o=0;o<t.length;o++){const e=t[o];"number"==typeof e?r=e:1==r?s=te(s,e):2==r&&(n=te(n,e+": "+t[++o]+";"))}i?e.styles=n:e.stylesWithoutHost=n,i?e.classes=s:e.classesWithoutHost=s}const Cs=new Ii("INJECTOR",-1);class Ps{get(e,t=ji){if(t===ji){const t=new Error(`NullInjectorError: No provider for ${ee(e)}!`);throw t.name="NullInjectorError",t}return t}}const Os=new Ii("Set Injector scope."),Ts={},Es={};let As;function Is(){return void 0===As&&(As=new Ps),As}function Ds(e,t=null,i=null,n){return new Ms(e,i,t||Is(),n)}class Ms{constructor(e,t,i,n=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&zi(t,i=>this.processProvider(i,e,t)),zi([e],e=>this.processInjectorType(e,[],s)),this.records.set(Cs,zs(void 0,this));const r=this.records.get(Os);this.scope=null!=r?r.value:null,this.source=n||("object"==typeof e?null:ee(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=ji,i=ye.Default){this.assertNotDestroyed();const n=Wi(this);try{if(!(i&ye.SkipSelf)){let t=this.records.get(e);if(void 0===t){const i=("function"==typeof(s=e)||"object"==typeof s&&s instanceof Ii)&&ce(e);t=i&&this.injectableDefInScope(i)?zs(Rs(e),Ts):null,this.records.set(e,t)}if(null!=t)return this.hydrate(e,t)}return(i&ye.Self?Is():this.parent).get(e,t=i&ye.Optional&&t===ji?null:t)}catch(r){if("NullInjectorError"===r.name){if((r.ngTempTokenPath=r.ngTempTokenPath||[]).unshift(ee(e)),n)throw r;return function(e,t,i,n){const s=e.ngTempTokenPath;throw t[_i]&&s.unshift(t[_i]),e.message=function(e,t,i,n=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let s=ee(t);if(Array.isArray(t))s=t.map(ee).join(" -> ");else if("object"==typeof t){let e=[];for(let i in t)if(t.hasOwnProperty(i)){let n=t[i];e.push(i+":"+("string"==typeof n?JSON.stringify(n):ee(n)))}s=`{${e.join(", ")}}`}return`${i}${n?"("+n+")":""}[${s}]: ${e.replace(Hi,"\n  ")}`}("\n"+e.message,s,i,n),e.ngTokenPath=s,e.ngTempTokenPath=null,e}(r,e,"R3InjectorError",this.source)}throw r}finally{Wi(n)}var s}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((t,i)=>e.push(ee(i))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,i){if(!(e=se(e)))return!1;let n=pe(e);const s=null==n&&e.ngModule||void 0,r=void 0===s?e:s,o=-1!==i.indexOf(r);if(void 0!==s&&(n=pe(s)),null==n)return!1;if(null!=n.imports&&!o){let e;i.push(r);try{zi(n.imports,n=>{this.processInjectorType(n,t,i)&&(void 0===e&&(e=[]),e.push(n))})}finally{}if(void 0!==e)for(let t=0;t<e.length;t++){const{ngModule:i,providers:n}=e[t];zi(n,e=>this.processProvider(e,i,n||De))}}this.injectorDefTypes.add(r);const a=it(r)||(()=>new r);this.records.set(r,zs(a,Ts));const l=n.providers;if(null!=l&&!o){const t=e;zi(l,e=>this.processProvider(e,t,l))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,i){let n=ks(e=se(e))?e:se(e&&e.provide);const s=function(e,t,i){return Ls(e)?zs(void 0,e.useValue):zs(function(e,t,i){let n;if(ks(e)){const t=se(e);return it(t)||Rs(t)}if(Ls(e))n=()=>se(e.useValue);else if((s=e)&&s.useFactory)n=()=>e.useFactory(...Vi(e.deps||[]));else if(function(e){return!(!e||!e.useExisting)}(e))n=()=>Fi(se(e.useExisting));else{const t=se(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return it(t)||Rs(t);n=()=>new t(...Vi(e.deps))}var s;return n}(e),Ts)}(e);if(ks(e)||!0!==e.multi)this.records.get(n);else{let t=this.records.get(n);t||(t=zs(void 0,Ts,!0),t.factory=()=>Vi(t.multi),this.records.set(n,t)),n=e,t.multi.push(e)}this.records.set(n,s)}hydrate(e,t){var i;return t.value===Ts&&(t.value=Es,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(i=t.value)&&"object"==typeof i&&"function"==typeof i.ngOnDestroy&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=se(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function Rs(e){const t=ce(e),i=null!==t?t.factory:it(e);if(null!==i)return i;if(e instanceof Ii)throw new Error(`Token ${ee(e)} is missing a \u0275prov definition.`);if(e instanceof Function)return function(e){const t=e.length;if(t>0){const i=function(e,t){const i=[];for(let n=0;n<e;n++)i.push("?");return i}(t);throw new Error(`Can't resolve all parameters for ${ee(e)}: (${i.join(", ")}).`)}const i=function(e){const t=e&&(e[ue]||e[me]);if(t){const i=function(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${i}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${i}" class.`),t}return null}(e);return null!==i?()=>i.factory(e):()=>new e}(e);throw new Error("unreachable")}function zs(e,t,i=!1){return{factory:e,value:t,multi:i?[]:void 0}}function Ls(e){return null!==e&&"object"==typeof e&&Ni in e}function ks(e){return"function"==typeof e}const js=function(e,t,i){return function(e,t=null,i=null,n){const s=Ds(e,t,i,n);return s._resolveInjectorDefTypes(),s}({name:i},t,e,i)};let Hs=(()=>{class e{static create(e,t){return Array.isArray(e)?js(e,t,""):js(e.providers,e.parent,e.name||"")}}return e.THROW_IF_NOT_FOUND=ji,e.NULL=new Ps,e.\u0275prov=le({token:e,providedIn:"any",factory:()=>Fi(Cs)}),e.__NG_ELEMENT_ID__=-1,e})();function _s(e,t){Xt($i(e)[1],Pt())}function Ns(e){let t=Object.getPrototypeOf(e.type.prototype).constructor,i=!0;const n=[e];for(;t;){let s;if(tt(e))s=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");s=t.\u0275dir}if(s){if(i){n.push(s);const t=e;t.inputs=Bs(e.inputs),t.declaredInputs=Bs(e.declaredInputs),t.outputs=Bs(e.outputs);const i=s.hostBindings;i&&Fs(e,i);const r=s.viewQuery,o=s.contentQueries;if(r&&Ws(e,r),o&&Us(e,o),K(e.inputs,s.inputs),K(e.declaredInputs,s.declaredInputs),K(e.outputs,s.outputs),tt(s)&&s.data.animation){const t=e.data;t.animation=(t.animation||[]).concat(s.data.animation)}}const t=s.features;if(t)for(let n=0;n<t.length;n++){const s=t[n];s&&s.ngInherit&&s(e),s===Ns&&(i=!1)}}t=Object.getPrototypeOf(t)}!function(e){let t=0,i=null;for(let n=e.length-1;n>=0;n--){const s=e[n];s.hostVars=t+=s.hostVars,s.hostAttrs=ni(s.hostAttrs,i=ni(i,s.hostAttrs))}}(n)}function Bs(e){return e===Ie?{}:e===De?[]:e}function Ws(e,t){const i=e.viewQuery;e.viewQuery=i?(e,n)=>{t(e,n),i(e,n)}:t}function Us(e,t){const i=e.contentQueries;e.contentQueries=i?(e,n,s)=>{t(e,n,s),i(e,n,s)}:t}function Fs(e,t){const i=e.hostBindings;e.hostBindings=i?(e,n)=>{t(e,n),i(e,n)}:t}let Vs=null;function Ys(){if(!Vs){const e=Ae.Symbol;if(e&&e.iterator)Vs=e.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Vs=i)}}}return Vs}function Xs(e){return!!Gs(e)&&(Array.isArray(e)||!(e instanceof Map)&&Ys()in e)}function Gs(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function qs(e,t=ye.Default){const i=St();return null===i?Fi(e,t):bi(Pt(),i,se(e),t)}function Zs(e,t,i){const n=St();return function(e,t,i){return!Object.is(e[t],i)&&(e[t]=i,!0)}(n,wt.lFrame.bindingIndex++,t)&&function(e,t,i,n,s,r,o,a){const l=pt(t,i);let h,c=t.inputs;var d;null!=c&&(h=c[n])?(xs(e,i,h,n,s),Ke(t)&&function(e,t){const i=gt(t,e);16&i[2]||(i[2]|=64)}(i,t.index)):3&t.type&&(n="class"===(d=n)?"className":"for"===d?"htmlFor":"formaction"===d?"formAction":"innerHtml"===d?"innerHTML":"readonly"===d?"readOnly":"tabindex"===d?"tabIndex":d,s=null!=o?o(s,t.value||"",n):s,ht(r)?r.setProperty(l,n,s):ii(n)||(l.setProperty?l.setProperty(n,s):l[n]=s))}(Ct(),function(){const e=wt.lFrame;return ut(e.tView,e.selectedIndex)}(),n,e,t,n[11],i),Zs}function $s(e,t,i,n,s){const r=s?"class":"style";xs(e,i,t.inputs[r],r,n)}function Qs(e,t,i,n){const s=St(),r=Ct(),o=qe+e,a=s[11],l=s[o]=dn(a,t,wt.lFrame.currentNamespace),h=r.firstCreatePass?function(e,t,i,n,s,r,o){const a=t.consts,l=Vn(t,e,2,s,yt(a,r));return function(e,t,i,n){let s=!1;if(xt()){const r=function(e,t,i){const n=e.directiveRegistry;let s=null;if(n)for(let r=0;r<n.length;r++){const o=n[r];Hn(i,o.selectors,!1)&&(s||(s=[]),mi(di(i,t),e,o.type),tt(o)?(is(e,i),s.unshift(o)):s.push(o))}return s}(e,t,i),o=null===n?null:{"":-1};if(null!==r){s=!0,ss(i,e.data.length,r.length);for(let e=0;e<r.length;e++){const t=r[e];t.providersResolver&&t.providersResolver(t)}let n=!1,a=!1,l=Yn(e,t,r.length,null);for(let s=0;s<r.length;s++){const h=r[s];i.mergedAttrs=ni(i.mergedAttrs,h.hostAttrs),rs(e,i,t,l,h),ns(l,h,o),null!==h.contentQueries&&(i.flags|=8),null===h.hostBindings&&null===h.hostAttrs&&0===h.hostVars||(i.flags|=128);const c=h.type.prototype;!n&&(c.ngOnChanges||c.ngOnInit||c.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(i.index),n=!0),a||!c.ngOnChanges&&!c.ngDoCheck||((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(i.index),a=!0),l++}!function(e,t){const i=t.directiveEnd,n=e.data,s=t.attrs,r=[];let o=null,a=null;for(let l=t.directiveStart;l<i;l++){const e=n[l],i=e.inputs,h=null===s||Rn(t)?null:ls(i,s);r.push(h),o=Kn(i,l,o),a=Kn(e.outputs,l,a)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=r,t.inputs=o,t.outputs=a}(e,i)}o&&function(e,t,i){if(t){const n=e.localNames=[];for(let e=0;e<t.length;e+=2){const s=i[t[e+1]];if(null==s)throw new re("301",`Export of name '${t[e+1]}' not found!`);n.push(t[e],s)}}}(i,n,o)}i.mergedAttrs=ni(i.mergedAttrs,i.attrs)}(t,i,l,yt(a,o)),null!==l.attrs&&Ss(l,l.attrs,!1),null!==l.mergedAttrs&&Ss(l,l.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,l),l}(o,r,s,0,t,i,n):r.data[o];Tt(h,!0);const c=h.mergedAttrs;null!==c&&ei(a,l,c);const d=h.classes;null!==d&&An(a,l,d);const p=h.styles;null!==p&&En(a,l,p),64!=(64&h.flags)&&wn(r,s,l,h),0===wt.lFrame.elementDepthCount&&Zi(l,s),wt.lFrame.elementDepthCount++,et(h)&&(function(e,t,i){xt()&&(function(e,t,i,n){const s=i.directiveStart,r=i.directiveEnd;e.firstCreatePass||di(i,t),Zi(n,t);const o=i.initialInputs;for(let a=s;a<r;a++){const n=e.data[a],r=tt(n);r&&os(t,i,n);const l=Ci(t,e,a,i);Zi(l,t),null!==o&&as(0,a-s,l,n,0,o),r&&(gt(i.index,t)[8]=l)}}(e,t,i,pt(i,t)),128==(128&i.flags)&&function(e,t,i){const n=i.directiveStart,s=i.directiveEnd,r=i.index,o=wt.lFrame.currentDirectiveIndex;try{Ft(r);for(let i=n;i<s;i++){const n=e.data[i],s=t[i];Mt(i),null===n.hostBindings&&0===n.hostVars&&null===n.hostAttrs||ts(n,s)}}finally{Ft(-1),Mt(o)}}(e,t,i))}(r,s,h),function(e,t,i){if(Je(t)){const n=t.directiveEnd;for(let s=t.directiveStart;s<n;s++){const t=e.data[s];t.contentQueries&&t.contentQueries(1,i[s],s)}}}(r,h,s)),null!==n&&function(e,t,i=pt){const n=t.localNames;if(null!==n){let s=t.index+1;for(let r=0;r<n.length;r+=2){const o=n[r+1],a=-1===o?i(t,e):e[o];e[s++]=a}}}(s,h)}function Js(){let e=Pt();Et()?wt.lFrame.isParent=!1:(e=e.parent,Tt(e,!1));const t=e;wt.lFrame.elementDepthCount--;const i=Ct();i.firstCreatePass&&(Xt(i,e),Je(e)&&i.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&$s(i,t,St(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&$s(i,t,St(),t.stylesWithoutHost,!1)}function Ks(e,t,i,n){Qs(e,t,i,n),Js()}function er(e){return!!e&&"function"==typeof e.then}const tr=function(e){return!!e&&"function"==typeof e.subscribe};function ir(e,t,i,n){const s=St(),r=Ct(),o=Pt();return function(e,t,i,n,s,r,o,a){const l=et(n),h=e.firstCreatePass&&vs(e),c=bs(t);let d=!0;if(3&n.type||a){const p=pt(n,t),u=a?a(p):p,g=c.length,m=a?e=>a(dt(e[n.index])):n.index;if(ht(i)){let o=null;if(!a&&l&&(o=function(e,t,i,n){const s=e.cleanup;if(null!=s)for(let r=0;r<s.length-1;r+=2){const e=s[r];if(e===i&&s[r+1]===n){const e=t[7],i=s[r+2];return e.length>i?e[i]:null}"string"==typeof e&&(r+=2)}return null}(e,t,s,n.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=r,o.__ngLastListenerFn__=r,d=!1;else{r=sr(n,t,0,r,!1);const e=i.listen(u,s,r);c.push(r,e),h&&h.push(s,m,g,g+1)}}else r=sr(n,t,0,r,!0),u.addEventListener(s,r,o),c.push(r),h&&h.push(s,m,g,o)}else r=sr(n,t,0,r,!1);const p=n.outputs;let u;if(d&&null!==p&&(u=p[s])){const e=u.length;if(e)for(let i=0;i<e;i+=2){const e=t[u[i]][u[i+1]].subscribe(r),o=c.length;c.push(r,e),h&&h.push(s,n.index,o,-(o+1))}}}(r,s,s[11],o,e,t,!!i,n),ir}function nr(e,t,i,n){try{return!1!==i(n)}catch(s){return ws(e,s),!1}}function sr(e,t,i,n,s){return function i(r){if(r===Function)return n;const o=2&e.flags?gt(e.index,t):t;0==(32&t[2])&&us(o);let a=nr(t,0,n,r),l=i.__ngNextListenerFn__;for(;l;)a=nr(t,0,l,r)&&a,l=l.__ngNextListenerFn__;return s&&!1===a&&(r.preventDefault(),r.returnValue=!1),a}}function rr(e,t=""){const i=St(),n=Ct(),s=e+qe,r=n.firstCreatePass?Vn(n,s,1,t,null):n.data[s],o=i[s]=function(e,t){return ht(e)?e.createText(t):e.createTextNode(t)}(i[11],t);wn(n,i,o,r),Tt(r,!1)}const or=void 0;var ar=["en",[["a","p"],["AM","PM"],or],[["AM","PM"],or,or],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],or,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],or,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",or,"{1} 'at' {0}",or],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){let t=Math.floor(Math.abs(e)),i=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let lr={};function hr(e){return e in lr||(lr[e]=Ae.ng&&Ae.ng.common&&Ae.ng.common.locales&&Ae.ng.common.locales[e]),lr[e]}var cr=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}({});const dr="en-US";let pr=dr;function ur(e){var t,i;i="Expected localeId to be defined",null==(t=e)&&function(e,t,i,n){throw new Error(`ASSERTION ERROR: ${e} [Expected=> null != ${t} <=Actual]`)}(i,t),"string"==typeof e&&(pr=e.toLowerCase().replace(/_/g,"-"))}class gr{}class mr{resolveComponentFactory(e){throw function(e){const t=Error(`No component factory found for ${ee(e)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=e,t}(e)}}let fr=(()=>{class e{}return e.NULL=new mr,e})();function yr(...e){}function br(e,t){return new wr(pt(e,t))}const vr=function(){return br(Pt(),St())};let wr=(()=>{class e{constructor(e){this.nativeElement=e}}return e.__NG_ELEMENT_ID__=vr,e})();function xr(e){return e instanceof wr?e.nativeElement:e}class Sr{}let Cr=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>Pr(),e})();const Pr=function(){const e=St(),t=gt(Pt().index,e);return function(e){return e[11]}($e(t)?t:e)};let Or=(()=>{class e{}return e.\u0275prov=le({token:e,providedIn:"root",factory:()=>null}),e})();class Tr{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Er=new Tr("12.0.5");class Ar{constructor(){}supports(e){return Xs(e)}create(e){return new Dr(e)}}const Ir=(e,t)=>t;class Dr{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Ir}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,n=0,s=null;for(;t||i;){const r=!i||t&&t.currentIndex<Lr(i,n,s)?t:i,o=Lr(r,n,s),a=r.currentIndex;if(r===i)n--,i=i._nextRemoved;else if(t=t._next,null==r.previousIndex)n++;else{s||(s=[]);const e=o-n,t=a-n;if(e!=t){for(let i=0;i<e;i++){const n=i<s.length?s[i]:s[i]=0,r=n+i;t<=r&&r<e&&(s[i]=n+1)}s[r.previousIndex]=t-e}}o!==a&&e(r,o,a)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Xs(e))throw new Error(`Error trying to diff '${ee(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t,i,n,s=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let t=0;t<this.length;t++)i=e[t],n=this._trackByFn(t,i),null!==s&&Object.is(s.trackById,n)?(r&&(s=this._verifyReinsertion(s,i,n,t)),Object.is(s.item,i)||this._addIdentityChange(s,i)):(s=this._mismatch(s,i,n,t),r=!0),s=s._next}else t=0,function(e,t){if(Array.isArray(e))for(let i=0;i<e.length;i++)t(e[i]);else{const i=e[Ys()]();let n;for(;!(n=i.next()).done;)t(n.value)}}(e,e=>{n=this._trackByFn(t,e),null!==s&&Object.is(s.trackById,n)?(r&&(s=this._verifyReinsertion(s,e,n,t)),Object.is(s.item,e)||this._addIdentityChange(s,e)):(s=this._mismatch(s,e,n,t),r=!0),s=s._next,t++}),this.length=t;return this._truncate(s),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,n){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,n)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,n))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,n)):e=this._addAfter(new Mr(t,i),s,n),e}_verifyReinsertion(e,t,i,n){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,n):e.currentIndex!=n&&(e.currentIndex=n,this._addToMoves(e,n)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const n=e._prevRemoved,s=e._nextRemoved;return null===n?this._removalsHead=s:n._nextRemoved=s,null===s?this._removalsTail=n:s._prevRemoved=n,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const n=null===t?this._itHead:t._next;return e._next=n,e._prev=t,null===n?this._itTail=e:n._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new zr),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new zr),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Mr{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Rr{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class zr{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new Rr,this.map.set(t,i)),i.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Lr(e,t,i){const n=e.previousIndex;if(null===n)return n;let s=0;return i&&n<i.length&&(s=i[n]),n+t+s}class kr{constructor(){}supports(e){return e instanceof Map||Gs(e)}create(){return new jr}}class jr{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Gs(e)))throw new Error(`Error trying to diff '${ee(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(e,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,e),this._appendAfter=t,t=t._next;else{const n=this._getOrCreateRecordForKey(i,e);t=this._insertBeforeOrAppend(t,n)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let e=t;null!==e;e=e._nextRemoved)e===this._mapHead&&(this._mapHead=null),this._records.delete(e.key),e._nextRemoved=e._next,e.previousValue=e.currentValue,e.currentValue=null,e._prev=null,e._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,t);const n=i._prev,s=i._next;return n&&(n._next=s),s&&(s._prev=n),i._next=null,i._prev=null,i}const i=new Hr(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class Hr{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function _r(){return new Nr([new Ar])}let Nr=(()=>{class e{constructor(e){this.factories=e}static create(t,i){if(null!=i){const e=i.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||_r()),deps:[[e,new qi,new Gi]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(null!=t)return t;throw new Error(`Cannot find a differ supporting object '${e}' of type '${i=e,i.name||typeof i}'`);var i}}return e.\u0275prov=le({token:e,providedIn:"root",factory:_r}),e})();function Br(){return new Wr([new kr])}let Wr=(()=>{class e{constructor(e){this.factories=e}static create(t,i){if(i){const e=i.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||Br()),deps:[[e,new qi,new Gi]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(t)return t;throw new Error(`Cannot find a differ supporting object '${e}'`)}}return e.\u0275prov=le({token:e,providedIn:"root",factory:Br}),e})();function Ur(e,t,i,n,s=!1){for(;null!==i;){const r=t[i.index];if(null!==r&&n.push(dt(r)),Qe(r))for(let e=Ze;e<r.length;e++){const t=r[e],i=t[1].firstChild;null!==i&&Ur(t[1],t,i,n)}const o=i.type;if(8&o)Ur(e,t,i.child,n);else if(32&o){const e=rn(i,t);let s;for(;s=e();)n.push(s)}else if(16&o){const e=Sn(t,i);if(Array.isArray(e))n.push(...e);else{const i=on(t[16]);Ur(i[1],i,e,n,!0)}}i=s?i.projectionNext:i.next}return n}class Fr{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Ur(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Qe(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(un(e,i),ki(t,i))}this._attachedToViewContainer=!1}gn(this._lView[1],this._lView)}onDestroy(e){Jn(this._lView[1],this._lView,null,e)}markForCheck(){us(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){gs(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(e,t,i){It(!0);try{gs(e,t,i)}finally{It(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var e;this._appRef=null,On(this._lView[1],e=this._lView,e[11],2,null,null)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class Vr extends Fr{constructor(e){super(e),this._view=e}detectChanges(){ms(this._view)}checkNoChanges(){!function(e){It(!0);try{ms(e)}finally{It(!1)}}(this._view)}get context(){return null}}const Yr=function(e){return function(e,t,i){if(Ke(e)&&!i){const i=gt(e.index,t);return new Fr(i,i)}return 47&e.type?new Fr(t[16],t):null}(Pt(),St(),16==(16&e))};let Xr=(()=>{class e{}return e.__NG_ELEMENT_ID__=Yr,e})();const Gr=[new kr],qr=new Nr([new Ar]),Zr=new Wr(Gr),$r=function(){return eo(Pt(),St())};let Qr=(()=>{class e{}return e.__NG_ELEMENT_ID__=$r,e})();const Jr=Qr,Kr=class extends Jr{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=Fn(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const n=this._declarationLView[19];return null!==n&&(i[19]=n.createEmbeddedView(t)),Xn(t,i,e),new Fr(i)}};function eo(e,t){return 4&e.type?new Kr(t,e,br(e,t)):null}class to{}class io{}const no=function(){return ho(Pt(),St())};let so=(()=>{class e{}return e.__NG_ELEMENT_ID__=no,e})();const ro=so,oo=class extends ro{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return br(this._hostTNode,this._hostLView)}get injector(){return new Ti(this._hostTNode,this._hostLView)}get parentInjector(){const e=gi(this._hostTNode,this._hostLView);if(ri(e)){const t=ai(e,this._hostLView),i=oi(e);return new Ti(t[1].data[i+8],t)}return new Ti(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=ao(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Ze}createEmbeddedView(e,t,i){const n=e.createEmbeddedView(t||{});return this.insert(n,i),n}createComponent(e,t,i,n,s){const r=i||this.parentInjector;if(!s&&null==e.ngModule&&r){const e=r.get(to,null);e&&(s=e)}const o=e.create(r,n,void 0,s);return this.insert(o.hostView,t),o}insert(e,t){const i=e._lView,n=i[1];if(Qe(i[3])){const t=this.indexOf(e);if(-1!==t)this.detach(t);else{const t=i[3],n=new oo(t,t[6],t[3]);n.detach(n.indexOf(e))}}const s=this._adjustIndex(t),r=this._lContainer;!function(e,t,i,n){const s=Ze+n,r=i.length;n>0&&(i[s-1][4]=t),n<r-Ze?(t[4]=i[s],Li(i,Ze+n,t)):(i.push(t),t[4]=null),t[3]=i;const o=t[17];null!==o&&i!==o&&function(e,t){const i=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===i?e[9]=[t]:i.push(t)}(o,t);const a=t[19];null!==a&&a.insertView(e),t[2]|=128}(n,i,r,s);const o=Cn(s,r),a=i[11],l=vn(a,r[7]);return null!==l&&function(e,t,i,n,s,r){n[0]=s,n[6]=t,On(e,n,i,1,s,r)}(n,r[6],a,i,l,o),e.attachToViewContainerRef(),Li(lo(r),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=ao(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=un(this._lContainer,t);i&&(ki(lo(this._lContainer),t),gn(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=un(this._lContainer,t);return i&&null!=ki(lo(this._lContainer),t)?new Fr(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function ao(e){return e[8]}function lo(e){return e[8]||(e[8]=[])}function ho(e,t){let i;const n=t[e.index];if(Qe(n))i=n;else{let s;if(8&e.type)s=dt(n);else{const i=t[11];s=i.createComment("");const n=pt(e,t);fn(i,vn(i,n),s,function(e,t){return ht(e)?e.nextSibling(t):t.nextSibling}(i,n),!1)}t[e.index]=i=new Array(n,!0,!1,t,null,0,e,s,null,null),ps(t,i)}return new oo(i,e,t)}const co={};class po extends fr{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Xe(e);return new mo(t,this.ngModule)}}function uo(e){const t=[];for(let i in e)e.hasOwnProperty(i)&&t.push({propName:e[i],templateName:i});return t}const go=new Ii("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>tn});class mo extends gr{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=e.selectors.map(Nn).join(","),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return uo(this.componentDef.inputs)}get outputs(){return uo(this.componentDef.outputs)}create(e,t,i,n){const s=(n=n||this.ngModule)?function(e,t){return{get:(i,n,s)=>{const r=e.get(i,co,s);return r!==co||n===co?r:t.get(i,n,s)}}}(e,n.injector):e,r=s.get(Sr,ct),o=s.get(Or,null),a=r.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",h=i?function(e,t,i){if(ht(e))return e.selectRootElement(t,i===Ce.ShadowDom);let n="string"==typeof t?e.querySelector(t):t;return n.textContent="",n}(a,i,this.componentDef.encapsulation):dn(r.createRenderer(null,this.componentDef),l,function(e){const t=e.toLowerCase();return"svg"===t?at:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),c=this.componentDef.onPush?576:528,d={components:[],scheduler:tn,clean:ys,playerHandler:null,flags:0},p=Qn(0,null,null,1,0,null,null,null,null,null),u=Fn(null,p,d,c,null,null,r,a,o,s);let g,m;jt(u);try{const e=function(e,t,i,n,s,r){const o=i[1];i[20]=e;const a=Vn(o,20,2,"#host",null),l=a.mergedAttrs=t.hostAttrs;null!==l&&(Ss(a,l,!0),null!==e&&(ei(s,e,l),null!==a.classes&&An(s,e,a.classes),null!==a.styles&&En(s,e,a.styles)));const h=n.createRenderer(e,t),c=Fn(i,$n(t),null,t.onPush?64:16,i[20],a,n,h,null,null);return o.firstCreatePass&&(mi(di(a,i),o,t.type),is(o,a),ss(a,i.length,1)),ps(i,c),i[20]=c}(h,this.componentDef,u,r,a);if(h)if(i)ei(a,h,["ng-version",Er.full]);else{const{attrs:e,classes:t}=function(e){const t=[],i=[];let n=1,s=2;for(;n<e.length;){let r=e[n];if("string"==typeof r)2===s?""!==r&&t.push(r,e[++n]):8===s&&i.push(r);else{if(!kn(s))break;s=r}n++}return{attrs:t,classes:i}}(this.componentDef.selectors[0]);e&&ei(a,h,e),t&&t.length>0&&An(a,h,t.join(" "))}if(m=ut(p,qe),void 0!==t){const e=m.projection=[];for(let i=0;i<this.ngContentSelectors.length;i++){const n=t[i];e.push(null!=n?Array.from(n):null)}}g=function(e,t,i,n,s){const r=i[1],o=function(e,t,i){const n=Pt();e.firstCreatePass&&(i.providersResolver&&i.providersResolver(i),rs(e,n,t,Yn(e,t,1,null),i));const s=Ci(t,e,n.directiveStart,n);Zi(s,t);const r=pt(n,t);return r&&Zi(r,t),s}(r,i,t);if(n.components.push(o),e[8]=o,s&&s.forEach(e=>e(o,t)),t.contentQueries){const e=Pt();t.contentQueries(1,o,e.directiveStart)}const a=Pt();return!r.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Ft(a.index),es(i[1],a,0,a.directiveStart,a.directiveEnd,t),ts(t,o)),o}(e,this.componentDef,u,d,[_s]),Xn(p,u,null)}finally{Wt()}return new fo(this.componentType,g,br(m,u),u,m)}}class fo extends class{}{constructor(e,t,i,n,s){super(),this.location=i,this._rootLView=n,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new Vr(n),this.componentType=e}get injector(){return new Ti(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const yo=new Map;class bo extends to{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new po(this);const i=Ge(e),n=e[ke]||null;n&&ur(n),this._bootstrapComponents=nn(i.bootstrap),this._r3Injector=Ds(e,t,[{provide:to,useValue:this},{provide:fr,useValue:this.componentFactoryResolver}],ee(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Hs.THROW_IF_NOT_FOUND,i=ye.Default){return e===Hs||e===to||e===Cs?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class vo extends io{constructor(e){super(),this.moduleType=e,null!==Ge(e)&&function(e){const t=new Set;!function e(i){const n=Ge(i,!0),s=n.id;null!==s&&(function(e,t,i){if(t&&t!==i)throw new Error(`Duplicate module registered for ${e} - ${ee(t)} vs ${ee(t.name)}`)}(s,yo.get(s),i),yo.set(s,i));const r=nn(n.imports);for(const o of r)t.has(o)||(t.add(o),e(o))}(e)}(e)}create(e){return new bo(this.moduleType,e)}}function wo(e){return t=>{setTimeout(e,void 0,t)}}const xo=class extends C{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var n,s,r;let o=e,a=t||(()=>null),l=i;if(e&&"object"==typeof e){const t=e;o=null===(n=t.next)||void 0===n?void 0:n.bind(t),a=null===(s=t.error)||void 0===s?void 0:s.bind(t),l=null===(r=t.complete)||void 0===r?void 0:r.bind(t)}this.__isAsync&&(a=wo(a),o&&(o=wo(o)),l&&(l=wo(l)));const h=super.subscribe({next:o,error:a,complete:l});return e instanceof d&&e.add(h),h}};function So(){return this._results[Ys()]()}class Co{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Ys(),i=Co.prototype;i[t]||(i[t]=So)}get changes(){return this._changes||(this._changes=new xo)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const n=Ri(e);(this._changesDetected=!function(e,t,i){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++){let s=e[n],r=t[n];if(i&&(s=i(s),r=i(r)),r!==s)return!1}return!0}(i._results,n,t))&&(i._results=n,i.length=n.length,i.last=n[this.length-1],i.first=n[0])}notifyOnChanges(){!this._changes||!this._changesDetected&&this._emitDistinctChangesOnly||this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class Po{constructor(e){this.queryList=e,this.matches=null}clone(){return new Po(this.queryList)}setDirty(){this.queryList.setDirty()}}class Oo{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,n=[];for(let e=0;e<i;e++){const i=t.getByIndex(e);n.push(this.queries[i.indexInDeclarationView].clone())}return new Oo(n)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==_o(e,t).matches&&this.queries[t].setDirty()}}class To{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class Eo{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const n=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,n);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new Eo(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Ao{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Ao(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let n=0;n<i.length;n++){const s=i[n];this.matchTNodeWithReadOption(e,t,Io(t,s)),this.matchTNodeWithReadOption(e,t,Si(t,e,s,!1,!1))}else i===Qr?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Si(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const n=this.metadata.read;if(null!==n)if(n===wr||n===so||n===Qr&&4&t.type)this.addMatch(t.index,-2);else{const i=Si(t,e,n,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function Io(e,t){const i=e.localNames;if(null!==i)for(let n=0;n<i.length;n+=2)if(i[n]===t)return i[n+1];return null}function Do(e,t,i,n){return-1===i?function(e,t){return 11&e.type?br(e,t):4&e.type?eo(e,t):null}(t,e):-2===i?function(e,t,i){return i===wr?br(t,e):i===Qr?eo(t,e):i===so?ho(t,e):void 0}(e,t,n):Ci(e,e[1],i,t)}function Mo(e,t,i,n){const s=t[19].queries[n];if(null===s.matches){const n=e.data,r=i.matches,o=[];for(let e=0;e<r.length;e+=2){const s=r[e];o.push(s<0?null:Do(t,n[s],r[e+1],i.metadata.read))}s.matches=o}return s.matches}function Ro(e,t,i,n){const s=e.queries.getByIndex(i),r=s.matches;if(null!==r){const o=Mo(e,t,s,i);for(let e=0;e<r.length;e+=2){const i=r[e];if(i>0)n.push(o[e/2]);else{const s=r[e+1],o=t[-i];for(let e=Ze;e<o.length;e++){const t=o[e];t[17]===t[3]&&Ro(t[1],t,s,n)}if(null!==o[9]){const e=o[9];for(let t=0;t<e.length;t++){const i=e[t];Ro(i[1],i,s,n)}}}}}return n}function zo(e){const t=St(),i=Ct(),n=Rt();zt(n+1);const s=_o(i,n);if(e.dirty&&mt(t)===(2==(2&s.metadata.flags))){if(null===s.matches)e.reset([]);else{const r=s.crossesNgTemplate?Ro(i,t,n,[]):Mo(i,t,s,n);e.reset(r,xr),e.notifyOnChanges()}return!0}return!1}function Lo(e,t,i,n){const s=Ct();if(s.firstCreatePass){const r=Pt();Ho(s,new To(t,i,n),r.index),function(e,t){const i=e.contentQueries||(e.contentQueries=[]);t!==(i.length?i[i.length-1]:-1)&&i.push(e.queries.length-1,t)}(s,e),2==(2&i)&&(s.staticContentQueries=!0)}jo(s,St(),i)}function ko(){return e=St(),t=Rt(),e[19].queries[t].queryList;var e,t}function jo(e,t,i){const n=new Co(4==(4&i));Jn(e,t,n,n.destroy),null===t[19]&&(t[19]=new Oo),t[19].queries.push(new Po(n))}function Ho(e,t,i){null===e.queries&&(e.queries=new Eo),e.queries.track(new Ao(t,i))}function _o(e,t){return e.queries.getByIndex(t)}const No=new Ii("Application Initializer");let Bo=(()=>{class e{constructor(e){this.appInits=e,this.resolve=yr,this.reject=yr,this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}runInitializers(){if(this.initialized)return;const e=[],t=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let i=0;i<this.appInits.length;i++){const t=this.appInits[i]();if(er(t))e.push(t);else if(tr(t)){const i=new Promise((e,i)=>{t.subscribe({complete:e,error:i})});e.push(i)}}Promise.all(e).then(()=>{t()}).catch(e=>{this.reject(e)}),0===e.length&&t(),this.initialized=!0}}return e.\u0275fac=function(t){return new(t||e)(Fi(No,8))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();const Wo=new Ii("AppId"),Uo={provide:Wo,useFactory:function(){return`${Fo()}${Fo()}${Fo()}`},deps:[]};function Fo(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Vo=new Ii("Platform Initializer"),Yo=new Ii("Platform ID"),Xo=new Ii("appBootstrapListener");let Go=(()=>{class e{log(e){console.log(e)}warn(e){console.warn(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();const qo=new Ii("LocaleId"),Zo=new Ii("DefaultCurrencyCode");class $o{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const Qo=function(e){return new vo(e)},Jo=Qo,Ko=function(e){return Promise.resolve(Qo(e))},ea=function(e){const t=Qo(e),i=nn(Ge(e).declarations).reduce((e,t)=>{const i=Xe(t);return i&&e.push(new mo(i)),e},[]);return new $o(t,i)},ta=ea,ia=function(e){return Promise.resolve(ea(e))};let na=(()=>{class e{constructor(){this.compileModuleSync=Jo,this.compileModuleAsync=Ko,this.compileModuleAndAllComponentsSync=ta,this.compileModuleAndAllComponentsAsync=ia}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();const sa=(()=>Promise.resolve(0))();function ra(e){"undefined"==typeof Zone?sa.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class oa{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new xo(!1),this.onMicrotaskEmpty=new xo(!1),this.onStable=new xo(!1),this.onError=new xo(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const n=this;n._nesting=0,n._outer=n._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(n._inner=n._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(n._inner=n._inner.fork(Zone.longStackTraceZoneSpec)),n.shouldCoalesceEventChangeDetection=!i&&t,n.shouldCoalesceRunChangeDetection=i,n.lastRequestAnimationFrameId=-1,n.nativeRequestAnimationFrame=function(){let e=Ae.requestAnimationFrame,t=Ae.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i);const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){const t=()=>{!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Ae,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,ha(e),e.isCheckStableRunning=!0,la(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),ha(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(i,n,s,r,o,a)=>{try{return ca(e),i.invokeTask(s,r,o,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===r.type||e.shouldCoalesceRunChangeDetection)&&t(),da(e)}},onInvoke:(i,n,s,r,o,a,l)=>{try{return ca(e),i.invoke(s,r,o,a,l)}finally{e.shouldCoalesceRunChangeDetection&&t(),da(e)}},onHasTask:(t,i,n,s)=>{t.hasTask(n,s),i===n&&("microTask"==s.change?(e._hasPendingMicrotasks=s.microTask,ha(e),la(e)):"macroTask"==s.change&&(e.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,n,s)=>(t.handleError(n,s),e.runOutsideAngular(()=>e.onError.emit(s)),!1)})}(n)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!oa.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(oa.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,n){const s=this._inner,r=s.scheduleEventTask("NgZoneEvent: "+n,e,aa,yr,yr);try{return s.runTask(r,t,i)}finally{s.cancelTask(r)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const aa={};function la(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function ha(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function ca(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function da(e){e._nesting--,la(e)}class pa{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new xo,this.onMicrotaskEmpty=new xo,this.onStable=new xo,this.onError=new xo}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,n){return e.apply(t,i)}}let ua=(()=>{class e{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{oa.assertNotInAngularZone(),ra(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())ra(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(t=>!t.updateCb||!t.updateCb(e)||(clearTimeout(t.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,t,i){let n=-1;t&&t>0&&(n=setTimeout(()=>{this._callbacks=this._callbacks.filter(e=>e.timeoutId!==n),e(this._didWork,this.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:n,updateCb:i})}whenStable(e,t,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,t,i){return[]}}return e.\u0275fac=function(t){return new(t||e)(Fi(oa))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})(),ga=(()=>{class e{constructor(){this._applications=new Map,ya.addToWindow(this)}registerApplication(e,t){this._applications.set(e,t)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,t=!0){return ya.findTestabilityInTree(this,e,t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();class ma{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let fa,ya=new ma,ba=!0,va=!1;const wa=new Ii("AllowMultipleToken");class xa{constructor(e,t){this.name=e,this.token=t}}function Sa(e,t,i=[]){const n=`Platform: ${t}`,s=new Ii(n);return(t=[])=>{let r=Ca();if(!r||r.injector.get(wa,!1))if(e)e(i.concat(t).concat({provide:s,useValue:!0}));else{const e=i.concat(t).concat({provide:s,useValue:!0},{provide:Os,useValue:"platform"});!function(e){if(fa&&!fa.destroyed&&!fa.injector.get(wa,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");fa=e.get(Pa);const t=e.get(Vo,null);t&&t.forEach(e=>e())}(Hs.create({providers:e,name:n}))}return function(e){const t=Ca();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(s)}}function Ca(){return fa&&!fa.destroyed?fa:null}let Pa=(()=>{class e{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,t){const i=function(e,t){let i;return i="noop"===e?new pa:("zone.js"===e?void 0:e)||new oa({enableLongStackTrace:(va=!0,ba),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),i}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),n=[{provide:oa,useValue:i}];return i.run(()=>{const t=Hs.create({providers:n,parent:this.injector,name:e.moduleType.name}),s=e.create(t),r=s.injector.get(en,null);if(!r)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return i.runOutsideAngular(()=>{const e=i.onError.subscribe({next:e=>{r.handleError(e)}});s.onDestroy(()=>{Ea(this._modules,s),e.unsubscribe()})}),function(e,t,i){try{const n=i();return er(n)?n.catch(i=>{throw t.runOutsideAngular(()=>e.handleError(i)),i}):n}catch(n){throw t.runOutsideAngular(()=>e.handleError(n)),n}}(r,i,()=>{const e=s.injector.get(Bo);return e.runInitializers(),e.donePromise.then(()=>(ur(s.injector.get(qo,dr)||dr),this._moduleDoBootstrap(s),s))})})}bootstrapModule(e,t=[]){const i=Oa({},t);return function(e,t,i){const n=new vo(i);return Promise.resolve(n)}(0,0,e).then(e=>this.bootstrapModuleFactory(e,i))}_moduleDoBootstrap(e){const t=e.injector.get(Ta);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(e=>t.bootstrap(e));else{if(!e.instance.ngDoBootstrap)throw new Error(`The module ${ee(e.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);e.instance.ngDoBootstrap(t)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(t){return new(t||e)(Fi(Hs))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();function Oa(e,t){return Array.isArray(t)?t.reduce(Oa,e):Object.assign(Object.assign({},e),t)}let Ta=(()=>{class e{constructor(e,t,i,n,s){this._zone=e,this._injector=t,this._exceptionHandler=i,this._componentFactoryResolver=n,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const r=new b(e=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{e.next(this._stable),e.complete()})}),o=new b(e=>{let t;this._zone.runOutsideAngular(()=>{t=this._zone.onStable.subscribe(()=>{oa.assertNotInAngularZone(),ra(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,e.next(!0))})})});const i=this._zone.onUnstable.subscribe(()=>{oa.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{e.next(!1)}))});return()=>{t.unsubscribe(),i.unsubscribe()}});this.isStable=function(...e){let t=Number.POSITIVE_INFINITY,i=null,n=e[e.length-1];return O(n)?(i=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(t=e.pop())):"number"==typeof n&&(t=e.pop()),null===i&&1===e.length&&e[0]instanceof b?e[0]:F(t)(V(e,i))}(r,o.pipe(e=>{return Y()((t=Q,function(e){let i;i="function"==typeof t?t:function(){return t};const n=Object.create(e,Z);return n.source=e,n.subjectFactory=i,n})(e));var t}))}bootstrap(e,t){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let i;i=e instanceof gr?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(i.componentType);const n=i.isBoundToModule?void 0:this._injector.get(to),s=i.create(Hs.NULL,[],t||i.selector,n),r=s.location.nativeElement,o=s.injector.get(ua,null),a=o&&s.injector.get(ga);return o&&a&&a.registerApplication(r,o),s.onDestroy(()=>{this.detachView(s.hostView),Ea(this.components,s),a&&a.unregisterApplication(r)}),this._loadComponent(s),s}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const t=e;this._views.push(t),t.attachToAppRef(this)}detachView(e){const t=e;Ea(this._views,t),t.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(Xo,[]).concat(this._bootstrapListeners).forEach(t=>t(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return e.\u0275fac=function(t){return new(t||e)(Fi(oa),Fi(Hs),Fi(en),Fi(fr),Fi(Bo))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();function Ea(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}class Aa{}class Ia{}const Da={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let Ma=(()=>{class e{constructor(e,t){this._compiler=e,this._config=t||Da}load(e){return this.loadAndCompile(e)}loadAndCompile(e){let[t,n]=e.split("#");return void 0===n&&(n="default"),i(255)(t).then(e=>e[n]).then(e=>Ra(e,t,n)).then(e=>this._compiler.compileModuleAsync(e))}loadFactory(e){let[t,n]=e.split("#"),s="NgFactory";return void 0===n&&(n="default",s=""),i(255)(this._config.factoryPathPrefix+t+this._config.factoryPathSuffix).then(e=>e[n+s]).then(e=>Ra(e,t,n))}}return e.\u0275fac=function(t){return new(t||e)(Fi(na),Fi(Ia,8))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();function Ra(e,t,i){if(!e)throw new Error(`Cannot find '${i}' in '${t}'`);return e}const za=Sa(null,"core",[{provide:Yo,useValue:"unknown"},{provide:Pa,deps:[Hs]},{provide:ga,deps:[]},{provide:Go,deps:[]}]),La=[{provide:Ta,useClass:Ta,deps:[oa,Hs,en,fr,Bo]},{provide:go,deps:[oa],useFactory:function(e){let t=[];return e.onStable.subscribe(()=>{for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:Bo,useClass:Bo,deps:[[new Gi,No]]},{provide:na,useClass:na,deps:[]},Uo,{provide:Nr,useFactory:function(){return qr},deps:[]},{provide:Wr,useFactory:function(){return Zr},deps:[]},{provide:qo,useFactory:function(e){return ur(e=e||"undefined"!=typeof $localize&&$localize.locale||dr),e},deps:[[new Xi(qo),new Gi,new qi]]},{provide:Zo,useValue:"USD"}];let ka=(()=>{class e{constructor(e){}}return e.\u0275fac=function(t){return new(t||e)(Fi(Ta))},e.\u0275mod=Fe({type:e}),e.\u0275inj=he({providers:La}),e})(),ja=null;function Ha(){return ja}const _a=new Ii("DocumentToken");let Na=(()=>{class e{historyGo(e){throw new Error("Not implemented")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=le({factory:Ba,token:e,providedIn:"platform"}),e})();function Ba(){return Fi(Ua)}const Wa=new Ii("Location Initialized");let Ua=(()=>{class e extends Na{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ha().getBaseHref(this._doc)}onPopState(e){const t=Ha().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),()=>t.removeEventListener("popstate",e)}onHashChange(e){const t=Ha().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),()=>t.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,t,i){Fa()?this._history.pushState(e,t,i):this.location.hash=i}replaceState(e,t,i){Fa()?this._history.replaceState(e,t,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return e.\u0275fac=function(t){return new(t||e)(Fi(_a))},e.\u0275prov=le({factory:Va,token:e,providedIn:"platform"}),e})();function Fa(){return!!window.history.pushState}function Va(){return new Ua(Fi(_a))}function Ya(e,t){if(0==e.length)return t;if(0==t.length)return e;let i=0;return e.endsWith("/")&&i++,t.startsWith("/")&&i++,2==i?e+t.substring(1):1==i?e+t:e+"/"+t}function Xa(e){const t=e.match(/#|\?|$/),i=t&&t.index||e.length;return e.slice(0,i-("/"===e[i-1]?1:0))+e.slice(i)}function Ga(e){return e&&"?"!==e[0]?"?"+e:e}let qa=(()=>{class e{historyGo(e){throw new Error("Not implemented")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=le({factory:Za,token:e,providedIn:"root"}),e})();function Za(e){const t=Fi(_a).location;return new Qa(Fi(Na),t&&t.origin||"")}const $a=new Ii("appBaseHref");let Qa=(()=>{class e extends qa{constructor(e,t){if(super(),this._platformLocation=e,this._removeListenerFns=[],null==t&&(t=this._platformLocation.getBaseHrefFromDOM()),null==t)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=t}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return Ya(this._baseHref,e)}path(e=!1){const t=this._platformLocation.pathname+Ga(this._platformLocation.search),i=this._platformLocation.hash;return i&&e?`${t}${i}`:t}pushState(e,t,i,n){const s=this.prepareExternalUrl(i+Ga(n));this._platformLocation.pushState(e,t,s)}replaceState(e,t,i,n){const s=this.prepareExternalUrl(i+Ga(n));this._platformLocation.replaceState(e,t,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var t,i;null===(i=(t=this._platformLocation).historyGo)||void 0===i||i.call(t,e)}}return e.\u0275fac=function(t){return new(t||e)(Fi(Na),Fi($a,8))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})(),Ja=(()=>{class e extends qa{constructor(e,t){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=t&&(this._baseHref=t)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let t=this._platformLocation.hash;return null==t&&(t="#"),t.length>0?t.substring(1):t}prepareExternalUrl(e){const t=Ya(this._baseHref,e);return t.length>0?"#"+t:t}pushState(e,t,i,n){let s=this.prepareExternalUrl(i+Ga(n));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(e,t,s)}replaceState(e,t,i,n){let s=this.prepareExternalUrl(i+Ga(n));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(e=0){var t,i;null===(i=(t=this._platformLocation).historyGo)||void 0===i||i.call(t,e)}}return e.\u0275fac=function(t){return new(t||e)(Fi(Na),Fi($a,8))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})(),Ka=(()=>{class e{constructor(e,t){this._subject=new xo,this._urlChangeListeners=[],this._platformStrategy=e;const i=this._platformStrategy.getBaseHref();this._platformLocation=t,this._baseHref=Xa(tl(i)),this._platformStrategy.onPopState(e=>{this._subject.emit({url:this.path(!0),pop:!0,state:e.state,type:e.type})})}path(e=!1){return this.normalize(this._platformStrategy.path(e))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(e,t=""){return this.path()==this.normalize(e+Ga(t))}normalize(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,tl(t)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}go(e,t="",i=null){this._platformStrategy.pushState(i,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Ga(t)),i)}replaceState(e,t="",i=null){this._platformStrategy.replaceState(i,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Ga(t)),i)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(e=0){var t,i;null===(i=(t=this._platformStrategy).historyGo)||void 0===i||i.call(t,e)}onUrlChange(e){this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(e=>{this._notifyUrlChangeListeners(e.url,e.state)}))}_notifyUrlChangeListeners(e="",t){this._urlChangeListeners.forEach(i=>i(e,t))}subscribe(e,t,i){return this._subject.subscribe({next:e,error:t,complete:i})}}return e.\u0275fac=function(t){return new(t||e)(Fi(qa),Fi(Na))},e.normalizeQueryParams=Ga,e.joinWithSlash=Ya,e.stripTrailingSlash=Xa,e.\u0275prov=le({factory:el,token:e,providedIn:"root"}),e})();function el(){return new Ka(Fi(qa),Fi(Na))}function tl(e){return e.replace(/\/index.html$/,"")}var il=function(e){return e[e.Zero=0]="Zero",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Few=3]="Few",e[e.Many=4]="Many",e[e.Other=5]="Other",e}({});class nl{}let sl=(()=>{class e extends nl{constructor(e){super(),this.locale=e}getPluralCategory(e,t){switch(function(e){return function(e){const t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e);let i=hr(t);if(i)return i;const n=t.split("-")[0];if(i=hr(n),i)return i;if("en"===n)return ar;throw new Error(`Missing locale data for the locale "${e}".`)}(e)[cr.PluralCase]}(t||this.locale)(e)){case il.Zero:return"zero";case il.One:return"one";case il.Two:return"two";case il.Few:return"few";case il.Many:return"many";default:return"other"}}}return e.\u0275fac=function(t){return new(t||e)(Fi(qo))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})(),rl=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Fe({type:e}),e.\u0275inj=he({providers:[{provide:nl,useClass:sl}]}),e})(),ol=(()=>{class e{}return e.\u0275prov=le({token:e,providedIn:"root",factory:()=>new al(Fi(_a),window)}),e})();class al{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function(e,t){const i=e.getElementById(t)||e.getElementsByName(t)[0];if(i)return i;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow)){const i=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let n=i.currentNode;for(;n;){const e=n.shadowRoot;if(e){const i=e.getElementById(t)||e.querySelector(`[name="${t}"]`);if(i)return i}n=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,n=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],n-s[1])}attemptFocus(e){return e.focus(),this.document.activeElement===e}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=ll(this.window.history)||ll(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function ll(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}class hl extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){var e;e=new hl,ja||(ja=e)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=(dl=dl||document.querySelector("base"),dl?dl.getAttribute("href"):null);return null==t?null:function(e){cl=cl||document.createElement("a"),cl.setAttribute("href",e);const t=cl.pathname;return"/"===t.charAt(0)?t:`/${t}`}(t)}resetBaseElement(){dl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function(e,t){t=encodeURIComponent(t);for(const i of e.split(";")){const e=i.indexOf("="),[n,s]=-1==e?[i,""]:[i.slice(0,e),i.slice(e+1)];if(n.trim()===t)return decodeURIComponent(s)}return null}(document.cookie,e)}}let cl,dl=null;const pl=new Ii("TRANSITION_ID"),ul=[{provide:No,useFactory:function(e,t,i){return()=>{i.get(Bo).donePromise.then(()=>{const i=Ha();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter(t=>t.getAttribute("ng-transition")===e).forEach(e=>i.remove(e))})}},deps:[pl,_a,Hs],multi:!0}];class gl{static init(){!function(e){ya=e}(new gl)}addToWindow(e){Ae.getAngularTestability=(t,i=!0)=>{const n=e.findTestabilityInTree(t,i);if(null==n)throw new Error("Could not find testability for element.");return n},Ae.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ae.getAllAngularRootElements=()=>e.getAllRootElements(),Ae.frameworkStabilizers||(Ae.frameworkStabilizers=[]),Ae.frameworkStabilizers.push(e=>{const t=Ae.getAllAngularTestabilities();let i=t.length,n=!1;const s=function(t){n=n||t,i--,0==i&&e(n)};t.forEach(function(e){e.whenStable(s)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const n=e.getTestability(t);return null!=n?n:i?Ha().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let ml=(()=>{class e{build(){return new XMLHttpRequest}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();const fl=new Ii("EventManagerPlugins");let yl=(()=>{class e{constructor(e,t){this._zone=t,this._eventNameToPlugin=new Map,e.forEach(e=>e.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,t,i){return this._findPluginFor(t).addEventListener(e,t,i)}addGlobalEventListener(e,t,i){return this._findPluginFor(t).addGlobalEventListener(e,t,i)}getZone(){return this._zone}_findPluginFor(e){const t=this._eventNameToPlugin.get(e);if(t)return t;const i=this._plugins;for(let n=0;n<i.length;n++){const t=i[n];if(t.supports(e))return this._eventNameToPlugin.set(e,t),t}throw new Error(`No event manager plugin found for event ${e}`)}}return e.\u0275fac=function(t){return new(t||e)(Fi(fl),Fi(oa))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();class bl{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const n=Ha().getGlobalEventTarget(this._doc,e);if(!n)throw new Error(`Unsupported event target ${n} for event ${t}`);return this.addEventListener(n,t,i)}}let vl=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(e){const t=new Set;e.forEach(e=>{this._stylesSet.has(e)||(this._stylesSet.add(e),t.add(e))}),this.onStylesAdded(t)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})(),wl=(()=>{class e extends vl{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,t,i){e.forEach(e=>{const n=this._doc.createElement("style");n.textContent=e,i.push(t.appendChild(n))})}addHost(e){const t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}removeHost(e){const t=this._hostNodes.get(e);t&&t.forEach(xl),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((t,i)=>{this._addStylesToHost(e,i,t)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(xl))}}return e.\u0275fac=function(t){return new(t||e)(Fi(_a))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();function xl(e){Ha().remove(e)}const Sl={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Cl=/%COMP%/g;function Pl(e,t,i){for(let n=0;n<t.length;n++){let s=t[n];Array.isArray(s)?Pl(e,s,i):(s=s.replace(Cl,e),i.push(s))}return i}function Ol(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let Tl=(()=>{class e{constructor(e,t,i){this.eventManager=e,this.sharedStylesHost=t,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new El(e)}createRenderer(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Ce.Emulated:{let i=this.rendererByCompId.get(t.id);return i||(i=new Al(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,i)),i.applyToHost(e),i}case 1:case Ce.ShadowDom:return new Il(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){const e=Pl(t.id,t.styles,[]);this.sharedStylesHost.addStyles(e),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(t){return new(t||e)(Fi(yl),Fi(wl),Fi(Wo))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();class El{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(Sl[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,n){if(n){t=n+":"+t;const s=Sl[n];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const n=Sl[i];n?e.removeAttributeNS(n,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,n){n&(sn.DashCase|sn.Important)?e.style.setProperty(t,i,n&sn.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&sn.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Ol(i)):this.eventManager.addEventListener(e,t,Ol(i))}}class Al extends El{constructor(e,t,i,n){super(e),this.component=i;const s=Pl(n+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr="_ngcontent-%COMP%".replace(Cl,n+"-"+i.id),this.hostAttr="_nghost-%COMP%".replace(Cl,n+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class Il extends El{constructor(e,t,i,n){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Pl(n.id,n.styles,[]);for(let r=0;r<s.length;r++){const e=document.createElement("style");e.textContent=s[r],this.shadowRoot.appendChild(e)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Dl=(()=>{class e extends bl{constructor(e){super(e)}supports(e){return!0}addEventListener(e,t,i){return e.addEventListener(t,i,!1),()=>this.removeEventListener(e,t,i)}removeEventListener(e,t,i){return e.removeEventListener(t,i)}}return e.\u0275fac=function(t){return new(t||e)(Fi(_a))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();const Ml=["alt","control","meta","shift"],Rl={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},zl={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Ll={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let kl=(()=>{class e extends bl{constructor(e){super(e)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,i,n){const s=e.parseEventName(i),r=e.eventCallback(s.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ha().onAndCancel(t,s.domEventName,r))}static parseEventName(t){const i=t.toLowerCase().split("."),n=i.shift();if(0===i.length||"keydown"!==n&&"keyup"!==n)return null;const s=e._normalizeKey(i.pop());let r="";if(Ml.forEach(e=>{const t=i.indexOf(e);t>-1&&(i.splice(t,1),r+=e+".")}),r+=s,0!=i.length||0===s.length)return null;const o={};return o.domEventName=n,o.fullKey=r,o}static getEventFullKey(e){let t="",i=function(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&zl.hasOwnProperty(t)&&(t=zl[t]))}return Rl[t]||t}(e);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),Ml.forEach(n=>{n!=i&&(0,Ll[n])(e)&&(t+=n+".")}),t+=i,t}static eventCallback(t,i,n){return s=>{e.getEventFullKey(s)===t&&n.runGuarded(()=>i(s))}}static _normalizeKey(e){switch(e){case"esc":return"escape";default:return e}}}return e.\u0275fac=function(t){return new(t||e)(Fi(_a))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();const jl=Sa(za,"browser",[{provide:Yo,useValue:"browser"},{provide:Vo,useValue:function(){hl.makeCurrent(),gl.init()},multi:!0},{provide:_a,useFactory:function(){return function(e){lt=e}(document),document},deps:[]}]),Hl=[[],{provide:Os,useValue:"root"},{provide:en,useFactory:function(){return new en},deps:[]},{provide:fl,useClass:Dl,multi:!0,deps:[_a,oa,Yo]},{provide:fl,useClass:kl,multi:!0,deps:[_a]},[],{provide:Tl,useClass:Tl,deps:[yl,wl,Wo]},{provide:Sr,useExisting:Tl},{provide:vl,useExisting:wl},{provide:wl,useClass:wl,deps:[_a]},{provide:ua,useClass:ua,deps:[oa]},{provide:yl,useClass:yl,deps:[fl,oa]},{provide:class{},useClass:ml,deps:[]},[]];let _l=(()=>{class e{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:e,providers:[{provide:Wo,useValue:t.appId},{provide:pl,useExisting:Wo},ul]}}}return e.\u0275fac=function(t){return new(t||e)(Fi(e,12))},e.\u0275mod=Fe({type:e}),e.\u0275inj=he({providers:Hl,imports:[rl,ka]}),e})();function Nl(...e){let t=e[e.length-1];return O(t)?(e.pop(),k(e,t)):V(e)}"undefined"!=typeof window&&window;class Bl extends C{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return t&&!t.closed&&e.next(this._value),t}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new w;return this._value}next(e){super.next(this._value=e)}}class Wl extends g{notifyNext(e,t,i,n,s){this.destination.next(t)}notifyError(e,t){this.destination.error(e)}notifyComplete(e){this.destination.complete()}}class Ul extends g{constructor(e,t,i){super(),this.parent=e,this.outerValue=t,this.outerIndex=i,this.index=0}_next(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}_error(e){this.parent.notifyError(e,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}function Fl(e,t,i,n,s=new Ul(e,i,n)){if(!s.closed)return t instanceof b?t.subscribe(s):L(t)(s)}const Vl={};class Yl{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new Xl(e,this.resultSelector))}}class Xl extends Wl{constructor(e,t){super(e),this.resultSelector=t,this.active=0,this.values=[],this.observables=[]}_next(e){this.values.push(Vl),this.observables.push(e)}_complete(){const e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(let i=0;i<t;i++)this.add(Fl(this,e[i],void 0,i))}}notifyComplete(e){0==(this.active-=1)&&this.destination.complete()}notifyNext(e,t,i){const n=this.values,s=this.toRespond?n[i]===Vl?--this.toRespond:this.toRespond:0;n[i]=t,0===s&&(this.resultSelector?this._tryResultSelector(n):this.destination.next(n.slice()))}_tryResultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(i){return void this.destination.error(i)}this.destination.next(t)}}const Gl=(()=>{function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e})();function ql(...e){return F(1)(Nl(...e))}const Zl=new b(e=>e.complete());function $l(e){return e?function(e){return new b(t=>e.schedule(()=>t.complete()))}(e):Zl}function Ql(e){return new b(t=>{let i;try{i=e()}catch(n){return void t.error(n)}return(i?j(i):$l()).subscribe(t)})}function Jl(e,t){return"function"==typeof t?i=>i.pipe(Jl((i,n)=>j(e(i,n)).pipe(T((e,s)=>t(i,e,n,s))))):t=>t.lift(new Kl(e))}class Kl{constructor(e){this.project=e}call(e,t){return t.subscribe(new eh(e,this.project))}}class eh extends _{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const i=this.index++;try{t=this.project(e,i)}catch(n){return void this.destination.error(n)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const i=new H(this),n=this.destination;n.add(i),this.innerSubscription=N(e,i),this.innerSubscription!==i&&n.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;e&&!e.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const th=(()=>{function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e})();function ih(e){return t=>0===e?$l():t.lift(new nh(e))}class nh{constructor(e){if(this.total=e,this.total<0)throw new th}call(e,t){return t.subscribe(new sh(e,this.total))}}class sh extends g{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,i=++this.count;i<=t&&(this.destination.next(e),i===t&&(this.destination.complete(),this.unsubscribe()))}}function rh(e,t){let i=!1;return arguments.length>=2&&(i=!0),function(n){return n.lift(new oh(e,t,i))}}class oh{constructor(e,t,i=!1){this.accumulator=e,this.seed=t,this.hasSeed=i}call(e,t){return t.subscribe(new ah(e,this.accumulator,this.seed,this.hasSeed))}}class ah extends g{constructor(e,t,i,n){super(e),this.accumulator=t,this._seed=i,this.hasSeed=n,this.index=0}get seed(){return this._seed}set seed(e){this.hasSeed=!0,this._seed=e}_next(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}_tryNext(e){const t=this.index++;let i;try{i=this.accumulator(this.seed,e,t)}catch(n){this.destination.error(n)}this.seed=i,this.destination.next(i)}}function lh(e,t){return function(i){return i.lift(new hh(e,t))}}class hh{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new ch(e,this.predicate,this.thisArg))}}class ch extends g{constructor(e,t,i){super(e),this.predicate=t,this.thisArg=i,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(i){return void this.destination.error(i)}t&&this.destination.next(e)}}function dh(e){return function(t){const i=new ph(e),n=t.lift(i);return i.caught=n}}class ph{constructor(e){this.selector=e}call(e,t){return t.subscribe(new uh(e,this.selector,this.caught))}}class uh extends _{constructor(e,t,i){super(e),this.selector=t,this.caught=i}error(e){if(!this.isStopped){let i;try{i=this.selector(e,this.caught)}catch(t){return void super.error(t)}this._unsubscribeAndRecycle();const n=new H(this);this.add(n);const s=N(i,n);s!==n&&this.add(s)}}}function gh(e,t){return B(e,t,1)}function mh(e){return function(t){return 0===e?$l():t.lift(new fh(e))}}class fh{constructor(e){if(this.total=e,this.total<0)throw new th}call(e,t){return t.subscribe(new yh(e,this.total))}}class yh extends g{constructor(e,t){super(e),this.total=t,this.ring=new Array,this.count=0}_next(e){const t=this.ring,i=this.total,n=this.count++;t.length<i?t.push(e):t[n%i]=e}_complete(){const e=this.destination;let t=this.count;if(t>0){const i=this.count>=this.total?this.total:this.count,n=this.ring;for(let s=0;s<i;s++){const s=t++%i;e.next(n[s])}}e.complete()}}function bh(e=xh){return t=>t.lift(new vh(e))}class vh{constructor(e){this.errorFactory=e}call(e,t){return t.subscribe(new wh(e,this.errorFactory))}}class wh extends g{constructor(e,t){super(e),this.errorFactory=t,this.hasValue=!1}_next(e){this.hasValue=!0,this.destination.next(e)}_complete(){if(this.hasValue)return this.destination.complete();{let t;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)}}}function xh(){return new Gl}function Sh(e=null){return t=>t.lift(new Ch(e))}class Ch{constructor(e){this.defaultValue=e}call(e,t){return t.subscribe(new Ph(e,this.defaultValue))}}class Ph extends g{constructor(e,t){super(e),this.defaultValue=t,this.isEmpty=!0}_next(e){this.isEmpty=!1,this.destination.next(e)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function Oh(e,t){const i=arguments.length>=2;return n=>n.pipe(e?lh((t,i)=>e(t,i,n)):y,ih(1),i?Sh(t):bh(()=>new Gl))}function Th(){}function Eh(e,t,i){return function(n){return n.lift(new Ah(e,t,i))}}class Ah{constructor(e,t,i){this.nextOrObserver=e,this.error=t,this.complete=i}call(e,t){return t.subscribe(new Ih(e,this.nextOrObserver,this.error,this.complete))}}class Ih extends g{constructor(e,t,i,s){super(e),this._tapNext=Th,this._tapError=Th,this._tapComplete=Th,this._tapError=i||Th,this._tapComplete=s||Th,n(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||Th,this._tapError=t.error||Th,this._tapComplete=t.complete||Th)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}class Dh{constructor(e){this.callback=e}call(e,t){return t.subscribe(new Mh(e,this.callback))}}class Mh extends g{constructor(e,t){super(e),this.add(new d(t))}}class Rh{constructor(e,t){this.id=e,this.url=t}}class zh extends Rh{constructor(e,t,i="imperative",n=null){super(e,t),this.navigationTrigger=i,this.restoredState=n}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Lh extends Rh{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class kh extends Rh{constructor(e,t,i){super(e,t),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class jh extends Rh{constructor(e,t,i){super(e,t),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Hh extends Rh{constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class _h extends Rh{constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Nh extends Rh{constructor(e,t,i,n,s){super(e,t),this.urlAfterRedirects=i,this.state=n,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Bh extends Rh{constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Wh extends Rh{constructor(e,t,i,n){super(e,t),this.urlAfterRedirects=i,this.state=n}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Uh{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Fh{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Vh{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Yh{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Xh{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Gh{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class qh{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Zh="primary";class $h{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Qh(e){return new $h(e)}function Jh(e){const t=Error("NavigationCancelingError: "+e);return t.ngNavigationCancelingError=!0,t}function Kh(e,t,i){const n=i.path.split("/");if(n.length>e.length)return null;if("full"===i.pathMatch&&(t.hasChildren()||n.length<e.length))return null;const s={};for(let r=0;r<n.length;r++){const t=n[r],i=e[r];if(t.startsWith(":"))s[t.substring(1)]=i;else if(t!==i.path)return null}return{consumed:e.slice(0,n.length),posParams:s}}function ec(e,t){const i=e?Object.keys(e):void 0,n=t?Object.keys(t):void 0;if(!i||!n||i.length!=n.length)return!1;let s;for(let r=0;r<i.length;r++)if(s=i[r],!tc(e[s],t[s]))return!1;return!0}function tc(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const i=[...e].sort(),n=[...t].sort();return i.every((e,t)=>n[t]===e)}return e===t}function ic(e){return Array.prototype.concat.apply([],e)}function nc(e){return e.length>0?e[e.length-1]:null}function sc(e,t){for(const i in e)e.hasOwnProperty(i)&&t(e[i],i)}function rc(e){return tr(e)?e:er(e)?j(Promise.resolve(e)):Nl(e)}const oc={exact:function e(t,i,n){if(!mc(t.segments,i.segments))return!1;if(!dc(t.segments,i.segments,n))return!1;if(t.numberOfChildren!==i.numberOfChildren)return!1;for(const s in i.children){if(!t.children[s])return!1;if(!e(t.children[s],i.children[s],n))return!1}return!0},subset:hc},ac={exact:function(e,t){return ec(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(i=>tc(e[i],t[i]))},ignored:()=>!0};function lc(e,t,i){return oc[i.paths](e.root,t.root,i.matrixParams)&&ac[i.queryParams](e.queryParams,t.queryParams)&&!("exact"===i.fragment&&e.fragment!==t.fragment)}function hc(e,t,i){return cc(e,t,t.segments,i)}function cc(e,t,i,n){if(e.segments.length>i.length){const s=e.segments.slice(0,i.length);return!!mc(s,i)&&!t.hasChildren()&&!!dc(s,i,n)}if(e.segments.length===i.length){if(!mc(e.segments,i))return!1;if(!dc(e.segments,i,n))return!1;for(const i in t.children){if(!e.children[i])return!1;if(!hc(e.children[i],t.children[i],n))return!1}return!0}{const s=i.slice(0,e.segments.length),r=i.slice(e.segments.length);return!!mc(e.segments,s)&&!!dc(e.segments,s,n)&&!!e.children.primary&&cc(e.children.primary,t,r,n)}}function dc(e,t,i){return t.every((t,n)=>ac[i](e[n].parameters,t.parameters))}class pc{constructor(e,t,i){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Qh(this.queryParams)),this._queryParamMap}toString(){return bc.serialize(this)}}class uc{constructor(e,t){this.segments=e,this.children=t,this.parent=null,sc(t,(e,t)=>e.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return vc(this)}}class gc{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Qh(this.parameters)),this._parameterMap}toString(){return Tc(this)}}function mc(e,t){return e.length===t.length&&e.every((e,i)=>e.path===t[i].path)}class fc{}class yc{parse(e){const t=new Mc(e);return new pc(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){var t;return`/${wc(e.root,!0)}${function(e){const t=Object.keys(e).map(t=>{const i=e[t];return Array.isArray(i)?i.map(e=>`${Sc(t)}=${Sc(e)}`).join("&"):`${Sc(t)}=${Sc(i)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(e.queryParams)}${"string"==typeof e.fragment?`#${t=e.fragment,encodeURI(t)}`:""}`}}const bc=new yc;function vc(e){return e.segments.map(e=>Tc(e)).join("/")}function wc(e,t){if(!e.hasChildren())return vc(e);if(t){const t=e.children.primary?wc(e.children.primary,!1):"",i=[];return sc(e.children,(e,t)=>{t!==Zh&&i.push(`${t}:${wc(e,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function(e,t){let i=[];return sc(e.children,(e,n)=>{n===Zh&&(i=i.concat(t(e,n)))}),sc(e.children,(e,n)=>{n!==Zh&&(i=i.concat(t(e,n)))}),i}(e,(t,i)=>i===Zh?[wc(e.children.primary,!1)]:[`${i}:${wc(t,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children.primary?`${vc(e)}/${t[0]}`:`${vc(e)}/(${t.join("//")})`}}function xc(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Sc(e){return xc(e).replace(/%3B/gi,";")}function Cc(e){return xc(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Pc(e){return decodeURIComponent(e)}function Oc(e){return Pc(e.replace(/\+/g,"%20"))}function Tc(e){return`${Cc(e.path)}${t=e.parameters,Object.keys(t).map(e=>`;${Cc(e)}=${Cc(t[e])}`).join("")}`;var t}const Ec=/^[^\/()?;=#]+/;function Ac(e){const t=e.match(Ec);return t?t[0]:""}const Ic=/^[^=?&#]+/,Dc=/^[^?&#]+/;class Mc{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new uc([],{}):new uc([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i.primary=new uc(e,t)),i}parseSegment(){const e=Ac(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new gc(Pc(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=Ac(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const e=Ac(this.remaining);e&&(i=e,this.capture(i))}e[Pc(t)]=Pc(i)}parseQueryParam(e){const t=function(e){const t=e.match(Ic);return t?t[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const e=function(e){const t=e.match(Dc);return t?t[0]:""}(this.remaining);e&&(i=e,this.capture(i))}const n=Oc(t),s=Oc(i);if(e.hasOwnProperty(n)){let t=e[n];Array.isArray(t)||(t=[t],e[n]=t),t.push(s)}else e[n]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Ac(this.remaining),n=this.remaining[i.length];if("/"!==n&&")"!==n&&";"!==n)throw new Error(`Cannot parse url '${this.url}'`);let s;i.indexOf(":")>-1?(s=i.substr(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Zh);const r=this.parseChildren();t[s]=1===Object.keys(r).length?r.primary:new uc([],r),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class Rc{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=zc(e,this._root);return t?t.children.map(e=>e.value):[]}firstChild(e){const t=zc(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Lc(e,this._root);return t.length<2?[]:t[t.length-2].children.map(e=>e.value).filter(t=>t!==e)}pathFromRoot(e){return Lc(e,this._root).map(e=>e.value)}}function zc(e,t){if(e===t.value)return t;for(const i of t.children){const t=zc(e,i);if(t)return t}return null}function Lc(e,t){if(e===t.value)return[t];for(const i of t.children){const n=Lc(e,i);if(n.length)return n.unshift(t),n}return[]}class kc{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function jc(e){const t={};return e&&e.children.forEach(e=>t[e.value.outlet]=e),t}class Hc extends Rc{constructor(e,t){super(e),this.snapshot=t,Fc(this,e)}toString(){return this.snapshot.toString()}}function _c(e,t){const i=function(e,t){const i=new Wc([],{},{},"",{},Zh,t,null,e.root,-1,{});return new Uc("",new kc(i,[]))}(e,t),n=new Bl([new gc("",{})]),s=new Bl({}),r=new Bl({}),o=new Bl({}),a=new Bl(""),l=new Nc(n,s,o,a,r,Zh,t,i.root);return l.snapshot=i.root,new Hc(new kc(l,[]),i)}class Nc{constructor(e,t,i,n,s,r,o,a){this.url=e,this.params=t,this.queryParams=i,this.fragment=n,this.data=s,this.outlet=r,this.component=o,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(T(e=>Qh(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(T(e=>Qh(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Bc(e,t="emptyOnly"){const i=e.pathFromRoot;let n=0;if("always"!==t)for(n=i.length-1;n>=1;){const e=i[n],t=i[n-1];if(e.routeConfig&&""===e.routeConfig.path)n--;else{if(t.component)break;n--}}return function(e){return e.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(i.slice(n))}class Wc{constructor(e,t,i,n,s,r,o,a,l,h,c){this.url=e,this.params=t,this.queryParams=i,this.fragment=n,this.data=s,this.outlet=r,this.component=o,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=h,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Qh(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Qh(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(e=>e.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Uc extends Rc{constructor(e,t){super(t),this.url=e,Fc(this,t)}toString(){return Vc(this._root)}}function Fc(e,t){t.value._routerState=e,t.children.forEach(t=>Fc(e,t))}function Vc(e){const t=e.children.length>0?` { ${e.children.map(Vc).join(", ")} } `:"";return`${e.value}${t}`}function Yc(e){if(e.snapshot){const t=e.snapshot,i=e._futureSnapshot;e.snapshot=i,ec(t.queryParams,i.queryParams)||e.queryParams.next(i.queryParams),t.fragment!==i.fragment&&e.fragment.next(i.fragment),ec(t.params,i.params)||e.params.next(i.params),function(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!ec(e[i],t[i]))return!1;return!0}(t.url,i.url)||e.url.next(i.url),ec(t.data,i.data)||e.data.next(i.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function Xc(e,t){var i,n;return ec(e.params,t.params)&&mc(i=e.url,n=t.url)&&i.every((e,t)=>ec(e.parameters,n[t].parameters))&&!(!e.parent!=!t.parent)&&(!e.parent||Xc(e.parent,t.parent))}function Gc(e,t,i){if(i&&e.shouldReuseRoute(t.value,i.value.snapshot)){const n=i.value;n._futureSnapshot=t.value;const s=function(e,t,i){return t.children.map(t=>{for(const n of i.children)if(e.shouldReuseRoute(t.value,n.value.snapshot))return Gc(e,t,n);return Gc(e,t)})}(e,t,i);return new kc(n,s)}{if(e.shouldAttach(t.value)){const i=e.retrieve(t.value);if(null!==i){const e=i.route;return qc(t,e),e}}const i=new Nc(new Bl((n=t.value).url),new Bl(n.params),new Bl(n.queryParams),new Bl(n.fragment),new Bl(n.data),n.outlet,n.component,n),s=t.children.map(t=>Gc(e,t));return new kc(i,s)}var n}function qc(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(let i=0;i<e.children.length;++i)qc(e.children[i],t.children[i])}function Zc(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function $c(e){return"object"==typeof e&&null!=e&&e.outlets}function Qc(e,t,i,n,s){let r={};return n&&sc(n,(e,t)=>{r[t]=Array.isArray(e)?e.map(e=>`${e}`):`${e}`}),new pc(i.root===e?t:Jc(i.root,e,t),r,s)}function Jc(e,t,i){const n={};return sc(e.children,(e,s)=>{n[s]=e===t?i:Jc(e,t,i)}),new uc(e.segments,n)}class Kc{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Zc(i[0]))throw new Error("Root segment cannot have matrix parameters");const n=i.find($c);if(n&&n!==nc(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ed{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function td(e,t,i){if(e||(e=new uc([],{})),0===e.segments.length&&e.hasChildren())return id(e,t,i);const n=function(e,t,i){let n=0,s=t;const r={match:!1,pathIndex:0,commandIndex:0};for(;s<e.segments.length;){if(n>=i.length)return r;const t=e.segments[s],o=i[n];if($c(o))break;const a=`${o}`,l=n<i.length-1?i[n+1]:null;if(s>0&&void 0===a)break;if(a&&l&&"object"==typeof l&&void 0===l.outlets){if(!od(a,l,t))return r;n+=2}else{if(!od(a,{},t))return r;n++}s++}return{match:!0,pathIndex:s,commandIndex:n}}(e,t,i),s=i.slice(n.commandIndex);if(n.match&&n.pathIndex<e.segments.length){const t=new uc(e.segments.slice(0,n.pathIndex),{});return t.children.primary=new uc(e.segments.slice(n.pathIndex),e.children),id(t,0,s)}return n.match&&0===s.length?new uc(e.segments,{}):n.match&&!e.hasChildren()?nd(e,t,i):n.match?id(e,0,s):nd(e,t,i)}function id(e,t,i){if(0===i.length)return new uc(e.segments,{});{const n=function(e){return $c(e[0])?e[0].outlets:{[Zh]:e}}(i),s={};return sc(n,(i,n)=>{"string"==typeof i&&(i=[i]),null!==i&&(s[n]=td(e.children[n],t,i))}),sc(e.children,(e,t)=>{void 0===n[t]&&(s[t]=e)}),new uc(e.segments,s)}}function nd(e,t,i){const n=e.segments.slice(0,t);let s=0;for(;s<i.length;){const r=i[s];if($c(r)){const e=sd(r.outlets);return new uc(n,e)}if(0===s&&Zc(i[0])){n.push(new gc(e.segments[t].path,rd(i[0]))),s++;continue}const o=$c(r)?r.outlets.primary:`${r}`,a=s<i.length-1?i[s+1]:null;o&&a&&Zc(a)?(n.push(new gc(o,rd(a))),s+=2):(n.push(new gc(o,{})),s++)}return new uc(n,{})}function sd(e){const t={};return sc(e,(e,i)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[i]=nd(new uc([],{}),0,e))}),t}function rd(e){const t={};return sc(e,(e,i)=>t[i]=`${e}`),t}function od(e,t,i){return e==i.path&&ec(t,i.parameters)}class ad{constructor(e,t,i,n){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=n}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),Yc(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const n=jc(t);e.children.forEach(e=>{const t=e.value.outlet;this.deactivateRoutes(e,n[t],i),delete n[t]}),sc(n,(e,t)=>{this.deactivateRouteAndItsChildren(e,i)})}deactivateRoutes(e,t,i){const n=e.value,s=t?t.value:null;if(n===s)if(n.component){const s=i.getContext(n.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet);if(i&&i.outlet){const t=i.outlet.detach(),n=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:t,route:e,contexts:n})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),n=i&&e.value.component?i.children:t,s=jc(e);for(const r of Object.keys(s))this.deactivateRouteAndItsChildren(s[r],n);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const n=jc(t);e.children.forEach(e=>{this.activateRoutes(e,n[e.value.outlet],i),this.forwardEvent(new Gh(e.value.snapshot))}),e.children.length&&this.forwardEvent(new Yh(e.value.snapshot))}activateRoutes(e,t,i){const n=e.value,s=t?t.value:null;if(Yc(n),n===s)if(n.component){const s=i.getOrCreateContext(n.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(n.component){const t=i.getOrCreateContext(n.outlet);if(this.routeReuseStrategy.shouldAttach(n.snapshot)){const e=this.routeReuseStrategy.retrieve(n.snapshot);this.routeReuseStrategy.store(n.snapshot,null),t.children.onOutletReAttached(e.contexts),t.attachRef=e.componentRef,t.route=e.route.value,t.outlet&&t.outlet.attach(e.componentRef,e.route.value),ld(e.route)}else{const i=function(e){for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig;if(e&&e.component)return null}return null}(n.snapshot),s=i?i.module.componentFactoryResolver:null;t.attachRef=null,t.route=n,t.resolver=s,t.outlet&&t.outlet.activateWith(n,s),this.activateChildRoutes(e,null,t.children)}}else this.activateChildRoutes(e,null,i)}}function ld(e){Yc(e.value),e.children.forEach(ld)}class hd{constructor(e,t){this.routes=e,this.module=t}}function cd(e){return"function"==typeof e}function dd(e){return e instanceof pc}const pd=Symbol("INITIAL_VALUE");function ud(){return Jl(e=>function(...e){let t,i;return O(e[e.length-1])&&(i=e.pop()),"function"==typeof e[e.length-1]&&(t=e.pop()),1===e.length&&l(e[0])&&(e=e[0]),V(e,i).lift(new Yl(t))}(e.map(e=>e.pipe(ih(1),function(...e){const t=e[e.length-1];return O(t)?(e.pop(),i=>ql(e,i,t)):t=>ql(e,t)}(pd)))).pipe(rh((e,t)=>{let i=!1;return t.reduce((e,n,s)=>{if(e!==pd)return e;if(n===pd&&(i=!0),!i){if(!1===n)return n;if(s===t.length-1||dd(n))return n}return e},e)},pd),lh(e=>e!==pd),T(e=>dd(e)?e:!0===e),ih(1)))}let gd=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Ne({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&Ks(0,"router-outlet")},directives:function(){return[lp]},encapsulation:2}),e})();function md(e,t=""){for(let i=0;i<e.length;i++){const n=e[i];fd(n,yd(t,n))}}function fd(e,t){e.children&&md(e.children,t)}function yd(e,t){return t?e||t.path?e&&!t.path?`${e}/`:!e&&t.path?t.path:`${e}/${t.path}`:"":e}function bd(e){const t=e.children&&e.children.map(bd),i=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!i.component&&(t||i.loadChildren)&&i.outlet&&i.outlet!==Zh&&(i.component=gd),i}function vd(e){return e.outlet||Zh}function wd(e,t){const i=e.filter(e=>vd(e)===t);return i.push(...e.filter(e=>vd(e)!==t)),i}const xd={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Sd(e,t,i){var n;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||i.length>0)?Object.assign({},xd):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const s=(t.matcher||Kh)(i,e,t);if(!s)return Object.assign({},xd);const r={};sc(s.posParams,(e,t)=>{r[t]=e.path});const o=s.consumed.length>0?Object.assign(Object.assign({},r),s.consumed[s.consumed.length-1].parameters):r;return{matched:!0,consumedSegments:s.consumed,lastChild:s.consumed.length,parameters:o,positionalParamSegments:null!==(n=s.posParams)&&void 0!==n?n:{}}}function Cd(e,t,i,n,s="corrected"){if(i.length>0&&function(e,t,i){return i.some(i=>Pd(e,t,i)&&vd(i)!==Zh)}(e,i,n)){const s=new uc(t,function(e,t,i,n){const s={};s.primary=n,n._sourceSegment=e,n._segmentIndexShift=t.length;for(const r of i)if(""===r.path&&vd(r)!==Zh){const i=new uc([],{});i._sourceSegment=e,i._segmentIndexShift=t.length,s[vd(r)]=i}return s}(e,t,n,new uc(i,e.children)));return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:[]}}if(0===i.length&&function(e,t,i){return i.some(i=>Pd(e,t,i))}(e,i,n)){const r=new uc(e.segments,function(e,t,i,n,s,r){const o={};for(const a of n)if(Pd(e,i,a)&&!s[vd(a)]){const i=new uc([],{});i._sourceSegment=e,i._segmentIndexShift="legacy"===r?e.segments.length:t.length,o[vd(a)]=i}return Object.assign(Object.assign({},s),o)}(e,t,i,n,e.children,s));return r._sourceSegment=e,r._segmentIndexShift=t.length,{segmentGroup:r,slicedSegments:i}}const r=new uc(e.segments,e.children);return r._sourceSegment=e,r._segmentIndexShift=t.length,{segmentGroup:r,slicedSegments:i}}function Pd(e,t,i){return(!(e.hasChildren()||t.length>0)||"full"!==i.pathMatch)&&""===i.path}function Od(e,t,i,n){return!!(vd(e)===n||n!==Zh&&Pd(t,i,e))&&("**"===e.path||Sd(t,e,i).matched)}function Td(e,t,i){return 0===t.length&&!e.children[i]}class Ed{constructor(e){this.segmentGroup=e||null}}class Ad{constructor(e){this.urlTree=e}}function Id(e){return new b(t=>t.error(new Ed(e)))}function Dd(e){return new b(t=>t.error(new Ad(e)))}function Md(e){return new b(t=>t.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e}'`)))}class Rd{constructor(e,t,i,n,s){this.configLoader=t,this.urlSerializer=i,this.urlTree=n,this.config=s,this.allowRedirects=!0,this.ngModule=e.get(to)}apply(){const e=Cd(this.urlTree.root,[],[],this.config).segmentGroup,t=new uc(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,Zh).pipe(T(e=>this.createUrlTree(zd(e),this.urlTree.queryParams,this.urlTree.fragment))).pipe(dh(e=>{if(e instanceof Ad)return this.allowRedirects=!1,this.match(e.urlTree);if(e instanceof Ed)throw this.noMatchError(e);throw e}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,Zh).pipe(T(t=>this.createUrlTree(zd(t),e.queryParams,e.fragment))).pipe(dh(e=>{if(e instanceof Ed)throw this.noMatchError(e);throw e}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,i){const n=e.segments.length>0?new uc([],{[Zh]:e}):e;return new pc(n,t,i)}expandSegmentGroup(e,t,i,n){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(T(e=>new uc([],e))):this.expandSegment(e,i,t,i.segments,n,!0)}expandChildren(e,t,i){const n=[];for(const s of Object.keys(i.children))"primary"===s?n.unshift(s):n.push(s);return j(n).pipe(gh(n=>{const s=i.children[n],r=wd(t,n);return this.expandSegmentGroup(e,r,s,n).pipe(T(e=>({segment:e,outlet:n})))}),rh((e,t)=>(e[t.outlet]=t.segment,e),{}),function(e,t){const i=arguments.length>=2;return n=>n.pipe(e?lh((t,i)=>e(t,i,n)):y,mh(1),i?Sh(t):bh(()=>new Gl))}())}expandSegment(e,t,i,n,s,r){return j(i).pipe(gh(o=>this.expandSegmentAgainstRoute(e,t,i,o,n,s,r).pipe(dh(e=>{if(e instanceof Ed)return Nl(null);throw e}))),Oh(e=>!!e),dh((e,i)=>{if(e instanceof Gl||"EmptyError"===e.name){if(Td(t,n,s))return Nl(new uc([],{}));throw new Ed(t)}throw e}))}expandSegmentAgainstRoute(e,t,i,n,s,r,o){return Od(n,t,s,r)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(e,t,n,s,r):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,n,s,r):Id(t):Id(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,n,s,r){return"**"===n.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,n,r):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,n,s,r)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,n){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?Dd(s):this.lineralizeSegments(i,s).pipe(B(i=>{const s=new uc(i,{});return this.expandSegment(e,s,t,i,n,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,n,s,r){const{matched:o,consumedSegments:a,lastChild:l,positionalParamSegments:h}=Sd(t,n,s);if(!o)return Id(t);const c=this.applyRedirectCommands(a,n.redirectTo,h);return n.redirectTo.startsWith("/")?Dd(c):this.lineralizeSegments(n,c).pipe(B(n=>this.expandSegment(e,t,i,n.concat(s.slice(l)),r,!1)))}matchSegmentAgainstRoute(e,t,i,n,s){if("**"===i.path)return i.loadChildren?(i._loadedConfig?Nl(i._loadedConfig):this.configLoader.load(e.injector,i)).pipe(T(e=>(i._loadedConfig=e,new uc(n,{})))):Nl(new uc(n,{}));const{matched:r,consumedSegments:o,lastChild:a}=Sd(t,i,n);if(!r)return Id(t);const l=n.slice(a);return this.getChildConfig(e,i,n).pipe(B(e=>{const n=e.module,r=e.routes,{segmentGroup:a,slicedSegments:h}=Cd(t,o,l,r),c=new uc(a.segments,a.children);if(0===h.length&&c.hasChildren())return this.expandChildren(n,r,c).pipe(T(e=>new uc(o,e)));if(0===r.length&&0===h.length)return Nl(new uc(o,{}));const d=vd(i)===s;return this.expandSegment(n,c,r,h,d?Zh:s,!0).pipe(T(e=>new uc(o.concat(e.segments),e.children)))}))}getChildConfig(e,t,i){return t.children?Nl(new hd(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Nl(t._loadedConfig):this.runCanLoadGuards(e.injector,t,i).pipe(B(i=>i?this.configLoader.load(e.injector,t).pipe(T(e=>(t._loadedConfig=e,e))):function(e){return new b(t=>t.error(Jh(`Cannot load children because the guard of the route "path: '${e.path}'" returned false`)))}(t))):Nl(new hd([],e))}runCanLoadGuards(e,t,i){const n=t.canLoad;return n&&0!==n.length?Nl(n.map(n=>{const s=e.get(n);let r;if(function(e){return e&&cd(e.canLoad)}(s))r=s.canLoad(t,i);else{if(!cd(s))throw new Error("Invalid CanLoad guard");r=s(t,i)}return rc(r)})).pipe(ud(),Eh(e=>{if(!dd(e))return;const t=Jh(`Redirecting to "${this.urlSerializer.serialize(e)}"`);throw t.url=e,t}),T(e=>!0===e)):Nl(!0)}lineralizeSegments(e,t){let i=[],n=t.root;for(;;){if(i=i.concat(n.segments),0===n.numberOfChildren)return Nl(i);if(n.numberOfChildren>1||!n.children.primary)return Md(e.redirectTo);n=n.children.primary}}applyRedirectCommands(e,t,i){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreatreUrlTree(e,t,i,n){const s=this.createSegmentGroup(e,t.root,i,n);return new pc(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return sc(e,(e,n)=>{if("string"==typeof e&&e.startsWith(":")){const s=e.substring(1);i[n]=t[s]}else i[n]=e}),i}createSegmentGroup(e,t,i,n){const s=this.createSegments(e,t.segments,i,n);let r={};return sc(t.children,(t,s)=>{r[s]=this.createSegmentGroup(e,t,i,n)}),new uc(s,r)}createSegments(e,t,i,n){return t.map(t=>t.path.startsWith(":")?this.findPosParam(e,t,n):this.findOrReturn(t,i))}findPosParam(e,t,i){const n=i[t.path.substring(1)];if(!n)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return n}findOrReturn(e,t){let i=0;for(const n of t){if(n.path===e.path)return t.splice(i),n;i++}return e}}function zd(e){const t={};for(const i of Object.keys(e.children)){const n=zd(e.children[i]);(n.segments.length>0||n.hasChildren())&&(t[i]=n)}return function(e){if(1===e.numberOfChildren&&e.children.primary){const t=e.children.primary;return new uc(e.segments.concat(t.segments),t.children)}return e}(new uc(e.segments,t))}class Ld{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class kd{constructor(e,t){this.component=e,this.route=t}}function jd(e,t,i){const n=e._root;return _d(n,t?t._root:null,i,[n.value])}function Hd(e,t,i){const n=function(e){if(!e)return null;for(let t=e.parent;t;t=t.parent){const e=t.routeConfig;if(e&&e._loadedConfig)return e._loadedConfig}return null}(t);return(n?n.module.injector:i).get(e)}function _d(e,t,i,n,s={canDeactivateChecks:[],canActivateChecks:[]}){const r=jc(t);return e.children.forEach(e=>{!function(e,t,i,n,s={canDeactivateChecks:[],canActivateChecks:[]}){const r=e.value,o=t?t.value:null,a=i?i.getContext(e.value.outlet):null;if(o&&r.routeConfig===o.routeConfig){const l=function(e,t,i){if("function"==typeof i)return i(e,t);switch(i){case"pathParamsChange":return!mc(e.url,t.url);case"pathParamsOrQueryParamsChange":return!mc(e.url,t.url)||!ec(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Xc(e,t)||!ec(e.queryParams,t.queryParams);case"paramsChange":default:return!Xc(e,t)}}(o,r,r.routeConfig.runGuardsAndResolvers);l?s.canActivateChecks.push(new Ld(n)):(r.data=o.data,r._resolvedData=o._resolvedData),_d(e,t,r.component?a?a.children:null:i,n,s),l&&a&&a.outlet&&a.outlet.isActivated&&s.canDeactivateChecks.push(new kd(a.outlet.component,o))}else o&&Nd(t,a,s),s.canActivateChecks.push(new Ld(n)),_d(e,null,r.component?a?a.children:null:i,n,s)}(e,r[e.value.outlet],i,n.concat([e.value]),s),delete r[e.value.outlet]}),sc(r,(e,t)=>Nd(e,i.getContext(t),s)),s}function Nd(e,t,i){const n=jc(e),s=e.value;sc(n,(e,n)=>{Nd(e,s.component?t?t.children.getContext(n):null:t,i)}),i.canDeactivateChecks.push(new kd(s.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,s))}class Bd{}function Wd(e){return new b(t=>t.error(e))}class Ud{constructor(e,t,i,n,s,r){this.rootComponentType=e,this.config=t,this.urlTree=i,this.url=n,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=r}recognize(){const e=Cd(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,Zh);if(null===t)return null;const i=new Wc([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Zh,this.rootComponentType,null,this.urlTree.root,-1,{}),n=new kc(i,t),s=new Uc(this.url,n);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(e){const t=e.value,i=Bc(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(e=>this.inheritParamsAndData(e))}processSegmentGroup(e,t,i){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,i)}processChildren(e,t){const i=[];for(const s of Object.keys(t.children)){const n=t.children[s],r=wd(e,s),o=this.processSegmentGroup(r,n,s);if(null===o)return null;i.push(...o)}const n=Vd(i);return n.sort((e,t)=>e.value.outlet===Zh?-1:t.value.outlet===Zh?1:e.value.outlet.localeCompare(t.value.outlet)),n}processSegment(e,t,i,n){for(const s of e){const e=this.processSegmentAgainstRoute(s,t,i,n);if(null!==e)return e}return Td(t,i,n)?[]:null}processSegmentAgainstRoute(e,t,i,n){if(e.redirectTo||!Od(e,t,i,n))return null;let s,r=[],o=[];if("**"===e.path){const n=i.length>0?nc(i).parameters:{};s=new Wc(i,n,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Gd(e),vd(e),e.component,e,Yd(t),Xd(t)+i.length,qd(e))}else{const n=Sd(t,e,i);if(!n.matched)return null;r=n.consumedSegments,o=i.slice(n.lastChild),s=new Wc(r,n.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Gd(e),vd(e),e.component,e,Yd(t),Xd(t)+r.length,qd(e))}const a=function(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(e),{segmentGroup:l,slicedSegments:h}=Cd(t,r,o,a.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution);if(0===h.length&&l.hasChildren()){const e=this.processChildren(a,l);return null===e?null:[new kc(s,e)]}if(0===a.length&&0===h.length)return[new kc(s,[])];const c=vd(e)===n,d=this.processSegment(a,l,h,c?Zh:n);return null===d?null:[new kc(s,d)]}}function Fd(e){const t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function Vd(e){const t=[],i=new Set;for(const n of e){if(!Fd(n)){t.push(n);continue}const e=t.find(e=>n.value.routeConfig===e.value.routeConfig);void 0!==e?(e.children.push(...n.children),i.add(e)):t.push(n)}for(const n of i){const e=Vd(n.children);t.push(new kc(n.value,e))}return t.filter(e=>!i.has(e))}function Yd(e){let t=e;for(;t._sourceSegment;)t=t._sourceSegment;return t}function Xd(e){let t=e,i=t._segmentIndexShift?t._segmentIndexShift:0;for(;t._sourceSegment;)t=t._sourceSegment,i+=t._segmentIndexShift?t._segmentIndexShift:0;return i-1}function Gd(e){return e.data||{}}function qd(e){return e.resolve||{}}function Zd(e){return Jl(t=>{const i=e(t);return i?j(i).pipe(T(()=>t)):Nl(t)})}class $d extends class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const Qd=new Ii("ROUTES");class Jd{constructor(e,t,i,n){this.loader=e,this.compiler=t,this.onLoadStartListener=i,this.onLoadEndListener=n}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const i=this.loadModuleFactory(t.loadChildren).pipe(T(i=>{this.onLoadEndListener&&this.onLoadEndListener(t);const n=i.create(e);return new hd(ic(n.injector.get(Qd,void 0,ye.Self|ye.Optional)).map(bd),n)}),dh(e=>{throw t._loader$=void 0,e}));return t._loader$=new q(i,()=>new C).pipe(Y()),t._loader$}loadModuleFactory(e){return"string"==typeof e?j(this.loader.load(e)):rc(e()).pipe(B(e=>e instanceof io?Nl(e):j(this.compiler.compileModuleAsync(e))))}}class Kd{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new ep,this.attachRef=null}}class ep{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const i=this.getOrCreateContext(e);i.outlet=t,this.contexts.set(e,i)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new Kd,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}class tp{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function ip(e){throw e}function np(e,t,i){return t.parse("/")}function sp(e,t){return Nl(null)}const rp={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},op={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ap=(()=>{class e{constructor(e,t,i,n,s,r,o,a){this.rootComponentType=e,this.urlSerializer=t,this.rootContexts=i,this.location=n,this.config=a,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new C,this.errorHandler=ip,this.malformedUriErrorHandler=np,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:sp,afterPreactivation:sp},this.urlHandlingStrategy=new tp,this.routeReuseStrategy=new $d,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=s.get(to),this.console=s.get(Go);const l=s.get(oa);this.isNgZoneEnabled=l instanceof oa&&oa.isInAngularZone(),this.resetConfig(a),this.currentUrlTree=new pc(new uc([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Jd(r,o,e=>this.triggerEvent(new Uh(e)),e=>this.triggerEvent(new Fh(e))),this.routerState=_c(this.currentUrlTree,this.rootComponentType),this.transitions=new Bl({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(e){const t=this.events;return e.pipe(lh(e=>0!==e.id),T(e=>Object.assign(Object.assign({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl)})),Jl(e=>{let i=!1,n=!1;return Nl(e).pipe(Eh(e=>{this.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Jl(e=>{const i=!this.navigated||e.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||i)&&this.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return Nl(e).pipe(Jl(e=>{const i=this.transitions.getValue();return t.next(new zh(e.id,this.serializeUrl(e.extractedUrl),e.source,e.restoredState)),i!==this.transitions.getValue()?Zl:Promise.resolve(e)}),function(e,t,i,n){return Jl(s=>function(e,t,i,n,s){return new Rd(e,t,i,n,s).apply()}(e,t,i,s.extractedUrl,n).pipe(T(e=>Object.assign(Object.assign({},s),{urlAfterRedirects:e}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Eh(e=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,t,i,n,s){return B(r=>function(e,t,i,n,s="emptyOnly",r="legacy"){try{const o=new Ud(e,t,i,n,s,r).recognize();return null===o?Wd(new Bd):Nl(o)}catch(o){return Wd(o)}}(e,t,r.urlAfterRedirects,i(r.urlAfterRedirects),n,s).pipe(T(e=>Object.assign(Object.assign({},r),{targetSnapshot:e}))))}(this.rootComponentType,this.config,e=>this.serializeUrl(e),this.paramsInheritanceStrategy,this.relativeLinkResolution),Eh(e=>{"eager"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(e.urlAfterRedirects,e),this.browserUrlTree=e.urlAfterRedirects);const i=new Hh(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.next(i)}));if(i&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:i,extractedUrl:n,source:s,restoredState:r,extras:o}=e,a=new zh(i,this.serializeUrl(n),s,r);t.next(a);const l=_c(n,this.rootComponentType).snapshot;return Nl(Object.assign(Object.assign({},e),{targetSnapshot:l,urlAfterRedirects:n,extras:Object.assign(Object.assign({},o),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=e.rawUrl,this.browserUrlTree=e.urlAfterRedirects,e.resolve(null),Zl}),Zd(e=>{const{targetSnapshot:t,id:i,extractedUrl:n,rawUrl:s,extras:{skipLocationChange:r,replaceUrl:o}}=e;return this.hooks.beforePreactivation(t,{navigationId:i,appliedUrlTree:n,rawUrlTree:s,skipLocationChange:!!r,replaceUrl:!!o})}),Eh(e=>{const t=new _h(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),T(e=>Object.assign(Object.assign({},e),{guards:jd(e.targetSnapshot,e.currentSnapshot,this.rootContexts)})),function(e,t){return B(i=>{const{targetSnapshot:n,currentSnapshot:s,guards:{canActivateChecks:r,canDeactivateChecks:o}}=i;return 0===o.length&&0===r.length?Nl(Object.assign(Object.assign({},i),{guardsResult:!0})):function(e,t,i,n){return j(e).pipe(B(e=>function(e,t,i,n,s){const r=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return r&&0!==r.length?Nl(r.map(r=>{const o=Hd(r,t,s);let a;if(function(e){return e&&cd(e.canDeactivate)}(o))a=rc(o.canDeactivate(e,t,i,n));else{if(!cd(o))throw new Error("Invalid CanDeactivate guard");a=rc(o(e,t,i,n))}return a.pipe(Oh())})).pipe(ud()):Nl(!0)}(e.component,e.route,i,t,n)),Oh(e=>!0!==e,!0))}(o,n,s,e).pipe(B(i=>i&&"boolean"==typeof i?function(e,t,i,n){return j(t).pipe(gh(t=>ql(function(e,t){return null!==e&&t&&t(new Vh(e)),Nl(!0)}(t.route.parent,n),function(e,t){return null!==e&&t&&t(new Xh(e)),Nl(!0)}(t.route,n),function(e,t,i){const n=t[t.length-1],s=t.slice(0,t.length-1).reverse().map(e=>function(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)).filter(e=>null!==e).map(t=>Ql(()=>Nl(t.guards.map(s=>{const r=Hd(s,t.node,i);let o;if(function(e){return e&&cd(e.canActivateChild)}(r))o=rc(r.canActivateChild(n,e));else{if(!cd(r))throw new Error("Invalid CanActivateChild guard");o=rc(r(n,e))}return o.pipe(Oh())})).pipe(ud())));return Nl(s).pipe(ud())}(e,t.path,i),function(e,t,i){const n=t.routeConfig?t.routeConfig.canActivate:null;return n&&0!==n.length?Nl(n.map(n=>Ql(()=>{const s=Hd(n,t,i);let r;if(function(e){return e&&cd(e.canActivate)}(s))r=rc(s.canActivate(t,e));else{if(!cd(s))throw new Error("Invalid CanActivate guard");r=rc(s(t,e))}return r.pipe(Oh())}))).pipe(ud()):Nl(!0)}(e,t.route,i))),Oh(e=>!0!==e,!0))}(n,r,e,t):Nl(i)),T(e=>Object.assign(Object.assign({},i),{guardsResult:e})))})}(this.ngModule.injector,e=>this.triggerEvent(e)),Eh(e=>{if(dd(e.guardsResult)){const t=Jh(`Redirecting to "${this.serializeUrl(e.guardsResult)}"`);throw t.url=e.guardsResult,t}const t=new Nh(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);this.triggerEvent(t)}),lh(e=>!!e.guardsResult||(this.cancelNavigationTransition(e,""),!1)),Zd(e=>{if(e.guards.canActivateChecks.length)return Nl(e).pipe(Eh(e=>{const t=new Bh(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}),Jl(e=>{let t=!1;return Nl(e).pipe((i=this.paramsInheritanceStrategy,n=this.ngModule.injector,B(e=>{const{targetSnapshot:t,guards:{canActivateChecks:s}}=e;if(!s.length)return Nl(e);let r=0;return j(s).pipe(gh(e=>function(e,t,i,n){return function(e,t,i,n){const s=Object.keys(e);if(0===s.length)return Nl({});const r={};return j(s).pipe(B(s=>function(e,t,i,n){const s=Hd(e,t,n);return rc(s.resolve?s.resolve(t,i):s(t,i))}(e[s],t,i,n).pipe(Eh(e=>{r[s]=e}))),mh(1),B(()=>Object.keys(r).length===s.length?Nl(r):Zl))}(e._resolve,e,t,n).pipe(T(t=>(e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),Bc(e,i).resolve),null)))}(e.route,t,i,n)),Eh(()=>r++),mh(1),B(t=>r===s.length?Nl(e):Zl))})),Eh({next:()=>t=!0,complete:()=>{t||this.cancelNavigationTransition(e,"At least one route resolver didn't emit any value.")}}));var i,n}),Eh(e=>{const t=new Wh(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);this.triggerEvent(t)}))}),Zd(e=>{const{targetSnapshot:t,id:i,extractedUrl:n,rawUrl:s,extras:{skipLocationChange:r,replaceUrl:o}}=e;return this.hooks.afterPreactivation(t,{navigationId:i,appliedUrlTree:n,rawUrlTree:s,skipLocationChange:!!r,replaceUrl:!!o})}),T(e=>{const t=function(e,t,i){const n=Gc(e,t._root,i?i._root:void 0);return new Hc(n,t)}(this.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:t})}),Eh(e=>{this.currentUrlTree=e.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl),this.routerState=e.targetRouterState,"deferred"===this.urlUpdateStrategy&&(e.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,e),this.browserUrlTree=e.urlAfterRedirects)}),(r=this.rootContexts,o=this.routeReuseStrategy,a=e=>this.triggerEvent(e),T(e=>(new ad(o,e.targetRouterState,e.currentRouterState,a).activate(r),e))),Eh({next(){i=!0},complete(){i=!0}}),(s=()=>{i||n||this.cancelNavigationTransition(e,`Navigation ID ${e.id} is not equal to the current navigation id ${this.navigationId}`),this.currentNavigation=null},e=>e.lift(new Dh(s))),dh(i=>{if(n=!0,(s=i)&&s.ngNavigationCancelingError){const n=dd(i.url);n||(this.navigated=!0,this.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl));const s=new kh(e.id,this.serializeUrl(e.extractedUrl),i.message);t.next(s),n?setTimeout(()=>{const t=this.urlHandlingStrategy.merge(i.url,this.rawUrlTree);this.scheduleNavigation(t,"imperative",null,{skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{this.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl);const n=new jh(e.id,this.serializeUrl(e.extractedUrl),i);t.next(n);try{e.resolve(this.errorHandler(i))}catch(r){e.reject(r)}}var s;return Zl}));var s,r,o,a}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}getTransition(){const e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}setTransition(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const t=this.extractLocationChangeInfoFromEvent(e);this.shouldScheduleNavigation(this.lastLocationChangeInfo,t)&&setTimeout(()=>{const{source:e,state:i,urlTree:n}=t,s={replaceUrl:!0};if(i){const e=Object.assign({},i);delete e.navigationId,delete e.\u0275routerPageId,0!==Object.keys(e).length&&(s.state=e)}this.scheduleNavigation(n,e,i,s)},0),this.lastLocationChangeInfo=t}))}extractLocationChangeInfoFromEvent(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(e,t){if(!e)return!0;const i=t.urlTree.toString()===e.urlTree.toString();return!(t.transitionId===e.transitionId&&i&&("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){md(e),this.config=e.map(bd),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,t={}){const{relativeTo:i,queryParams:n,fragment:s,queryParamsHandling:r,preserveFragment:o}=t,a=i||this.routerState.root,l=o?this.currentUrlTree.fragment:s;let h=null;switch(r){case"merge":h=Object.assign(Object.assign({},this.currentUrlTree.queryParams),n);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=n||null}return null!==h&&(h=this.removeEmptyProps(h)),function(e,t,i,n,s){if(0===i.length)return Qc(t.root,t.root,t,n,s);const r=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new Kc(!0,0,e);let t=0,i=!1;const n=e.reduce((e,n,s)=>{if("object"==typeof n&&null!=n){if(n.outlets){const t={};return sc(n.outlets,(e,i)=>{t[i]="string"==typeof e?e.split("/"):e}),[...e,{outlets:t}]}if(n.segmentPath)return[...e,n.segmentPath]}return"string"!=typeof n?[...e,n]:0===s?(n.split("/").forEach((n,s)=>{0==s&&"."===n||(0==s&&""===n?i=!0:".."===n?t++:""!=n&&e.push(n))}),e):[...e,n]},[]);return new Kc(i,t,n)}(i);if(r.toRoot())return Qc(t.root,new uc([],{}),t,n,s);const o=function(e,t,i){if(e.isAbsolute)return new ed(t.root,!0,0);if(-1===i.snapshot._lastPathIndex){const e=i.snapshot._urlSegment;return new ed(e,e===t.root,0)}const n=Zc(e.commands[0])?0:1;return function(e,t,i){let n=e,s=t,r=i;for(;r>s;){if(r-=s,n=n.parent,!n)throw new Error("Invalid number of '../'");s=n.segments.length}return new ed(n,!1,s-r)}(i.snapshot._urlSegment,i.snapshot._lastPathIndex+n,e.numberOfDoubleDots)}(r,t,e),a=o.processChildren?id(o.segmentGroup,o.index,r.commands):td(o.segmentGroup,o.index,r.commands);return Qc(o.segmentGroup,a,t,n,s)}(a,this.currentUrlTree,e,h,null!=l?l:null)}navigateByUrl(e,t={skipLocationChange:!1}){const i=dd(e)?e:this.parseUrl(e),n=this.urlHandlingStrategy.merge(i,this.rawUrlTree);let s=null;return"computed"===this.canceledNavigationResolution&&(0===this.currentPageId||t.skipLocationChange||t.replaceUrl)&&(s=this.location.getState()),this.scheduleNavigation(n,"imperative",s,t)}navigate(e,t={skipLocationChange:!1}){return function(e){for(let t=0;t<e.length;t++){const i=e[t];if(null==i)throw new Error(`The requested path contains ${i} segment at index ${t}`)}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let t;try{t=this.urlSerializer.parse(e)}catch(i){t=this.malformedUriErrorHandler(i,this.urlSerializer,e)}return t}isActive(e,t){let i;if(i=!0===t?Object.assign({},rp):!1===t?Object.assign({},op):t,dd(e))return lc(this.currentUrlTree,e,i);const n=this.parseUrl(e);return lc(this.currentUrlTree,n,i)}removeEmptyProps(e){return Object.keys(e).reduce((t,i)=>{const n=e[i];return null!=n&&(t[i]=n),t},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new Lh(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,e.resolve(!0)},e=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(e,t,i,n,s){if(this.disposed)return Promise.resolve(!1);const r=this.getTransition(),o="imperative"!==t&&"imperative"===(null==r?void 0:r.source),a=(this.lastSuccessfulId===r.id||this.currentNavigation?r.rawUrl:r.urlAfterRedirects).toString()===e.toString();if(o&&a)return Promise.resolve(!0);let l,h,c;s?(l=s.resolve,h=s.reject,c=s.promise):c=new Promise((e,t)=>{l=e,h=t});const d=++this.navigationId;let p;return p="computed"===this.canceledNavigationResolution?i&&i.\u0275routerPageId?i.\u0275routerPageId:this.currentPageId+1:0,this.setTransition({id:d,targetPageId:p,source:t,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:n,resolve:l,reject:h,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(e=>Promise.reject(e))}setBrowserUrl(e,t){const i=this.urlSerializer.serialize(e),n=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(i)||t.extras.replaceUrl?this.location.replaceState(i,"",n):this.location.go(i,"",n)}resetStateAndUrl(e,t,i){this.routerState=e,this.currentUrlTree=t,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,t){"computed"===this.canceledNavigationResolution?"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy||this.location.historyGo(this.currentPageId-e.targetPageId):this.resetUrlToCurrentUrlTree();const i=new kh(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(i),e.resolve(!1)}generateNgRouterState(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}return e.\u0275fac=function(t){return new(t||e)(Fi(Mi),Fi(fc),Fi(ep),Fi(Ka),Fi(Hs),Fi(Aa),Fi(na),Fi(void 0))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})(),lp=(()=>{class e{constructor(e,t,i,n,s){this.parentContexts=e,this.location=t,this.resolver=i,this.changeDetector=s,this.activated=null,this._activatedRoute=null,this.activateEvents=new xo,this.deactivateEvents=new xo,this.name=n||Zh,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,e}attach(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;const i=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),n=this.parentContexts.getOrCreateContext(this.name).children,s=new hp(e,n,this.location.injector);this.activated=this.location.createComponent(i,this.location.length,s),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(t){return new(t||e)(qs(ep),qs(so),qs(fr),("name",function(e,t){const i=e.attrs;if(i){const e=i.length;let n=0;for(;n<e;){const s=i[n];if(ti(s))break;if(0===s)n+=2;else if("number"==typeof s)for(n++;n<e&&"string"==typeof i[n];)n++;else{if(s===t)return i[n+1];n+=2}}}return null}(Pt(),"name")),qs(Xr))},e.\u0275dir=Ye({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e})();class hp{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Nc?this.route:e===ep?this.childContexts:this.parent.get(e,t)}}class cp{}class dp{preload(e,t){return Nl(null)}}let pp=(()=>{class e{constructor(e,t,i,n,s){this.router=e,this.injector=n,this.preloadingStrategy=s,this.loader=new Jd(t,i,t=>e.triggerEvent(new Uh(t)),t=>e.triggerEvent(new Fh(t)))}setUpPreloading(){this.subscription=this.router.events.pipe(lh(e=>e instanceof Lh),gh(()=>this.preload())).subscribe(()=>{})}preload(){const e=this.injector.get(to);return this.processRoutes(e,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,t){const i=[];for(const n of t)if(n.loadChildren&&!n.canLoad&&n._loadedConfig){const e=n._loadedConfig;i.push(this.processRoutes(e.module,e.routes))}else n.loadChildren&&!n.canLoad?i.push(this.preloadConfig(e,n)):n.children&&i.push(this.processRoutes(e,n.children));return j(i).pipe(F(),T(e=>{}))}preloadConfig(e,t){return this.preloadingStrategy.preload(t,()=>(t._loadedConfig?Nl(t._loadedConfig):this.loader.load(e.injector,t)).pipe(B(e=>(t._loadedConfig=e,this.processRoutes(e.module,e.routes)))))}}return e.\u0275fac=function(t){return new(t||e)(Fi(ap),Fi(Aa),Fi(na),Fi(Hs),Fi(cp))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})(),up=(()=>{class e{constructor(e,t,i={}){this.router=e,this.viewportScroller=t,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof zh?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Lh&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof qh&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,t){this.router.triggerEvent(new qh(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(Fi(ap),Fi(ol),Fi(void 0))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();const gp=new Ii("ROUTER_CONFIGURATION"),mp=new Ii("ROUTER_FORROOT_GUARD"),fp=[Ka,{provide:fc,useClass:yc},{provide:ap,useFactory:function(e,t,i,n,s,r,o,a={},l,h){const c=new ap(null,e,t,i,n,s,r,ic(o));return l&&(c.urlHandlingStrategy=l),h&&(c.routeReuseStrategy=h),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(a,c),a.enableTracing&&c.events.subscribe(e=>{var t,i;null===(t=console.group)||void 0===t||t.call(console,`Router Event: ${e.constructor.name}`),console.log(e.toString()),console.log(e),null===(i=console.groupEnd)||void 0===i||i.call(console)}),c},deps:[fc,ep,Ka,Hs,Aa,na,Qd,gp,[class{},new Gi],[class{},new Gi]]},ep,{provide:Nc,useFactory:function(e){return e.routerState.root},deps:[ap]},{provide:Aa,useClass:Ma},pp,dp,class{preload(e,t){return t().pipe(dh(()=>Nl(null)))}},{provide:gp,useValue:{enableTracing:!1}}];function yp(){return new xa("Router",ap)}let bp=(()=>{class e{constructor(e,t){}static forRoot(t,i){return{ngModule:e,providers:[fp,Sp(t),{provide:mp,useFactory:xp,deps:[[ap,new Gi,new qi]]},{provide:gp,useValue:i||{}},{provide:qa,useFactory:wp,deps:[Na,[new Xi($a),new Gi],gp]},{provide:up,useFactory:vp,deps:[ap,ol,gp]},{provide:cp,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:dp},{provide:xa,multi:!0,useFactory:yp},[Cp,{provide:No,multi:!0,useFactory:Pp,deps:[Cp]},{provide:Tp,useFactory:Op,deps:[Cp]},{provide:Xo,multi:!0,useExisting:Tp}]]}}static forChild(t){return{ngModule:e,providers:[Sp(t)]}}}return e.\u0275fac=function(t){return new(t||e)(Fi(mp,8),Fi(ap,8))},e.\u0275mod=Fe({type:e}),e.\u0275inj=he({}),e})();function vp(e,t,i){return i.scrollOffset&&t.setOffset(i.scrollOffset),new up(e,t,i)}function wp(e,t,i={}){return i.useHash?new Ja(e,t):new Qa(e,t)}function xp(e){return"guarded"}function Sp(e){return[{provide:Di,multi:!0,useValue:e},{provide:Qd,multi:!0,useValue:e}]}let Cp=(()=>{class e{constructor(e){this.injector=e,this.initNavigation=!1,this.resultOfPreactivationDone=new C}appInitializer(){return this.injector.get(Wa,Promise.resolve(null)).then(()=>{let e=null;const t=new Promise(t=>e=t),i=this.injector.get(ap),n=this.injector.get(gp);return"disabled"===n.initialNavigation?(i.setUpLocationChangeListener(),e(!0)):"enabled"===n.initialNavigation||"enabledBlocking"===n.initialNavigation?(i.hooks.afterPreactivation=()=>this.initNavigation?Nl(null):(this.initNavigation=!0,e(!0),this.resultOfPreactivationDone),i.initialNavigation()):e(!0),t})}bootstrapListener(e){const t=this.injector.get(gp),i=this.injector.get(pp),n=this.injector.get(up),s=this.injector.get(ap),r=this.injector.get(Ta);e===r.components[0]&&("enabledNonBlocking"!==t.initialNavigation&&void 0!==t.initialNavigation||s.initialNavigation(),i.setUpPreloading(),n.init(),s.resetRootComponentType(r.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}}return e.\u0275fac=function(t){return new(t||e)(Fi(Hs))},e.\u0275prov=le({token:e,factory:e.\u0275fac}),e})();function Pp(e){return e.appInitializer.bind(e)}function Op(e){return e.bootstrapListener.bind(e)}const Tp=new Ii("Router Initializer"),Ep=[];let Ap=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Fe({type:e}),e.\u0275inj=he({imports:[[bp.forRoot(Ep)],bp]}),e})(),Ip=0;function Dp(e,t){const i=t;return i.unshift(void 0),new(Function.prototype.bind.apply(e,i))}function Mp(e,t){let i=t;const n=e.replace(/\[/g,".").replace(/\]/g,"").split(".");for(let s=0;s<n.length&&!Hp(i);s++)i=i[n[s]];return i}function Rp(e,t,i){const n=e.replace(/\[/g,".").replace(/\]/g,"").split("."),s=i||{};let r,o=s;const a=n.length;let l;for(r=0;r<a;r++)l=n[r],r+1===a?o[l]=void 0===t?{}:t:jp(o[l])&&(o[l]={}),o=o[l];return s}function zp(e){return!jp(e)&&e.constructor==={}.constructor}function Lp(e,t){if(!jp(t)){const i=e,n=t,s=Object.keys(t),r="deepMerge";for(const e of s)jp(i[r])||-1===i[r].indexOf(e)||!zp(n[e])&&!Array.isArray(n[e])?i[e]=n[e]:kp(i[e],i[e],n[e],!0)}}function kp(e,t,i,n){const s=e&&"object"==typeof e?e:{};let r=arguments.length;n&&(r-=1);for(let o=1;o<r;o++){if(!arguments[o])continue;let e=arguments[o];Object.keys(e).forEach(t=>{const i=s[t],r=e[t];let o;Array.isArray(r)&&Array.isArray(i);n&&(zp(r)||Array.isArray(r))?zp(r)?(o=i||{},Array.isArray(o)&&o.hasOwnProperty("isComplexArray")?kp(o,{},r,n):s[t]=kp(o,{},r,n)):(o=i||[],s[t]=kp([],o,r,n)):s[t]=r})}return s}function jp(e){return null==e}function Hp(e){return void 0===e}function _p(e){return e+"_"+Ip++}function Np(e,t){return e===t||!(e===document||!e)&&Np(e.parentNode,t)}function Bp(e){try{throw new Error(e)}catch(t){throw t.message+"\n"+t.stack}}function Wp(e){const t=e+"";return"auto"===t||-1!==t.indexOf("%")||-1!==t.indexOf("px")?t:t+"px"}function Up(){return!1}const Fp={latn:{_digits:"0123456789",_type:"numeric"}},Vp={decimal:".",group:",",percentSign:"%",plusSign:"+",minusSign:"-",infinity:"\u221e",nan:"NaN",exponential:"E"},Yp=[0,1,2,3,4,5,6,7,8,9];let Xp=(()=>{class e{static getMainObject(e,t){return Mp("main."+t,e)}static getNumberingSystem(e){return Mp("supplemental.numberingSystems",e)||this.numberingSystems}static reverseObject(e,t){const i=t||Object.keys(e),n={};for(const s of i)n.hasOwnProperty(e[s])||(n[e[s]]=s);return n}static getSymbolRegex(e){const t=e.map(e=>e.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")).join("|");return new RegExp(t,"g")}static getSymbolMatch(e){const t=Object.keys(Vp),i={};for(const n of t)i[e[n]]=Vp[n];return i}static constructRegex(e){const t=e.length;let i="";for(let n=0;n<t;n++)i+=n!==t-1?e[n]+"|":e[n];return i}static convertValueParts(e,t,i){return e.replace(t,e=>i[e])}static getDefaultNumberingSystem(e){const t={};return t.obj=Mp("numbers",e),t.nSystem=Mp("defaultNumberingSystem",t.obj),t}static getCurrentNumericOptions(e,t,i,n){const s={},r=this.getDefaultNumberingSystem(e);if(!Hp(r.nSystem)||n){const e=n?Mp("obj.mapperDigits",r):Mp(r.nSystem+"._digits",t);Hp(e)||(s.numericPair=this.reverseObject(e,Yp),s.numberParseRegex=new RegExp(this.constructRegex(e),"g"),s.numericRegex="["+e[0]+"-"+e[9]+"]",i&&(s.numericRegex=e[0]+"-"+e[9],s.symbolNumberSystem=Mp(n?"numberSymbols":"symbols-numberSystem-"+r.nSystem,r.obj),s.symbolMatch=this.getSymbolMatch(s.symbolNumberSystem),s.numberSystem=r.nSystem))}return s}static getNumberMapper(e,t,i){const n={mapper:{}},s=this.getDefaultNumberingSystem(e);if(!Hp(s.nSystem)){n.numberSystem=s.nSystem,n.numberSymbols=Mp("symbols-numberSystem-"+s.nSystem,s.obj),n.timeSeparator=Mp("timeSeparator",n.numberSymbols);const e=Mp(s.nSystem+"._digits",t);if(!Hp(e))for(const t of Yp)n.mapper[t]=e[t]}return n}}return e.nPair="numericPair",e.nRegex="numericRegex",e.numberingSystems=Fp,e})();const Gp={DJF:"Fdj",ERN:"Nfk",ETB:"Br",NAD:"$",ZAR:"R",XAF:"FCFA",GHS:"GH\u20b5",XDR:"XDR",AED:"\u062f.\u0625.\u200f",BHD:"\u062f.\u0628.\u200f",DZD:"\u062f.\u062c.\u200f",EGP:"\u062c.\u0645.\u200f",ILS:"\u20aa",IQD:"\u062f.\u0639.\u200f",JOD:"\u062f.\u0627.\u200f",KMF:"CF",KWD:"\u062f.\u0643.\u200f",LBP:"\u0644.\u0644.\u200f",LYD:"\u062f.\u0644.\u200f",MAD:"\u062f.\u0645.\u200f",MRU:"\u0623.\u0645.",OMR:"\u0631.\u0639.\u200f",QAR:"\u0631.\u0642.\u200f",SAR:"\u0631.\u0633.\u200f",SDG:"\u062c.\u0633.",SOS:"S",SSP:"\xa3",SYP:"\u0644.\u0633.\u200f",TND:"\u062f.\u062a.\u200f",YER:"\u0631.\u064a.\u200f",CLP:"$",INR:"\u20b9",TZS:"TSh",EUR:"\u20ac",AZN:"\u20bc",RUB:"\u20bd",BYN:"Br",ZMW:"K",BGN:"\u043b\u0432.",NGN:"\u20a6",XOF:"CFA",BDT:"\u09f3",CNY:"\xa5",BAM:"\u041a\u041c",UGX:"USh",USD:"$",CZK:"K\u010d",GBP:"\xa3",DKK:"kr.",KES:"Ksh",CHF:"CHF",MVR:"\u0783.",BTN:"Nu.",XCD:"EC$",AUD:"$",BBD:"$",BIF:"FBu",BMD:"$",BSD:"$",BWP:"P",BZD:"$",CAD:"$",NZD:"$",FJD:"$",FKP:"\xa3",GIP:"\xa3",GMD:"D",GYD:"$",HKD:"$",IDR:"Rp",JMD:"$",KYD:"$",LRD:"$",MGA:"Ar",MOP:"MOP$",MUR:"Rs",MWK:"MK",MYR:"RM",PGK:"K",PHP:"\u20b1",PKR:"Rs",RWF:"RF",SBD:"$",SCR:"SR",SEK:"kr",SGD:"$",SHP:"\xa3",SLL:"Le",ANG:"NAf.",SZL:"E",TOP:"T$",TTD:"$",VUV:"VT",WST:"WS$",ARS:"$",BOB:"Bs",BRL:"R$",COP:"$",CRC:"\u20a1",CUP:"$",DOP:"$",GTQ:"Q",HNL:"L",MXN:"$",NIO:"C$",PAB:"B/.",PEN:"S/",PYG:"\u20b2",UYU:"$",VES:"Bs.S",IRR:"\u0631\u064a\u0627\u0644",GNF:"FG",CDF:"FC",HTG:"G",XPF:"FCFP",HRK:"kn",HUF:"Ft",AMD:"\u058f",ISK:"kr",JPY:"\xa5",GEL:"\u20be",CVE:"\u200b",KZT:"\u20b8",KHR:"\u17db",KPW:"\u20a9",KRW:"\u20a9",KGS:"\u0441\u043e\u043c",AOA:"Kz",LAK:"\u20ad",MZN:"MTn",MKD:"\u0434\u0435\u043d",MNT:"\u20ae",BND:"$",MMK:"K",NOK:"kr",NPR:"\u0930\u0941",AWG:"Afl.",SRD:"$",PLN:"z\u0142",AFN:"\u060b",STN:"Db",MDL:"L",RON:"lei",UAH:"\u20b4",LKR:"\u0dbb\u0dd4.",ALL:"Lek\xeb",RSD:"\u0434\u0438\u043d.",TJS:"\u0441\u043c\u043d",THB:"\u0e3f",TMT:"m.",TRY:"\u20ba",UZS:"\u0441\u045e\u043c",VND:"\u20ab",TWD:"NT$"};var qp;!function(e){const t=[28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990];e.getHijriDate=function(e){let i=e.getDate(),n=e.getMonth(),s=e.getFullYear(),r=n+1,o=s;r<3&&(o-=1,r+=12);let a=Math.floor(o/100),l=a-Math.floor(a/4)-2;const h=Math.floor(365.25*(o+4716))+Math.floor(30.6001*(r+1))+i-l-1524;a=Math.floor((h-1867216.25)/36524.25),l=a-Math.floor(a/4)+1;const c=h+l+1524;let d=Math.floor((c-122.1)/365.25);const p=Math.floor(365.25*d),u=Math.floor((c-p)/30.6001);i=c-p-Math.floor(30.6001*u),n=Math.floor((c-p)/20.6001),n>13&&(d+=1,n-=12),n-=1,s=d-4716;const g=h-24e5,m=10631/30;let f=h-1948084;const y=Math.floor(f/10631);f-=10631*y;const b=Math.floor((f-.1335)/m),v=30*y+b;f-=Math.floor(b*m+.1335);let w=Math.floor((f+28.5001)/29.5);13===w&&(w=12);const x=f-Math.floor(29.5001*w-29);let S=0;for(;S<t.length&&!(t[S]>g);S++);const C=S+16260,P=Math.floor((C-1)/12);let O=P+1,T=C-12*P,E=g-t[S-1]+1;return(E+"").length>2&&(E=x,T=w,O=v),{year:O,month:T,date:E}},e.toGregorian=function(e,i,n){const s=Math.floor(n+t[12*(e-1)+1+(i-1)-16260-1]-1+24e5+.5);let r=Math.floor((s-1867216.25)/36524.25);r=s+1+r-Math.floor(r/4);const o=r+1524,a=Math.floor((o-122.1)/365.25),l=Math.floor(365.25*a),h=Math.floor((o-l)/30.6001),c=o-l-Math.floor(30.6001*h);let d=h-(h>13.5?13:1);const p=a-(d>2.5?4716:4715);return p<=0&&d--,new Date(p+"/"+d+"/"+c)}}(qp||(qp={}));const Zp=/\/MMMMM|MMMM|MMM|a|LLLL|LLL|EEEEE|EEEE|E|K|cccc|ccc|WW|W|G+|z+/gi,$p="stand-alone",Qp=["sun","mon","tue","wed","thu","fri","sat"],Jp={m:"getMinutes",h:"getHours",H:"getHours",s:"getSeconds",d:"getDate",f:"getMilliseconds"};class Kp{static dateFormat(e,t,i){const n=lu.getDependables(i,e,t.calendar),s=(Mp("parserObject.numbers",n),n.dateObject),r={isIslamic:lu.islamicRegex.test(t.calendar)};let o=t.format||lu.getResultantPattern(t.skeleton,n.dateObject,t.type,!1,"");if(r.dateSeperator=lu.getDateSeparator(n.dateObject),Hp(o))Bp("Format options or type given must be invalid");else{o=lu.ConvertDateToWeekFormat(o),r.pattern=o,r.numMapper=Xp.getNumberMapper(n.parserObject,Xp.getNumberingSystem(i));const e=o.match(Zp)||[];for(const t of e){const e=t.length;let i=t[0];switch("K"===i&&(i="h"),i){case"E":case"c":r.weekday=n.dateObject[lu.days][$p][lu.monthIndex[e]];break;case"M":case"L":r.month=n.dateObject[lu.month][$p][lu.monthIndex[e]];break;case"a":r.designator=Mp("dayPeriods.format.wide",s);break;case"G":r.era=Mp("eras."+(e<=3?"eraAbbr":4===e?"eraNames":"eraNarrow"),n.dateObject);break;case"z":r.timeZone=Mp("dates.timeZoneNames",n.parserObject)}}}return e=>isNaN(e.getDate())?null:this.intDateFormatter(e,r)}static intDateFormatter(e,t){let i="";const n=t.pattern.match(lu.dateParseRegex),s=this.getCurrentDateValue(e,t.isIslamic);for(const r of n){const n=r.length;let o,a=r[0];"K"===a&&(a="h");let l,h,c="",d="";switch(a){case"M":case"L":o=s.month,n>2?i+=t.month[o]:l=!0;break;case"E":case"c":i+=t.weekday[Qp[e.getDay()]];break;case"H":case"h":case"m":case"s":case"d":case"f":if(l=!0,"d"===a)o=s.date;else if("f"===a){l=!1,h=!0,c=e[Jp[a]]().toString(),c=c.substring(0,n);const t=c.length;if(n!==t){if(n>3)continue;for(let e=0;e<n-t;e++)c="0"+c.toString()}d+=c}else o=e[Jp[a]]();"h"===a&&(o=o%12||12);break;case"y":h=!0,d+=s.year,2===n&&(d=d.substr(d.length-2));break;case"a":let p=e.getHours()<12?"am":"pm";i+=t.designator[p];break;case"G":let u=e.getFullYear()<0?0:1,g=t.era[u];jp(g)&&(g=t.era[u?0:1]),i+=g||"";break;case"'":i+="''"===r?"'":r.replace(/'/g,"");break;case"z":let m=e.getTimezoneOffset(),f=n<4?"+H;-H":t.timeZone.hourFormat;f=f.replace(/:/g,t.numMapper.timeSeparator),0===m?i+=t.timeZone.gmtZeroFormat:(h=!0,d=this.getTimeZoneValue(m,f)),d=t.timeZone.gmtFormat.replace(/\{0\}/,d);break;case":":i+=t.numMapper.numberSymbols.timeSeparator;break;case"/":i+=t.dateSeperator;break;case"W":l=!0,o=lu.getWeekOfYear(e);break;default:i+=r}l&&(h=!0,d=this.checkTwodigitNumber(o,n)),h&&(i+=Xp.convertValueParts(d,lu.latnParseRegex,t.numMapper.mapper))}return i}static getCurrentDateValue(e,t){return t?qp.getHijriDate(e):{year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate()}}static checkTwodigitNumber(e,t){const i=e+"";return 2===t&&2!==i.length?"0"+i:i}static getTimeZoneValue(e,t){let i=t.split(";")[e>0?1:0];const n=Math.abs(e);return i.replace(/HH?|mm/g,e=>{const t=e.length,i=-1!==e.indexOf("H");return this.checkTwodigitNumber(Math.floor(i?n/60:n%60),t)})}}const eu={ms:"minimumSignificantDigits",ls:"maximumSignificantDigits",mf:"minimumFractionDigits",lf:"maximumFractionDigits"},tu=["infinity","nan","group","decimal","exponential"];class iu{static numberFormatter(e,t,i){const n=kp({},t);let s={};const r={};let o;const a=lu.getDependables(i,e,"",!0);r.numberMapper=Xp.getNumberMapper(a.parserObject,Xp.getNumberingSystem(i),!0),r.currencySymbol=lu.getCurrencySymbol(a.numericObject,n.currency||ou,t.altSymbol),r.percentSymbol=r.numberMapper.numberSymbols.percentSign,r.minusSymbol=r.numberMapper.numberSymbols.minusSign;const l=r.numberMapper.numberSymbols;if(t.format&&!lu.formatRegex.test(t.format))s=lu.customFormat(t.format,r,a.numericObject);else{kp(n,lu.getProperNumericSkeleton(t.format||"N")),n.isCurrency="currency"===n.type,n.isPercent="percent"===n.type,o=lu.getSymbolPattern(n.type,r.numberMapper.numberSystem,a.numericObject,n.isAccount),n.groupOne=this.checkValueRange(n.maximumSignificantDigits,n.minimumSignificantDigits,!0),this.checkValueRange(n.maximumFractionDigits,n.minimumFractionDigits,!1,!0),Hp(n.fractionDigits)||(n.minimumFractionDigits=n.maximumFractionDigits=n.fractionDigits),Hp(n.useGrouping)&&(n.useGrouping=!0),n.isCurrency&&(o=o.replace(/\u00A4/g,lu.defaultCurrency));{const e=o.split(";");s.nData=lu.getFormatData(e[1]||"-"+e[0],!0,r.currencySymbol),s.pData=lu.getFormatData(e[0],!1,r.currencySymbol),n.useGrouping&&(n.groupSeparator=l[tu[2]],n.groupData=this.getGroupingDetails(e[0]))}if(Hp(n.minimumFractionDigits)&&(n.minimumFractionDigits=s.nData.minimumFraction),Hp(n.maximumFractionDigits)){const e=s.nData.maximumFraction;n.maximumFractionDigits=Hp(e)&&n.isPercent?0:e}const e=n.minimumFractionDigits,i=n.maximumFractionDigits;Hp(e)||Hp(i)||e>i&&(n.maximumFractionDigits=e)}return kp(s.nData,n),kp(s.pData,n),e=>isNaN(e)?l[tu[1]]:isFinite(e)?this.intNumberFormatter(e,s,r):l[tu[0]]}static getGroupingDetails(e){const t={},i=e.match(lu.negativeDataRegex);if(i&&i[4]){const e=i[4],n=e.lastIndexOf(",");if(-1!==n){const i=e.split(".")[0];t.primary=i.length-n-1;const s=e.lastIndexOf(",",n-1);-1!==s&&(t.secondary=n-1-s)}}return t}static checkValueRange(e,t,i,n){const s=n?"f":"s";let r=0;const o=eu["l"+s];let a=eu["m"+s];if(Hp(e)||(this.checkRange(e,o,n),r++),Hp(t)||(this.checkRange(t,a,n),r++),2===r){if(!(e<t))return!0;Bp(a+"specified must be less than the"+o)}else i&&1===r&&Bp("Both"+a+"and"+a+"must be present");return!1}static checkRange(e,t,i){const n=i?[0,20]:[1,21];(e<n[0]||e>n[1])&&Bp(t+"value must be within the range"+n[0]+"to"+n[1])}static intNumberFormatter(e,t,i){let n;if(!Hp(t.nData.type)){e<0?(e*=-1,n=t.nData):n=0===e&&t.zeroData||t.pData;let s="";return n.isPercent&&(e*=100),n.groupOne?s=this.processSignificantDigits(e,n.minimumSignificantDigits,n.maximumSignificantDigits):(s=this.processFraction(e,n.minimumFractionDigits,n.maximumFractionDigits),n.minimumIntegerDigits&&(s=this.processMinimumIntegers(s,n.minimumIntegerDigits))),"scientific"===n.type&&(s=e.toExponential(n.maximumFractionDigits),s=s.replace("e",i.numberMapper.numberSymbols[tu[4]])),s=s.replace(".",i.numberMapper.numberSymbols[tu[3]]),n.useGrouping&&(s=this.groupNumbers(s,n.groupData.primary,n.groupSeparator||",",i.numberMapper.numberSymbols[tu[3]]||".",n.groupData.secondary)),s=Xp.convertValueParts(s,lu.latnParseRegex,i.numberMapper.mapper),"N/A"===n.nlead?n.nlead:n.nlead+s+n.nend}}static processSignificantDigits(e,t,i){let n,s=e+"";return s.length<t?e.toPrecision(t):(s=e.toPrecision(i),n=+s,n+"")}static groupNumbers(e,t,i,n,s){let r=!jp(s)&&0!==s;const o=e.split(n),a=o[0];let l=a.length,h="";for(;l>t;)h=a.slice(l-t,l)+(h.length?i+h:""),l-=t,r&&(t=s,r=!1);return o[0]=a.slice(0,l)+(h.length?i:"")+h,o.join(n)}static processFraction(e,t,i){const n=(e+"").split(".")[1],s=n?n.length:0;if(t&&s<t){let i="";if(0!==s){i+=e;for(let e=0;e<t-s;e++)i+="0";return i}return i=e.toFixed(t),e.toFixed(t)}return!jp(i)&&(s>i||0===i)?e.toFixed(i):e+""}static processMinimumIntegers(e,t){const i=e.split(".");let n=i[0];const s=n.length;if(s<t){for(let e=0;e<t-s;e++)n="0"+n;i[0]=n}return i.join(".")}}class nu{constructor(e){this.ranArray=[],this.boundedEvents={},jp(e)||(this.context=e)}on(e,t,i,n){if(jp(t))return;const s=i||this.context;this.notExist(e)?this.boundedEvents[e]=[{handler:t,context:s}]:jp(n)?this.isHandlerPresent(this.boundedEvents[e],t)||this.boundedEvents[e].push({handler:t,context:s}):-1===this.ranArray.indexOf(n)&&(this.ranArray.push(n),this.boundedEvents[e].push({handler:t,context:s,id:n}))}off(e,t,i){if(this.notExist(e))return;const n=Mp(e,this.boundedEvents);if(t){for(let s=0;s<n.length;s++)if(i){if(n[s].id===i){n.splice(s,1);const e=this.ranArray.indexOf(i);-1!==e&&this.ranArray.splice(e,1);break}}else if(t===n[s].handler){n.splice(s,1);break}}else delete this.boundedEvents[e]}notify(e,t,i,n){if(this.notExist(e))return void(i&&i.call(this,t));t&&(t.name=e);const s=Mp(e,this.boundedEvents).slice(0);if(window.Blazor)return this.blazorCallback(s,t,i,n,0);for(const r of s)r.handler.call(r.context,t);i&&i.call(this,t)}blazorCallback(e,t,i,n,s){const r=s===e.length-1;if(s<e.length){const o=e[s],a=o.handler.call(o.context,t);if(a&&"function"==typeof a.then){if(!i)return a;a.then(a=>{if(a="string"==typeof a&&this.isJson(a)?JSON.parse(a,this.dateReviver):a,kp(t,t,a,!0),!i||!r)return this.blazorCallback(e,t,i,n,s+1);i.call(o.context,t)}).catch(e=>{n&&n.call(o.context,"string"==typeof e&&this.isJson(e)?JSON.parse(e,this.dateReviver):e)})}else{if(!i||!r)return this.blazorCallback(e,t,i,n,s+1);i.call(o.context,t)}}}dateReviver(e,t){return Up&&"string"==typeof t&&null!==t.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)?new Date(t):t}isJson(e){try{JSON.parse(e)}catch(t){return!1}return!0}destroy(){this.boundedEvents=this.context=void 0}notExist(e){return!1===this.boundedEvents.hasOwnProperty(e)||this.boundedEvents[e].length<=0}isHandlerPresent(e,t){for(const i of e)if(i.handler===t)return!0;return!1}}const su=new nu;let ru="en-US",ou="USD";const au={"en-US":{d:"M/d/y",D:"EEEE, MMMM d, y",f:"EEEE, MMMM d, y h:mm a",F:"EEEE, MMMM d, y h:mm:s a",g:"M/d/y h:mm a",G:"M/d/yyyy h:mm:ss tt",m:"MMMM d",M:"MMMM d",r:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",R:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",s:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",t:"h:mm tt",T:"h:m:s tt",u:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",U:"dddd, MMMM d, yyyy h:mm:ss tt",y:"MMMM yyyy",Y:"MMMM yyyy"}};var lu;!function(e){e.negativeDataRegex=/^(('[^']+'|''|[^*#@0,.E])*)(\*.)?((([#,]*[0,]*0+)(\.0*[0-9]*#*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,e.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,e.latnParseRegex=/0|1|2|3|4|5|6|7|8|9/g;const t=/[0-9]/g;e.defaultCurrency="$";const i=["infinity","nan","group","decimal"],n=/G|M|L|H|c|'| a|yy|y|EEEE|E/g,s={G:"",M:"m",L:"m",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};e.dateConverterMapper=/dddd|ddd/gi,e.islamicRegex=/^islamic/;const r={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};e.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i,e.currencyFormatRegex=/(^[ca]{1})([0-1]?[0-9]|20)?$/i,e.curWithoutNumberRegex=/(c|a)$/gi;const o={$:"isCurrency","%":"isPercent","-":"isNegative",0:"nlead",1:"nend"};function a(t,i,n,s,r){let o;const a=n||"date";if(r)o=d({skeleton:t},r).format||d({skeleton:"d"},"en-US").format;else{if(-1!==e.basicPatterns.indexOf(t)){if(o=Mp(a+"Formats."+t,i),"dateTime"===a){const e=Mp("dateFormats."+t,i),n=Mp("timeFormats."+t,i);o=o.replace("{1}",e).replace("{0}",n)}}else o=Mp("dateTimeFormats.availableFormats."+t,i);Hp(o)&&"yMd"===t&&(o="M/d/y")}return o}function l(t,i,n,s){const r={},o=n||"gregorian";return r.parserObject=Xp.getMainObject(t,i)||e.defaultObject,s?r.numericObject=Mp("numbers",r.parserObject):r.dateObject=Mp("dates.calendars."+o,r.parserObject),r}function h(e,t,i,n){return Mp(e+"Formats-numberSystem-"+t+(n?".accounting":".standard"),i)||(n?Mp(e+"Formats-numberSystem-"+t+".standard",i):"")}function c(t){return t.match(e.dateConverterMapper),t}function d(e,t){const i=e.format||e.skeleton;let n=Mp((t||"en-US")+"."+i,au);return n||(n=Mp("en-US."+i,au)),n&&(n=c(n),e.format=n.replace(/tt/,"a")),e}function p(t){const i=t.match(e.formatRegex),n={},s=i[1].toUpperCase();return n.isAccount="A"===s,n.type=e.patternMatcher[s],t.length>1&&(n.fractionDigits=parseInt(i[2],10)),n}function u(i,n,s,r){const o=r?{}:{nlead:"",nend:""},a=i.match(e.customRegex);if(a){r||(o.nlead=g(a[1],s),o.nend=g(a[10],s),o.groupPattern=a[4]);const e=a[7];if(e&&n){const i=e.match(t);o.minimumFraction=jp(i)?0:i.length,o.maximumFraction=e.length-1}}return o}function g(t,i){return t?t.replace(e.defaultCurrency,i):""}function m(e,t,i){return Mp("currencies."+t+(i?"."+i:".symbol"),e)||Mp("currencies."+t+".symbol-alt-narrow",e)||"$"}function f(t,n,s){const r={type:"decimal",minimumFractionDigits:0,maximumFractionDigits:0},o=t.match(e.customRegex);if(jp(o)||""===o[5]&&"N/A"!==t)return r.type=void 0,r;r.nlead=o[1],r.nend=o[10];let a=o[6];r.useGrouping=-1!==a.indexOf(","),a=a.replace(/,/g,"");const l=o[7];if(-1!==a.indexOf("0")&&(r.minimumIntegerDigits=a.length-a.indexOf("0")),jp(l)||(r.minimumFractionDigits=l.lastIndexOf("0"),r.maximumFractionDigits=l.lastIndexOf("#"),-1===r.minimumFractionDigits&&(r.minimumFractionDigits=0),(-1===r.maximumFractionDigits||r.maximumFractionDigits<r.minimumFractionDigits)&&(r.maximumFractionDigits=r.minimumFractionDigits)),jp(n)?kp(r,y([r.nlead,r.nend],"%","%")):(kp(r,y([r.nlead,r.nend],"$",n.currencySymbol)),r.isCurrency||kp(r,y([r.nlead,r.nend],"%",n.percentSymbol))),!jp(s)){const e=h(r.type,n.numberMapper.numberSystem,s,!1);r.useGrouping&&(r.groupSeparator=n.numberMapper.numberSymbols[i[2]],r.groupData=iu.getGroupingDetails(e.split(";")[0])),r.nlead=r.nlead.replace(/'/g,""),r.nend=r.nend.replace(/'/g,"")}return r}function y(e,t,i){const n={nlead:e[0],nend:e[1]};for(let s=0;s<2;s++){const r=e[s],a=r.indexOf(t);if(-1!==a&&(a<r.indexOf("'")||a>r.lastIndexOf("'"))){n[o[s]]=r.substr(0,a)+i+r.substr(a+1),n[o[t]]=!0,n.type=n.isCurrency?"currency":"percent";break}}return n}function b(e,t,i){e+=".";for(let n=0;n<t;n++)e+="0";if(t<i){const n=i-t;for(let t=0;t<n;t++)e+="#"}return e}function v(e,t){const i=e.split(".");let n="";for(let s=0;s<t;s++)n+="0";return i[1]?n+"."+i[1]:n}function w(e){const t=e.split(".");let i=t[0];const n=3-i.length%3;i=(n&&1===n?"#":2===n?"##":"")+i,e="";for(let s=i.length-1;s>0;s-=3)e=","+i[s-2]+i[s-1]+i[s]+e;return e=e.slice(1),t[1]?e+"."+t[1]:e}e.dateParseRegex=/([a-z])\1*|'([^']|'')+'|''|./gi,e.basicPatterns=["short","medium","long","full"],e.defaultObject={dates:{calendars:{gregorian:{months:{"stand-alone":{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},narrow:{1:"J",2:"F",3:"M",4:"A",5:"M",6:"J",7:"J",8:"A",9:"S",10:"O",11:"N",12:"D"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"Before Christ","0-alt-variant":"Before Common Era",1:"Anno Domini","1-alt-variant":"Common Era"},eraAbbr:{0:"BC","0-alt-variant":"BCE",1:"AD","1-alt-variant":"CE"},eraNarrow:{0:"B","0-alt-variant":"BCE",1:"A","1-alt-variant":"CE"}},dateFormats:{full:"EEEE, MMMM d, y",long:"MMMM d, y",medium:"MMM d, y",short:"M/d/yy"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",hmsv:"h:mm:ss a v",Hmsv:"HH:mm:ss v",hmv:"h:mm a v",Hmv:"HH:mm v",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y",yM:"M/y",yMd:"M/d/y",yMEd:"E, M/d/y",yMMM:"MMM y",yMMMd:"MMM d, y",yMMMEd:"E, MMM d, y",yMMMM:"MMMM y"}}},islamic:{months:{"stand-alone":{abbreviated:{1:"Muh.",2:"Saf.",3:"Rab. I",4:"Rab. II",5:"Jum. I",6:"Jum. II",7:"Raj.",8:"Sha.",9:"Ram.",10:"Shaw.",11:"Dhu\u02bbl-Q.",12:"Dhu\u02bbl-H."},narrow:{1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",11:"11",12:"12"},wide:{1:"Muharram",2:"Safar",3:"Rabi\u02bb I",4:"Rabi\u02bb II",5:"Jumada I",6:"Jumada II",7:"Rajab",8:"Sha\u02bbban",9:"Ramadan",10:"Shawwal",11:"Dhu\u02bbl-Qi\u02bbdah",12:"Dhu\u02bbl-Hijjah"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"AH"},eraAbbr:{0:"AH"},eraNarrow:{0:"AH"}},dateFormats:{full:"EEEE, MMMM d, y G",long:"MMMM d, y G",medium:"MMM d, y G",short:"M/d/y GGGGG"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y G",yyyy:"y G",yyyyM:"M/y GGGGG",yyyyMd:"M/d/y GGGGG",yyyyMEd:"E, M/d/y GGGGG",yyyyMMM:"MMM y G",yyyyMMMd:"MMM d, y G",yyyyMMMEd:"E, MMM d, y G",yyyyMMMM:"MMMM y G",yyyyQQQ:"QQQ y G",yyyyQQQQ:"QQQQ y G"}}}},timeZoneNames:{hourFormat:"+HH:mm;-HH:mm",gmtFormat:"GMT{0}",gmtZeroFormat:"GMT"}},numbers:{currencies:{USD:{displayName:"US Dollar",symbol:"$","symbol-alt-narrow":"$"},EUR:{displayName:"Euro",symbol:"\u20ac","symbol-alt-narrow":"\u20ac"},GBP:{displayName:"British Pound","symbol-alt-narrow":"\xa3"}},defaultNumberingSystem:"latn",minimumGroupingDigits:"1","symbols-numberSystem-latn":{decimal:".",group:",",list:";",percentSign:"%",plusSign:"+",minusSign:"-",exponential:"E",superscriptingExponent:"\xd7",perMille:"\u2030",infinity:"\u221e",nan:"NaN",timeSeparator:":"},"decimalFormats-numberSystem-latn":{standard:"#,##0.###"},"percentFormats-numberSystem-latn":{standard:"#,##0%"},"currencyFormats-numberSystem-latn":{standard:"\xa4#,##0.00",accounting:"\xa4#,##0.00;(\xa4#,##0.00)"},"scientificFormats-numberSystem-latn":{standard:"#E0"}}},e.blazorDefaultObject={numbers:{mapper:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9"},mapperDigits:"0123456789",numberSymbols:{decimal:".",group:",",plusSign:"+",minusSign:"-",percentSign:"%",nan:"NaN",timeSeparator:":",infinity:"\u221e"},timeSeparator:":",currencySymbol:"$",currencypData:{nlead:"$",nend:"",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentpData:{nlead:"",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},percentnData:{nlead:"-",nend:"%",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},currencynData:{nlead:"($",nend:")",groupSeparator:",",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalnData:{nlead:"-",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2},decimalpData:{nlead:"",nend:"",groupData:{primary:3},maximumFraction:2,minimumFraction:2}},dates:{dayPeriods:{am:"AM",pm:"PM"},dateSeperator:"/",days:{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}},months:{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}},eras:{1:"AD"}}},e.monthIndex={3:"abbreviated",4:"wide",5:"narrow",1:"abbreviated"},e.month="months",e.days="days",e.patternMatcher={C:"currency",P:"percent",N:"decimal",A:"currency",E:"scientific"},e.getResultantPattern=a,e.getDependables=l,e.getSymbolPattern=h,e.ConvertDateToWeekFormat=c,e.compareBlazorDateFormats=d,e.getProperNumericSkeleton=p,e.getFormatData=u,e.changeCurrencySymbol=g,e.getCurrencySymbol=m,e.customFormat=function(e,t,i){const n={},s=e.split(";"),r=["pData","nData","zeroData"];for(let o=0;o<s.length;o++)n[r[o]]=f(s[o],t,i);return jp(n.nData)&&(n.nData=kp({},n.pData),n.nData.nlead=jp(t)?"-"+n.nData.nlead:t.minusSymbol+n.nData.nlead),n},e.customNumberFormat=f,e.isCurrencyPercent=y,e.getDateSeparator=function(e){const t=(Mp("dateFormats.short",e)||"").match(/[d\u200fM\u200f]([^d\u200fM])[d\u200fM\u200f]/i);return t?t[1]:"/"},e.getActualDateTimeFormat=function(e,t,i,r){const o=l(i,e,t.calendar);let h=t.format||a(t.skeleton,o.dateObject,t.type);if(r){if(h=h.replace(n,e=>s[e]),-1!==h.indexOf("z")){const e=h.match(/z/g).length;let t;const n={timeZone:{}};n.numMapper=Xp.getNumberMapper(o.parserObject,Xp.getNumberingSystem(i)),n.timeZone=Mp("dates.timeZoneNames",o.parserObject);const s=(new Date).getTimezoneOffset();let r=e<4?"+H;-H":n.timeZone.hourFormat;r=r.replace(/:/g,n.numMapper.timeSeparator),0===s?t=n.timeZone.gmtZeroFormat:(t=Kp.getTimeZoneValue(s,r),t=n.timeZone.gmtFormat.replace(/\{0\}/,t)),h=h.replace(/[z]+/,'"'+t+'"')}h=h.replace(/ $/,"")}return h},e.getActualNumberFormat=function(t,i,n,s){const r=l(n,t,"",!0),o={custom:!0};let a;const c={},d=(i.format||"").match(e.currencyFormatRegex),g=(e.formatRegex.test(i.format)&&p(i.format||"N"),{});if(d){g.numberMapper=Xp.getNumberMapper(r.parserObject,Xp.getNumberingSystem(n),!0);const e=m(r.numericObject,i.currency||ou,i.altSymbol);let t=h("currency",g.numberMapper.numberSystem,r.numericObject,/a/i.test(i.format));t=t.replace(/\u00A4/g,e);const s=t.split(";");c.hasNegativePattern=s.length>1,c.nData=u(s[1]||"-"+s[0],!0,e),c.pData=u(s[0],!1,e),d[2]||i.minimumFractionDigits||i.maximumFractionDigits||(a=u(t.split(";")[0],!0,"",!0).minimumFraction)}let f;if(e.formatRegex.test(i.format)||!i.format){if(kp(o,p(i.format||"N")),o.custom=!1,f="###0",o.fractionDigits||i.minimumFractionDigits||i.maximumFractionDigits||a){const e=0;o.fractionDigits&&(i.minimumFractionDigits=i.maximumFractionDigits=o.fractionDigits),f=b(f,a||o.fractionDigits||i.minimumFractionDigits||e,i.maximumFractionDigits||e)}if(i.minimumIntegerDigits&&(f=v(f,i.minimumIntegerDigits)),i.useGrouping&&(f=w(f)),"currency"===o.type){const e=f;f=c.pData.nlead+e+c.pData.nend,c.hasNegativePattern&&(f+=";"+c.nData.nlead+e+c.nData.nend)}"percent"!==o.type||(f+=" %")}else f=i.format.replace(/'/g,'"');return Object.keys(g).length>0&&(f=s?f:function(e,t){if(-1!==e.indexOf(",")){let i=e.split(",");e=i[0]+Mp("numberMapper.numberSymbols.group",t)+i[1].replace(".",Mp("numberMapper.numberSymbols.decimal",t))}else e=e.replace(".",Mp("numberMapper.numberSymbols.decimal",t));return e}(f,g)),f},e.fractionDigitsPattern=b,e.minimumIntegerPattern=v,e.groupingPattern=w,e.getWeekData=function(e,t){let i="sun";const n=Mp("supplemental.weekData.firstDay",t);let s=e;return/en-/.test(s)&&(s=s.slice(3)),s=s.slice(0,2).toUpperCase()+s.substr(2),n&&(i=n[s]||"sun"),r[i]},e.replaceBlazorCurrency=function(e,t,i){const n=Mp(i||"",Gp);if(t!==n)for(const s of e)s.nend=s.nend.replace(t,n),s.nlead=s.nlead.replace(t,n)},e.getWeekOfYear=function(e){const t=new Date(e.getFullYear(),0,1);let i,n=t.getDay();n=n>=0?n:n+7;const s=Math.floor((e.getTime()-t.getTime()-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)+1;if(n<4){if(i=Math.floor((s+n-1)/7)+1,i>52){let e=new Date(this.getFullYear()+1,0,1).getDay();e=e>=0?e:e+7,i=e<4?1:53}}else i=Math.floor((s+n-1)/7);return i}}(lu||(lu={}));const hu=/^(.*?):[ \t]*([^\r\n]*)$/gm;class cu{constructor(e,t,i,n){this.mode=!0,this.emitError=!0,this.options={},"string"==typeof e?(this.url=e,this.type=t?t.toUpperCase():"GET",this.mode=!!jp(i)||i):"object"==typeof e&&(this.options=e,Lp(this,this.options)),this.type=this.type?this.type.toUpperCase():"GET",this.contentType=void 0!==this.contentType?this.contentType:n}send(e){this.data=jp(e)?this.data:e;const t={cancel:!1,httpRequest:null};return new Promise((e,i)=>{this.httpRequest=new XMLHttpRequest,this.httpRequest.onreadystatechange=()=>{this.stateChange(e,i)},jp(this.onLoad)||(this.httpRequest.onload=this.onLoad),jp(this.onProgress)||(this.httpRequest.onprogress=this.onProgress),jp(this.onAbort)||(this.httpRequest.onabort=this.onAbort),jp(this.onError)||(this.httpRequest.onerror=this.onError),jp(this.onUploadProgress)||(this.httpRequest.upload.onprogress=this.onUploadProgress),this.httpRequest.open(this.type,this.url,this.mode),jp(this.data)||null===this.contentType||this.httpRequest.setRequestHeader("Content-Type",this.contentType||"application/json; charset=utf-8"),this.beforeSend&&(t.httpRequest=this.httpRequest,this.beforeSend(t)),t.cancel||this.httpRequest.send(jp(this.data)?null:this.data)})}successHandler(e){return this.onSuccess&&this.onSuccess(e,this),e}failureHandler(e){return this.onFailure&&this.onFailure(this.httpRequest),e}stateChange(e,t){let i=this.httpRequest.responseText;if(this.dataType&&"json"===this.dataType.toLowerCase())if(""===i)i=void 0;else try{i=JSON.parse(i)}catch(n){}4===this.httpRequest.readyState&&(this.httpRequest.status>=200&&this.httpRequest.status<=299||304===this.httpRequest.status?e(this.successHandler(i)):this.emitError?t(new Error(this.failureHandler(this.httpRequest.statusText))):e())}getResponseHeader(e){let t,i;t={};let n=hu.exec(this.httpRequest.getAllResponseHeaders());for(;n;)t[n[1].toLowerCase()]=n[2],n=hu.exec(this.httpRequest.getAllResponseHeaders());return i=t[e.toLowerCase()],jp(i)?null:i}}const du=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile/i,pu=/msie|trident/i,uu=/Trident\/7\./,gu=/(ipad|iphone|ipod touch)/i,mu=/(ipad|iphone|ipod touch);.*os 7_\d|(ipad|iphone|ipod touch);.*os 8_\d/i,fu=/android/i,yu=/trident|windows phone|edge/i,bu=/(version)[ /]([\w.]+)/i,vu={OPERA:/(opera|opr)(?:.*version|)[ /]([\w.]+)/i,EDGE:/(edge)(?:.*version|)[ /]([\w.]+)/i,CHROME:/(chrome|crios)[ /]([\w.]+)/i,PANTHOMEJS:/(phantomjs)[ /]([\w.]+)/i,SAFARI:/(safari)[ /]([\w.]+)/i,WEBKIT:/(webkit)[ /]([\w.]+)/i,MSIE:/(msie|trident) ([\w.]+)/i,MOZILLA:/(mozilla)(?:.*? rv:([\w.]+)|)/i};"undefined"!=typeof window&&(window.browserDetails=window.browserDetails||{});let wu=(()=>{class e{static extractBrowserDetail(){const t={culture:{}},i=Object.keys(vu);let n=[];for(const s of i)if(n=e.userAgent.match(vu[s]),n){if(t.name="opr"===n[1].toLowerCase()?"opera":n[1].toLowerCase(),t.name="crios"===n[1].toLowerCase()?"chrome":t.name,t.version=n[2],t.culture.name=t.culture.language=navigator.language,e.userAgent.match(uu)){t.name="msie";break}const i=e.userAgent.match(bu);"safari"===t.name&&i&&(t.version=i[2]);break}return t}static getEvent(t){const i={start:{isPointer:"pointerdown",isTouch:"touchstart",isDevice:"mousedown"},move:{isPointer:"pointermove",isTouch:"touchmove",isDevice:"mousemove"},end:{isPointer:"pointerup",isTouch:"touchend",isDevice:"mouseup"},cancel:{isPointer:"pointercancel",isTouch:"touchcancel",isDevice:"mouseleave"}};return e.isPointer?i[t].isPointer:e.isTouch?i[t].isTouch+(e.isDevice?"":" "+i[t].isDevice):i[t].isDevice}static getTouchStartEvent(){return e.getEvent("start")}static getTouchEndEvent(){return e.getEvent("end")}static getTouchMoveEvent(){return e.getEvent("move")}static getTouchCancelEvent(){return e.getEvent("cancel")}static getValue(t,i){const n=window.browserDetails;return void 0===n[t]?n[t]=i.test(e.userAgent):n[t]}static set userAgent(t){e.uA=t,window.browserDetails={}}static get userAgent(){return e.uA}static get info(){return Hp(window.browserDetails.info)?window.browserDetails.info=e.extractBrowserDetail():window.browserDetails.info}static get isIE(){return e.getValue("isIE",pu)}static get isTouch(){return Hp(window.browserDetails.isTouch)?window.browserDetails.isTouch="ontouchstart"in window.navigator||window&&window.navigator&&window.navigator.maxTouchPoints>0||"ontouchstart"in window:window.browserDetails.isTouch}static get isPointer(){return Hp(window.browserDetails.isPointer)?window.browserDetails.isPointer="pointerEnabled"in window.navigator:window.browserDetails.isPointer}static get isMSPointer(){return Hp(window.browserDetails.isMSPointer)?window.browserDetails.isMSPointer="msPointerEnabled"in window.navigator:window.browserDetails.isMSPointer}static get isDevice(){return e.getValue("isDevice",du)}static get isIos(){return e.getValue("isIos",gu)}static get isIos7(){return e.getValue("isIos7",mu)}static get isAndroid(){return e.getValue("isAndroid",fu)}static get isWebView(){return Hp(window.browserDetails.isWebView)?(window.browserDetails.isWebView=!(Hp(window.cordova)&&Hp(window.PhoneGap)&&Hp(window.phonegap)&&"object"!==window.forge),window.browserDetails.isWebView):window.browserDetails.isWebView}static get isWindows(){return e.getValue("isWindows",yu)}static get touchStartEvent(){return Hp(window.browserDetails.touchStartEvent)?window.browserDetails.touchStartEvent=e.getTouchStartEvent():window.browserDetails.touchStartEvent}static get touchMoveEvent(){return Hp(window.browserDetails.touchMoveEvent)?window.browserDetails.touchMoveEvent=e.getTouchMoveEvent():window.browserDetails.touchMoveEvent}static get touchEndEvent(){return Hp(window.browserDetails.touchEndEvent)?window.browserDetails.touchEndEvent=e.getTouchEndEvent():window.browserDetails.touchEndEvent}static get touchCancelEvent(){return Hp(window.browserDetails.touchCancelEvent)?window.browserDetails.touchCancelEvent=e.getTouchCancelEvent():window.browserDetails.touchCancelEvent}}return e.uA="undefined"!=typeof navigator?navigator.userAgent:"",e})();class xu{static addOrGetEventData(e){return"__eventList"in e?e.__eventList.events:(e.__eventList={},e.__eventList.events=[])}static add(e,t,i,n,s){const r=xu.addOrGetEventData(e);let o;o=s?function(e,t){let i;return function(){const n=arguments,s=()=>(i=null,e.apply(this,n));clearTimeout(i),i=setTimeout(s,t)}}(i,s):i,n&&(o=o.bind(n));const a=t.split(" ");for(let l=0;l<a.length;l++)r.push({name:a[l],listener:i,debounce:o}),wu.isIE?e.addEventListener(a[l],o):e.addEventListener(a[l],o,{passive:!1});return o}static remove(e,t,i){const n=xu.addOrGetEventData(e),s=t.split(" ");for(let r=0;r<s.length;r++){let t,o=-1;n&&0!==n.length&&n.some((e,n)=>e.name===s[r]&&e.listener===i&&(o=n,t=e.debounce,!0)),-1!==o&&n.splice(o,1),t&&e.removeEventListener(s[r],t)}}static clearEvents(e){let t,i;t=xu.addOrGetEventData(e),i=kp([],i,t);for(let n=0;n<i.length;n++)e.removeEventListener(i[n].name,i[n].debounce),t.shift()}static trigger(e,t,i){const n=xu.addOrGetEventData(e);for(const s of n)s.name===t&&s.debounce.call(this,i)}}const Su=/^svg|^path|^g/;function Cu(e,t){const i=Su.test(e)?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return void 0===t||(i.innerHTML=t.innerHTML?t.innerHTML:"",void 0!==t.className&&(i.className=t.className),void 0!==t.id&&(i.id=t.id),void 0!==t.styles&&i.setAttribute("style",t.styles),void 0!==t.attrs&&zu(i,t.attrs)),i}function Pu(e,t){const i=Tu(t);for(const n of e)for(const e of i)if(zp(n)){const t=Mp("attributes.className",n);jp(t)?Rp("attributes.className",e,n):new RegExp("\\b"+e+"\\b","i").test(t)||Rp("attributes.className",t+" "+e,n)}else n.classList.contains(e)||n.classList.add(e);return e}function Ou(e,t){const i=Tu(t);for(const n of e){const e=zp(n);if(e?Mp("attributes.className",n):""!==n.className)for(const t of i)if(e){const e=Mp("attributes.className",n).split(" "),i=e.indexOf(t);-1!==i&&e.splice(i,1),Rp("attributes.className",e.join(" "),n)}else n.classList.remove(t)}return e}function Tu(e){let t=[];return"string"==typeof e?t.push(e):t=e,t}function Eu(e){return""===e.style.visibility&&e.offsetWidth>0}function Au(e,t,i){const n=document.createDocumentFragment();for(const s of e)n.appendChild(s);return t.insertBefore(n,t.firstElementChild),i&&Du(t),e}function Iu(e,t,i){const n=document.createDocumentFragment();for(const s of e)n.appendChild(s);return t.appendChild(n),i&&Du(t),e}function Du(e){e.querySelectorAll("script").forEach(e=>{const t=document.createElement("script");t.text=e.innerHTML,document.head.appendChild(t),Mu(t)})}function Mu(e){const t=e.parentNode;if(t)return t.removeChild(e)}function Ru(e){const t=e.parentNode;xu.clearEvents(e),t.removeChild(e)}function zu(e,t){const i=Object.keys(t),n=e;for(const s of i)if(zp(n)){let e=s;"tabindex"===s&&(e="tabIndex"),n.attributes[e]=t[s]}else n.setAttribute(s,t[s]);return n}function Lu(e,t=document,i){return e=ju(e),t.querySelector(e)}function ku(e,t=document,i){return e=ju(e),t.querySelectorAll(e)}function ju(e){if(e.match(/#[0-9]/g)){const t=e.split(",");for(let e=0;e<t.length;e++){const i=t[e].split(" ");for(let e=0;e<i.length;e++)if(i[e].indexOf("#")>-1&&!i[e].match(/\[.*\]/)&&i[e].split("#")[1].match(/^\d/)){const t=i[e].split(".");t[0]=t[0].replace(/#/,"[id='")+"']",i[e]=t.join(".")}t[e]=i.join(" ")}return t.join(",")}return e}function Hu(e,t){let i=e;if("function"==typeof i.closest)return i.closest(t);for(;i&&1===i.nodeType;){if(Nu(i,t))return i;i=i.parentNode}return null}function _u(e,t){void 0!==t&&Object.keys(t).forEach(i=>{e.style[i]=t[i]})}function Nu(e,t){let i=e.matches||e.msMatchesSelector||e.webkitMatchesSelector;return i?i.call(e,t):-1!==[].indexOf.call(document.querySelectorAll(t),e)}const Bu=new RegExp("]");class Wu{constructor(e,t){this.isRendered=!1,this.isComplexArraySetter=!1,this.isServerRendered=!1,this.allowServerDataBinding=!0,this.isProtectedOnChange=!0,this.properties={},this.changedProperties={},this.oldProperties={},this.bulkChanges={},this.refreshing=!1,this.ignoreCollectionWatch=!1,this.finalUpdate=()=>{},this.childChangedProperties={},this.modelObserver=new nu(this),Hp(t)||(this.element="string"==typeof t?document.querySelector(t):t,jp(this.element)||(this.isProtectedOnChange=!1,this.addInstance())),Hp(e)||this.setProperties(e,!0),this.isDestroyed=!1}setProperties(e,t){const i=this.isProtectedOnChange;this.isProtectedOnChange=!!t,Lp(this,e),!0!==t&&(Lp(this.changedProperties,e),this.dataBind()),this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.isProtectedOnChange=i}static callChildDataBind(e,t){const i=Object.keys(e);for(const n of i)if(t[n]instanceof Array)for(const e of t[n])void 0!==e.dataBind&&e.dataBind();else t[n].dataBind()}clearChanges(){this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.childChangedProperties={}}dataBind(){if(Wu.callChildDataBind(this.childChangedProperties,this),Object.getOwnPropertyNames(this.changedProperties).length){const e=this.isProtectedOnChange,t=this.changedProperties,i=this.oldProperties;this.clearChanges(),this.isProtectedOnChange=!0,this.onPropertyChanged(t,i),this.isProtectedOnChange=e}}serverDataBind(e){}saveChanges(e,t,i){this.isProtectedOnChange||(this.oldProperties[e]=i,this.changedProperties[e]=t,this.finalUpdate(),this.finalUpdate=function(e){let t;const i=new Uint16Array(5);(window.msCrypto||window.crypto).getRandomValues(i);let n="ej2"+function(e){let t="";for(let i=0;i<5;i++)t+=(i?",":"")+e[i];return t}(i),s=i=>{i.source===window&&"string"==typeof i.data&&i.data.length<=32&&i.data===n&&(e(),t())};return window.addEventListener("message",s,!1),window.postMessage(n,"*"),t=()=>{window.removeEventListener("message",s),e=s=n=void 0}}(this.dataBind.bind(this)))}addEventListener(e,t){this.modelObserver.on(e,t)}removeEventListener(e,t){this.modelObserver.off(e,t)}trigger(e,t,i,n){if(!0!==this.isDestroyed){const s=this.isProtectedOnChange;this.isProtectedOnChange=!1;let r=this.modelObserver.notify(e,t,i,n);if(Bu.test(e)){const s=Mp(e,this);if(s)if(window.Blazor){const e=s.call(this,t);e&&"function"==typeof e.then?i?e.then(e=>{i&&(e="string"==typeof e&&this.modelObserver.isJson(e)?JSON.parse(e):e,i.call(this,e))}).catch(e=>{n&&(e="string"==typeof e&&this.modelObserver.isJson(e)?JSON.parse(e):e,n.call(this,e))}):r=e:i&&i.call(this,t)}else s.call(this,t),i&&i.call(this,t);else i&&i.call(this,t)}return this.isProtectedOnChange=s,r}}addInstance(){const e="e-"+this.getModuleName().toLowerCase();Pu([this.element],["e-lib",e]),jp(this.element.ej2_instances)?Rp("ej2_instances",[this],this.element):this.element.ej2_instances.push(this)}destroy(){this.element.ej2_instances=this.element.ej2_instances.filter(e=>e!==this),Ou([this.element],["e-"+this.getModuleName()]),0===this.element.ej2_instances.length&&Ou([this.element],["e-lib"]),this.clearChanges(),this.modelObserver.destroy(),this.isDestroyed=!0}}function Uu(e,t,i,n){return e.properties.hasOwnProperty(t)&&e.properties[t]instanceof n||(e.properties[t]=Dp(n,[e,t,i])),e.properties[t]}function Fu(e,t,i,n,s,r){const o=[],a=i?i.length:0;for(let l=0;l<a;l++){let a=n;if(r&&(a=n(i[l],e)),s){const n=Dp(a,[e,t,{},!0]);n.setProperties(i[l],!0),o.push(n)}else o.push(Dp(a,[e,t,i[l],!1]))}return o}function Vu(e,t){return function(){return this.properties.hasOwnProperty(t)||(this.properties[t]=e),this.properties[t]}}function Yu(e,t){return function(i){if(this.properties[t]!==i){let n=this.properties.hasOwnProperty(t)?this.properties[t]:e;this.saveChanges(t,i,n),this.properties[t]=i}}}function Xu(e,t,i){return function(){return Uu(this,t,e,i)}}function Gu(e,t,i){return function(n){Uu(this,t,e,i).setProperties(n)}}function qu(e,t,i){return function(){const n=i({});return this.properties.hasOwnProperty(t)?this.properties[t]:Uu(this,t,e,n)}}function Zu(e,t,i){return function(n){const s=i(n,this);Uu(this,t,e,s).setProperties(n)}}function $u(e,t,i){return function(){if(!this.properties.hasOwnProperty(t)){const n=Fu(this,t,e,i,!1);this.properties[t]=n}const n=void 0!==this.controlParent&&this.controlParent.ignoreCollectionWatch||this.ignoreCollectionWatch;return this.properties[t].hasOwnProperty("push")||n||["push","pop"].forEach(e=>{const i={value:eg(e,t,0,this.properties[t]).bind(this),configurable:!0};Object.defineProperty(this.properties[t],e,i)}),this.properties[t].hasOwnProperty("isComplexArray")||Object.defineProperty(this.properties[t],"isComplexArray",{value:!0}),this.properties[t]}}function Qu(e,t,i){return function(n){this.isComplexArraySetter=!0;const s=Fu(this,t,e,i,!1),r=Fu(this,t,n,i,!0);this.isComplexArraySetter=!1,this.saveChanges(t,r,s),this.properties[t]=r}}function Ju(e,t,i){return function(n){const s=this.properties.hasOwnProperty(t)?this.properties[t]:e,r=Fu(this,t,n,i,!0,!0);this.saveChanges(t,r,s),this.properties[t]=r}}function Ku(e,t,i){return function(){const n=i({});if(!this.properties.hasOwnProperty(t)){const i=Fu(this,t,e,n,!1);this.properties[t]=i}return this.properties[t]}}function eg(e,t,i,n){return function(...i){const s=this.propName?this.getParentKey()+"."+t+"-":t+"-";switch(e){case"push":for(let r=0;r<i.length;r++){Array.prototype[e].apply(n,[i[r]]);const t=tg(s+(n.length-1),i[r],!this.controlParent,e);this.serverDataBind(t,i[r],!1,e)}break;case"pop":Array.prototype[e].apply(n);let t=tg(s+n.length,null,!this.controlParent,e);this.serverDataBind(t,{ejsAction:"pop"},!1,e)}return n}}function tg(e,t,i,n){let s=e;return i&&(s={},s[e]=t,t&&"object"==typeof t)&&(s[e].ejsAction=n),s}function ig(e){return(t,i)=>{const n={set:Yu(e,i),get:Vu(e,i),enumerable:!0,configurable:!0};Object.defineProperty(t,i,n),lg(t,i,"prop",e)}}function ng(e,t){return(i,n)=>{const s={set:Gu(e,n,t),get:Xu(e,n,t),enumerable:!0,configurable:!0};Object.defineProperty(i,n,s),lg(i,n,"complexProp",e,t)}}function sg(e){return(t,i)=>{const n={set:Zu({},i,e),get:qu({},i,e),enumerable:!0,configurable:!0};Object.defineProperty(t,i,n),lg(t,i,"complexProp",{},e)}}function rg(e,t){return(i,n)=>{const s={set:Qu(e,n,t),get:$u(e,n,t),enumerable:!0,configurable:!0};Object.defineProperty(i,n,s),lg(i,n,"colProp",e,t)}}function og(){return(e,t)=>{const i={set:function(e){const i=this.properties[t];if(i!==e){const n=hg(this,t);!1===Hp(i)&&n.context.removeEventListener(n.prefix,i),n.context.addEventListener(n.prefix,e),this.properties[t]=e}},get:Vu(void 0,t),enumerable:!0,configurable:!0};Object.defineProperty(e,t,i),lg(e,t,"event")}}function ag(e){}function lg(e,t,i,n,s){Hp(e.propList)&&(e.propList={props:[],complexProps:[],colProps:[],events:[],propNames:[],complexPropNames:[],colPropNames:[],eventNames:[]}),e.propList[i+"s"].push({propertyName:t,defaultValue:n,type:s}),e.propList[i+"Names"].push(t)}function hg(e,t){if(!1===e.hasOwnProperty("parentObj"))return{context:e,prefix:t};{const i=Mp("propName",e);return i&&(t=i+"-"+t),hg(Mp("parentObj",e),t)}}var cg,dg=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let pg=(()=>{let e=cg=class extends Wu{constructor(e){super(e,void 0),this.easing={ease:"cubic-bezier(0.250, 0.100, 0.250, 1.000)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)",easeIn:"cubic-bezier(0.420, 0.000, 1.000, 1.000)",easeOut:"cubic-bezier(0.000, 0.000, 0.580, 1.000)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",elasticInOut:"cubic-bezier(0.5,-0.58,0.38,1.81)",elasticIn:"cubic-bezier(0.17,0.67,0.59,1.81)",elasticOut:"cubic-bezier(0.7,-0.75,0.99,1.01)"}}animate(e,t){const i=this.getModel(t=t||{});if("string"==typeof e){const t=Array.prototype.slice.call(ku(e,document));for(const e of t)i.element=e,cg.delayAnimation(i)}else i.element=e,cg.delayAnimation(i)}static stop(e,t){e.style.animation="",e.removeAttribute("e-animate");const i=e.getAttribute("e-animation-id");if(i){const t=parseInt(i,10);cancelAnimationFrame(t),e.removeAttribute("e-animation-id")}t&&t.end&&t.end.call(this,t)}static delayAnimation(e){e.delay?setTimeout(()=>{cg.applyAnimation(e)},e.delay):cg.applyAnimation(e)}static applyAnimation(e){e.timeStamp=0;let t=0,i=0,n=0;const s=e.duration;e.element.setAttribute("e-animate","true");const r=o=>{try{if(o){n=0===n?o:n,e.timeStamp=o+e.timeStamp-n,n=o,!t&&e.begin&&e.begin.call(this,e),t+=1;const a=e.timeStamp/t;e.timeStamp<s&&e.timeStamp+a<s&&e.element.getAttribute("e-animate")?(e.element.style.animation=e.name+" "+e.duration+"ms "+e.timingFunction,e.progress&&e.progress.call(this,e),requestAnimationFrame(r)):(cancelAnimationFrame(i),e.element.removeAttribute("e-animation-id"),e.element.removeAttribute("e-animate"),e.element.style.animation="",e.end&&e.end.call(this,e))}else i=requestAnimationFrame(r),e.element.setAttribute("e-animation-id",i.toString())}catch(a){cancelAnimationFrame(i),e.element.removeAttribute("e-animation-id"),e.fail&&e.fail.call(this,a)}};r()}getModel(e){return{name:e.name||this.name,delay:e.delay||this.delay,duration:void 0!==e.duration?e.duration:this.duration,begin:e.begin||this.begin,end:e.end||this.end,fail:e.fail||this.fail,progress:e.progress||this.progress,timingFunction:this.easing[e.timingFunction]?this.easing[e.timingFunction]:e.timingFunction||this.easing[this.timingFunction]}}onPropertyChanged(e,t){}getModuleName(){return"animation"}destroy(){}};return dg([ig("FadeIn")],e.prototype,"name",void 0),dg([ig(400)],e.prototype,"duration",void 0),dg([ig("ease")],e.prototype,"timingFunction",void 0),dg([ig(0)],e.prototype,"delay",void 0),dg([og()],e.prototype,"progress",void 0),dg([og()],e.prototype,"begin",void 0),dg([og()],e.prototype,"end",void 0),dg([og()],e.prototype,"fail",void 0),e=cg=dg([ag],e),e})();function ug(e){const t=e.target,i=this.rippleOptions.selector,n=i?Hu(t,i):t;if(!n||this.rippleOptions&&Hu(t,this.rippleOptions.ignore))return;const s=n.getBoundingClientRect(),r=e.pageX-document.body.scrollLeft,o=e.pageY-(!document.body.scrollTop&&document.documentElement?document.documentElement.scrollTop:document.body.scrollTop),a=Math.max(Math.abs(r-s.left),Math.abs(r-s.right)),l=Math.max(Math.abs(o-s.top),Math.abs(o-s.bottom)),h=Math.sqrt(a*a+l*l);let c=2*h+"px",d=r-s.left-h,p=o-s.top-h;this.rippleOptions&&this.rippleOptions.isCenterRipple&&(d=0,p=0,c="100%"),n.classList.add("e-ripple");const u=Cu("div",{className:"e-ripple-element",styles:"width: "+c+";height: "+c+";left: "+d+"px;top: "+p+"px;transition-duration: "+this.rippleOptions.duration.toString()+"ms;"});n.appendChild(u),window.getComputedStyle(u).getPropertyValue("opacity"),u.style.transform="scale(1)",n!==this.parent&&xu.add(n,"mouseleave",mg,{parent:this.parent,rippleOptions:this.rippleOptions})}function gg(e){fg(e,this)}function mg(e){fg(e,this)}function fg(e,t){const i=t.rippleOptions.duration,n=e.target,s=t.rippleOptions.selector,r=s?Hu(n,s):n;if(!r||r&&-1===r.className.indexOf("e-ripple"))return;const o=ku(".e-ripple-element",r),a=o[o.length-1];a&&(a.style.opacity="0.5"),t.parent!==r&&xu.remove(r,"mouseleave",mg),setTimeout(()=>{a&&a.parentNode&&a.parentNode.removeChild(a),r.getElementsByClassName("e-ripple-element").length||r.classList.remove("e-ripple"),t.done&&t.done(e)},i)}class yg{constructor(e){this.loadedModules=[],this.parent=e}inject(e,t){const i=e.length;if(0!==i){this.loadedModules.length&&this.clearUnusedModule(e);for(let n=0;n<i;n++){const i=e[n];for(const e of t){const t=i.member;if(e.prototype.getModuleName()===i.member&&!this.isModuleLoaded(t)){const n=Dp(e,i.args),s=this.getMemberName(t);Rp(s,i.isProperty?e:n,this.parent);const r=i;r.member=s,this.loadedModules.push(r)}}}}else this.clean()}clean(){for(const e of this.loadedModules)e.isProperty||Mp(e.member,this.parent).destroy();this.loadedModules=[]}clearUnusedModule(e){const t=e.map(e=>this.getMemberName(e.member)),i=this.loadedModules.filter(e=>-1===t.indexOf(e.member));for(const n of i)n.isProperty||Mp(n.member,this.parent).destroy(),this.loadedModules.splice(this.loadedModules.indexOf(n),1),delete this.parent[n.member]}getMemberName(e){return e[0].toLowerCase()+e.substring(1)+"Module"}isModuleLoaded(e){for(const t of this.loadedModules)if(t.member===this.getMemberName(e))return!0;return!1}}class bg{constructor(e,t,i,n){this.isComplexArraySetter=!1,this.properties={},this.changedProperties={},this.childChangedProperties={},this.oldProperties={},this.finalUpdate=()=>{},this.callChildDataBind=Mp("callChildDataBind",Wu),this.parentObj=e,this.controlParent=this.parentObj.controlParent||this.parentObj,this.propName=t,this.isParentArray=n,this.setProperties(i,!0)}updateChange(e,t){!0===e?this.parentObj.childChangedProperties[t]=e:delete this.parentObj.childChangedProperties[t],this.parentObj.updateChange&&this.parentObj.updateChange(e,this.parentObj.propName)}updateTimeOut(){if(this.parentObj.updateTimeOut)this.parentObj.finalUpdate(),this.parentObj.updateTimeOut();else{const e=setTimeout(this.parentObj.dataBind.bind(this.parentObj));this.finalUpdate=()=>{clearTimeout(e)}}}clearChanges(){this.finalUpdate(),this.updateChange(!1,this.propName),this.oldProperties={},this.changedProperties={}}setProperties(e,t){!0===t?(Lp(this,e),this.updateChange(!1,this.propName),this.clearChanges()):Lp(this,e)}dataBind(){if(this.callChildDataBind(this.childChangedProperties,this),this.isParentArray){const e=this.parentObj[this.propName].indexOf(this);Object.keys(this.changedProperties).length&&(Rp(this.propName+"."+e,this.changedProperties,this.parentObj.changedProperties),Rp(this.propName+"."+e,this.oldProperties,this.parentObj.oldProperties))}else this.parentObj.changedProperties[this.propName]=this.changedProperties,this.parentObj.oldProperties[this.propName]=this.oldProperties;this.clearChanges()}saveChanges(e,t,i,n){this.controlParent.isProtectedOnChange||(n||this.serverDataBind(e,t,!0),this.oldProperties[e]=i,this.changedProperties[e]=t,this.updateChange(!0,this.propName),this.finalUpdate(),this.updateTimeOut())}serverDataBind(e,t,i,n){}getParentKey(e){let t="",i=this.propName;if(this.isParentArray){t=this.parentObj[this.propName].indexOf(this);let n=this.parentObj[this.propName].length;n=e?n:n>0?n-1:0,t=-1!==t?"-"+t:"-"+n,i+=t}return this.controlParent!==this.parentObj&&(i=this.parentObj.getParentKey()+"."+this.propName+t),i}}var vg=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let wg,xg=0,Sg=0,Cg=(()=>{let e=class extends Wu{constructor(e,t){super(e,t),this.randomId=function(){if("undefined"==typeof window)return;let e=new Uint16Array(5);return(window.msCrypto||window.crypto).getRandomValues(e)}(),this.isStringTemplate=!1,this.needsID=!1,this.isReactHybrid=!1,jp(this.enableRtl)&&this.setProperties({enableRtl:!1},!0),jp(this.locale)&&this.setProperties({locale:ru},!0),this.moduleLoader=new yg(this),this.localObserver=new nu(this),su.on("notifyExternalChange",this.detectFunction,this,this.randomId),Hp(t)||this.appendTo()}requiredModules(){return[]}destroy(){this.isDestroyed||(this.enablePersistence&&this.setPersistData(),this.localObserver.destroy(),this.refreshing||(Ou([this.element],["e-control"]),this.trigger("destroyed",{cancel:!1}),super.destroy(),this.moduleLoader.clean(),su.off("notifyExternalChange",this.detectFunction,this.randomId)))}refresh(){this.refreshing=!0,this.moduleLoader.clean(),this.destroy(),this.clearChanges(),this.localObserver=new nu(this),this.preRender(),this.injectModules(),this.render(),this.refreshing=!1}accessMount(){this.mount&&!this.isReactHybrid&&this.mount()}getRootElement(){return this.isReactHybrid?this.actualElement:this.element}getLocalData(){const e=this.getModuleName()+this.element.id;return window.localStorage.getItem(e)}appendTo(e){if(jp(e)||"string"!=typeof e?jp(e)||(this.element=e):this.element=Lu(e,document),!jp(this.element)){const e="e-"+this.getModuleName().toLowerCase();Pu([this.element],["e-control",e]),this.isProtectedOnChange=!1,this.needsID&&!this.element.id&&(this.element.id=this.getUniqueID(this.getModuleName())),this.enablePersistence&&(this.mergePersistData(),window.addEventListener("unload",this.setPersistData.bind(this)));const t=Mp("ej2_instances",this.element);t&&-1!==t.indexOf(this)||super.addInstance(),this.preRender(),this.injectModules(),this.render(),this.mount?this.accessMount():this.trigger("created")}}renderComplete(e){this.isRendered=!0}dataBind(){this.injectModules(),super.dataBind()}on(e,t,i){if("string"==typeof e)this.localObserver.on(e,t,i);else for(const n of e)this.localObserver.on(n.event,n.handler,n.context)}off(e,t){if("string"==typeof e)this.localObserver.off(e,t);else for(const i of e)this.localObserver.off(i.event,i.handler)}notify(e,t){!0!==this.isDestroyed&&this.localObserver.notify(e,t)}getInjectedModules(){return this.injectedModules}static Inject(...e){this.prototype.injectedModules||(this.prototype.injectedModules=[]);for(let t=0;t<e.length;t++)-1===this.prototype.injectedModules.indexOf(e[t])&&this.prototype.injectedModules.push(e[t])}createElement(e,t,i){return Cu(e,t)}triggerStateChange(e,t){this.isReactHybrid&&(this.setState(),this.currentContext={calls:e,args:t})}injectModules(){this.injectedModules&&this.injectedModules.length&&this.moduleLoader.inject(this.requiredModules(),this.injectedModules)}detectFunction(e){const t=Object.keys(e);t.length&&(this[t[0]]=e[t[0]])}mergePersistData(){let e;e=window.localStorage.getItem(this.getModuleName()+this.element.id),jp(e)||""===e||this.setProperties(JSON.parse(e),!0)}setPersistData(){this.isDestroyed||window.localStorage.setItem(this.getModuleName()+this.element.id,this.getPersistData())}renderReactTemplates(){}clearTemplate(e,t){}getUniqueID(e){return this.isHistoryChanged()&&(xg=0),wg=this.pageID(location.href),Sg=history.length,e+"_"+wg+"_"+xg++}pageID(e){let t=0;if(0===e.length)return t;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t&=t;return Math.abs(t)}isHistoryChanged(){return wg!==this.pageID(location.href)||Sg!==history.length}addOnPersist(e){const t={};for(const i of e){let e;e=Mp(i,this),Hp(e)||Rp(i,this.getActualProperties(e),t)}return JSON.stringify(t,(e,t)=>this.getActualProperties(t))}getActualProperties(e){return e instanceof bg?Mp("properties",e):e}ignoreOnPersist(e){return JSON.stringify(this.iterateJsonProperties(this.properties,e))}iterateJsonProperties(e,t){const i={};for(const n of Object.keys(e))if(-1===t.indexOf(n)){const s=e[n];if("object"!=typeof s||s instanceof Array)i[n]=s;else{const e=t.filter(e=>new RegExp(n+".").test(e)).map(e=>e.replace(n+".",""));i[n]=this.iterateJsonProperties(this.getActualProperties(s),e)}}return i}};return vg([ig(!1)],e.prototype,"enablePersistence",void 0),vg([ig()],e.prototype,"enableRtl",void 0),vg([ig()],e.prototype,"locale",void 0),e=vg([ag],e),e})();"undefined"!=typeof window&&window.addEventListener("popstate",()=>{xg=0});var Pg,Og=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};const Tg={left:0,top:0,bottom:0,right:0},Eg={isDragged:!1};let Ag=(()=>{class e extends bg{}return Og([ig(0)],e.prototype,"left",void 0),Og([ig(0)],e.prototype,"top",void 0),e})(),Ig=(()=>{let e=Pg=class extends Wu{constructor(e,t){super(t,e),this.dragLimit=Pg.getDefaultPosition(),this.borderWidth=Pg.getDefaultPosition(),this.padding=Pg.getDefaultPosition(),this.diffX=0,this.prevLeft=0,this.prevTop=0,this.dragProcessStarted=!1,this.tapHoldTimer=0,this.externalInitialize=!1,this.diffY=0,this.parentScrollX=0,this.parentScrollY=0,this.droppables={},this.bind()}bind(){this.toggleEvents(),wu.isIE&&Pu([this.element],"e-block-touch"),this.droppables[this.scope]={}}static getDefaultPosition(){return kp({},Tg)}toggleEvents(e){let t;Hp(this.handle)||(t=Lu(this.handle,this.element));let i=this.enableTapHold&&wu.isDevice&&wu.isTouch?this.mobileInitialize:this.initialize;e?xu.remove(t||this.element,wu.touchStartEvent,i):xu.add(t||this.element,wu.touchStartEvent,i,this)}mobileInitialize(e){let t=e.currentTarget;this.tapHoldTimer=setTimeout(()=>{this.externalInitialize=!0,this.removeTapholdTimer(),this.initialize(e,t)},this.tapHoldThreshold),xu.add(document,wu.touchMoveEvent,this.removeTapholdTimer,this),xu.add(document,wu.touchEndEvent,this.removeTapholdTimer,this)}removeTapholdTimer(){clearTimeout(this.tapHoldTimer),xu.remove(document,wu.touchMoveEvent,this.removeTapholdTimer),xu.remove(document,wu.touchEndEvent,this.removeTapholdTimer)}getScrollableParent(e,t){return jp(e)?null:e[{vertical:"scrollHeight",horizontal:"scrollWidth"}[t]]>e[{vertical:"clientHeight",horizontal:"clientWidth"}[t]]&&("vertical"===t?e.scrollTop>0:e.scrollLeft>0)?("vertical"===t?(this.parentScrollY=this.parentScrollY+(0===this.parentScrollY?e.scrollTop:e.scrollTop-this.parentScrollY),this.tempScrollHeight=e.scrollHeight):(this.parentScrollX=this.parentScrollX+(0===this.parentScrollX?e.scrollLeft:e.scrollLeft-this.parentScrollX),this.tempScrollWidth=e.scrollWidth),jp(e)?e:this.getScrollableParent(e.parentNode,t)):this.getScrollableParent(e.parentNode,t)}getScrollableValues(){this.parentScrollX=0,this.parentScrollY=0,this.element.classList.contains("e-dialog")&&this.element.classList.contains("e-dlg-modal"),this.getScrollableParent(this.element.parentNode,"vertical"),this.getScrollableParent(this.element.parentNode,"horizontal")}initialize(e,t){if(this.currentStateTarget=e.target,this.isDragStarted())return;if(this.isDragStarted(!0),this.externalInitialize=!1,this.target=e.currentTarget||t,this.dragProcessStarted=!1,this.abort){let t=this.abort;"string"==typeof t&&(t=[t]);for(let i=0;i<t.length;i++)if(!jp(Hu(e.target,t[i])))return void(this.isDragStarted()&&this.isDragStarted(!0))}this.preventDefault&&!Hp(e.changedTouches)&&"touchstart"!==e.type&&e.preventDefault(),this.element.setAttribute("aria-grabbed","true");let i=this.getCoordinates(e);if(this.initialPosition={x:i.pageX,y:i.pageY},!this.clone){let t=this.element.getBoundingClientRect();this.getScrollableValues(),e.clientX===e.pageX&&(this.parentScrollX=0),e.clientY===e.pageY&&(this.parentScrollY=0),this.relativeXPosition=i.pageX-(t.left+this.parentScrollX),this.relativeYPosition=i.pageY-(t.top+this.parentScrollY)}this.externalInitialize?this.intDragStart(e):(xu.add(document,wu.touchMoveEvent,this.intDragStart,this),xu.add(document,wu.touchEndEvent,this.intDestroy,this)),this.toggleEvents(!0),"touchstart"!==e.type&&this.isPreventSelect&&document.body.classList.add("e-prevent-select"),this.externalInitialize=!1,xu.trigger(document.documentElement,wu.touchStartEvent,e)}intDragStart(e){this.removeTapholdTimer();let t=!Hp(e.changedTouches);if(t&&1!==e.changedTouches.length)return;t&&e.preventDefault();let i,n=this.getCoordinates(e),s=getComputedStyle(this.element);this.margin={left:parseInt(s.marginLeft,10),top:parseInt(s.marginTop,10),right:parseInt(s.marginRight,10),bottom:parseInt(s.marginBottom,10)};let r=this.element;if(this.clone&&this.dragTarget){let t=Hu(e.target,this.dragTarget);jp(t)||(r=t)}this.isReplaceDragEle&&(r=this.currentStateCheck(e.target,r)),this.offset=this.calculateParentPosition(r),this.position=this.getMousePosition(e,this.isDragScroll);let o=this.initialPosition.x-n.pageX,a=this.initialPosition.y-n.pageY;if(Math.sqrt(o*o+a*a)>=this.distance||this.externalInitialize){let t=this.getHelperElement(e);if(!t||jp(t))return;let n=this.helperElement=t;if(this.parentClientRect=this.calculateParentPosition(n.offsetParent),this.dragStart){let t={event:e,element:r,target:this.getProperTargetElement(e),bindEvents:null,dragElement:n};this.trigger("dragStart",t)}this.dragArea?this.setDragArea():(this.dragLimit={left:0,right:0,bottom:0,top:0},this.borderWidth={top:0,left:0}),i={left:this.position.left-this.parentClientRect.left,top:this.position.top-this.parentClientRect.top},this.clone&&!this.enableTailMode&&(this.diffX=this.position.left-this.offset.left,this.diffY=this.position.top-this.offset.top),this.getScrollableValues();let s=getComputedStyle(r),o=parseFloat(s.marginTop);this.clone&&0!==o&&(i.top+=o),this.enableScrollHandler&&!this.clone&&(i.top-=this.parentScrollY,i.left-=this.parentScrollX);let a=this.getProcessedPositionValue({top:i.top-this.diffY+"px",left:i.left-this.diffX+"px"});this.dragElePosition={top:i.top,left:i.left},_u(n,this.getDragPosition({position:"absolute",left:a.left,top:a.top})),xu.remove(document,wu.touchMoveEvent,this.intDragStart),xu.remove(document,wu.touchEndEvent,this.intDestroy),this.bindDragEvents(n)}}bindDragEvents(e){Eu(e)?(xu.add(document,wu.touchMoveEvent,this.intDrag,this),xu.add(document,wu.touchEndEvent,this.intDragStop,this),this.setGlobalDroppables(!1,this.element,e)):(this.toggleEvents(),document.body.classList.remove("e-prevent-select"))}elementInViewport(e){for(this.top=e.offsetTop,this.left=e.offsetLeft,this.width=e.offsetWidth,this.height=e.offsetHeight;e.offsetParent;)this.top+=(e=e.offsetParent).offsetTop,this.left+=e.offsetLeft;return this.top>=window.pageYOffset&&this.left>=window.pageXOffset&&this.top+this.height<=window.pageYOffset+window.innerHeight&&this.left+this.width<=window.pageXOffset+window.innerWidth}getProcessedPositionValue(e){return this.queryPositionInfo?this.queryPositionInfo(e):e}calculateParentPosition(e){if(jp(e))return{left:0,top:0};let t=e.getBoundingClientRect(),i=getComputedStyle(e);return{left:t.left+window.pageXOffset-parseInt(i.marginLeft,10),top:t.top+window.pageYOffset-parseInt(i.marginTop,10)}}intDrag(e){if(!Hp(e.changedTouches)&&1!==e.changedTouches.length)return;let t,i;this.position=this.getMousePosition(e,this.isDragScroll);let n=this.getDocumentWidthHeight("Height");n<this.position.top&&(this.position.top=n);let s=this.getDocumentWidthHeight("Width");if(s<this.position.left&&(this.position.left=s),this.drag){let t=this.getProperTargetElement(e);this.trigger("drag",{event:e,element:this.element,target:t})}let r=this.checkTargetElement(e);if(r.target&&r.instance){let t=!0;this.hoverObject&&(this.hoverObject.instance!==r.instance?this.triggerOutFunction(e,r):t=!1),t&&(r.instance.dragData[this.scope]=this.droppables[this.scope],r.instance.intOver(e,r.target),this.hoverObject=r)}else this.hoverObject&&this.triggerOutFunction(e,r);let o=this.droppables[this.scope].helper;this.parentClientRect=this.calculateParentPosition(this.helperElement.offsetParent);let a=this.parentClientRect.left,l=this.parentClientRect.top,h=this.getCoordinates(e),c=h.pageX,d=h.pageY,p=this.position.left-this.diffX,u=this.position.top-this.diffY,g=getComputedStyle(o),m=parseFloat(g.marginTop);if(this.dragArea){if(this.pageX!==c||this.skipDistanceCheck){let e=o.offsetWidth+(parseFloat(g.marginLeft)+parseFloat(g.marginRight));t=this.dragLimit.left>p&&p>0?this.dragLimit.left:this.dragLimit.right+window.pageXOffset<p+e&&p>0?p-(p-this.dragLimit.right)+window.pageXOffset-e:p<0?this.dragLimit.left:p}if(this.pageY!==d||this.skipDistanceCheck){let e=o.offsetHeight+(parseFloat(g.marginTop)+parseFloat(g.marginBottom));i=this.dragLimit.top>u&&u>0?this.dragLimit.top:this.dragLimit.bottom+window.pageYOffset<u+e&&u>0?u-(u-this.dragLimit.bottom)+window.pageYOffset-e:u<0?this.dragLimit.top:u}}else t=p,i=u;let f,y,b=l+this.borderWidth.top,v=a+this.borderWidth.left;if(this.dragProcessStarted&&(jp(i)&&(i=this.prevTop),jp(t)&&(t=this.prevLeft)),this.dragArea){if(this.dragLimit.top=this.clone?this.dragLimit.top:0,f=i-b<0?this.dragLimit.top:i-b,y=t-v<0?this.dragElePosition.left:t-v,m>0&&(this.clone&&(f+=this.element.offsetTop,u<0&&(this.element.offsetTop+u>=0?f=this.element.offsetTop+u:f-=this.element.offsetTop),f=this.dragLimit.bottom<f?this.dragLimit.bottom:f),i-b<0))if(u+m+(o.offsetHeight-b)>=0){let e=this.dragLimit.top+u-b;e+m+b<0?f-=m+b:f=e}else f-=m+b}else f=i-b,y=t-v;this.enableScrollHandler&&!this.clone&&(f-=this.parentScrollY,y-=this.parentScrollX);let w=this.getProcessedPositionValue({top:f+"px",left:y+"px"});_u(o,this.getDragPosition(w)),!this.elementInViewport(o)&&this.enableAutoScroll&&this.helperElement.scrollIntoView(),this.dragProcessStarted=!0,this.prevLeft=t,this.prevTop=i,this.position.left=t,this.position.top=i,this.pageX=c,this.pageY=d}triggerOutFunction(e,t){this.hoverObject.instance.intOut(e,t.target),this.hoverObject.instance.dragData[this.scope]=null,this.hoverObject=null}getDragPosition(e){let t=kp({},e);return this.axis&&("x"===this.axis?delete t.top:"y"===this.axis&&delete t.left),t}getDocumentWidthHeight(e){let t=document.body,i=document.documentElement;return Math.max(t["scroll"+e],i["scroll"+e],t["offset"+e],i["offset"+e],i["client"+e])}intDragStop(e){if(this.dragProcessStarted=!1,!Hp(e.changedTouches)&&1!==e.changedTouches.length)return;if(-1!==["touchend","pointerup","mouseup"].indexOf(e.type)){if(this.dragStop){let t=this.getProperTargetElement(e);this.trigger("dragStop",{event:e,element:this.element,target:t,helper:this.helperElement})}this.intDestroy(e)}else this.element.setAttribute("aria-grabbed","false");let t=this.checkTargetElement(e);t.target&&t.instance&&(t.instance.dragStopCalled=!0,t.instance.dragData[this.scope]=this.droppables[this.scope],t.instance.intDrop(e,t.target)),this.setGlobalDroppables(!0),document.body.classList.remove("e-prevent-select")}intDestroy(e){this.dragProcessStarted=!1,this.toggleEvents(),document.body.classList.remove("e-prevent-select"),this.element.setAttribute("aria-grabbed","false"),xu.remove(document,wu.touchMoveEvent,this.intDragStart),xu.remove(document,wu.touchEndEvent,this.intDragStop),xu.remove(document,wu.touchEndEvent,this.intDestroy),xu.remove(document,wu.touchMoveEvent,this.intDrag),this.isDragStarted()&&this.isDragStarted(!0)}onPropertyChanged(e,t){}getModuleName(){return"draggable"}isDragStarted(e){return e&&(Eg.isDragged=!Eg.isDragged),Eg.isDragged}setDragArea(){let e,t,i,n=0,s=0;if(i="string"==typeof this.dragArea?Lu(this.dragArea):this.dragArea,i){let r=i.getBoundingClientRect();e=i.scrollWidth?i.scrollWidth:r.right-r.left,t=i.scrollHeight?i.scrollHeight:r.bottom-r.top;let o=["Top","Left","Bottom","Right"],a=getComputedStyle(i);for(let e=0;e<o.length;e++){let t=o[e],i=a["border"+t+"Width"],n=a["padding"+t],s=t.toLowerCase();this.borderWidth[s]=isNaN(parseFloat(i))?0:parseFloat(i),this.padding[s]=isNaN(parseFloat(n))?0:parseFloat(n)}n=r.top,s=r.left,this.dragLimit.left=s+this.borderWidth.left+this.padding.left,this.dragLimit.top=i.offsetTop+this.borderWidth.top+this.padding.top,this.dragLimit.right=s+e-(this.borderWidth.right+this.padding.right),this.dragLimit.bottom=n+t-(this.borderWidth.bottom+this.padding.bottom)}}getProperTargetElement(e){let t,i=this.getCoordinates(e),n=this.helperElement.style.pointerEvents||"";return Np(e.target,this.helperElement)||-1!==e.type.indexOf("touch")?(this.helperElement.style.pointerEvents="none",t=document.elementFromPoint(i.clientX,i.clientY),this.helperElement.style.pointerEvents=n):t=e.target,t}currentStateCheck(e,t){let i;return i=jp(this.currentStateTarget)||this.currentStateTarget===e?jp(t)?e:t:this.currentStateTarget,i}getMousePosition(e,t){let i,n,s=void 0!==e.srcElement?e.srcElement:e.target,r=this.getCoordinates(e),o=jp(s.offsetParent);return t?(i=this.clone?r.pageX:r.pageX+(o?0:s.offsetParent.scrollLeft)-this.relativeXPosition,n=this.clone?r.pageY:r.pageY+(o?0:s.offsetParent.scrollTop)-this.relativeYPosition):(i=this.clone?r.pageX:r.pageX+window.pageXOffset-this.relativeXPosition,n=this.clone?r.pageY:r.pageY+window.pageYOffset-this.relativeYPosition),this.clone||!this.dragArea||t||(this.getScrollableValues(),n-=this.tempScrollHeight?this.parentScrollY:0,i-=this.tempScrollWidth?this.parentScrollX:0),{left:i-(this.margin.left+this.cursorAt.left),top:n-(this.margin.top+this.cursorAt.top)}}getCoordinates(e){return e.type.indexOf("touch")>-1?e.changedTouches[0]:e}getHelperElement(e){let t;return this.clone?this.helper?t=this.helper({sender:e,element:this.target}):(t=Cu("div",{className:"e-drag-helper e-block-touch",innerHTML:"Draggable"}),document.body.appendChild(t)):t=this.element,t}setGlobalDroppables(e,t,i){this.droppables[this.scope]=e?null:{draggable:t,helper:i,draggedElement:this.element}}checkTargetElement(e){let t=this.getProperTargetElement(e),i=this.getDropInstance(t);if(!i&&t&&!jp(t.parentNode)){let e=Hu(t.parentNode,".e-droppable")||t.parentElement;e&&(i=this.getDropInstance(e))}return{target:t,instance:i}}getDropInstance(e){let t,i=e&&e.ej2_instances;if(i)for(let n of i)if("droppable"===n.getModuleName()){t=n;break}return t}destroy(){this.toggleEvents(!0),super.destroy()}};return Og([ng({},Ag)],e.prototype,"cursorAt",void 0),Og([ig(!0)],e.prototype,"clone",void 0),Og([ig()],e.prototype,"dragArea",void 0),Og([ig()],e.prototype,"isDragScroll",void 0),Og([ig()],e.prototype,"isReplaceDragEle",void 0),Og([ig(!0)],e.prototype,"isPreventSelect",void 0),Og([og()],e.prototype,"drag",void 0),Og([og()],e.prototype,"dragStart",void 0),Og([og()],e.prototype,"dragStop",void 0),Og([ig(1)],e.prototype,"distance",void 0),Og([ig()],e.prototype,"handle",void 0),Og([ig()],e.prototype,"abort",void 0),Og([ig()],e.prototype,"helper",void 0),Og([ig("default")],e.prototype,"scope",void 0),Og([ig("")],e.prototype,"dragTarget",void 0),Og([ig()],e.prototype,"axis",void 0),Og([ig()],e.prototype,"queryPositionInfo",void 0),Og([ig(!1)],e.prototype,"enableTailMode",void 0),Og([ig(!1)],e.prototype,"skipDistanceCheck",void 0),Og([ig(!0)],e.prototype,"preventDefault",void 0),Og([ig(!1)],e.prototype,"enableAutoScroll",void 0),Og([ig(!1)],e.prototype,"enableTapHold",void 0),Og([ig(750)],e.prototype,"tapHoldThreshold",void 0),Og([ig(!1)],e.prototype,"enableScrollHandler",void 0),e=Pg=Og([ag],e),e})();var Dg=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let Mg=(()=>{let e=class extends Wu{constructor(e,t){super(t,e),this.mouseOver=!1,this.dragData={},this.dragStopCalled=!1,this.bind()}bind(){this.wireEvents()}wireEvents(){xu.add(this.element,wu.touchEndEvent,this.intDrop,this)}onPropertyChanged(e,t){}getModuleName(){return"droppable"}intOver(e,t){this.mouseOver||(this.trigger("over",{event:e,target:t,dragData:this.dragData[this.scope]}),this.mouseOver=!0)}intOut(e,t){this.mouseOver&&(this.trigger("out",{evt:e,target:t}),this.mouseOver=!1)}intDrop(e,t){if(!this.dragStopCalled)return;this.dragStopCalled=!1;let i=!0;const n=this.dragData[this.scope],s=!!n&&n.helper&&Eu(n.helper);let r;s&&(r=this.isDropArea(e,n.helper,t),this.accept&&(i=Nu(n.helper,this.accept))),s&&this.drop&&r.canDrop&&i&&this.trigger("drop",{event:e,target:r.target,droppedElement:n.helper,dragData:n}),this.mouseOver=!1}isDropArea(e,t,i){const n={canDrop:!0,target:i||e.target},s="touchend"===e.type;if(s||n.target===t){t.style.display="none";const i=s?e.changedTouches[0]:e,r=document.elementFromPoint(i.clientX,i.clientY);n.canDrop=!1,n.canDrop=Np(r,this.element),n.canDrop&&(n.target=r),t.style.display=""}return n}destroy(){xu.remove(this.element,wu.touchEndEvent,this.intDrop),super.destroy()}};return Dg([ig()],e.prototype,"accept",void 0),Dg([ig("default")],e.prototype,"scope",void 0),Dg([og()],e.prototype,"drop",void 0),Dg([og()],e.prototype,"over",void 0),Dg([og()],e.prototype,"out",void 0),e=Dg([ag],e),e})(),Rg=(()=>{class e{constructor(e,t,i){this.controlName=e,this.localeStrings=t,this.setLocale(i||ru)}setLocale(t){const i=this.intGetControlConstant(e.locale,t);this.currentLocale=i||this.localeStrings}static load(e){this.locale=kp(this.locale,e,{},!0)}getConstant(e){return jp(this.currentLocale[e])?this.localeStrings[e]||"":this.currentLocale[e]}intGetControlConstant(e,t){return e[t]?e[t][this.controlName]:null}}return e.locale={},e})();var zg=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let Lg=(()=>{class e extends bg{}return zg([ig(50)],e.prototype,"swipeThresholdDistance",void 0),e})();const kg=/(Up|Down)/;let jg=(()=>{let e=class extends Wu{constructor(e,t){super(t,e),this.touchAction=!0,this.tapCount=0,this.startEvent=e=>{if(!0===this.touchAction){const t=this.updateChangeTouches(e);void 0!==e.changedTouches&&(this.touchAction=!1),this.isTouchMoved=!1,this.movedDirection="",this.startPoint=this.lastMovedPoint={clientX:t.clientX,clientY:t.clientY},this.startEventData=t,this.hScrollLocked=this.vScrollLocked=!1,this.tStampStart=Date.now(),this.timeOutTapHold=setTimeout(()=>{this.tapHoldEvent(e)},this.tapHoldThreshold),xu.add(this.element,wu.touchMoveEvent,this.moveEvent,this),xu.add(this.element,wu.touchEndEvent,this.endEvent,this),xu.add(this.element,wu.touchCancelEvent,this.cancelEvent,this)}},this.moveEvent=e=>{const t=this.updateChangeTouches(e);this.movedPoint=t,this.isTouchMoved=!(t.clientX===this.startPoint.clientX&&t.clientY===this.startPoint.clientY);let i={};this.isTouchMoved&&(clearTimeout(this.timeOutTapHold),this.calcScrollPoints(e),i=kp(i,{},{startEvents:this.startEventData,originalEvent:e,startX:this.startPoint.clientX,startY:this.startPoint.clientY,distanceX:this.distanceX,distanceY:this.distanceY,scrollDirection:this.scrollDirection,velocity:this.getVelocity(t)}),this.trigger("scroll",i),this.lastMovedPoint={clientX:t.clientX,clientY:t.clientY})},this.cancelEvent=e=>{clearTimeout(this.timeOutTapHold),clearTimeout(this.timeOutTap),this.tapCount=0,this.swipeFn(e),xu.remove(this.element,wu.touchCancelEvent,this.cancelEvent)},this.endEvent=e=>{this.swipeFn(e),this.isTouchMoved||"function"==typeof this.tap&&(this.trigger("tap",{originalEvent:e,tapCount:++this.tapCount}),this.timeOutTap=setTimeout(()=>{this.tapCount=0},this.tapThreshold)),this.modeclear()},this.swipeFn=e=>{clearTimeout(this.timeOutTapHold),clearTimeout(this.timeOutTap);const t=this.updateChangeTouches(e);let i=t.clientX-this.startPoint.clientX,n=t.clientY-this.startPoint.clientY;i=Math.floor(i<0?-1*i:i),n=Math.floor(n<0?-1*n:i),this.isTouchMoved=i>1||n>1,this.endPoint=t,this.calcPoints(e);const s={originalEvent:e,startEvents:this.startEventData,startX:this.startPoint.clientX,startY:this.startPoint.clientY,distanceX:this.distanceX,distanceY:this.distanceY,swipeDirection:this.movedDirection,velocity:this.getVelocity(t)};if(this.isTouchMoved){let e;const t=this.swipeSettings.swipeThresholdDistance;e=kp(e,this.defaultArgs,s);let i=!1;const n=this.element,r=this.isScrollable(n),o=kg.test(this.movedDirection);(t<this.distanceX&&!o||t<this.distanceY&&o)&&(i=!r||this.checkSwipe(n,o)),i&&this.trigger("swipe",e)}this.modeclear()},this.modeclear=()=>{this.modeClear=setTimeout(()=>{this.touchAction=!0},"function"!=typeof this.tap?0:20),this.lastTapTime=(new Date).getTime(),xu.remove(this.element,wu.touchMoveEvent,this.moveEvent),xu.remove(this.element,wu.touchEndEvent,this.endEvent),xu.remove(this.element,wu.touchCancelEvent,this.cancelEvent)},this.bind()}onPropertyChanged(e,t){}bind(){this.wireEvents(),wu.isIE&&this.element.classList.add("e-block-touch")}destroy(){this.unwireEvents(),super.destroy()}wireEvents(){xu.add(this.element,wu.touchStartEvent,this.startEvent,this)}unwireEvents(){xu.remove(this.element,wu.touchStartEvent,this.startEvent)}getModuleName(){return"touch"}isScrollable(e){const t=getComputedStyle(e);return!!/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY)}tapHoldEvent(e){let t;this.tapCount=0,this.touchAction=!0,xu.remove(this.element,wu.touchMoveEvent,this.moveEvent),xu.remove(this.element,wu.touchEndEvent,this.endEvent),t={originalEvent:e},this.trigger("tapHold",t),xu.remove(this.element,wu.touchCancelEvent,this.cancelEvent)}calcPoints(e){const t=this.updateChangeTouches(e);this.defaultArgs={originalEvent:e},this.distanceX=Math.abs(Math.abs(t.clientX)-Math.abs(this.startPoint.clientX)),this.distanceY=Math.abs(Math.abs(t.clientY)-Math.abs(this.startPoint.clientY)),this.movedDirection=this.distanceX>this.distanceY?t.clientX>this.startPoint.clientX?"Right":"Left":t.clientY<this.startPoint.clientY?"Up":"Down"}calcScrollPoints(e){const t=this.updateChangeTouches(e);this.defaultArgs={originalEvent:e},this.distanceX=Math.abs(Math.abs(t.clientX)-Math.abs(this.lastMovedPoint.clientX)),this.distanceY=Math.abs(Math.abs(t.clientY)-Math.abs(this.lastMovedPoint.clientY)),(this.distanceX>this.distanceY||!0===this.hScrollLocked)&&!1===this.vScrollLocked?(this.scrollDirection=t.clientX>this.lastMovedPoint.clientX?"Right":"Left",this.hScrollLocked=!0):(this.scrollDirection=t.clientY<this.lastMovedPoint.clientY?"Up":"Down",this.vScrollLocked=!0)}getVelocity(e){const t=e.clientX,i=e.clientY,n=Date.now(),s=t-this.startPoint.clientX,r=i-this.startPoint.clientX,o=n-this.tStampStart;return Math.sqrt(s*s+r*r)/o}checkSwipe(e,t){const i=["scroll","offset"],n=t?["Height","Top"]:["Width","Left"];return e[i[0]+n[0]]<=e[i[1]+n[0]]||0===e[i[0]+n[1]]||e[i[1]+n[0]]+e[i[0]+n[1]]>=e[i[0]+n[0]]}updateChangeTouches(e){return e.changedTouches&&0!==e.changedTouches.length?e.changedTouches[0]:e}};return zg([og()],e.prototype,"tap",void 0),zg([og()],e.prototype,"tapHold",void 0),zg([og()],e.prototype,"swipe",void 0),zg([og()],e.prototype,"scroll",void 0),zg([ig(350)],e.prototype,"tapThreshold",void 0),zg([ig(750)],e.prototype,"tapHoldThreshold",void 0),zg([ng({},Lg)],e.prototype,"swipeSettings",void 0),e=zg([ag],e),e})();const Hg=new RegExp("\\n|\\r|\\s\\s+","g"),_g=new RegExp(/'|"/g),Ng=new RegExp("if ?\\("),Bg=new RegExp("else if ?\\("),Wg=new RegExp("else"),Ug=new RegExp("for ?\\("),Fg=new RegExp("(/if|/for)"),Vg=new RegExp("\\((.*)\\)",""),Yg=new RegExp("^[0-9]+$","g"),Xg=new RegExp("[\\w\"'.\\s+]+","g"),Gg=new RegExp('"(.*?)"',"g"),qg=new RegExp("[\\w\"'@#$.\\s-+]+","g");let Zg=new RegExp("\\${([^}]*)}","g");const $g=/^\..*/gm,Qg=/\\/gi,Jg=/\\\\/gi,Kg=new RegExp("[\\w\"'@#$.\\s+]+","g"),em=/\window\./gm;function tm(e,t,i,n,s){return!t||Yg.test(e)||-1!==n.indexOf(e.split(".")[0])||s?e:i+"."+e}function im(e,t,i,n){return t&&!Yg.test(e)&&-1===n.indexOf(e.split(".")[0])?i+'["'+e:e}function nm(e){return e.match(Jg)?e:e.replace(Qg,"\\\\")}function sm(e,t,i,n){if(e=e.trim(),/\window\./gm.test(e))return e;{const s=/'|"/gm;return/@|\$|#/gm.test(e)&&(e=im(e,-1===i.indexOf(e),t,i)+'"]'),$g.test(e)?function(e,t,i,n){return!t||Yg.test(e)||-1!==n.indexOf(e.split(".")[0])||/^\..*/gm.test(e)?e:i+"."+e}(e,!s.test(e)&&-1===i.indexOf(e),t,i):tm(e,!s.test(e)&&-1===i.indexOf(e),t,i,n)}}const rm=/^[\n\r.]+<tr|^<tr/,om=/^[\n\r.]+<svg|^<path|^<g/;function am(e,t,i){const n=hm.compile(e,t,i);return(e,t,i,s,r,o,a)=>{const l=n(e,t,i,a);return"string"==typeof l?om.test(l)?Cu("svg",{innerHTML:l}).childNodes:Cu(rm.test(l)?"table":"div",{innerHTML:l}).childNodes:l}}function lm(e,t,i){const n=document.getElementById(e);if(n){const e=n.getElementsByClassName("blazor-inner-template");for(let t=0;t<e.length;t++){let n=" ";n=jp(i)?e[t].getAttribute("data-templateId"):e[i].getAttribute("data-templateId");const s=document.getElementById(n);if(s){const n=s.childNodes.length;for(let r=0;r<n;r++)jp(i)?e[t].appendChild(s.childNodes[0]):(e[i].appendChild(s.childNodes[0]),t=e.length)}}}}const hm={compile:(new class{compile(e,t={},i){return function(e,t,i){const n="data",s=function(e,t,i,n){let s=0;const r=[],o=e.match(/class="([^"]+|)\s{2}/g);let a="";return o&&o.forEach(t=>{a=t.replace(/\s\s+/g," "),e=e.replace(t,a)}),e.replace(Hg,"").replace(Gg,"'$1'").replace(Zg,(e,o,a,l)=>{const h=o.match(Vg);if(h){const e=h[1];if(Bg.test(o))o='";} '+o.replace(h[1],e.replace(Xg,e=>tm(e=e.trim(),!_g.test(e)&&-1===r.indexOf(e),t,r,n)))+'{ \n str = str + "';else if(Ng.test(o))o='"; '+o.replace(h[1],e.replace(qg,e=>sm(e,t,r,n)))+'{ \n str = str + "';else if(Ug.test(o)){const e=h[1].split(" of ");o='"; '+o.replace(h[1],i=>(r.push(e[0]),r.push(e[0]+"Index"),s+=1,"var i"+s+"=0; i"+s+" < "+tm(e[1],!0,t,r,n)+".length; i"+s+"++"))+"{ \n "+e[0]+"= "+tm(e[1],!0,t,r,n)+"[i"+s+"]; \n var "+e[0]+"Index=i"+s+'; \n str = str + "'}else{const s=o.split("(");let a=i&&i.hasOwnProperty(s[0])?"this.":"global";a=/\./.test(s[0])?"":a;const l=h[1].split(",");0===h[1].length||/data/.test(l[0])||/window./.test(l[0])||(h[1]="global"===a?"data."+h[1]:h[1]);const c=/@|\$|#/gm,d=/\]\./gm;em.test(o)&&d.test(o)||c.test(o)?/@|\$|#|\]\./gm.test(o)&&(o='"+ '+("global"===a?"":a)+o.replace(h[1],e.replace(Kg,e=>sm(e,t,r,n)))+'+ "'):o='" + '+("global"===a?"":a)+o.replace(e,tm(h[1].replace(/,( |)data.|,/gi,",data.").replace(/,( |)data.window/gi,",window"),"global"!==a,t,r,n))+'+"'}}else Wg.test(o)?o='"; '+o.replace(Wg,'} else { \n str = str + "'):o.match(Fg)?o=o.replace(Fg,'"; \n } \n str = str + "'):/@|#|\$/gm.test(o)?(o.match(Qg)&&(o=nm(o)),o='"+'+im(o,-1===r.indexOf(o),t,r)+'"]+"'):o=o.match(Qg)?'"+'+im(o=nm(o),-1===r.indexOf(o),t,r)+'"]+"':'"+'+tm(o.replace(/,/gi,"+data."),-1===r.indexOf(o),t,r,n)+'+"';return o})}(e,n,t,void 0);return new Function(n,'var str="'+s+"\";var valueRegEx = (/value=\\'([A-Za-z0-9 _]*)((.)([\\w)(!-;?-\u25a0\\s]+)['])/g);\n    var hrefRegex = (/(?:href)([\\s='\"./]+)([\\w-./?=&\\\\#\"]+)((.)([\\w)(!-;/?-\u25a0\\s]+)['])/g);\n    if(str.match(valueRegEx)){\n        var check = str.match(valueRegEx);\n        var str1 = str;\n        for (var i=0; i < check.length; i++) {\n            var check1 = str.match(valueRegEx)[i].split('value=')[1];\n            var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '\"') : check1;\n            change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'\"') : change;\n            str1 = str1.replace(check1, change);\n        }\n        str = str.replace(str, str1);\n    }\n    else if(str.match(hrefRegex)) {\n        var check = str.match(hrefRegex);\n        var str1 = str;\n        for (var i=0; i < check.length; i++) {\n            var check1 = str.match(hrefRegex)[i].split('href=')[1];\n            var change = check1.match(/^'/) !== null ? check1.replace(/^'/, '\"') : check1;\n            change =change.match(/.$/)[0] === '\\'' ? change.replace(/.$/,'\"') : change;\n            str1 = str1.replace(check1, change);\n        }\n        str = str.replace(str, str1);\n    }\n     return str;").bind(t)}(e,t)}}).compile},cm=["script","style","iframe[src]",'link[href*="javascript:"]','object[type="text/x-scriptlet"]','object[data^="data:text/html;base64"]','img[src^="data:text/html;base64"]','[src^="javascript:"]','[dynsrc^="javascript:"]','[lowsrc^="javascript:"]','[type^="application/x-shockwave-flash"]'],dm=[{attribute:"href",selector:'[href*="javascript:"]'},{attribute:"background",selector:'[background^="javascript:"]'},{attribute:"style",selector:'[style*="javascript:"]'},{attribute:"style",selector:'[style*="expression("]'},{attribute:"href",selector:'a[href^="data:text/html;base64"]'}],pm=["onchange","onclick","onmouseover","onmouseout","onkeydown","onload","onerror","onblur","onfocus","onbeforeload","onbeforeunload","onkeyup","onsubmit","onafterprint","onbeforeonload","onbeforeprint","onblur","oncanplay","oncanplaythrough","onchange","onclick","oncontextmenu","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onerror","onfocus","onformchange","onforminput","onhaschange","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onoffline","onoine","ononline","onpagehide","onpageshow","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreadystatechange","onredo","onresize","onscroll","onseeked","onseeking","onselect","onstalled","onstorage","onsubmit","onsuspend","ontimeupdate","onundo","onunload","onvolumechange","onwaiting","onmouseenter","onmouseleave","onmousewheel","onstart","onpropertychange"];class um{static beforeSanitize(){return{selectors:{tags:cm,attributes:dm}}}static sanitize(e){const t=this.beforeSanitize();return this.serializeValue(t,e)}static serializeValue(e,t){this.removeAttrs=e.selectors.attributes,this.removeTags=e.selectors.tags,this.wrapElement=document.createElement("div"),this.wrapElement.innerHTML=t,this.removeXssTags(),this.removeJsEvents(),this.removeXssAttrs();const i=this.wrapElement.innerHTML;return this.removeElement(),i}static removeElement(){const e=this.wrapElement.children;for(let t=0;t<e.length;t++){const i=e[t].attributes;for(let e=0;e<i.length;e++)this.wrapElement.children[t].removeAttribute(i[e].localName)}}static removeXssTags(){const e=this.wrapElement.querySelectorAll(this.removeTags.join(","));e.length>0&&e.forEach(e=>{Mu(e)})}static removeJsEvents(){const e=this.wrapElement.querySelectorAll("["+pm.join("],[")+"]");e.length>0&&e.forEach(e=>{pm.forEach(t=>{e.hasAttribute(t)&&e.removeAttribute(t)})})}static removeXssAttrs(){this.removeAttrs.forEach((e,t)=>{const i=this.wrapElement.querySelectorAll(e.selector);i.length>0&&i.forEach(t=>{t.removeAttribute(e.attribute)})})}}function gm(e){let t;const i=e.childNodes;for(let n=0;n<i.length;n++)if(t=i[n],3===t.nodeType)return t;return null}var mm=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};new nu;const fm="e-rtl",ym="e-primary",bm="e-icon-btn";let vm,wm,xm,Sm,Cm,Pm,Om=(()=>{let e=class extends Cg{constructor(e,t){super(e,t)}preRender(){}render(){this.initialize(),this.removeRippleEffect=function(e,t,i){const n=function(e){return{selector:e&&e.selector?e.selector:null,ignore:e&&e.ignore?e.ignore:null,rippleFlag:e&&e.rippleFlag,isCenterRipple:e&&e.isCenterRipple,duration:e&&e.duration?e.duration:350}}({selector:".e-btn"});return!1===n.rippleFlag||void 0===n.rippleFlag?Function:(e.setAttribute("data-ripple","true"),xu.add(e,"mousedown",ug,{parent:e,rippleOptions:n}),xu.add(e,"mouseup",gg,{parent:e,rippleOptions:n,done:void 0}),xu.add(e,"mouseleave",mg,{parent:e,rippleOptions:n}),wu.isPointer&&xu.add(e,"transitionend",mg,{parent:e,rippleOptions:n}),()=>{e.removeAttribute("data-ripple"),xu.remove(e,"mousedown",ug),xu.remove(e,"mouseup",gg),xu.remove(e,"mouseleave",mg),xu.remove(e,"transitionend",mg)})}(this.element),this.renderComplete()}initialize(){if(this.cssClass&&Pu([this.element],this.cssClass.split(" ")),this.isPrimary&&this.element.classList.add(ym),this.content){const e=this.enableHtmlSanitizer?um.sanitize(this.content):this.content;this.element.innerHTML=e}this.setIconCss(),this.enableRtl&&this.element.classList.add(fm),this.disabled?this.controlStatus(this.disabled):this.wireEvents()}controlStatus(e){this.element.disabled=e}setIconCss(){if(this.iconCss){const e=this.createElement("span",{className:"e-btn-icon "+this.iconCss});this.element.textContent.trim()?(e.classList.add("e-icon-"+this.iconPosition.toLowerCase()),"Top"!==this.iconPosition&&"Bottom"!==this.iconPosition||this.element.classList.add("e-"+this.iconPosition.toLowerCase()+"-icon-btn")):this.element.classList.add(bm);const t=this.element.childNodes[0];!t||"Left"!==this.iconPosition&&"Top"!==this.iconPosition?this.element.appendChild(e):this.element.insertBefore(e,t)}}wireEvents(){this.isToggle&&xu.add(this.element,"click",this.btnClickHandler,this)}unWireEvents(){this.isToggle&&xu.remove(this.element,"click",this.btnClickHandler)}btnClickHandler(){this.element.classList.contains("e-active")?this.element.classList.remove("e-active"):this.element.classList.add("e-active")}destroy(){let e=[ym,fm,bm,"e-success","e-info","e-danger","e-warning","e-flat","e-outline","e-small","e-bigger","e-active","e-round","e-top-icon-btn","e-bottom-icon-btn"];this.cssClass&&(e=e.concat(this.cssClass.split(" "))),super.destroy(),Ou([this.element],e),this.element.getAttribute("class")||this.element.removeAttribute("class"),this.disabled&&this.element.removeAttribute("disabled"),this.content&&(this.element.innerHTML=this.element.innerHTML.replace(this.content,""));const t=this.element.querySelector("span.e-btn-icon");t&&Mu(t),this.unWireEvents()}getModuleName(){return"btn"}getPersistData(){return this.addOnPersist([])}static Inject(){}onPropertyChanged(e,t){let i=this.element.querySelector("span.e-btn-icon");for(const n of Object.keys(e))switch(n){case"isPrimary":e.isPrimary?this.element.classList.add(ym):this.element.classList.remove(ym);break;case"disabled":this.controlStatus(e.disabled);break;case"iconCss":i?e.iconCss?(i.className="e-btn-icon "+e.iconCss,this.element.textContent.trim()&&i.classList.add("Left"===this.iconPosition?"e-icon-left":"e-icon-right")):Mu(i):this.setIconCss();break;case"iconPosition":Ou([this.element],["e-top-icon-btn","e-bottom-icon-btn"]),i=this.element.querySelector("span.e-btn-icon"),i&&Mu(i),this.setIconCss();break;case"cssClass":t.cssClass&&Ou([this.element],t.cssClass.split(" ")),e.cssClass&&Pu([this.element],e.cssClass.split(" "));break;case"enableRtl":e.enableRtl?this.element.classList.add(fm):this.element.classList.remove(fm);break;case"content":gm(this.element)||this.element.classList.remove(bm),this.enableHtmlSanitizer&&(e.content=um.sanitize(e.content)),this.element.innerHTML=e.content,this.setIconCss();break;case"isToggle":e.isToggle?xu.add(this.element,"click",this.btnClickHandler,this):(xu.remove(this.element,"click",this.btnClickHandler),Ou([this.element],["e-active"]))}}click(){this.element.click()}focusIn(){this.element.focus()}};return mm([ig("Left")],e.prototype,"iconPosition",void 0),mm([ig("")],e.prototype,"iconCss",void 0),mm([ig(!1)],e.prototype,"disabled",void 0),mm([ig(!1)],e.prototype,"isPrimary",void 0),mm([ig("")],e.prototype,"cssClass",void 0),mm([ig("")],e.prototype,"content",void 0),mm([ig(!1)],e.prototype,"isToggle",void 0),mm([ig()],e.prototype,"locale",void 0),mm([ig(!1)],e.prototype,"enableHtmlSanitizer",void 0),mm([og()],e.prototype,"created",void 0),e=mm([ag],e),e})(),Tm=!1;function Em(e,t,i,n,s){return wm=void 0,wm=s,Tm=!!n,e?(t||(t="left"),i||(i="top"),Sm=e.ownerDocument,xm=e,function(e,t,i){switch(vm=xm.getBoundingClientRect(),t+e){case"topcenter":Am(Hm(),i),Im(Lm(),i);break;case"topright":Am(jm(),i),Im(Lm(),i);break;case"centercenter":Am(Hm(),i),Im(zm(),i);break;case"centerright":Am(jm(),i),Im(zm(),i);break;case"centerleft":Am(km(),i),Im(zm(),i);break;case"bottomcenter":Am(Hm(),i),Im(Rm(),i);break;case"bottomright":Am(jm(),i),Im(Rm(),i);break;case"bottomleft":Am(km(),i),Im(Rm(),i);break;default:case"topleft":Am(km(),i),Im(Lm(),i)}return i}(t.toLowerCase(),i.toLowerCase(),{left:0,top:0})):{left:0,top:0}}function Am(e,t){t.left=e}function Im(e,t){t.top=e}function Dm(){return Sm.documentElement.scrollTop||Sm.body.scrollTop}function Mm(){return Sm.documentElement.scrollLeft||Sm.body.scrollLeft}function Rm(){return Tm?vm.bottom:vm.bottom+Dm()}function zm(){return Lm()+vm.height/2}function Lm(){return Tm?vm.top:vm.top+Dm()}function km(){return vm.left+Mm()}function jm(){const e=xm&&xm.classList.contains("e-date-range-wrapper")?wm?wm.width:0:wm&&vm.width>=wm.width?wm.width:0;return vm.right+Mm()-e}function Hm(){return km()+vm.width/2}function _m(e,t=null,i={X:!1,Y:!1},n){if(!i.Y&&!i.X)return{left:0,top:0};const s=e.getBoundingClientRect();if(Pm=t,Cm=e.ownerDocument,n||(n=Em(e,"left","top")),i.X){const e=Pm?Xm():sf(),t=Qm(),i=Jm(),r=t-n.left,o=n.left+s.width-i;s.width>e?n.left=r>0&&o<=0?i-s.width:o>0&&r<=0?t:r>o?i-s.width:t:r>0?n.left+=r:o>0&&(n.left-=o)}if(i.Y){const e=Pm?Gm():nf(),t=$m(),i=Km(),r=t-n.top,o=n.top+s.height-i;s.height>e?n.top=r>0&&o<=0?i-s.height:o>0&&r<=0?t:r>o?i-s.height:t:r>0?n.top+=r:o>0&&(n.top-=o)}return n}function Nm(e,t=null,i,n){const s=Em(e,"left","top");i&&(s.left=i),n&&(s.top=n);const r=[];Pm=t,Cm=e.ownerDocument;const o=e.getBoundingClientRect(),a=s.left,l=s.left+o.width,h=Ym(s.top,s.top+o.height),c=Um(a,l);return h.topSide&&r.push("top"),c.rightSide&&r.push("right"),c.leftSide&&r.push("left"),h.bottomSide&&r.push("bottom"),r}function Bm(e,t,i,n,s,r,o=null,a={X:!0,Y:!0},l){if(!(t&&e&&s&&r&&(a.X||a.Y)))return;const h={TL:null,TR:null,BL:null,BR:null},c={TL:null,TR:null,BL:null,BR:null};let d;if("none"===window.getComputedStyle(e).display){const t=e.style.visibility;e.style.visibility="hidden",e.style.display="block",d=e.getBoundingClientRect(),e.style.removeProperty("display"),e.style.visibility=t}else d=e.getBoundingClientRect();const p={posX:s,posY:r,offsetX:i,offsetY:n,position:{left:0,top:0}};Pm=o,Cm=t.ownerDocument,function(e,t,i,n,s){i.position=Em(e,i.posX,i.posY,n,s),t.TL=Em(e,"left","top",n,s),t.TR=Em(e,"right","top",n,s),t.BR=Em(e,"left","bottom",n,s),t.BL=Em(e,"right","bottom",n,s)}(t,h,p,l,d),Wm(c,p,d),a.X&&Fm(t,c,h,p,d,!0),a.Y&&h.TL.top>-1&&Vm(t,c,h,p,d,!0),function(e,t,i){let n=0,s=0;if(null!=e.offsetParent&&("absolute"===getComputedStyle(e.offsetParent).position||"relative"===getComputedStyle(e.offsetParent).position)){const t=Em(e.offsetParent,"left","top",!1,i);n=t.left,s=t.top}e.style.top=t.position.top+t.offsetY-s+"px",e.style.left=t.position.left+t.offsetX-n+"px"}(e,p,d)}function Wm(e,t,i){e.TL={top:t.position.top+t.offsetY,left:t.position.left+t.offsetX},e.TR={top:e.TL.top,left:e.TL.left+i.width},e.BL={top:e.TL.top+i.height,left:e.TL.left},e.BR={top:e.TL.top+i.height,left:e.TL.left+i.width}}function Um(e,t){let i=!1,n=!1;return e-tf()<Qm()&&(i=!0),t>Jm()&&(n=!0),{leftSide:i,rightSide:n}}function Fm(e,t,i,n,s,r){const o=Um(t.TL.left,t.TR.left);i.TL.left-tf()<=Qm()&&(o.leftSide=!1),i.TR.left>Jm()&&(o.rightSide=!1),(o.leftSide&&!o.rightSide||!o.leftSide&&o.rightSide)&&(n.posX="right"===n.posX?"left":"right",n.offsetX=n.offsetX+s.width,n.offsetX=-1*n.offsetX,n.position=Em(e,n.posX,n.posY,!1),Wm(t,n,s),r&&Fm(e,t,i,n,s,!1))}function Vm(e,t,i,n,s,r){const o=Ym(t.TL.top,t.BL.top);i.TL.top-ef()<=$m()&&(o.topSide=!1),i.BL.top>=Km()&&e.getBoundingClientRect().bottom<window.innerHeight&&(o.bottomSide=!1),(o.topSide&&!o.bottomSide||!o.topSide&&o.bottomSide)&&(n.posY="top"===n.posY?"bottom":"top",n.offsetY=n.offsetY+s.height,n.offsetY=-1*n.offsetY,n.position=Em(e,n.posX,n.posY,!1,s),Wm(t,n,s),r&&Vm(e,t,i,n,s,!1))}function Ym(e,t){let i=!1,n=!1;return e-ef()<$m()&&(i=!0),t>Km()&&(n=!0),{topSide:i,bottomSide:n}}function Xm(){return Pm.getBoundingClientRect().width}function Gm(){return Pm.getBoundingClientRect().height}function qm(){return Pm.getBoundingClientRect().left}function Zm(){return Pm.getBoundingClientRect().top}function $m(){return Pm?Zm():0}function Qm(){return Pm?qm():0}function Jm(){return Pm?tf()+qm()+Xm():tf()+sf()}function Km(){return Pm?ef()+Zm()+Gm():ef()+nf()}function ef(){return Cm.documentElement.scrollTop||Cm.body.scrollTop}function tf(){return Cm.documentElement.scrollLeft||Cm.body.scrollLeft}function nf(){return window.innerHeight}function sf(){const e=window.innerWidth;let t=document.documentElement.getBoundingClientRect();return e-(e-(jp(document.documentElement)?0:t.width))}var rf=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let of=(()=>{class e extends bg{}return rf([ig("left")],e.prototype,"X",void 0),rf([ig("top")],e.prototype,"Y",void 0),e})();const af="e-popup",lf="e-rtl",hf="e-popup-open",cf="e-popup-close";let df=(()=>{let e=class extends Cg{constructor(e,t){super(t,e)}onPropertyChanged(e,t){for(const i of Object.keys(e))switch(i){case"width":_u(this.element,{width:Wp(e.width)});break;case"height":_u(this.element,{height:Wp(e.height)});break;case"zIndex":_u(this.element,{zIndex:e.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":let i=e.offsetX-t.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+i).toString()+"px";break;case"offsetY":let n=e.offsetY-t.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+n).toString()+"px";break;case"content":this.setContent();break;case"actionOnScroll":"none"!==e.actionOnScroll?this.wireScrollEvents():this.unwireScrollEvents()}}getModuleName(){return"popup"}resolveCollision(){this.checkCollision()}getPersistData(){return this.addOnPersist([])}destroy(){this.element.classList.remove(af,lf,hf,cf),this.unwireEvents(),super.destroy()}render(){this.element.classList.add(af);const e={};1e3!==this.zIndex&&(e.zIndex=this.zIndex),"auto"!==this.width&&(e.width=Wp(this.width)),"auto"!==this.height&&(e.height=Wp(this.height)),_u(this.element,e),this.fixedParent=!1,this.setEnableRtl(),this.setContent()}wireEvents(){wu.isDevice&&xu.add(window,"orientationchange",this.orientationOnChange,this),"none"!==this.actionOnScroll&&this.wireScrollEvents()}wireScrollEvents(){if(this.getRelateToElement())for(const e of this.getScrollableParent(this.getRelateToElement()))xu.add(e,"scroll",this.scrollRefresh,this)}unwireEvents(){wu.isDevice&&xu.remove(window,"orientationchange",this.orientationOnChange),"none"!==this.actionOnScroll&&this.unwireScrollEvents()}unwireScrollEvents(){if(this.getRelateToElement())for(const e of this.getScrollableParent(this.getRelateToElement()))xu.remove(e,"scroll",this.scrollRefresh)}getRelateToElement(){const e=""===this.relateTo||jp(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:e},!0),"string"==typeof this.relateTo?document.querySelector(this.relateTo):this.relateTo}scrollRefresh(e){if("reposition"===this.actionOnScroll?jp(this.element)||this.element.offsetParent===e.target||this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&null==e.target.parentElement||this.refreshPosition():"hide"===this.actionOnScroll&&this.hide(),"none"!==this.actionOnScroll&&this.getRelateToElement()){const t=this.isElementOnViewport(this.getRelateToElement(),e.target);t||this.targetInvisibleStatus?t&&(this.targetInvisibleStatus=!1):(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0)}}isElementOnViewport(e,t){const i=this.getScrollableParent(e);for(let n=0;n<i.length;n++)if(!this.isElementVisible(e,i[n]))return!1;return!0}isElementVisible(e,t){const i=this.checkGetBoundingClientRect(e);if(!i.height||!i.width)return!1;if(jp(this.checkGetBoundingClientRect(t))){const t=window,n={top:t.scrollY,left:t.scrollX,right:t.scrollX+t.outerWidth,bottom:t.scrollY+t.outerHeight},s=Em(e),r={top:s.top,left:s.left,right:s.left+i.width,bottom:s.top+i.height},o={top:n.bottom-r.top,left:n.right-r.left,bottom:r.bottom-n.top,right:r.right-n.left};return o.top>0&&o.left>0&&o.right>0&&o.bottom>0}{const e=t.getBoundingClientRect();return!(i.bottom<e.top||i.bottom>e.bottom||i.right>e.right||i.left<e.left)}}preRender(){}setEnableRtl(){this.reposition(),this.enableRtl?this.element.classList.add(lf):this.element.classList.remove(lf)}setContent(){jp(this.content)||(this.element.innerHTML="","string"==typeof this.content?this.element.textContent=this.content:this.element.appendChild(this.content))}orientationOnChange(){setTimeout(()=>{this.refreshPosition()},200)}refreshPosition(e,t){jp(e)||this.checkFixedParent(e),this.reposition(),t||this.checkCollision()}reposition(){let e,t;const i=this.getRelateToElement();if("number"==typeof this.position.X&&"number"==typeof this.position.Y)e={left:this.position.X,top:this.position.Y};else if("string"==typeof this.position.X&&"number"==typeof this.position.Y||"number"==typeof this.position.X&&"string"==typeof this.position.Y){let n;const s=this.element.style.display;this.element.style.display="block",this.element.classList.contains("e-dlg-modal")&&(n=this.element.parentElement.style.display,this.element.parentElement.style.display="block"),t=this.getAnchorPosition(i,this.element,this.position,this.offsetX,this.offsetY),e="string"==typeof this.position.X?{left:t.left,top:this.position.Y}:{left:this.position.X,top:t.top},this.element.style.display=s,this.element.classList.contains("e-dlg-modal")&&(this.element.parentElement.style.display=n)}else if(i){const t=this.element.style.display;this.element.style.display="block",e=this.getAnchorPosition(i,this.element,this.position,this.offsetX,this.offsetY),this.element.style.display=t}else e={left:0,top:0};jp(e)||(this.element.style.left=e.left+"px",this.element.style.top=e.top+"px")}checkGetBoundingClientRect(e){let t;try{return t=e.getBoundingClientRect(),t}catch(i){return null}}getAnchorPosition(e,t,i,n,s){const r=this.checkGetBoundingClientRect(t),o=this.checkGetBoundingClientRect(e);if(jp(r)||jp(o))return null;const a=e;let l={left:0,top:0};switch(t.offsetParent&&"BODY"===t.offsetParent.tagName&&"BODY"===e.tagName?l=Em(e):(t.classList.contains("e-dlg-modal")&&"BODY"!==a.tagName&&(t=t.parentElement),l=function(e,t){let i=!1;const n={left:0,top:0},s=e;if(!e||!t)return n;for(jp(t.offsetParent)&&"fixed"===t.style.position&&(i=!0);(t.offsetParent||i)&&e&&t.offsetParent!==e;)n.left+=e.offsetLeft,n.top+=e.offsetTop,e=e.offsetParent;for(e=s;(t.offsetParent||i)&&e&&t.offsetParent!==e;)n.left-=e.scrollLeft,n.top-=e.scrollTop,e=e.parentElement;return n}(a,t)),i.X){default:case"left":break;case"center":t.classList.contains("e-dlg-modal")&&"BODY"===a.tagName&&"container"===this.targetType?l.left+=window.innerWidth/2-r.width/2:l.left+="container"===this.targetType?o.width/2-r.width/2:o.width/2;break;case"right":t.classList.contains("e-dlg-modal")&&"BODY"===a.tagName&&"container"===this.targetType?l.left+=window.innerWidth-r.width:l.left+="container"===this.targetType?o.width-r.width:o.width}switch(i.Y){default:case"top":break;case"center":t.classList.contains("e-dlg-modal")&&"BODY"===a.tagName&&"container"===this.targetType?l.top+=window.innerHeight/2-r.height/2:l.top+="container"===this.targetType?o.height/2-r.height/2:o.height/2;break;case"bottom":t.classList.contains("e-dlg-modal")&&"BODY"===a.tagName&&"container"===this.targetType?l.top+=window.innerHeight-r.height:l.top+="container"===this.targetType?o.height-r.height:o.height}return l.left+=n,l.top+=s,l}callFlip(e){const t=this.getRelateToElement();Bm(this.element,t,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,e,this.fixedParent)}callFit(e){if(0!==Nm(this.element,this.viewPortElement).length)if(jp(this.viewPortElement)){const t=_m(this.element,this.viewPortElement,e);e.X&&(this.element.style.left=t.left+"px"),e.Y&&(this.element.style.top=t.top+"px")}else{const t=this.checkGetBoundingClientRect(this.element),i=this.checkGetBoundingClientRect(this.viewPortElement);if(jp(t)||jp(i))return null;e&&!0===e.Y&&(i.top>t.top?this.element.style.top="0px":i.bottom<t.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(t.bottom-i.bottom)+"px")),e&&!0===e.X&&(i.right<t.right?this.element.style.left=parseInt(this.element.style.left,10)-(t.right-i.right)+"px":i.left>t.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(i.left-t.left)+"px"))}}checkCollision(){const e=this.collision.X,t=this.collision.Y;"none"===e&&"none"===t||("flip"===e&&"flip"===t?this.callFlip({X:!0,Y:!0}):"fit"===e&&"fit"===t?this.callFit({X:!0,Y:!0}):("flip"===e?this.callFlip({X:!0,Y:!1}):"flip"===t&&this.callFlip({Y:!0,X:!1}),"fit"===e?this.callFit({X:!0,Y:!1}):"fit"===t&&this.callFit({X:!1,Y:!0})))}show(e,t){if(this.wireEvents(),1e3===this.zIndex||!jp(t)){const e=jp(t)?this.element:t;this.zIndex=pf(e),_u(this.element,{zIndex:this.zIndex})}e=jp(e)||"object"!=typeof e?this.showAnimation:e,"none"===this.collision.X&&"none"===this.collision.Y||(Ou([this.element],cf),Pu([this.element],hf),this.checkCollision(),Ou([this.element],hf),Pu([this.element],cf)),jp(e)?(Ou([this.element],cf),Pu([this.element],hf),this.trigger("open")):(e.begin=()=>{this.isDestroyed||(Ou([this.element],cf),Pu([this.element],hf))},e.end=()=>{this.isDestroyed||this.trigger("open")},new pg(e).animate(this.element))}hide(e){e=jp(e)||"object"!=typeof e?this.hideAnimation:e,jp(e)?(Ou([this.element],hf),Pu([this.element],cf),this.trigger("close")):(e.end=()=>{this.isDestroyed||(Ou([this.element],hf),Pu([this.element],cf),this.trigger("close"))},new pg(e).animate(this.element)),this.unwireEvents()}getScrollableParent(e){return this.checkFixedParent(e),function(e,t){const i=getComputedStyle(e),n=[],s=/(auto|scroll)/;let r=e.parentElement;for(;r&&"HTML"!==r.tagName;){const e=getComputedStyle(r);"absolute"===i.position&&"static"===e.position||!s.test(e.overflow+e.overflowY+e.overflowX)||n.push(r),r=r.parentElement}return t||n.push(document),n}(e,this.fixedParent)}checkFixedParent(e){let t=e.parentElement;for(;t&&"HTML"!==t.tagName;){const e=getComputedStyle(t);"fixed"===e.position&&!jp(this.element)&&this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&(this.element.style.top=window.scrollY>parseInt(this.element.style.top)?Wp(window.scrollY-parseInt(this.element.style.top)):Wp(parseInt(this.element.style.top)-window.scrollY),this.element.style.position="fixed",this.fixedParent=!0),t=t.parentElement,!jp(this.element)&&jp(this.element.offsetParent)&&"fixed"===e.position&&"fixed"===this.element.style.position&&(this.fixedParent=!0)}}};return rf([ig("auto")],e.prototype,"height",void 0),rf([ig("auto")],e.prototype,"width",void 0),rf([ig(null)],e.prototype,"content",void 0),rf([ig("container")],e.prototype,"targetType",void 0),rf([ig(null)],e.prototype,"viewPortElement",void 0),rf([ig({X:"none",Y:"none"})],e.prototype,"collision",void 0),rf([ig("")],e.prototype,"relateTo",void 0),rf([ng({},of)],e.prototype,"position",void 0),rf([ig(0)],e.prototype,"offsetX",void 0),rf([ig(0)],e.prototype,"offsetY",void 0),rf([ig(1e3)],e.prototype,"zIndex",void 0),rf([ig(!1)],e.prototype,"enableRtl",void 0),rf([ig("reposition")],e.prototype,"actionOnScroll",void 0),rf([ig(null)],e.prototype,"showAnimation",void 0),rf([ig(null)],e.prototype,"hideAnimation",void 0),rf([og()],e.prototype,"open",void 0),rf([og()],e.prototype,"close",void 0),rf([og()],e.prototype,"targetExitViewport",void 0),e=rf([ag],e),e})();function pf(e){let t=e.parentElement;const i=[];for(;t&&"BODY"!==t.tagName;){const e=document.defaultView.getComputedStyle(t,null).getPropertyValue("z-index"),n=document.defaultView.getComputedStyle(t,null).getPropertyValue("position");"auto"!==e&&"static"!==n&&i.push(e),t=t.parentElement}const n=[];for(let a=0;a<document.body.children.length;a++)if(!e.isEqualNode(document.body.children[a])){const e=document.defaultView.getComputedStyle(document.body.children[a],null).getPropertyValue("z-index"),t=document.defaultView.getComputedStyle(document.body.children[a],null).getPropertyValue("position");"auto"!==e&&"static"!==t&&n.push(e)}n.push("999");const s=[];if(!jp(e.parentElement)&&"BODY"!==e.parentElement.tagName){const t=[].slice.call(e.parentElement.children);for(let i=0;i<t.length;i++)if(!e.isEqualNode(t[i])){const e=document.defaultView.getComputedStyle(t[i],null).getPropertyValue("z-index"),n=document.defaultView.getComputedStyle(t[i],null).getPropertyValue("position");"auto"!==e&&"static"!==n&&s.push(e)}}const r=i.concat(n,s),o=Math.max.apply(Math,r)+1;return o>2147483647?2147483647:o}const uf=["north-west","north","north-east","west","east","south-west","south","south-east"],gf="e-focused-handle",mf=["e-restrict-left"],ff="e-resize-viewport",yf=["north","west","east","south"];let bf,vf,wf,xf,Sf,Cf,Pf,Of,Tf,Ef=0,Af=0,If=0,Df=0,Mf=0,Rf=0,zf=null,Lf=null,kf=null,jf=!0,Hf=0,_f=!0;function Nf(e){Yf();const t=Cu("span",{attrs:{unselectable:"on",contenteditable:"false"}});t.setAttribute("class","e-dialog-border-resize e-"+e),"south"===e&&(t.style.height="2px",t.style.width="100%",t.style.bottom="0px",t.style.left="0px"),"north"===e&&(t.style.height="2px",t.style.width="100%",t.style.top="0px",t.style.left="0px"),"east"===e&&(t.style.height="100%",t.style.width="2px",t.style.right="0px",t.style.top="0px"),"west"===e&&(t.style.height="100%",t.style.width="2px",t.style.left="0px",t.style.top="0px"),bf.appendChild(t)}function Bf(e){let t;return jp(e)||(t="string"==typeof e?document.querySelector(e):e),t}function Wf(e){jp(e)&&(e=this);const t=bf.querySelectorAll(".e-resize-handle");for(let n=0;n<t.length;n++)vf=t[n],xu.add(vf,"mousedown",Ff,e),xu.add(vf,"msie"===wu.info.name?"pointerdown":"touchstart",Xf,e);const i=bf.querySelectorAll(".e-dialog-border-resize");if(!jp(i))for(let n=0;n<i.length;n++)vf=i[n],xu.add(vf,"mousedown",Ff,e),xu.add(vf,"msie"===wu.info.name?"pointerdown":"touchstart",Xf,e)}function Uf(e){return e.indexOf("mouse")>-1?"mouse":"touch"}function Ff(e){if(e.preventDefault(),bf=e.target.parentElement,Yf(),Mf=e.pageX,Rf=e.pageY,e.target.classList.add(gf),!jp(zf)&&(Tf=this,!0===zf(e,Tf)))return;const t=jp(Pf)?document:Pf;xu.add(t,"mousemove",Gf,this),xu.add(document,"mouseup",Vf,this);for(let i=0;i<mf.length;i++)jf=!bf.classList.contains(mf[i])}function Vf(e){const t="msie"===wu.info.name?"pointermove":"touchmove",i="msie"===wu.info.name?"pointerup":"touchend",n=jp(Pf)?document:Pf,s="msie"===wu.info.name?"pointerdown":"touchstart";xu.remove(n,"mousemove",Gf),xu.remove(n,t,Gf),xu.remove(n,s,Gf),jp(document.body.querySelector(".e-focused-handle"))||document.body.querySelector(".e-focused-handle").classList.remove(gf),jp(kf)||(Tf=this,kf(e,Tf)),xu.remove(document,"mouseup",Vf),xu.remove(document,i,Vf)}function Yf(){Ef=parseFloat(getComputedStyle(bf,null).getPropertyValue("width").replace("px","")),Af=parseFloat(getComputedStyle(bf,null).getPropertyValue("height").replace("px","")),If=bf.getBoundingClientRect().left,Df=bf.getBoundingClientRect().top}function Xf(e){bf=e.target.parentElement,Yf();const t=e.touches?e.changedTouches[0]:e;if(Mf=t.pageX,Rf=t.pageY,!jp(zf)&&(Tf=this,!0===zf(e,Tf)))return;const i="msie"===wu.info.name?"pointermove":"touchmove",n="msie"===wu.info.name?"pointerup":"touchend",s=jp(Pf)?document:Pf;xu.add(s,i,Gf,this),xu.add(document,n,Vf)}function Gf(e){if(e.target.classList.contains("e-resize-handle")&&e.target.classList.contains(gf)?vf=e.target:jp(document.body.querySelector(".e-focused-handle"))||(vf=document.body.querySelector(".e-focused-handle")),!jp(vf)){let t="";for(let e=0;e<uf.length;e++)vf.classList.contains("e-"+uf[e])&&(t=uf[e]);switch(jp(Lf)||(Tf=this,Lf(e,Tf)),t){case"south":Zf(e);break;case"north":$f(e);break;case"west":Qf(e);break;case"east":Jf(e);break;case"south-east":Zf(e),Jf(e);break;case"south-west":Zf(e),Qf(e);break;case"north-east":$f(e),Jf(e);break;case"north-west":$f(e),Qf(e)}}}function qf(e){return e.getBoundingClientRect()}function Zf(e){const t=document.documentElement.clientHeight;let i=!1;const n=(e.touches?e.changedTouches[0]:e).pageY,s=qf(bf);let r;jp(Pf)||(r=qf(Pf)),jp(Pf)?jp(Pf)&&(t-n>=0||s.top<0)&&(i=!0):i=!0;let o=Af+(n-Rf);o=o>wf?o:wf;let a=0;jp(Pf)||(a=r.top);const l=jp(Pf)?0:Pf.offsetHeight-Pf.clientHeight;let h=s.top-a-l/2;if(h=h<0?0:h,s.top>0&&h+o>xf){if(i=!1,bf.classList.contains(ff))return;return void(bf.style.height=xf-parseInt(h.toString(),10)+"px")}let c=0;if(i){s.top<0&&t+(s.height+s.top)>0&&(c=s.top,o+c<=30&&(o=s.height-(s.height+s.top)+30)),o+s.top>=xf&&(bf.style.height=s.height+(t-(s.height+s.top))+"px");const e=jp(Pf)?c:h;o>=wf&&o+e<=xf&&(bf.style.height=o+"px")}}function $f(e){let t,i=!1;const n="mouse"===Uf(e.type)?e.pageY:e.touches[0].pageY,s=qf(bf);jp(Pf)||(t=qf(Pf)),(!jp(Pf)&&s.top-t.top>0||jp(Pf)&&n>0)&&(i=!0);const r=Af-(n-Rf);if(i&&r>=wf&&r<=xf){let e=0;jp(Pf)||(e=t.top);let i=Df-e+(n-Rf);i=i>0?i:1,bf.style.height=r+"px",bf.style.top=i+"px"}}function Qf(e){const t=document.documentElement.clientWidth;let i,n=!1;jp(Pf)||(i=qf(Pf));const s="mouse"===Uf(e.type)?e.pageX:e.touches[0].pageX,r=qf(bf),o=jp(Pf)?0:Pf.offsetWidth-Pf.clientWidth;let a=jp(Pf)?0:i.left,l=jp(Pf)?0:i.width;jp(Of)&&(jp(Pf)?Of=t:(Of=r.left-a-o/2+r.width,Of+=l-o-Of)),(!jp(Pf)&&Math.floor(r.left-i.left+r.width+(i.right-r.right))-o<=Cf||jp(Pf)&&s>=0)&&(n=!0);let h=Ef-(s-Mf);if(jf&&(h=h>Of?Of:h),n&&h>=Sf&&h<=Cf){let e=0;jp(Pf)||(e=i.left);let t=If-e+(s-Mf);t=t>0?t:1,h!==Hf&&_f&&(bf.style.width=h+"px"),jf&&(bf.style.left=t+"px",_f=1!==t)}Hf=h}function Jf(e){const t=document.documentElement.clientWidth;let i,n=!1;jp(Pf)||(i=qf(Pf));const s=(e.touches?e.changedTouches[0]:e).pageX,r=qf(bf);(!jp(Pf)&&(r.left-i.left+r.width<=Cf||r.right-i.left>=r.width)||jp(Pf)&&t-s>0)&&(n=!0);const o=Ef+(s-Mf);let a=0;if(jp(Pf)||(a=i.left),r.left-a+o>Cf){if(n=!1,bf.classList.contains(ff))return;bf.style.width=Cf-(r.left-a)+"px"}n&&o>=Sf&&o<=Cf&&(bf.style.width=o+"px")}function Kf(){const e=bf.querySelectorAll(".e-resize-handle");for(let i=0;i<e.length;i++)Mu(e[i]);const t=bf.querySelectorAll(".e-dialog-border-resize");if(!jp(t))for(let i=0;i<t.length;i++)Mu(t[i])}var ey=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let ty=(()=>{class e extends bg{}return ey([ig(!0)],e.prototype,"isFlat",void 0),ey([ig()],e.prototype,"buttonModel",void 0),ey([ig("Button")],e.prototype,"type",void 0),ey([og()],e.prototype,"click",void 0),e})(),iy=(()=>{class e extends bg{}return ey([ig("Fade")],e.prototype,"effect",void 0),ey([ig(400)],e.prototype,"duration",void 0),ey([ig(0)],e.prototype,"delay",void 0),e})();const ny="e-dialog",sy="e-rtl",ry="e-dlg-header-content",oy="e-dlg-header",ay="e-footer-content",ly="e-dlg-modal",hy="e-icon-dlg-close",cy="e-dlg-target",dy="e-scroll-disabled",py="e-device",uy="e-dlg-fullscreen",gy="e-popup-open",my="Information",fy="e-scroll-disabled",yy="e-alert-dialog",by="e-confirm-dialog",vy="e-dlg-resizable",wy="e-restrict-left",xy="e-resize-viewport",Sy="user action";let Cy=(()=>{let e=class extends Cg{constructor(e,t){super(e,t),this.dlgClosedBy=Sy}render(){this.initialize(),this.initRender(),this.wireEvents(),"100%"===this.width&&(this.element.style.width=""),""!==this.minHeight&&(this.element.style.minHeight=Wp(this.minHeight)),this.enableResize&&(this.setResize(),"None"===this.animationSettings.effect&&this.getMinHeight()),this.renderComplete()}preRender(){if(this.headerContent=null,this.allowMaxHeight=!0,this.preventVisibility=!0,this.clonedEle=this.element.cloneNode(!0),this.closeIconClickEventHandler=e=>{this.dlgClosedBy="close icon",this.hide(e)},this.dlgOverlayClickEventHandler=e=>{this.dlgClosedBy="overlayClick",e.preventFocus=!1,this.trigger("overlayClick",e,e=>{e.preventFocus||this.focusContent(),this.dlgClosedBy=Sy})},this.l10n=new Rg("dialog",{close:"Close"},this.locale),this.checkPositionData(),jp(this.target)){const e=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.target=document.body,this.isProtectedOnChange=e}}isNumberValue(e){return/^[-+]?\d*\.?\d+$/.test(e)}checkPositionData(){if(!jp(this.position)){if(!jp(this.position.X)&&"number"!=typeof this.position.X&&this.isNumberValue(this.position.X)){const e=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.X=parseFloat(this.position.X),this.isProtectedOnChange=e}if(!jp(this.position.Y)&&"number"!=typeof this.position.Y&&this.isNumberValue(this.position.Y)){const e=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.Y=parseFloat(this.position.Y),this.isProtectedOnChange=e}}}getEle(e,t){let i;for(let n=0;n<e.length;n++)if(e[n].classList.contains(t)){i=e[n];break}return i}getMinHeight(){let e="0px",t="0px";jp(this.element.querySelector("."+ry))||(e=getComputedStyle(this.headerContent).height);const i=this.getEle(this.element.children,ay);jp(i)||(t=getComputedStyle(i).height);const n=parseInt(e.slice(0,e.indexOf("p")),10),s=parseInt(t.slice(0,t.indexOf("p")),10);var r;return r=n+30+(isNaN(s)?0:s),wf=r,n+30+s}onResizeStart(e,t){return t.trigger("resizeStart",e),e.cancel}onResizing(e,t){t.trigger("resizing",e)}onResizeComplete(e,t){t.trigger("resizeStop",e)}setResize(){if(this.enableResize){if(this.isBlazorServerRender()&&!jp(this.element.querySelector(".e-icons.e-resize-handle")))return;this.element.classList.add(vy);const e=getComputedStyle(this.element).minHeight,t=getComputedStyle(this.element).minWidth;let i="";for(let n=0;n<this.resizeHandles.length;n++){if("All"===this.resizeHandles[n]){i="south north east west north-east north-west south-east south-west";break}{let e="";switch(this.resizeHandles[n].toString()){case"SouthEast":e="south-east";break;case"SouthWest":e="south-west";break;case"NorthEast":e="north-east";break;case"NorthWest":e="north-west";break;default:e=this.resizeHandles[n].toString()}i+=e.toLocaleLowerCase()+" "}}this.enableRtl&&"south-east"===i.trim()?i="south-west":this.enableRtl&&"south-west"===i.trim()&&(i="south-east"),this.isModal&&this.enableRtl?this.element.classList.add(wy):this.isModal&&this.target===document.body&&this.element.classList.add(xy),function(e){zf=e.resizeBegin,Lf=e.resizing,kf=e.resizeComplete,bf=Bf(e.element),Pf=Bf(e.boundary);const t=e.direction.split(" ");for(let i=0;i<t.length;i++)if(yf.indexOf(t[i])>=0&&t[i])Nf(t[i]);else if(""!==t[i].trim()){const e=Cu("div",{className:"e-icons e-resize-handle e-"+t[i]});bf.appendChild(e)}wf=e.minHeight,Sf=e.minWidth,Cf=e.maxWidth,xf=e.maxHeight,e.proxy&&e.proxy.element&&e.proxy.element.classList.contains("e-dialog")?Wf(e.proxy):Wf()}({element:this.element,direction:i,minHeight:parseInt(e.slice(0,t.indexOf("p")),10),maxHeight:this.targetEle.clientHeight,minWidth:parseInt(t.slice(0,t.indexOf("p")),10),maxWidth:this.targetEle.clientWidth,boundary:this.target===document.body?null:this.targetEle,resizeBegin:this.onResizeStart.bind(this),resizeComplete:this.onResizeComplete.bind(this),resizing:this.onResizing.bind(this),proxy:this}),this.wireWindowResizeEvent()}else Kf(),this.unWireWindowResizeEvent(),this.element.classList.remove(this.isModal?wy:xy),this.element.classList.remove(vy)}getFocusElement(e){const t=e.querySelectorAll('input,select,textarea,button:enabled,a,[contenteditable="true"],[tabindex]');return{element:t[t.length-1]}}keyDown(e){if(9===e.keyCode&&this.isModal){let t;jp(this.btnObj)||(t=this.btnObj[this.btnObj.length-1]),jp(this.btnObj)&&!jp(this.ftrTemplateContent)&&(t=this.getFocusElement(this.ftrTemplateContent)),jp(this.btnObj)&&jp(this.ftrTemplateContent)&&!jp(this.contentEle)&&(t=this.getFocusElement(this.contentEle)),jp(t)||document.activeElement!==t.element||e.shiftKey||(e.preventDefault(),this.focusableElements(this.element).focus()),document.activeElement===this.focusableElements(this.element)&&e.shiftKey&&(e.preventDefault(),jp(t)||t.element.focus())}const t=document.activeElement,i=["input","textarea"].indexOf(t.tagName.toLowerCase())>-1;let n=!1;if(i||(n=t.hasAttribute("contenteditable")&&"true"===t.getAttribute("contenteditable")),27===e.keyCode&&this.closeOnEscape&&(this.dlgClosedBy="escape",this.hide(e)),13===e.keyCode&&!e.ctrlKey&&"textarea"!==t.tagName.toLowerCase()&&i&&!jp(this.primaryButtonEle)||13===e.keyCode&&e.ctrlKey&&("textarea"===t.tagName.toLowerCase()||n)&&!jp(this.primaryButtonEle)){let t;this.buttons.some((e,i)=>{t=i;let n=e.buttonModel;return!jp(n)&&!0===n.isPrimary})&&"function"==typeof this.buttons[t].click&&setTimeout(()=>{this.buttons[t].click.call(this,e)})}}initialize(){jp(this.target)||(this.targetEle="string"==typeof this.target?document.querySelector(this.target):this.target),this.isBlazorServerRender()||Pu([this.element],ny),wu.isDevice&&Pu([this.element],py),this.isBlazorServerRender()||this.setCSSClass(),this.setMaxHeight()}initRender(){if(this.initialRender=!0,this.isBlazorServerRender()||zu(this.element,{role:"dialog"}),1e3===this.zIndex?(this.setzIndex(this.element,!1),this.calculatezIndex=!0):this.calculatezIndex=!1,this.isBlazorServerRender()&&jp(this.headerContent)&&(this.headerContent=this.element.getElementsByClassName("e-dlg-header-content")[0]),this.isBlazorServerRender()&&jp(this.contentEle)&&(this.contentEle=this.element.querySelector("#"+this.element.id+"_dialog-content")),this.isBlazorServerRender()||(this.setTargetContent(),""===this.header||jp(this.header)||this.setHeader(),this.showCloseIcon&&this.renderCloseIcon(),this.setContent(),""===this.footerTemplate||jp(this.footerTemplate)?jp(this.buttons[0].buttonModel)||this.setButton():this.setFooterTemplate()),this.isBlazorServerRender()&&(jp(this.buttons[0].buttonModel)||""!==this.footerTemplate||this.setButton()),this.allowDragging&&!jp(this.headerContent)&&this.setAllowDragging(),this.isBlazorServerRender()||(zu(this.element,{"aria-modal":this.isModal?"true":"false"}),this.isModal&&this.setIsModal()),this.isBlazorServerRender()&&jp(this.dlgContainer)){this.dlgContainer=this.element.parentElement;for(let e=0,t=this.dlgContainer.children;e<t.length;e++)t[e].classList.contains("e-dlg-overlay")&&(this.dlgOverlay=t[e])}if(!0!==this.element.classList.contains(yy)&&!0!==this.element.classList.contains(by)&&!jp(this.element.parentElement)){const e=this.isModal?this.dlgContainer.parentElement:this.element.parentElement;this.refElement=this.createElement("div",{className:"e-dlg-ref-element"}),e.insertBefore(this.refElement,this.isModal?this.dlgContainer:this.element)}jp(this.targetEle)||this.targetEle.appendChild(this.isModal?this.dlgContainer:this.element),this.popupObj=new df(this.element,{height:this.height,width:this.width,zIndex:this.zIndex,relateTo:this.target,actionOnScroll:"none",enableRtl:this.enableRtl,open:e=>{const t={container:this.isModal?this.dlgContainer:this.element,element:this.element,target:this.target,preventFocus:!1};this.enableResize&&this.resetResizeIcon(),this.trigger("open",t,e=>{e.preventFocus||this.focusContent()})},close:e=>{this.isModal&&Pu([this.dlgOverlay],"e-fade"),this.unBindEvent(this.element),this.isModal&&(this.dlgContainer.style.display="none"),this.trigger("close",this.closeArgs);const t=document.activeElement;jp(t)||jp(t.blur)||t.blur(),jp(this.storeActiveElement)||jp(this.storeActiveElement.focus)||this.storeActiveElement.focus()}}),this.positionChange(),this.setEnableRTL(),this.isBlazorServerRender()||(Pu([this.element],"e-popup-close"),this.isModal&&this.setOverlayZindex()),this.visible?this.show():this.isModal&&(this.dlgOverlay.style.display="none"),this.initialRender=!1}resetResizeIcon(){const e=this.getMinHeight();if(this.targetEle.offsetHeight<e){const t=this.element.querySelector("."+(this.enableRtl?"e-south-west":"e-south-east"));jp(t)||(t.style.bottom="-"+e.toString()+"px")}}setOverlayZindex(e){let t;t=jp(e)?parseInt(this.element.style.zIndex,10)?parseInt(this.element.style.zIndex,10):this.zIndex:e,this.dlgOverlay.style.zIndex=(t-1).toString(),this.dlgContainer.style.zIndex=t.toString()}positionChange(){this.isModal&&(isNaN(parseFloat(this.position.X))||isNaN(parseFloat(this.position.Y)))?!isNaN(parseFloat(this.position.X))&&isNaN(parseFloat(this.position.Y))||isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():(this.element.style.top="0px",this.element.style.left="0px",this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y)):this.setPopupPosition()}setPopupPosition(){this.popupObj.setProperties({position:{X:this.position.X,Y:this.position.Y}})}setAllowDragging(){this.dragObj=new Ig(this.element,{clone:!1,isDragScroll:!0,abort:".e-dlg-closeicon-btn",handle:".e-dlg-header-content",dragStart:e=>{this.trigger("dragStart",e,e=>{})},dragStop:e=>{this.isModal&&(jp(this.position)||this.dlgContainer.classList.remove("e-dlg-"+this.position.X+"-"+this.position.Y),this.element.style.position="relative"),this.trigger("dragStop",e),this.element.classList.remove(wy)},drag:e=>{this.trigger("drag",e)}}),jp(this.targetEle)||(this.dragObj.dragArea=this.targetEle)}setButton(){if(!this.isBlazorServerRender()){this.buttonContent=[],this.btnObj=[];for(let e=0;e<this.buttons.length;e++){const t=jp(this.buttons[e].type)?"button":this.buttons[e].type.toLowerCase(),i=this.createElement("button",{attrs:{type:t}});this.buttonContent.push(i.outerHTML)}this.setFooterTemplate()}let e;for(let t=0,i=this.element.children;t<i.length;t++)i[t].classList.contains(ay)&&(e=i[t].querySelectorAll("button"));for(let t=0;t<this.buttons.length;t++)this.isBlazorServerRender()||(this.btnObj[t]=new Om(this.buttons[t].buttonModel)),this.isBlazorServerRender()&&(this.ftrTemplateContent=this.element.querySelector(".e-footer-content")),!jp(this.ftrTemplateContent)&&e.length>0&&("function"==typeof this.buttons[t].click&&xu.add(e[t],"click",this.buttons[t].click,this),"object"==typeof this.buttons[t].click&&xu.add(e[t],"click",this.buttonClickHandler.bind(this,t),this)),this.isBlazorServerRender()||jp(this.ftrTemplateContent)||(this.btnObj[t].appendTo(this.ftrTemplateContent.children[t]),this.buttons[t].isFlat&&this.btnObj[t].element.classList.add("e-flat"),this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0])}buttonClickHandler(e){this.trigger("buttons["+e+"].click",{})}setContent(){zu(this.element,{"aria-describedby":this.element.id+"_dialog-content"}),this.contentEle=this.createElement("div",{className:"e-dlg-content",id:this.element.id+"_dialog-content"}),this.innerContentElement?this.contentEle.appendChild(this.innerContentElement):(jp(this.content)||""===this.content)&&this.initialRender||("string"!=typeof this.content?this.content instanceof HTMLElement?this.contentEle.appendChild(this.content):this.setTemplate(this.content,this.contentEle,"content"):this.contentEle.innerHTML=this.sanitizeHelper(this.content)),jp(this.headerContent)?this.element.insertBefore(this.contentEle,this.element.children[0]):this.element.insertBefore(this.contentEle,this.element.children[1]),"auto"===this.height&&(this.isBlazorServerRender()||!wu.isIE||""!==this.element.style.width||jp(this.width)||(this.element.style.width=Wp(this.width)),this.setMaxHeight())}setTemplate(e,t,i){let n,s,r;s=t.classList.contains(oy)?this.element.id+"header":t.classList.contains(ay)?this.element.id+"footerTemplate":this.element.id+"content",jp(e.outerHTML)?"string"!=typeof e?(n=am(e),r=e):t.innerHTML=this.sanitizeHelper(e):t.appendChild(e);const o=[];if(!jp(n)){const e=!0;for(const t of n({},this,i,s,e))o.push(t);Iu([].slice.call(o),t)}}sanitizeHelper(e){if(this.enableHtmlSanitizer){const t=um.beforeSanitize();kp(t,t,{cancel:!1,helper:null}),this.trigger("beforeSanitizeHtml",t),t.cancel&&!jp(t.helper)?e=t.helper(e):t.cancel||(e=um.serializeValue(t,e))}return e}setMaxHeight(){if(!this.allowMaxHeight)return;const e=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=!jp(this.target)&&this.targetEle.offsetHeight<window.innerHeight?this.targetEle.offsetHeight-20+"px":window.innerHeight-20+"px",this.element.style.display=e,wu.isIE&&"auto"===this.height&&!jp(this.contentEle)&&this.element.offsetHeight<this.contentEle.offsetHeight&&(this.element.style.height="inherit")}setEnableRTL(){this.isBlazorServerRender()||(this.enableRtl?Pu([this.element],sy):Ou([this.element],sy)),jp(this.element.querySelector(".e-resize-handle"))||(Kf(),this.setResize())}setTargetContent(){if(jp(this.content)||""===this.content){const e=""!==this.element.innerHTML.replace(/\s|<(\/?|\/?)(!--!--)>/g,"");(this.element.children.length>0||e)&&(this.innerContentElement=document.createDocumentFragment(),[].slice.call(this.element.childNodes).forEach(e=>{8!==e.nodeType&&this.innerContentElement.appendChild(e)}))}}setHeader(){this.headerEle?this.headerEle.innerHTML="":this.headerEle=this.createElement("div",{id:this.element.id+"_title",className:oy}),this.createHeaderContent(),this.headerContent.appendChild(this.headerEle),this.setTemplate(this.header,this.headerEle,"header"),zu(this.element,{"aria-labelledby":this.element.id}),this.element.insertBefore(this.headerContent,this.element.children[0])}setFooterTemplate(){this.ftrTemplateContent?this.ftrTemplateContent.innerHTML="":this.ftrTemplateContent=this.createElement("div",{className:ay}),""===this.footerTemplate||jp(this.footerTemplate)?this.ftrTemplateContent.innerHTML=this.buttonContent.join(""):this.setTemplate(this.footerTemplate,this.ftrTemplateContent,"footerTemplate"),this.element.appendChild(this.ftrTemplateContent)}createHeaderContent(){jp(this.headerContent)&&(this.headerContent=this.createElement("div",{id:this.element.id+"_dialog-header",className:ry}))}renderCloseIcon(){this.closeIcon=this.createElement("button",{className:"e-dlg-closeicon-btn",attrs:{type:"button"}}),this.closeIconBtnObj=new Om({cssClass:"e-flat",iconCss:hy+" e-icons"}),this.closeIconTitle(),jp(this.headerContent)?(this.createHeaderContent(),Au([this.closeIcon],this.headerContent),this.element.insertBefore(this.headerContent,this.element.children[0])):Au([this.closeIcon],this.headerContent),this.closeIconBtnObj.appendTo(this.closeIcon)}closeIconTitle(){this.l10n.setLocale(this.locale);const e=this.l10n.getConstant("close");this.closeIcon.setAttribute("title",e),this.closeIcon.setAttribute("aria-label",e)}setCSSClass(e){this.cssClass&&Pu([this.element],this.cssClass.split(" ")),e&&Ou([this.element],e.split(" "))}setIsModal(){this.dlgContainer=this.createElement("div",{className:"e-dlg-container"}),this.element.classList.remove(gy),this.element.parentNode.insertBefore(this.dlgContainer,this.element),this.dlgContainer.appendChild(this.element),Pu([this.element],ly),this.dlgOverlay=this.createElement("div",{className:"e-dlg-overlay"}),this.dlgOverlay.style.zIndex=(this.zIndex-1).toString(),this.dlgContainer.appendChild(this.dlgOverlay)}getValidFocusNode(e){let t;for(let i=0;i<e.length;i++){if(t=e[i],(t.clientHeight>0||"a"===t.tagName.toLowerCase()&&t.hasAttribute("href"))&&t.tabIndex>-1&&!t.disabled&&!this.disableElement(t,'[disabled],[aria-disabled="true"],[type="hidden"]'))return t;t=null}return t}focusableElements(e){if(!jp(e)){const t=e.querySelectorAll('input,select,textarea,button,a,[contenteditable="true"],[tabindex]');return this.getValidFocusNode(t)}return null}getAutoFocusNode(e){let t=e.querySelector(".e-dlg-closeicon-btn");const i=e.querySelectorAll("[autofocus]");let n=this.getValidFocusNode(i);if(jp(n)){if(n=this.focusableElements(this.contentEle),!jp(n))return n;if(!jp(this.primaryButtonEle))return this.element.querySelector(".e-primary")}else t=n;return t}disableElement(e,t){const i=e?e.matches||e.webkitMatchesSelector||e.msGetRegionContent:null;if(i)for(;e;e=e.parentNode)if(e instanceof Element&&i.call(e,t))return e;return null}focusContent(){const e=this.getAutoFocusNode(this.element),t=jp(e)?this.element:e,i=wu.userAgent;(i.indexOf("MSIE ")>0||i.indexOf("Trident/")>0)&&this.element.focus(),t.focus(),this.bindEvent(this.element)}bindEvent(e){xu.add(e,"keydown",this.keyDown,this)}unBindEvent(e){xu.remove(e,"keydown",this.keyDown)}updateSanitizeContent(){this.isBlazorServerRender()||(this.contentEle.innerHTML=this.sanitizeHelper(this.content))}isBlazorServerRender(){return!1}getModuleName(){return"dialog"}onPropertyChanged(e,t){if(this.element.classList.contains(ny))for(const i of Object.keys(e))switch(i){case"content":jp(this.content)||""===this.content?jp(this.contentEle)||(Mu(this.contentEle),this.contentEle=null):(this.isBlazorServerRender()&&(this.contentEle=this.element.querySelector(".e-dlg-content")),jp(this.contentEle)||"dialog"===this.contentEle.getAttribute("role")?this.isBlazorServerRender()&&!jp(this.element.querySelector(".e-dlg-content"))||this.setContent():(this.isBlazorServerRender()||(this.contentEle.innerHTML=""),"function"==typeof this.content?(this.clearTemplate(["content"]),Mu(this.contentEle),this.contentEle=null,this.setContent()):"string"==typeof this.content?this.isBlazorServerRender()&&""===this.contentEle.innerText?this.contentEle.insertAdjacentHTML("beforeend",this.sanitizeHelper(this.content)):this.updateSanitizeContent():this.contentEle.appendChild(this.content),this.setMaxHeight()));break;case"header":""===this.header||jp(this.header)?this.headerEle&&(Mu(this.headerEle),this.headerEle=null):this.isBlazorServerRender()&&!jp(this.element.querySelector(".e-dlg-header-content"))||this.setHeader();break;case"footerTemplate":if(""===this.footerTemplate||jp(this.footerTemplate)){if(!this.ftrTemplateContent)return;Mu(this.ftrTemplateContent),this.ftrTemplateContent=null,this.buttons=[{}]}else this.isBlazorServerRender()&&!jp(this.element.querySelector(".e-footer-content"))||this.setFooterTemplate(),this.buttons=[{}];break;case"showCloseIcon":this.element.getElementsByClassName(hy).length>0?this.showCloseIcon||""!==this.header&&!jp(this.header)?this.showCloseIcon?this.isBlazorServerRender()&&this.wireEvents():Mu(this.closeIcon):(Mu(this.headerContent),this.headerContent=null):(this.isBlazorServerRender()||this.renderCloseIcon(),this.wireEvents());break;case"locale":this.showCloseIcon&&this.closeIconTitle();break;case"visible":this.visible?this.show():this.hide();break;case"isModal":this.updateIsModal();break;case"height":_u(this.element,{height:Wp(e.height)});break;case"width":_u(this.element,{width:Wp(e.width)});break;case"zIndex":this.popupObj.zIndex=this.zIndex,this.isModal&&this.setOverlayZindex(this.zIndex),this.element.style.zIndex!==this.zIndex.toString()&&(this.calculatezIndex=!1);break;case"cssClass":this.setCSSClass(t.cssClass);break;case"buttons":{const e=this.buttons.length;jp(this.ftrTemplateContent)||this.isBlazorServerRender()||(Mu(this.ftrTemplateContent),this.ftrTemplateContent=null);for(let t=0;t<e;t++)jp(this.buttons[t].buttonModel)||(this.footerTemplate="",this.setButton());break}case"allowDragging":this.allowDragging&&!jp(this.headerContent)?this.setAllowDragging():this.dragObj.destroy();break;case"target":this.setTarget(e.target);break;case"position":if(this.checkPositionData(),this.isModal){const e=jp(t.position.X)?this.position.X:t.position.X,i=jp(t.position.Y)?this.position.Y:t.position.Y;this.dlgContainer.classList.contains("e-dlg-"+e+"-"+i)&&this.dlgContainer.classList.remove("e-dlg-"+e+"-"+i)}this.positionChange();break;case"enableRtl":this.setEnableRTL();break;case"enableResize":this.setResize()}}setTarget(e){this.popupObj.relateTo=e,this.target=e,this.targetEle="string"==typeof this.target?document.querySelector(this.target):this.target,this.dragObj&&(this.dragObj.dragArea=this.targetEle),this.setMaxHeight(),this.isModal&&this.updateIsModal(),this.enableResize&&this.setResize()}updateIsModal(){if(this.element.setAttribute("aria-modal",this.isModal?"true":"false"),this.isModal)jp(this.dlgOverlay)&&(this.setIsModal(),this.element.style.top="0px",this.element.style.left="0px",jp(this.targetEle)||this.targetEle.appendChild(this.dlgContainer));else{for(Ou([this.element],ly),Ou([document.body],[cy,dy]),Mu(this.dlgOverlay);this.dlgContainer.firstChild;)this.dlgContainer.parentElement.insertBefore(this.dlgContainer.firstChild,this.dlgContainer);this.dlgContainer.parentElement.removeChild(this.dlgContainer)}this.visible&&this.show(),this.positionChange(),this.isModal&&this.dlgOverlay&&xu.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)}setzIndex(e,t){const i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.zIndex=pf(e),this.isProtectedOnChange=i,t&&(this.popupObj.zIndex=this.zIndex)}windowResizeHandler(){Cf=this.targetEle.clientWidth,xf=this.targetEle.clientHeight,this.setMaxHeight()}getPersistData(){return this.addOnPersist([])}destroy(){if(this.isDestroyed)return;const e=[sy,ly,vy,wy,uy,py],t=["role","aria-modal","aria-labelledby","aria-describedby","aria-grabbed","tabindex","style"];if(Ou([this.targetEle],[cy,dy]),!jp(this.element)&&this.element.classList.contains(uy)&&Ou([document.body],[cy,dy]),this.isModal&&Ou([jp(this.targetEle)?document.body:this.targetEle],dy),this.unWireEvents(),!jp(this.btnObj))for(let i=0;i<this.btnObj.length;i++)this.btnObj[i].destroy();if(jp(this.dragObj)||this.dragObj.destroy(),!jp(this.popupObj.element)&&this.popupObj.element.classList.contains("e-popup")&&this.popupObj.destroy(),Ou([this.element],e),jp(this.cssClass)||""===this.cssClass||Ou([this.element],this.cssClass.split(" ")),jp(this.refElement)||jp(this.refElement.parentElement)||(this.refElement.parentElement.insertBefore(this.isModal?this.dlgContainer:this.element,this.refElement),Mu(this.refElement),this.refElement=void 0),this.isModal&&!this.isBlazorServerRender()&&(Mu(this.dlgOverlay),this.dlgContainer.parentNode.insertBefore(this.element,this.dlgContainer),Mu(this.dlgContainer)),this.isBlazorServerRender()||(this.element.innerHTML=this.clonedEle.innerHTML),this.isBlazorServerRender()&&!jp(this.element.children))for(let i=0;i<=this.element.children.length;i++)i-=i,Mu(this.element.children[i]);for(let i=0;i<t.length;i++)this.element.removeAttribute(t[i]);this.isBlazorServerRender()?this.isDestroyed=!0:super.destroy(),this.isReact&&this.clearTemplate()}wireWindowResizeEvent(){window.addEventListener("resize",this.windowResizeHandler.bind(this))}unWireWindowResizeEvent(){window.removeEventListener("resize",this.windowResizeHandler.bind(this))}wireEvents(){this.isBlazorServerRender()&&this.showCloseIcon&&(this.closeIcon=this.element.getElementsByClassName("e-dlg-closeicon-btn")[0]),this.showCloseIcon&&xu.add(this.closeIcon,"click",this.closeIconClickEventHandler,this),this.isModal&&this.dlgOverlay&&xu.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)}unWireEvents(){if(this.showCloseIcon&&xu.remove(this.closeIcon,"click",this.closeIconClickEventHandler),this.isModal&&xu.remove(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler),this.buttons.length>0&&!jp(this.buttons[0].buttonModel)&&""===this.footerTemplate)for(let e=0;e<this.buttons.length;e++)"function"==typeof this.buttons[e].click&&xu.remove(this.ftrTemplateContent.children[e],"click",this.buttons[e].click)}refreshPosition(){this.popupObj.refreshPosition()}show(e){if(this.element.classList.contains(ny)){if(!this.element.classList.contains(gy)||!jp(e)){jp(e)||this.fullScreen(e);const t={cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,target:this.target,maxHeight:this.element.style.maxHeight};this.trigger("beforeOpen",t,e=>{if(!e.cancel){this.element.style.maxHeight!==t.maxHeight&&(this.allowMaxHeight=!1,this.element.style.maxHeight=t.maxHeight),this.storeActiveElement=document.activeElement,this.element.tabIndex=-1,this.isModal&&!jp(this.dlgOverlay)&&(this.dlgOverlay.style.display="block",this.dlgContainer.style.display="flex",Ou([this.dlgOverlay],"e-fade"),jp(this.targetEle)?Pu([document.body],[cy,dy]):(this.dlgContainer.style.position=this.targetEle===document.body?"fixed":"absolute",this.dlgOverlay.style.position="absolute",this.element.style.position="relative",Pu([this.targetEle],[cy,dy])));const e={name:this.animationSettings.effect+"In",duration:this.animationSettings.duration,delay:this.animationSettings.delay},i=this.isModal?this.element.parentElement:this.element;this.calculatezIndex&&(this.setzIndex(i,!0),_u(this.element,{zIndex:this.zIndex}),this.isModal&&this.setOverlayZindex(this.zIndex)),"None"===this.animationSettings.effect?this.popupObj.show():this.popupObj.show(e),this.dialogOpen=!0;const n=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.visible=!0,this.preventVisibility=!0,this.isProtectedOnChange=n}})}this.isReact&&this.renderReactTemplates()}}hide(e){if(this.element.classList.contains(ny)&&this.preventVisibility){const t={cancel:!1,isInteracted:!!e,element:this.element,target:this.target,container:this.isModal?this.dlgContainer:this.element,event:e,closedBy:this.dlgClosedBy};this.closeArgs=t,this.trigger("beforeClose",t,e=>{if(!e.cancel){this.isModal&&(jp(this.targetEle)||Ou([this.targetEle],[cy,dy])),document.body.classList.contains(cy)&&document.body.classList.contains(dy)&&Ou([document.body],[cy,dy]);const e={name:this.animationSettings.effect+"Out",duration:this.animationSettings.duration,delay:this.animationSettings.delay};"None"===this.animationSettings.effect?this.popupObj.hide():this.popupObj.hide(e),this.dialogOpen=!1;const t=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.visible=!1,this.preventVisibility=!1,this.isProtectedOnChange=t}this.dlgClosedBy=Sy})}}fullScreen(e){if(e){Pu([this.element],uy);const e=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=jp(this.target)?window.innerHeight+"px":this.targetEle.offsetHeight+"px",this.element.style.display=e,Pu([document.body],[cy,dy]),this.allowDragging&&!jp(this.dragObj)&&this.dragObj.destroy()}else Ou([this.element],uy),Ou([document.body],[cy,dy]),this.allowDragging&&!jp(this.headerContent)&&this.setAllowDragging();return e}getButtons(e){return jp(e)?this.btnObj:this.btnObj[e]}};return ey([ig("")],e.prototype,"content",void 0),ey([ig(!0)],e.prototype,"enableHtmlSanitizer",void 0),ey([ig(!1)],e.prototype,"showCloseIcon",void 0),ey([ig(!1)],e.prototype,"isModal",void 0),ey([ig("")],e.prototype,"header",void 0),ey([ig(!0)],e.prototype,"visible",void 0),ey([ig(!1)],e.prototype,"enableResize",void 0),ey([ig(["South-East"])],e.prototype,"resizeHandles",void 0),ey([ig("auto")],e.prototype,"height",void 0),ey([ig("")],e.prototype,"minHeight",void 0),ey([ig("100%")],e.prototype,"width",void 0),ey([ig("")],e.prototype,"cssClass",void 0),ey([ig(1e3)],e.prototype,"zIndex",void 0),ey([ig(null)],e.prototype,"target",void 0),ey([ig("")],e.prototype,"footerTemplate",void 0),ey([ig(!1)],e.prototype,"allowDragging",void 0),ey([rg([{}],ty)],e.prototype,"buttons",void 0),ey([ig(!0)],e.prototype,"closeOnEscape",void 0),ey([ng({},iy)],e.prototype,"animationSettings",void 0),ey([ng({X:"center",Y:"center"},of)],e.prototype,"position",void 0),ey([og()],e.prototype,"created",void 0),ey([og()],e.prototype,"open",void 0),ey([og()],e.prototype,"beforeSanitizeHtml",void 0),ey([og()],e.prototype,"beforeOpen",void 0),ey([og()],e.prototype,"close",void 0),ey([og()],e.prototype,"beforeClose",void 0),ey([og()],e.prototype,"dragStart",void 0),ey([og()],e.prototype,"dragStop",void 0),ey([og()],e.prototype,"drag",void 0),ey([og()],e.prototype,"overlayClick",void 0),ey([og()],e.prototype,"resizeStart",void 0),ey([og()],e.prototype,"resizing",void 0),ey([og()],e.prototype,"resizeStop",void 0),ey([og()],e.prototype,"destroyed",void 0),e=ey([ag],e),e})();var Py;!function(e){function t(e,t){const i=new Cy(e);return i.appendTo(t),i}function i(e,t){return e.header=jp(t.title)?my:t.title,e.content=jp(t.content)?"":t.content,e.isModal=!!jp(t.isModal)||t.isModal,e.showCloseIcon=!jp(t.showCloseIcon)&&t.showCloseIcon,e.allowDragging=!jp(t.isDraggable)&&t.isDraggable,e.closeOnEscape=!jp(t.closeOnEscape)&&t.closeOnEscape,e.position=jp(t.position)?{X:"center",Y:"top"}:t.position,e.animationSettings=jp(t.animationSettings)?{effect:"Fade",duration:400,delay:0}:t.animationSettings,e.cssClass=jp(t.cssClass)?"":t.cssClass,e.zIndex=jp(t.zIndex)?1e3:t.zIndex,e.open=jp(t.open)?null:t.open,e}function n(e,t,i){const n=i;return jp(t.text)||(n.buttonModel.content=t.text),jp(t.icon)||(n.buttonModel.iconCss=t.icon),jp(t.cssClass)||(n.buttonModel.cssClass=t.cssClass),jp(t.click)||(n.click=t.click),n}e.alert=function(e){const s=Cu("div",{className:yy});let r;return document.body.appendChild(s),r=t("string"==typeof e?{content:e,position:{X:"center",Y:"top"},isModal:!0,header:my,buttons:[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}]}:function(e){let t={buttons:[]};return t=i(t,e),t=function(e,t){const i=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}];return jp(t.okButton)?e.buttons=i:e.buttons[0]=n(0,t.okButton,i[0]),e}(t,e),t}(e),s),r.close=()=>{e&&e.close&&e.close.apply(r),r.destroy(),r.element.classList.contains("e-dlg-modal")?(r.element.parentElement.remove(),r.target.classList.remove(fy)):r.element.remove()},r},e.confirm=function(e){const s=Cu("div",{className:by});let r;return document.body.appendChild(s),r=t("string"==typeof e?{position:{X:"center",Y:"top"},content:e,isModal:!0,header:my,buttons:[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},{buttonModel:{content:"Cancel"},click:function(){this.hide()}}]}:function(e){let t={buttons:[]};return t=i(t,e),t=function(e,t){const i={buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},s={buttonModel:{content:"Cancel"},click:function(){this.hide()}};return e.buttons[0]=jp(t.okButton)?i:n(0,t.okButton,i),e.buttons[1]=jp(t.cancelButton)?s:n(0,t.cancelButton,s),e}(t,e),t}(e),s),r.close=()=>{e&&e.close&&e.close.apply(r),r.destroy(),r.element.classList.contains("e-dlg-modal")?(r.element.parentElement.remove(),r.target.classList.remove(fy)):r.element.remove()},r}}(Py||(Py={}));var Oy=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};const Ty="e-tooltip",Ey="e-rtl",Ay="e-tip-content",Iy="e-arrow-tip",Dy="e-arrow-tip-inner",My="e-tip-bottom",Ry="e-tip-top",zy="e-tip-left",Ly="e-tip-right",ky="e-popup-open",jy="e-popup-close";let Hy=(()=>{class e extends bg{}return Oy([ig({effect:"FadeIn",duration:150,delay:0})],e.prototype,"open",void 0),Oy([ig({effect:"FadeOut",duration:150,delay:0})],e.prototype,"close",void 0),e})(),_y=(()=>{let e=class extends Cg{constructor(e,t){super(e,t),this.mouseMoveEvent=null,this.mouseMoveTarget=null}initialize(){this.formatPosition(),Pu([this.element],Ty)}formatPosition(){0===this.position.indexOf("Top")||0===this.position.indexOf("Bottom")?[this.tooltipPositionY,this.tooltipPositionX]=this.position.split(/(?=[A-Z])/):[this.tooltipPositionX,this.tooltipPositionY]=this.position.split(/(?=[A-Z])/)}renderArrow(){this.setTipClass(this.position);const e=this.createElement("div",{className:Iy+" "+this.tipClass});e.appendChild(this.createElement("div",{className:"e-arrow-tip-outer "+this.tipClass})),e.appendChild(this.createElement("div",{className:Dy+" "+this.tipClass})),this.tooltipEle.appendChild(e)}setTipClass(e){this.tipClass=0===e.indexOf("Right")?zy:0===e.indexOf("Bottom")?Ry:0===e.indexOf("Left")?Ly:My}renderPopup(e){const t=this.mouseTrail?{top:0,left:0}:this.getTooltipPosition(e);this.tooltipEle.classList.remove("e-lib"),this.popupObj=new df(this.tooltipEle,{height:this.height,width:this.width,position:{X:t.left,Y:t.top},enableRtl:this.enableRtl,open:this.openPopupHandler.bind(this),close:this.closePopupHandler.bind(this)})}getTooltipPosition(e){this.tooltipEle.style.display="block";const t=Em(e,this.tooltipPositionX,this.tooltipPositionY),i=this.calculateTooltipOffset(this.position),n=this.collisionFlipFit(e,t.left+i.left,t.top+i.top);return this.tooltipEle.style.display="",n}reposition(e){const t=this.getTooltipPosition(e);this.popupObj.position={X:t.left,Y:t.top},this.popupObj.dataBind()}openPopupHandler(){!this.mouseTrail&&this.needTemplateReposition()&&this.reposition(this.findTarget()),this.trigger("afterOpen",this.tooltipEventArgs)}closePopupHandler(){this.clearTemplate(["content"]),this.clear(),this.trigger("afterClose",this.tooltipEventArgs)}calculateTooltipOffset(e){const t={top:0,left:0},i=this.tooltipEle.offsetWidth,n=this.tooltipEle.offsetHeight,s=Lu("."+Iy,this.tooltipEle),r=s?s.offsetWidth:0,o=s?s.offsetHeight:0;let a=this.showTipPointer?0:8;const l=o/2+2+(this.tooltipEle.offsetHeight-this.tooltipEle.clientHeight),h=r/2+2+(this.tooltipEle.offsetWidth-this.tooltipEle.clientWidth);switch(this.mouseTrail&&(a+=2),e){case"RightTop":t.left+=r+a,t.top-=n-l;break;case"RightCenter":t.left+=r+a,t.top-=n/2;break;case"RightBottom":t.left+=r+a,t.top-=l;break;case"BottomRight":t.top+=o+a,t.left-=h;break;case"BottomCenter":t.top+=o+a,t.left-=i/2;break;case"BottomLeft":t.top+=o+a,t.left-=i-h;break;case"LeftBottom":t.left-=r+i+a,t.top-=l;break;case"LeftCenter":t.left-=r+i+a,t.top-=n/2;break;case"LeftTop":t.left-=r+i+a,t.top-=n-l;break;case"TopLeft":t.top-=n+o+a,t.left-=i-h;break;case"TopRight":t.top-=n+o+a,t.left-=h;break;default:t.top-=n+o+a,t.left-=i/2}return t.left+=this.offsetX,t.top+=this.offsetY,t}updateTipPosition(e){const t=ku(".e-arrow-tip,.e-arrow-tip-outer,."+Dy,this.tooltipEle);Ou(t,[My,Ry,zy,Ly]),this.setTipClass(e),Pu(t,this.tipClass)}adjustArrow(e,t,i,n){if(!1===this.showTipPointer)return;let s,r;this.updateTipPosition(t),this.tooltipEle.style.display="block";const o=this.tooltipEle.clientWidth,a=this.tooltipEle.clientHeight,l=Lu("."+Iy,this.tooltipEle),h=Lu("."+Dy,this.tooltipEle),c=l.offsetWidth,d=l.offsetHeight;if(this.tooltipEle.style.display="",this.tipClass===My||this.tipClass===Ry){if(this.tipClass===My?(r="99.9%",h.style.top="-"+(d-2)+"px"):(r=-(d-1)+"px",h.style.top="-"+(d-6)+"px"),e){const t="Center"!==i||o>e.offsetWidth||this.mouseTrail;s=t&&"Left"===i||!t&&"End"===this.tipPointerPosition?o-c-2+"px":t&&"Right"===i||!t&&"Start"===this.tipPointerPosition?"2px":o/2-c/2+"px"}}else{this.tipClass===Ly?(s="99.9%",h.style.left="-"+(c-2)+"px"):(s=-(c-1)+"px",h.style.left=c-2-c+"px");const t="Center"!==n||a>e.offsetHeight||this.mouseTrail;r=t&&"Top"===n||!t&&"End"===this.tipPointerPosition?a-d-2+"px":t&&"Bottom"===n||!t&&"Start"===this.tipPointerPosition?"2px":a/2-d/2+"px"}l.style.top=r,l.style.left=s}renderContent(e){const t=Lu("."+Ay,this.tooltipEle);if(this.cssClass&&Pu([this.tooltipEle],this.cssClass.split(" ")),e&&!jp(e.getAttribute("title"))&&(e.setAttribute("data-content",e.getAttribute("title")),e.removeAttribute("title")),jp(this.content))e&&!jp(e.getAttribute("data-content"))&&(t.innerHTML=e.getAttribute("data-content"));else if(t.innerHTML="",this.content instanceof HTMLElement)t.appendChild(this.content);else if("string"==typeof this.content)this.enableHtmlSanitizer&&this.setProperties({content:um.sanitize(this.content)},!0),t[this.enableHtmlParse?"innerHTML":"textContent"]=this.content;else{const e=am(this.content)({},this,"content",this.element.id+"content",void 0,void 0,t);e&&Iu(e,t),this.renderReactTemplates()}}renderCloseIcon(){if(!this.isSticky)return;const e=this.createElement("div",{className:"e-icons e-tooltip-close"});this.tooltipEle.appendChild(e),xu.add(e,wu.touchStartEvent,this.onStickyClose,this)}addDescribedBy(e,t){const i=(e.getAttribute("aria-describedby")||"").split(/\s+/);i.indexOf(t)<0&&i.push(t),zu(e,{"aria-describedby":i.join(" ").trim(),"data-tooltip-id":t})}removeDescribedBy(e){const t=e.getAttribute("data-tooltip-id"),i=(e.getAttribute("aria-describedby")||"").split(/\s+/),n=i.indexOf(t);-1!==n&&i.splice(n,1),e.removeAttribute("data-tooltip-id");const s=i.join(" ").trim();s?e.setAttribute("aria-describedby",s):e.removeAttribute("aria-describedby")}tapHoldHandler(e){clearTimeout(this.autoCloseTimer),this.targetHover(e.originalEvent)}touchEndHandler(e){this.isSticky||(this.autoCloseTimer=setTimeout(()=>{this.close()},1500))}targetClick(e){let t;t=this.target?Hu(e.target,this.target):this.element,jp(t)||(null===t.getAttribute("data-tooltip-id")?this.targetHover(e):this.isSticky||this.hideTooltip(this.animation.close,e,t))}targetHover(e){let t;if(t=this.target?Hu(e.target,this.target):this.element,jp(t)||null!==t.getAttribute("data-tooltip-id")&&0===this.closeDelay)return;const i=[].slice.call(ku('[data-tooltip-id= "'+this.ctrlId+'_content"]',document));for(const n of i)this.restoreElement(n);this.showTooltip(t,this.animation.open,e)}mouseMoveBeforeOpen(e){this.mouseMoveEvent=e}mouseMoveBeforeRemove(){this.mouseMoveTarget&&xu.remove(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen)}showTooltip(e,t,i){clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.openDelay&&this.mouseTrail&&(this.mouseMoveBeforeRemove(),this.mouseMoveTarget=e,xu.add(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen,this)),this.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:e,event:i||null,element:this.tooltipEle,isInteracted:!jp(i)},this.trigger("beforeRender",this.tooltipEventArgs,(n=>{this.beforeRenderCallback(n,e,i,t)}).bind(this))}beforeRenderCallback(e,t,i,n){e.cancel?(this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove()):(this.isHidden=!1,jp(this.tooltipEle)?(this.ctrlId=this.element.getAttribute("id")?_p(this.element.getAttribute("id")):_p("tooltip"),this.tooltipEle=this.createElement("div",{className:"e-tooltip-wrap e-popup e-lib",attrs:{role:"tooltip","aria-hidden":"false",id:this.ctrlId+"_content"},styles:"width:"+Wp(this.width)+";height:"+Wp(this.height)+";position:absolute;"}),this.tooltipBeforeRender(t,this),this.tooltipAfterRender(t,i,n,this)):t&&(this.adjustArrow(t,this.position,this.tooltipPositionX,this.tooltipPositionY),this.addDescribedBy(t,this.ctrlId+"_content"),this.renderContent(t),pg.stop(this.tooltipEle),this.reposition(t),this.tooltipAfterRender(t,i,n,this)))}tooltipBeforeRender(e,t){e&&(wu.isDevice&&Pu([t.tooltipEle],"e-bigger"),"auto"!==t.width&&(t.tooltipEle.style.maxWidth=Wp(t.width)),t.tooltipEle.appendChild(t.createElement("div",{className:Ay})),document.body.appendChild(t.tooltipEle),Ou([t.tooltipEle],"e-hidden"),t.addDescribedBy(e,t.ctrlId+"_content"),t.renderContent(e),Pu([t.tooltipEle],ky),t.showTipPointer&&t.renderArrow(),t.renderCloseIcon(),t.renderPopup(e),t.adjustArrow(e,t.position,t.tooltipPositionX,t.tooltipPositionY),pg.stop(t.tooltipEle),t.reposition(e))}tooltipAfterRender(e,t,i,n){if(e){Ou([n.tooltipEle],ky),Pu([n.tooltipEle],jy),n.tooltipEventArgs={type:t?t.type:null,cancel:!1,target:e,event:t||null,element:n.tooltipEle,isInteracted:!jp(t)},n.needTemplateReposition()&&!n.mouseTrail&&(n.tooltipEle.style.display="none");const s=s=>{n.beforeOpenCallback(s,e,i,t)};n.trigger("beforeOpen",n.tooltipEventArgs,s.bind(n))}}beforeOpenCallback(e,t,i,n){if(e.cancel)this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove(),this.restoreElement(t);else{let e={name:i.effect,duration:i.duration,delay:i.delay,timingFunction:"easeOut"};"None"===i.effect&&(e=void 0),this.openDelay>0?this.showTimer=setTimeout(()=>{this.mouseTrail&&xu.add(t,"mousemove touchstart mouseenter",this.onMouseMove,this),this.popupObj&&(this.popupObj.show(e,t),this.mouseMoveEvent&&this.mouseTrail&&this.onMouseMove(this.mouseMoveEvent))},this.openDelay):this.popupObj&&this.popupObj.show(e,t)}n&&this.wireMouseEvents(n,t)}needTemplateReposition(){return!jp(this.viewContainerRef)&&"string"!=typeof this.viewContainerRef}checkCollision(e,t,i){const n={left:t,top:i,position:this.position,horizontal:this.tooltipPositionX,vertical:this.tooltipPositionY},s=Nm(this.tooltipEle,this.checkCollideTarget(),t,i);return s.length>0&&(n.horizontal=s.indexOf("left")>=0?"Right":s.indexOf("right")>=0?"Left":this.tooltipPositionX,n.vertical=s.indexOf("top")>=0?"Bottom":s.indexOf("bottom")>=0?"Top":this.tooltipPositionY),n}collisionFlipFit(e,t,i){const n=this.checkCollision(e,t,i);let s=n.position;if(this.tooltipPositionY!==n.vertical&&(s=0===this.position.indexOf("Bottom")||0===this.position.indexOf("Top")?n.vertical+this.tooltipPositionX:this.tooltipPositionX+n.vertical),this.tooltipPositionX!==n.horizontal&&(0===s.indexOf("Left")&&(n.vertical="LeftTop"===s||"LeftCenter"===s?"Top":"Bottom",s=n.vertical+"Left"),0===s.indexOf("Right")&&(n.vertical="RightTop"===s||"RightCenter"===s?"Top":"Bottom",s=n.vertical+"Right"),n.horizontal=this.tooltipPositionX),this.tooltipEventArgs={type:null,cancel:!1,target:e,event:null,element:this.tooltipEle,collidedPosition:s},this.trigger("beforeCollision",this.tooltipEventArgs),n.position!==s){const t=Em(e,n.horizontal,n.vertical);this.adjustArrow(e,s,n.horizontal,n.vertical);const i=this.calculateTooltipOffset(s);i.top-=-1!=="TopBottom".indexOf(this.position.split(/(?=[A-Z])/)[0])&&-1!=="TopBottom".indexOf(s.split(/(?=[A-Z])/)[0])?2*this.offsetY:0,i.left-=-1!=="RightLeft".indexOf(this.position.split(/(?=[A-Z])/)[0])&&-1!=="RightLeft".indexOf(s.split(/(?=[A-Z])/)[0])?2*this.offsetX:0,n.position=s,n.left=t.left+i.left,n.top=t.top+i.top}else this.adjustArrow(e,s,n.horizontal,n.vertical);const r={left:n.left,top:n.top},o=_m(this.tooltipEle,this.checkCollideTarget(),{X:!0,Y:!1},r).left;if(this.tooltipEle.style.display="block",this.showTipPointer&&(0===s.indexOf("Bottom")||0===s.indexOf("Top"))){const e=Lu("."+Iy,this.tooltipEle);let t=parseInt(e.style.left,10)-(o-n.left);t<0?t=0:t+e.offsetWidth>this.tooltipEle.clientWidth&&(t=this.tooltipEle.clientWidth-e.offsetWidth),e.style.left=t.toString()+"px"}return this.tooltipEle.style.display="",r.left=o,r}checkCollideTarget(){return!this.windowCollision&&this.target?this.element:null}hideTooltip(e,t,i){this.closeDelay>0?(clearTimeout(this.hideTimer),clearTimeout(this.showTimer),this.hideTimer=setTimeout(()=>{this.closeDelay&&this.tooltipEle&&this.isTooltipOpen||this.tooltipHide(e,t,i)},this.closeDelay)):this.tooltipHide(e,t,i)}tooltipHide(e,t,i){let n;n=t?this.target?i||t.target:this.element:Lu('[data-tooltip-id= "'+this.ctrlId+'_content"]',document),this.tooltipEventArgs={type:t?t.type:null,cancel:!1,target:n,event:t||null,element:this.tooltipEle,isInteracted:!jp(t)},this.trigger("beforeClose",this.tooltipEventArgs,t=>{t.cancel?this.isHidden=!1:(this.mouseMoveBeforeRemove(),this.popupHide(e,n))})}popupHide(e,t){t&&this.restoreElement(t),this.isHidden=!0;let i={name:e.effect,duration:e.duration,delay:e.delay,timingFunction:"easeIn"};"None"===e.effect&&(i=void 0),this.popupObj&&this.popupObj.hide(i)}restoreElement(e){this.unwireMouseEvents(e),jp(e.getAttribute("data-content"))||(e.setAttribute("title",e.getAttribute("data-content")),e.removeAttribute("data-content")),this.removeDescribedBy(e)}clear(){this.tooltipEle&&(Ou([this.tooltipEle],jy),Pu([this.tooltipEle],ky)),this.isHidden&&(this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&Ru(this.tooltipEle),this.tooltipEle=null,this.popupObj=null)}tooltipHover(e){this.tooltipEle&&(this.isTooltipOpen=!0)}tooltipMouseOut(e){this.isTooltipOpen=!1,this.hideTooltip(this.animation.close,e,this.findTarget())}onMouseOut(e){const t=e.relatedTarget;if(t&&!this.mouseTrail){const i=Hu(t,".e-tooltip-wrap.e-lib.e-popup");i?xu.add(i,"mouseleave",this.tooltipElementMouseOut,this):(this.hideTooltip(this.animation.close,e,this.findTarget()),0===this.closeDelay&&this.clear())}else this.hideTooltip(this.animation.close,e,this.findTarget()),this.clear()}tooltipElementMouseOut(e){this.hideTooltip(this.animation.close,e,this.findTarget()),xu.remove(this.element,"mouseleave",this.tooltipElementMouseOut),this.clear()}onStickyClose(e){this.close()}onMouseMove(e){let t=0,i=0;e.type.indexOf("touch")>-1?(e.preventDefault(),t=e.touches[0].pageX,i=e.touches[0].pageY):(t=e.pageX,i=e.pageY),pg.stop(this.tooltipEle),Ou([this.tooltipEle],jy),Pu([this.tooltipEle],ky),this.adjustArrow(e.target,this.position,this.tooltipPositionX,this.tooltipPositionY);const n=this.calculateTooltipOffset(this.position),s=this.checkCollision(e.target,t+n.left+this.offsetX,i+n.top+this.offsetY);if(this.tooltipPositionX!==s.horizontal||this.tooltipPositionY!==s.vertical){const n=0===this.position.indexOf("Bottom")||0===this.position.indexOf("Top")?s.vertical+s.horizontal:s.horizontal+s.vertical;s.position=n,this.adjustArrow(e.target,s.position,s.horizontal,s.vertical);const r=this.calculateTooltipOffset(s.position);s.left=t+r.left-this.offsetX,s.top=i+r.top-this.offsetY}this.tooltipEle.style.left=s.left+"px",this.tooltipEle.style.top=s.top+"px"}keyDown(e){this.tooltipEle&&27===e.keyCode&&this.close()}touchEnd(e){this.tooltipEle&&null===Hu(e.target,"."+Ty)&&!this.isSticky&&this.close()}scrollHandler(e){this.tooltipEle&&(Hu(e.target,".e-tooltip-wrap.e-lib.e-popup")||this.close())}render(){this.initialize(),this.wireEvents(this.opensOn),this.renderComplete()}preRender(){this.tipClass=My,this.tooltipPositionX="Center",this.tooltipPositionY="Top",this.isHidden=!0}wireEvents(e){const t=this.getTriggerList(e);for(const i of t){if("Custom"===i)return;"Focus"===i&&this.wireFocusEvents(),"Click"===i&&xu.add(this.element,wu.touchStartEvent,this.targetClick,this),"Hover"===i&&(wu.isDevice?(this.touchModule=new jg(this.element,{tapHoldThreshold:500,tapHold:this.tapHoldHandler.bind(this)}),xu.add(this.element,wu.touchEndEvent,this.touchEndHandler,this)):xu.add(this.element,"mouseover",this.targetHover,this))}xu.add(document,"touchend",this.touchEnd,this),xu.add(document,"scroll wheel",this.scrollHandler,this),xu.add(document,"keydown",this.keyDown,this)}getTriggerList(e){return"Auto"===e&&(e=wu.isDevice?"Hover":"Hover Focus"),e.split(" ")}wireFocusEvents(){if(jp(this.target))xu.add(this.element,"focus",this.targetHover,this);else{const e=[].slice.call(ku(this.target,this.element));for(const t of e)xu.add(t,"focus",this.targetHover,this)}}wireMouseEvents(e,t){this.tooltipEle&&(this.isSticky||("focus"===e.type&&xu.add(t,"blur",this.onMouseOut,this),"mouseover"===e.type&&xu.add(t,"mouseleave",this.onMouseOut,this),this.closeDelay&&(xu.add(this.tooltipEle,"mouseenter",this.tooltipHover,this),xu.add(this.tooltipEle,"mouseleave",this.tooltipMouseOut,this))),this.mouseTrail&&0===this.openDelay&&xu.add(t,"mousemove touchstart mouseenter",this.onMouseMove,this))}unwireEvents(e){const t=this.getTriggerList(e);for(const i of t){if("Custom"===i)return;"Focus"===i&&this.unwireFocusEvents(),"Click"===i&&xu.remove(this.element,wu.touchStartEvent,this.targetClick),"Hover"===i&&(wu.isDevice?(this.touchModule&&this.touchModule.destroy(),xu.remove(this.element,wu.touchEndEvent,this.touchEndHandler)):xu.remove(this.element,"mouseover",this.targetHover))}xu.remove(document,"touchend",this.touchEnd),xu.remove(document,"scroll wheel",this.scrollHandler),xu.remove(document,"keydown",this.keyDown)}unwireFocusEvents(){if(jp(this.target))xu.remove(this.element,"focus",this.targetHover);else{const e=[].slice.call(ku(this.target,this.element));for(const t of e)xu.remove(t,"focus",this.targetHover)}}unwireMouseEvents(e){if(!this.isSticky){const t=this.getTriggerList(this.opensOn);for(const i of t)"Focus"===i&&xu.remove(e,"blur",this.onMouseOut),"Hover"!==i||wu.isDevice||xu.remove(e,"mouseleave",this.onMouseOut);this.closeDelay&&(xu.remove(e,"mouseenter",this.tooltipHover),xu.remove(e,"mouseleave",this.tooltipMouseOut))}this.mouseTrail&&xu.remove(e,"mousemove touchstart mouseenter",this.onMouseMove)}findTarget(){return Lu('[data-tooltip-id= "'+this.ctrlId+'_content"]',document)}getModuleName(){return"tooltip"}getPersistData(){return this.addOnPersist([])}onPropertyChanged(e,t){const i=this.findTarget();for(const n of Object.keys(e))switch(n){case"width":this.tooltipEle&&i&&(this.tooltipEle.style.width=this.tooltipEle.style.maxWidth=Wp(e.width),this.reposition(i));break;case"height":this.tooltipEle&&i&&(this.tooltipEle.style.height=Wp(e.height),this.reposition(i));break;case"content":this.tooltipEle&&this.renderContent();break;case"opensOn":this.unwireEvents(t.opensOn),this.wireEvents(e.opensOn);break;case"position":if(this.formatPosition(),this.tooltipEle&&i){const e=Lu("."+Dy,this.tooltipEle);e.style.top=e.style.left=null,this.reposition(i)}break;case"tipPointerPosition":this.tooltipEle&&i&&this.reposition(i);break;case"offsetX":if(this.tooltipEle){const i=e.offsetX-t.offsetX;this.tooltipEle.style.left=(parseInt(this.tooltipEle.style.left,10)+i).toString()+"px"}break;case"offsetY":if(this.tooltipEle){const i=e.offsetY-t.offsetY;this.tooltipEle.style.top=(parseInt(this.tooltipEle.style.top,10)+i).toString()+"px"}break;case"cssClass":this.tooltipEle&&(t.cssClass&&Ou([this.tooltipEle],t.cssClass.split(" ")),e.cssClass&&Pu([this.tooltipEle],e.cssClass.split(" ")));break;case"enableRtl":this.tooltipEle&&(this.enableRtl?Pu([this.tooltipEle],Ey):Ou([this.tooltipEle],Ey))}}open(e,t){jp(t)&&(t=this.animation.open),jp(e)&&(e=this.element),"none"!==e.style.display&&this.showTooltip(e,t)}close(e){e||(e=this.animation.close),this.hideTooltip(e)}refresh(e){this.tooltipEle&&this.renderContent(e),this.popupObj&&e&&this.reposition(e)}destroy(){super.destroy(),this.tooltipEle&&Ru(this.tooltipEle),this.popupObj&&this.popupObj.destroy(),Ou([this.element],Ty),this.unwireEvents(this.opensOn),this.unwireMouseEvents(this.element),this.tooltipEle=null,this.popupObj=null}};return Oy([ig("auto")],e.prototype,"width",void 0),Oy([ig("auto")],e.prototype,"height",void 0),Oy([ig()],e.prototype,"content",void 0),Oy([ig()],e.prototype,"target",void 0),Oy([ig("TopCenter")],e.prototype,"position",void 0),Oy([ig(0)],e.prototype,"offsetX",void 0),Oy([ig(0)],e.prototype,"offsetY",void 0),Oy([ig(!0)],e.prototype,"showTipPointer",void 0),Oy([ig(!0)],e.prototype,"enableHtmlParse",void 0),Oy([ig(!1)],e.prototype,"windowCollision",void 0),Oy([ig("Auto")],e.prototype,"tipPointerPosition",void 0),Oy([ig("Auto")],e.prototype,"opensOn",void 0),Oy([ig(!1)],e.prototype,"mouseTrail",void 0),Oy([ig(!1)],e.prototype,"isSticky",void 0),Oy([ng({},Hy)],e.prototype,"animation",void 0),Oy([ig(0)],e.prototype,"openDelay",void 0),Oy([ig(0)],e.prototype,"closeDelay",void 0),Oy([ig()],e.prototype,"cssClass",void 0),Oy([ig(!1)],e.prototype,"enableHtmlSanitizer",void 0),Oy([og()],e.prototype,"beforeRender",void 0),Oy([og()],e.prototype,"beforeOpen",void 0),Oy([og()],e.prototype,"afterOpen",void 0),Oy([og()],e.prototype,"beforeClose",void 0),Oy([og()],e.prototype,"afterClose",void 0),Oy([og()],e.prototype,"beforeCollision",void 0),Oy([og()],e.prototype,"created",void 0),Oy([og()],e.prototype,"destroyed",void 0),e=Oy([ag],e),e})();class Ny{constructor(e){return this.subQuery=null,this.isChild=!1,this.distincts=[],this.queries=[],this.key="",this.fKey="","string"==typeof e?this.fromTable=e:e&&e instanceof Array&&(this.lookups=e),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this.lazyLoad=[],this}setKey(e){return this.key=e,this}using(e){return this.dataManager=e,this}execute(e,t,i,n){return(e=e||this.dataManager)?e.executeQuery(this,t,i,n):Uy.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')}executeLocal(e){return(e=e||this.dataManager)?e.executeLocal(this):Uy.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')}clone(){let e=new Ny;return e.queries=this.queries.slice(0),e.key=this.key,e.isChild=this.isChild,e.dataManager=this.dataManager,e.fromTable=this.fromTable,e.params=this.params.slice(0),e.expands=this.expands.slice(0),e.sortedColumns=this.sortedColumns.slice(0),e.groupedColumns=this.groupedColumns.slice(0),e.subQuerySelector=this.subQuerySelector,e.subQuery=this.subQuery,e.fKey=this.fKey,e.isCountRequired=this.isCountRequired,e.distincts=this.distincts.slice(0),e.lazyLoad=this.lazyLoad.slice(0),e}from(e){return this.fromTable=e,this}addParams(e,t){return this.params.push("function"==typeof t?{key:e,fn:t}:{key:e,value:t}),this}distinct(e){return this.distincts="string"==typeof e?[].slice.call([e],0):e.slice(0),this}expand(e){return this.expands="string"==typeof e?[].slice.call([e],0):e.slice(0),this}where(e,t,i,n,s){t=t?t.toLowerCase():null;let r=null;return"string"==typeof e?r=new By(e,t,i,n,s):e instanceof By&&(r=e),this.queries.push({fn:"onWhere",e:r}),this}search(e,t,i,n,s){return"string"==typeof t&&(t=[t]),i&&"none"!==i||(i="contains"),this.queries.push({fn:"onSearch",e:{fieldNames:t,operator:i,searchKey:e,ignoreCase:n,ignoreAccent:s,comparer:Uy.fnOperators[i]}}),this}sortBy(e,t,i){return this.sortByForeignKey(e,t,i)}sortByForeignKey(e,t,i,n){let s,r,o=jp(n)?"ascending":n;if("string"==typeof e&&Uy.endsWith(e.toLowerCase()," desc")&&(e=e.replace(/ desc$/i,""),t="descending"),t&&"string"!=typeof t||(o=t?t.toLowerCase():"ascending",t=Uy.fnSort(t)),i){s=Ny.filterQueries(this.queries,"onSortBy");for(let t=0;t<s.length;t++)if(r=s[t].e.fieldName,"string"==typeof r){if(r===e)return this}else if(r instanceof Array)for(let i=0;i<r.length;i++)if(r[i]===e||e.toLowerCase()===r[i]+" desc")return this}return this.queries.push({fn:"onSortBy",e:{fieldName:e,comparer:t,direction:o}}),this}sortByDesc(e){return this.sortBy(e,"descending")}group(e,t,i){return this.sortBy(e,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:e,comparer:t||null,format:i||null}}),this}page(e,t){return this.queries.push({fn:"onPage",e:{pageIndex:e,pageSize:t}}),this}range(e,t){return this.queries.push({fn:"onRange",e:{start:e,end:t}}),this}take(e){return this.queries.push({fn:"onTake",e:{nos:e}}),this}skip(e){return this.queries.push({fn:"onSkip",e:{nos:e}}),this}select(e){return"string"==typeof e&&(e=[].slice.call([e],0)),this.queries.push({fn:"onSelect",e:{fieldNames:e}}),this}hierarchy(e,t){return this.subQuerySelector=t,this.subQuery=e,this}foreignKey(e){return this.fKey=e,this}requiresCount(){return this.isCountRequired=!0,this}aggregate(e,t){return this.queries.push({fn:"onAggregates",e:{field:t,type:e}}),this}static filterQueries(e,t){return e.filter(e=>e.fn===t)}static filterQueryLists(e,t){let i=e.filter(e=>-1!==t.indexOf(e.fn)),n={};for(let s=0;s<i.length;s++)n[i[s].fn]||(n[i[s].fn]=i[s].e);return n}}class By{constructor(e,t,i,n=!1,s){return this.ignoreAccent=!1,this.isComplex=!1,"string"==typeof e?(this.field=e,this.operator=t.toLowerCase(),this.value=i,this.ignoreCase=n,this.ignoreAccent=s,this.isComplex=!1,this.comparer=Uy.fnOperators.processOperator(this.operator)):(e instanceof By&&i instanceof By||i instanceof Array)&&(this.isComplex=!0,this.condition=t.toLowerCase(),this.predicates=[e],i instanceof Array?[].push.apply(this.predicates,i):this.predicates.push(i)),this}static and(...e){return By.combinePredicates([].slice.call(e,0),"and")}and(e,t,i,n,s){return By.combine(this,e,t,i,"and",n,s)}static or(...e){return By.combinePredicates([].slice.call(e,0),"or")}or(e,t,i,n,s){return By.combine(this,e,t,i,"or",n,s)}static fromJson(e){if(e instanceof Array){let t=[];for(let i=0,n=e.length;i<n;i++)t.push(this.fromJSONData(e[i]));return t}return this.fromJSONData(e)}validate(e){let t,i,n=this.predicates?this.predicates:[];if(!this.isComplex&&this.comparer)return this.comparer.call(this,Uy.getObject(this.field,e),this.value,this.ignoreCase,this.ignoreAccent);t="and"===this.condition;for(let s=0;s<n.length;s++)if(i=n[s].validate(e),t){if(!i)return!1}else if(i)return!0;return t}toJson(){let e,t;if(this.isComplex){e=[],t=this.predicates;for(let i=0;i<t.length;i++)e.push(t[i].toJson())}return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:e}}static combinePredicates(e,t){if(1===e.length){if(!(e[0]instanceof Array))return e[0];e=e[0]}return new By(e[0],t,e.slice(1))}static combine(e,t,i,n,s,r,o){return t instanceof By?By[s](e,t):"string"==typeof t?By[s](e,new By(t,i,n,r,o)):Uy.throwError("Predicate - "+s+" : invalid arguments")}static fromJSONData(e){let t,i=e.predicates||[],n=i.length,s=[];for(let r=0;r<n;r++)s.push(this.fromJSONData(i[r]));return t=e.isComplex?new By(s[0],e.condition,s.slice(1)):new By(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent),t}}const Wy={GroupGuid:"{271bbba0-1ee7}"};let Uy=(()=>{class e{static getValue(e,t){return"function"==typeof e?e.call(t||{}):e}static endsWith(e,t){return e.slice&&e.slice(-t.length)===t}static startsWith(e,t){return e.slice(0,t.length)===t}static fnSort(t){return"ascending"===(t=t?e.toLowerCase(t):"ascending")?this.fnAscending:this.fnDescending}static fnAscending(e,t){return jp(e)&&jp(t)||null==t?-1:"string"==typeof e?e.localeCompare(t):null==e?1:e-t}static fnDescending(e,t){return jp(e)&&jp(t)?-1:null==t?1:"string"==typeof e?-1*e.localeCompare(t):null==e?-1:t-e}static extractFields(e,t){let i={};for(let n=0;n<t.length;n++)i=this.setValue(t[n],this.getObject(t[n],e),i);return i}static select(e,t){let i=[];for(let n=0;n<e.length;n++)i.push(this.extractFields(e[n],t));return i}static group(t,i,n,s,r,o,a){s=s||1;let l=t,h="GroupGuid";if(l.GroupGuid===Wy[h]){for(let e=0;e<l.length;e++)if(jp(r))l[e].items=this.group(l[e].items,i,n,l.level+1,null,o,a),l[e].count=l[e].items.length;else{let t=-1,s=r.filter(t=>t.key===l[e].key);t=r.indexOf(s[0]),l[e].items=this.group(l[e].items,i,n,l.level+1,r[t].items,o,a),l[e].count=r[t].count}return l.childLevels+=1,l}let c={},d=[];d.GroupGuid=Wy[h],d.level=s,d.childLevels=0,d.records=l;for(let e=0;e<l.length;e++){let t=this.getVal(l,e,i);if(jp(o)||(t=o(t,i)),!c[t]&&(c[t]={key:t,count:0,items:[],aggregates:{},field:i},d.push(c[t]),!jp(r))){let e=r.filter(e=>e.key===c[t].key);c[t].count=e[0].count}c[t].count=jp(r)?c[t].count+=1:c[t].count,(!a||a&&n.length)&&c[t].items.push(l[e])}if(n&&n.length)for(let p=0;p<d.length;p++){let t,i={},s=n;for(let o=0;o<n.length;o++)if(t=e.aggregates[n[o].type],jp(r))t&&(i[s[o].field+" - "+s[o].type]=t(d[p].items,s[o].field));else{let e=r.filter(e=>e.key===d[p].key);t&&(i[s[o].field+" - "+s[o].type]=t(e[0].items,s[o].field))}d[p].aggregates=i}if(a&&d.length&&n.length)for(let e=0;e<d.length;e++)d[e].items=[];return l.length&&d||l}static buildHierarchy(e,t,i,n,s){let r,o,a={};for(n.result&&(n=n.result),n.GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),r=0;r<n.length;r++){let t=this.getObject(e,n[r]);o=a[t]||(a[t]=[]),o.push(n[r])}for(r=0;r<i.length;r++){let n=this.getObject(s||e,i[r]);i[r][t]=a[n]}}static getFieldList(e,t,i){if(void 0===i&&(i=""),null==t)return this.getFieldList(e,[],i);let n=e,s=Object.keys(e);for(let r of s)"object"!=typeof n[r]||n[r]instanceof Array?t.push(i+r):this.getFieldList(n[r],t,i+r+".");return t}static getObject(e,t){if(!e)return t;if(!t)return;if(-1===e.indexOf("."))return t[e];let i=t,n=e.split(".");for(let s=0;s<n.length&&null!=i;s++)i=i[n[s]];return i}static setValue(e,t,i){let n,s,r=e.toString().split("."),o=i||{},a=o,l=r.length;for(n=0;n<l;n++)s=r[n],n+1===l?a[s]=void 0===t?void 0:t:jp(a[s])&&(a[s]={}),a=a[s];return o}static sort(e,t,i){if(e.length<=1)return e;let n=parseInt((e.length/2).toString(),10),s=e.slice(0,n),r=e.slice(n);return s=this.sort(s,t,i),r=this.sort(r,t,i),this.merge(s,r,t,i)}static ignoreDiacritics(t){return"string"!=typeof t?t:t.split("").map(t=>t in e.diacritics?e.diacritics[t]:t).join("")}static merge(e,t,i,n){let s,r=[];for(;e.length>0||t.length>0;)s=e.length>0&&t.length>0?n?n(this.getVal(e,0,i),this.getVal(t,0,i),e[0],t[0])<=0?e:t:e[0][i]<e[0][i]?e:t:e.length>0?e:t,r.push(s.shift());return r}static getVal(e,t,i){return i?this.getObject(i,e[t]):e[t]}static toLowerCase(e){return e?"string"==typeof e?e.toLowerCase():e.toString():0===e||!1===e?e.toString():""}static callAdaptorFunction(e,t,i,n){if(t in e){let s=e[t](i,n);jp(s)||(i=s)}return i}static getAddParams(t,i,n){let s={};return e.callAdaptorFunction(t,"addParams",{dm:i,query:n,params:n.params,reqParams:s}),s}static isPlainObject(e){return!!e&&e.constructor===Object}static isCors(){let e=null;try{e=new window.XMLHttpRequest}catch(t){}return!!e&&"withCredentials"in e}static getGuid(e){let t;return(e||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,(e,i)=>{if("crypto"in window&&"getRandomValues"in crypto){let e=new Uint8Array(1);window.crypto.getRandomValues(e),t=e[0]%16|0}else t=16*Math.random()|0;return"0123456789abcdef"[19===i?3&t|8:t]})}static isNull(e){return null==e}static getItemFromComparer(t,i,n){let s,r,o,a=0,l="string"==typeof e.getVal(t,0,i);if(t.length)for(;jp(s)&&a<t.length;)s=e.getVal(t,a,i),o=t[a++];for(;a<t.length;a++)r=e.getVal(t,a,i),jp(r)||(l&&(s=+s,r=+r),n(s,r)>0&&(s=r,o=t[a]));return o}static distinct(t,i,n){n=!jp(n)&&n;let s,r=[],o={};return t.forEach((a,l)=>{s="object"==typeof t[l]?e.getVal(t,l,i):t[l],s in o||(r.push(n?t[l]:s),o[s]=1)}),r}static processData(e,t){let i=this.prepareQuery(e),n=new Qy(t);e.requiresCounts&&i.requiresCount();let s=n.executeLocal(i),r={result:e.requiresCounts?s.result:s,count:s.count,aggregates:JSON.stringify(s.aggregates)};return e.requiresCounts?r:s}static prepareQuery(t){let i=new Ny;return t.select&&i.select(t.select),t.where&&e.parse.parseJson(t.where).filter(e=>{if(jp(e.condition))i.where(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent);else{let t=[];e.field?t.push(new By(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent)):t=t.concat(this.getPredicate(e.predicates)),"or"==e.condition?i.where(By.or(t)):"and"==e.condition&&i.where(By.and(t))}}),t.search&&e.parse.parseJson(t.search).filter(e=>i.search(e.key,e.fields,e.operator,e.ignoreCase,e.ignoreAccent)),t.aggregates&&t.aggregates.filter(e=>i.aggregate(e.type,e.field)),t.sorted&&t.sorted.filter(e=>i.sortBy(e.name,e.direction)),t.skip&&i.skip(t.skip),t.take&&i.take(t.take),t.group&&t.group.filter(e=>i.group(e)),i}static getPredicate(e){let t=[];for(let i=0;i<e.length;i++){let n=e[i];if(n.field)t.push(new By(n.field,n.operator,n.value,n.ignoreCase,n.ignoreAccent));else{let e=[],i=this.getPredicate(n.predicates);for(const t of Object.keys(i))e.push(i[t]);t.push("or"==n.condition?By.or(e):By.and(e))}}return t}}return e.serverTimezoneOffset=null,e.timeZoneHandling=!0,e.throwError=e=>{try{throw new Error(e)}catch(t){throw t.message+"\n"+t.stack}},e.aggregates={sum:(t,i)=>{let n,s=0,r="number"!=typeof e.getVal(t,0,i);for(let o=0;o<t.length;o++)n=e.getVal(t,o,i),isNaN(n)||null===n||(r&&(n=+n),s+=n);return s},average:(t,i)=>e.aggregates.sum(t,i)/t.length,min:(t,i)=>{let n;return"function"==typeof i&&(n=i,i=null),e.getObject(i,e.getItemFromComparer(t,i,n||e.fnAscending))},max:(t,i)=>{let n;return"function"==typeof i&&(n=i,i=null),e.getObject(i,e.getItemFromComparer(t,i,n||e.fnDescending))},truecount:(e,t)=>new Qy(e).executeLocal((new Ny).where(t,"equal",!0,!0)).length,falsecount:(e,t)=>new Qy(e).executeLocal((new Ny).where(t,"equal",!1,!0)).length,count:(e,t)=>e.length},e.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},e.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},e.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof"},e.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains"},e.diacritics={"\u24b6":"A","\uff21":"A","\xc0":"A","\xc1":"A","\xc2":"A","\u1ea6":"A","\u1ea4":"A","\u1eaa":"A","\u1ea8":"A","\xc3":"A","\u0100":"A","\u0102":"A","\u1eb0":"A","\u1eae":"A","\u1eb4":"A","\u1eb2":"A","\u0226":"A","\u01e0":"A","\xc4":"A","\u01de":"A","\u1ea2":"A","\xc5":"A","\u01fa":"A","\u01cd":"A","\u0200":"A","\u0202":"A","\u1ea0":"A","\u1eac":"A","\u1eb6":"A","\u1e00":"A","\u0104":"A","\u023a":"A","\u2c6f":"A","\ua732":"AA","\xc6":"AE","\u01fc":"AE","\u01e2":"AE","\ua734":"AO","\ua736":"AU","\ua738":"AV","\ua73a":"AV","\ua73c":"AY","\u24b7":"B","\uff22":"B","\u1e02":"B","\u1e04":"B","\u1e06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24b8":"C","\uff23":"C","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\xc7":"C","\u1e08":"C","\u0187":"C","\u023b":"C","\ua73e":"C","\u24b9":"D","\uff24":"D","\u1e0a":"D","\u010e":"D","\u1e0c":"D","\u1e10":"D","\u1e12":"D","\u1e0e":"D","\u0110":"D","\u018b":"D","\u018a":"D","\u0189":"D","\ua779":"D","\u01f1":"DZ","\u01c4":"DZ","\u01f2":"Dz","\u01c5":"Dz","\u24ba":"E","\uff25":"E","\xc8":"E","\xc9":"E","\xca":"E","\u1ec0":"E","\u1ebe":"E","\u1ec4":"E","\u1ec2":"E","\u1ebc":"E","\u0112":"E","\u1e14":"E","\u1e16":"E","\u0114":"E","\u0116":"E","\xcb":"E","\u1eba":"E","\u011a":"E","\u0204":"E","\u0206":"E","\u1eb8":"E","\u1ec6":"E","\u0228":"E","\u1e1c":"E","\u0118":"E","\u1e18":"E","\u1e1a":"E","\u0190":"E","\u018e":"E","\u24bb":"F","\uff26":"F","\u1e1e":"F","\u0191":"F","\ua77b":"F","\u24bc":"G","\uff27":"G","\u01f4":"G","\u011c":"G","\u1e20":"G","\u011e":"G","\u0120":"G","\u01e6":"G","\u0122":"G","\u01e4":"G","\u0193":"G","\ua7a0":"G","\ua77d":"G","\ua77e":"G","\u24bd":"H","\uff28":"H","\u0124":"H","\u1e22":"H","\u1e26":"H","\u021e":"H","\u1e24":"H","\u1e28":"H","\u1e2a":"H","\u0126":"H","\u2c67":"H","\u2c75":"H","\ua78d":"H","\u24be":"I","\uff29":"I","\xcc":"I","\xcd":"I","\xce":"I","\u0128":"I","\u012a":"I","\u012c":"I","\u0130":"I","\xcf":"I","\u1e2e":"I","\u1ec8":"I","\u01cf":"I","\u0208":"I","\u020a":"I","\u1eca":"I","\u012e":"I","\u1e2c":"I","\u0197":"I","\u24bf":"J","\uff2a":"J","\u0134":"J","\u0248":"J","\u24c0":"K","\uff2b":"K","\u1e30":"K","\u01e8":"K","\u1e32":"K","\u0136":"K","\u1e34":"K","\u0198":"K","\u2c69":"K","\ua740":"K","\ua742":"K","\ua744":"K","\ua7a2":"K","\u24c1":"L","\uff2c":"L","\u013f":"L","\u0139":"L","\u013d":"L","\u1e36":"L","\u1e38":"L","\u013b":"L","\u1e3c":"L","\u1e3a":"L","\u0141":"L","\u023d":"L","\u2c62":"L","\u2c60":"L","\ua748":"L","\ua746":"L","\ua780":"L","\u01c7":"LJ","\u01c8":"Lj","\u24c2":"M","\uff2d":"M","\u1e3e":"M","\u1e40":"M","\u1e42":"M","\u2c6e":"M","\u019c":"M","\u24c3":"N","\uff2e":"N","\u01f8":"N","\u0143":"N","\xd1":"N","\u1e44":"N","\u0147":"N","\u1e46":"N","\u0145":"N","\u1e4a":"N","\u1e48":"N","\u0220":"N","\u019d":"N","\ua790":"N","\ua7a4":"N","\u01ca":"NJ","\u01cb":"Nj","\u24c4":"O","\uff2f":"O","\xd2":"O","\xd3":"O","\xd4":"O","\u1ed2":"O","\u1ed0":"O","\u1ed6":"O","\u1ed4":"O","\xd5":"O","\u1e4c":"O","\u022c":"O","\u1e4e":"O","\u014c":"O","\u1e50":"O","\u1e52":"O","\u014e":"O","\u022e":"O","\u0230":"O","\xd6":"O","\u022a":"O","\u1ece":"O","\u0150":"O","\u01d1":"O","\u020c":"O","\u020e":"O","\u01a0":"O","\u1edc":"O","\u1eda":"O","\u1ee0":"O","\u1ede":"O","\u1ee2":"O","\u1ecc":"O","\u1ed8":"O","\u01ea":"O","\u01ec":"O","\xd8":"O","\u01fe":"O","\u0186":"O","\u019f":"O","\ua74a":"O","\ua74c":"O","\u01a2":"OI","\ua74e":"OO","\u0222":"OU","\u24c5":"P","\uff30":"P","\u1e54":"P","\u1e56":"P","\u01a4":"P","\u2c63":"P","\ua750":"P","\ua752":"P","\ua754":"P","\u24c6":"Q","\uff31":"Q","\ua756":"Q","\ua758":"Q","\u024a":"Q","\u24c7":"R","\uff32":"R","\u0154":"R","\u1e58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1e5a":"R","\u1e5c":"R","\u0156":"R","\u1e5e":"R","\u024c":"R","\u2c64":"R","\ua75a":"R","\ua7a6":"R","\ua782":"R","\u24c8":"S","\uff33":"S","\u1e9e":"S","\u015a":"S","\u1e64":"S","\u015c":"S","\u1e60":"S","\u0160":"S","\u1e66":"S","\u1e62":"S","\u1e68":"S","\u0218":"S","\u015e":"S","\u2c7e":"S","\ua7a8":"S","\ua784":"S","\u24c9":"T","\uff34":"T","\u1e6a":"T","\u0164":"T","\u1e6c":"T","\u021a":"T","\u0162":"T","\u1e70":"T","\u1e6e":"T","\u0166":"T","\u01ac":"T","\u01ae":"T","\u023e":"T","\ua786":"T","\ua728":"TZ","\u24ca":"U","\uff35":"U","\xd9":"U","\xda":"U","\xdb":"U","\u0168":"U","\u1e78":"U","\u016a":"U","\u1e7a":"U","\u016c":"U","\xdc":"U","\u01db":"U","\u01d7":"U","\u01d5":"U","\u01d9":"U","\u1ee6":"U","\u016e":"U","\u0170":"U","\u01d3":"U","\u0214":"U","\u0216":"U","\u01af":"U","\u1eea":"U","\u1ee8":"U","\u1eee":"U","\u1eec":"U","\u1ef0":"U","\u1ee4":"U","\u1e72":"U","\u0172":"U","\u1e76":"U","\u1e74":"U","\u0244":"U","\u24cb":"V","\uff36":"V","\u1e7c":"V","\u1e7e":"V","\u01b2":"V","\ua75e":"V","\u0245":"V","\ua760":"VY","\u24cc":"W","\uff37":"W","\u1e80":"W","\u1e82":"W","\u0174":"W","\u1e86":"W","\u1e84":"W","\u1e88":"W","\u2c72":"W","\u24cd":"X","\uff38":"X","\u1e8a":"X","\u1e8c":"X","\u24ce":"Y","\uff39":"Y","\u1ef2":"Y","\xdd":"Y","\u0176":"Y","\u1ef8":"Y","\u0232":"Y","\u1e8e":"Y","\u0178":"Y","\u1ef6":"Y","\u1ef4":"Y","\u01b3":"Y","\u024e":"Y","\u1efe":"Y","\u24cf":"Z","\uff3a":"Z","\u0179":"Z","\u1e90":"Z","\u017b":"Z","\u017d":"Z","\u1e92":"Z","\u1e94":"Z","\u01b5":"Z","\u0224":"Z","\u2c7f":"Z","\u2c6b":"Z","\ua762":"Z","\u24d0":"a","\uff41":"a","\u1e9a":"a","\xe0":"a","\xe1":"a","\xe2":"a","\u1ea7":"a","\u1ea5":"a","\u1eab":"a","\u1ea9":"a","\xe3":"a","\u0101":"a","\u0103":"a","\u1eb1":"a","\u1eaf":"a","\u1eb5":"a","\u1eb3":"a","\u0227":"a","\u01e1":"a","\xe4":"a","\u01df":"a","\u1ea3":"a","\xe5":"a","\u01fb":"a","\u01ce":"a","\u0201":"a","\u0203":"a","\u1ea1":"a","\u1ead":"a","\u1eb7":"a","\u1e01":"a","\u0105":"a","\u2c65":"a","\u0250":"a","\ua733":"aa","\xe6":"ae","\u01fd":"ae","\u01e3":"ae","\ua735":"ao","\ua737":"au","\ua739":"av","\ua73b":"av","\ua73d":"ay","\u24d1":"b","\uff42":"b","\u1e03":"b","\u1e05":"b","\u1e07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24d2":"c","\uff43":"c","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\xe7":"c","\u1e09":"c","\u0188":"c","\u023c":"c","\ua73f":"c","\u2184":"c","\u24d3":"d","\uff44":"d","\u1e0b":"d","\u010f":"d","\u1e0d":"d","\u1e11":"d","\u1e13":"d","\u1e0f":"d","\u0111":"d","\u018c":"d","\u0256":"d","\u0257":"d","\ua77a":"d","\u01f3":"dz","\u01c6":"dz","\u24d4":"e","\uff45":"e","\xe8":"e","\xe9":"e","\xea":"e","\u1ec1":"e","\u1ebf":"e","\u1ec5":"e","\u1ec3":"e","\u1ebd":"e","\u0113":"e","\u1e15":"e","\u1e17":"e","\u0115":"e","\u0117":"e","\xeb":"e","\u1ebb":"e","\u011b":"e","\u0205":"e","\u0207":"e","\u1eb9":"e","\u1ec7":"e","\u0229":"e","\u1e1d":"e","\u0119":"e","\u1e19":"e","\u1e1b":"e","\u0247":"e","\u025b":"e","\u01dd":"e","\u24d5":"f","\uff46":"f","\u1e1f":"f","\u0192":"f","\ua77c":"f","\u24d6":"g","\uff47":"g","\u01f5":"g","\u011d":"g","\u1e21":"g","\u011f":"g","\u0121":"g","\u01e7":"g","\u0123":"g","\u01e5":"g","\u0260":"g","\ua7a1":"g","\u1d79":"g","\ua77f":"g","\u24d7":"h","\uff48":"h","\u0125":"h","\u1e23":"h","\u1e27":"h","\u021f":"h","\u1e25":"h","\u1e29":"h","\u1e2b":"h","\u1e96":"h","\u0127":"h","\u2c68":"h","\u2c76":"h","\u0265":"h","\u0195":"hv","\u24d8":"i","\uff49":"i","\xec":"i","\xed":"i","\xee":"i","\u0129":"i","\u012b":"i","\u012d":"i","\xef":"i","\u1e2f":"i","\u1ec9":"i","\u01d0":"i","\u0209":"i","\u020b":"i","\u1ecb":"i","\u012f":"i","\u1e2d":"i","\u0268":"i","\u0131":"i","\u24d9":"j","\uff4a":"j","\u0135":"j","\u01f0":"j","\u0249":"j","\u24da":"k","\uff4b":"k","\u1e31":"k","\u01e9":"k","\u1e33":"k","\u0137":"k","\u1e35":"k","\u0199":"k","\u2c6a":"k","\ua741":"k","\ua743":"k","\ua745":"k","\ua7a3":"k","\u24db":"l","\uff4c":"l","\u0140":"l","\u013a":"l","\u013e":"l","\u1e37":"l","\u1e39":"l","\u013c":"l","\u1e3d":"l","\u1e3b":"l","\u017f":"l","\u0142":"l","\u019a":"l","\u026b":"l","\u2c61":"l","\ua749":"l","\ua781":"l","\ua747":"l","\u01c9":"lj","\u24dc":"m","\uff4d":"m","\u1e3f":"m","\u1e41":"m","\u1e43":"m","\u0271":"m","\u026f":"m","\u24dd":"n","\uff4e":"n","\u01f9":"n","\u0144":"n","\xf1":"n","\u1e45":"n","\u0148":"n","\u1e47":"n","\u0146":"n","\u1e4b":"n","\u1e49":"n","\u019e":"n","\u0272":"n","\u0149":"n","\ua791":"n","\ua7a5":"n","\u01cc":"nj","\u24de":"o","\uff4f":"o","\xf2":"o","\xf3":"o","\xf4":"o","\u1ed3":"o","\u1ed1":"o","\u1ed7":"o","\u1ed5":"o","\xf5":"o","\u1e4d":"o","\u022d":"o","\u1e4f":"o","\u014d":"o","\u1e51":"o","\u1e53":"o","\u014f":"o","\u022f":"o","\u0231":"o","\xf6":"o","\u022b":"o","\u1ecf":"o","\u0151":"o","\u01d2":"o","\u020d":"o","\u020f":"o","\u01a1":"o","\u1edd":"o","\u1edb":"o","\u1ee1":"o","\u1edf":"o","\u1ee3":"o","\u1ecd":"o","\u1ed9":"o","\u01eb":"o","\u01ed":"o","\xf8":"o","\u01ff":"o","\u0254":"o","\ua74b":"o","\ua74d":"o","\u0275":"o","\u01a3":"oi","\u0223":"ou","\ua74f":"oo","\u24df":"p","\uff50":"p","\u1e55":"p","\u1e57":"p","\u01a5":"p","\u1d7d":"p","\ua751":"p","\ua753":"p","\ua755":"p","\u24e0":"q","\uff51":"q","\u024b":"q","\ua757":"q","\ua759":"q","\u24e1":"r","\uff52":"r","\u0155":"r","\u1e59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1e5b":"r","\u1e5d":"r","\u0157":"r","\u1e5f":"r","\u024d":"r","\u027d":"r","\ua75b":"r","\ua7a7":"r","\ua783":"r","\u24e2":"s","\uff53":"s","\xdf":"s","\u015b":"s","\u1e65":"s","\u015d":"s","\u1e61":"s","\u0161":"s","\u1e67":"s","\u1e63":"s","\u1e69":"s","\u0219":"s","\u015f":"s","\u023f":"s","\ua7a9":"s","\ua785":"s","\u1e9b":"s","\u24e3":"t","\uff54":"t","\u1e6b":"t","\u1e97":"t","\u0165":"t","\u1e6d":"t","\u021b":"t","\u0163":"t","\u1e71":"t","\u1e6f":"t","\u0167":"t","\u01ad":"t","\u0288":"t","\u2c66":"t","\ua787":"t","\ua729":"tz","\u24e4":"u","\uff55":"u","\xf9":"u","\xfa":"u","\xfb":"u","\u0169":"u","\u1e79":"u","\u016b":"u","\u1e7b":"u","\u016d":"u","\xfc":"u","\u01dc":"u","\u01d8":"u","\u01d6":"u","\u01da":"u","\u1ee7":"u","\u016f":"u","\u0171":"u","\u01d4":"u","\u0215":"u","\u0217":"u","\u01b0":"u","\u1eeb":"u","\u1ee9":"u","\u1eef":"u","\u1eed":"u","\u1ef1":"u","\u1ee5":"u","\u1e73":"u","\u0173":"u","\u1e77":"u","\u1e75":"u","\u0289":"u","\u24e5":"v","\uff56":"v","\u1e7d":"v","\u1e7f":"v","\u028b":"v","\ua75f":"v","\u028c":"v","\ua761":"vy","\u24e6":"w","\uff57":"w","\u1e81":"w","\u1e83":"w","\u0175":"w","\u1e87":"w","\u1e85":"w","\u1e98":"w","\u1e89":"w","\u2c73":"w","\u24e7":"x","\uff58":"x","\u1e8b":"x","\u1e8d":"x","\u24e8":"y","\uff59":"y","\u1ef3":"y","\xfd":"y","\u0177":"y","\u1ef9":"y","\u0233":"y","\u1e8f":"y","\xff":"y","\u1ef7":"y","\u1e99":"y","\u1ef5":"y","\u01b4":"y","\u024f":"y","\u1eff":"y","\u24e9":"z","\uff5a":"z","\u017a":"z","\u1e91":"z","\u017c":"z","\u017e":"z","\u1e93":"z","\u1e95":"z","\u01b6":"z","\u0225":"z","\u0240":"z","\u2c6c":"z","\ua763":"z","\u0386":"\u0391","\u0388":"\u0395","\u0389":"\u0397","\u038a":"\u0399","\u03aa":"\u0399","\u038c":"\u039f","\u038e":"\u03a5","\u03ab":"\u03a5","\u038f":"\u03a9","\u03ac":"\u03b1","\u03ad":"\u03b5","\u03ae":"\u03b7","\u03af":"\u03b9","\u03ca":"\u03b9","\u0390":"\u03b9","\u03cc":"\u03bf","\u03cd":"\u03c5","\u03cb":"\u03c5","\u03b0":"\u03c5","\u03c9":"\u03c9","\u03c2":"\u03c3"},e.fnOperators={equal:(t,i,n,s)=>(s&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),n?e.toLowerCase(t)===e.toLowerCase(i):t===i),notequal:(t,i,n,s)=>(s&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),!e.fnOperators.equal(t,i,n)),lessthan:(t,i,n)=>n?e.toLowerCase(t)<e.toLowerCase(i):(jp(t)&&(t=void 0),t<i),greaterthan:(t,i,n)=>n?e.toLowerCase(t)>e.toLowerCase(i):t>i,lessthanorequal:(t,i,n)=>n?e.toLowerCase(t)<=e.toLowerCase(i):t<=i,greaterthanorequal:(t,i,n)=>n?e.toLowerCase(t)>=e.toLowerCase(i):t>=i,contains:(t,i,n,s)=>(s&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),n?!jp(t)&&!jp(i)&&-1!==e.toLowerCase(t).indexOf(e.toLowerCase(i)):!jp(t)&&!jp(i)&&-1!==t.toString().indexOf(i)),notnull:e=>null!==e,isnull:e=>null===e,startswith:(t,i,n,s)=>(s&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),n?t&&i&&e.startsWith(e.toLowerCase(t),e.toLowerCase(i)):t&&i&&e.startsWith(t,i)),endswith:(t,i,n,s)=>(s&&(t=e.ignoreDiacritics(t),i=e.ignoreDiacritics(i)),n?t&&i&&e.endsWith(e.toLowerCase(t),e.toLowerCase(i)):t&&i&&e.endsWith(t,i)),processSymbols:t=>{let i=e.operatorSymbols[t];return i?e.fnOperators[i]:e.throwError("Query - Process Operator : Invalid operator")},processOperator:t=>e.fnOperators[t]||e.fnOperators.processSymbols(t)},e.parse={parseJson:t=>("string"==typeof t?t=JSON.parse(t,e.parse.jsonReviver):t instanceof Array?e.parse.iterateAndReviveArray(t):"object"==typeof t&&null!==t&&e.parse.iterateAndReviveJson(t),t),iterateAndReviveArray:t=>{for(let i=0;i<t.length;i++)"object"==typeof t[i]&&null!==t[i]?e.parse.iterateAndReviveJson(t[i]):t[i]="string"!=typeof t[i]||/^[\s]*\[|^[\s]*\{(.)+:|\"/g.test(t[i])?e.parse.parseJson(t[i]):e.parse.jsonReviver("",t[i])},iterateAndReviveJson:t=>{let i,n=Object.keys(t);for(let s of n)e.startsWith(s,"__")||(i=t[s],"object"==typeof i?i instanceof Array?e.parse.iterateAndReviveArray(i):i&&e.parse.iterateAndReviveJson(i):t[s]=e.parse.jsonReviver(t[s],i))},jsonReviver:(t,i)=>{if("string"==typeof i){let t=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(i),n=e.timeZoneHandling?e.serverTimezoneOffset:null;if(t)return e.dateParse.toTimeZone(new Date(parseInt(t[1],10)),n,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(i)){let t=i.indexOf("Z")>-1||i.indexOf("z")>-1,n=i.split(/[^0-9.]/);if(t)i=e.dateParse.toTimeZone(new Date(parseInt(n[0],10),parseInt(n[1],10)-1,parseInt(n[2],10),parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10)),e.serverTimezoneOffset,!1);else{let t=new Date(parseInt(n[0],10),parseInt(n[1],10)-1,parseInt(n[2],10),parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10)),s=parseInt(n[6],10),r=parseInt(n[7],10);if(isNaN(s)&&isNaN(r))return t;i.indexOf("+")>-1?t.setHours(t.getHours()-s,t.getMinutes()-r):t.setHours(t.getHours()+s,t.getMinutes()+r),i=e.dateParse.toTimeZone(t,e.serverTimezoneOffset,!1)}null==e.serverTimezoneOffset&&(i=e.dateParse.addSelfOffset(i))}}return i},isJson:t=>"string"==typeof t[0]?t:e.parse.parseJson(t),isGuid:e=>null!=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i.exec(e),replacer:(t,i)=>e.isPlainObject(t)?e.parse.jsonReplacer(t,i):t instanceof Array?e.parse.arrayReplacer(t):t instanceof Date?e.parse.jsonReplacer({val:t},i).val:t,jsonReplacer:(t,i)=>{let n,s=Object.keys(t);for(let r of s){if(n=t[r],!(n instanceof Date))continue;let i=n;null==e.serverTimezoneOffset?t[r]=e.dateParse.toTimeZone(i,null).toJSON():(i=new Date(+i+36e5*e.serverTimezoneOffset),t[r]=e.dateParse.toTimeZone(e.dateParse.addSelfOffset(i),null).toJSON())}return t},arrayReplacer:t=>{for(let i=0;i<t.length;i++)e.isPlainObject(t[i])?t[i]=e.parse.jsonReplacer(t[i]):t[i]instanceof Date&&(t[i]=e.parse.jsonReplacer({date:t[i]}).date);return t},jsonDateReplacer:(t,i)=>{if("value"===t&&i){if("string"==typeof i){let t=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(i);if(t)i=e.dateParse.toTimeZone(new Date(parseInt(t[1],10)),null,!0);else if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(i)){let t=i.split(/[^0-9]/);i=e.dateParse.toTimeZone(new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10),parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10)),null,!0)}}if(i instanceof Date)return i=e.dateParse.addSelfOffset(i),null===e.serverTimezoneOffset?e.dateParse.toTimeZone(e.dateParse.addSelfOffset(i),null).toJSON():(i=e.dateParse.toTimeZone(i,i.getTimezoneOffset()/60*2-e.serverTimezoneOffset,!1)).toJSON()}return i}},e.dateParse={addSelfOffset:e=>new Date(+e-6e4*e.getTimezoneOffset()),toUTC:e=>new Date(+e+6e4*e.getTimezoneOffset()),toTimeZone:(t,i,n)=>{if(null===i)return t;let s=n?e.dateParse.toUTC(t):t;return new Date(+s-36e5*i)},toLocalTime:e=>{let t=e,i=-t.getTimezoneOffset(),n=i>=0?"+":"-",s=e=>{let t=Math.floor(Math.abs(e));return(t<10?"0":"")+t};return t.getFullYear()+"-"+s(t.getMonth()+1)+"-"+s(t.getDate())+"T"+s(t.getHours())+":"+s(t.getMinutes())+":"+s(t.getSeconds())+n+s(i/60)+":"+s(i%60)}},e})();const Fy={GroupGuid:"{271bbba0-1ee7}"};class Vy{constructor(e){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates",expand:"expand"},this.type=Vy,this.dataSource=e,this.pvt={}}processResponse(e,t,i,n){return e}}class Yy extends Vy{processQuery(e,t){let i,n,s,r=e.dataSource.json.slice(0),o=r.length,a=!0,l={},h=0,c=[];for(let p=0;p<t.lazyLoad.length;p++)h++,l[t.lazyLoad[p].key]=t.lazyLoad[p].value;let d={};for(let p=0;p<t.queries.length;p++)n=t.queries[p],"onPage"!==n.fn&&"onGroup"!==n.fn||!t.lazyLoad.length?(i=this[n.fn].call(this,r,n.e,t),"onAggregates"===n.fn?d[n.e.field+" - "+n.e.type]=i:r=void 0!==i?i:r,"onPage"!==n.fn&&"onSkip"!==n.fn&&"onTake"!==n.fn&&"onRange"!==n.fn||(a=!1),a&&(o=r.length)):("onGroup"===n.fn&&c.push(n.e),"onPage"===n.fn&&(s=n.e));if(h){let e=this.lazyLoadGroup({query:t,lazyLoad:l,result:r,group:c,page:s});r=e.result,o=e.count}return t.isCountRequired&&(r={result:r,count:o,aggregates:d}),r}lazyLoadGroup(e){let t=0,i=this.getAggregate(e.query),n=e.result;if(jp(e.lazyLoad.onDemandGroupInfo)){n=Uy.group(n,e.group[0].fieldName,i,null,null,e.group[0].comparer,!0),t=n.length;let s=n;e.page&&(n=this.onPage(n,e.page,e.query)),this.formGroupResult(n,s)}else{let s=e.lazyLoad.onDemandGroupInfo;for(let e=s.where.length-1;e>=0;e--)n=this.onWhere(n,s.where[e]);e.group.length!==s.level&&(n=Uy.group(n,e.group[s.level].fieldName,i,null,null,e.group[0].comparer,!0)),t=n.length;let r=n;n=n.slice(s.skip),n=n.slice(0,s.take),e.group.length!==s.level&&this.formGroupResult(n,r)}return{result:n,count:t}}formGroupResult(e,t){if(e.length&&t.length){let i="GroupGuid",n="childLevels",s="level",r="records";e[i]=t[i],e[n]=t[n],e[s]=t[s],e[r]=t[r]}return e}getAggregate(e){let t=Ny.filterQueries(e.queries,"onAggregates"),i=[];if(t.length){let n;for(let s=0;s<t.length;s++)n=t[s].e,i.push({type:n.type,field:Uy.getValue(n.field,e)})}return i}batchRequest(e,t,i){let n,s=t.deletedRecords.length;for(n=0;n<t.addedRecords.length;n++)this.insert(e,t.addedRecords[n]);for(n=0;n<t.changedRecords.length;n++)this.update(e,i.key,t.changedRecords[n]);for(n=0;n<s;n++)this.remove(e,i.key,t.deletedRecords[n]);return t}onWhere(e,t){return e&&e.length?e.filter(e=>{if(t)return t.validate(e)}):e}onAggregates(e,t){let i=Uy.aggregates[t.type];return e&&i&&0!==e.length?i(e,t.field):null}onSearch(e,t){return e&&e.length?(0===t.fieldNames.length&&Uy.getFieldList(e[0],t.fieldNames),e.filter(e=>{for(let i=0;i<t.fieldNames.length;i++)if(t.comparer.call(e,Uy.getObject(t.fieldNames[i],e),t.searchKey,t.ignoreCase,t.ignoreAccent))return!0;return!1})):e}onSortBy(e,t,i){if(!e||!e.length)return e;let n,s=Uy.getValue(t.fieldName,i);if(!s)return e.sort(t.comparer);if(s instanceof Array){s=s.slice(0);for(let i=s.length-1;i>=0;i--)s[i]&&(n=t.comparer,Uy.endsWith(s[i]," desc")&&(n=Uy.fnSort("descending"),s[i]=s[i].replace(" desc","")),e=Uy.sort(e,s[i],n));return e}return Uy.sort(e,s,t.comparer)}onGroup(e,t,i){if(!e||!e.length)return e;let n=this.getAggregate(i);return Uy.group(e,Uy.getValue(t.fieldName,i),n,null,null,t.comparer)}onPage(e,t,i){let n=Uy.getValue(t.pageSize,i),s=(Uy.getValue(t.pageIndex,i)-1)*n;return e&&e.length?e.slice(s,s+n):e}onRange(e,t){return e&&e.length?e.slice(Uy.getValue(t.start),Uy.getValue(t.end)):e}onTake(e,t){return e&&e.length?e.slice(0,Uy.getValue(t.nos)):e}onSkip(e,t){return e&&e.length?e.slice(Uy.getValue(t.nos)):e}onSelect(e,t){return e&&e.length?Uy.select(e,Uy.getValue(t.fieldNames)):e}insert(e,t,i,n,s){return jp(s)?e.dataSource.json.push(t):e.dataSource.json.splice(s,0,t)}remove(e,t,i,n){let s,r=e.dataSource.json;for("object"!=typeof i||i instanceof Date||(i=Uy.getObject(t,i)),s=0;s<r.length&&Uy.getObject(t,r[s])!==i;s++);return s!==r.length?r.splice(s,1):null}update(e,t,i,n){let s,r,o=e.dataSource.json;for(jp(t)||(r=Mp(t,i)),s=0;s<o.length&&(jp(t)||Mp(t,o[s])!==r);s++);return s<o.length?Lp(o[s],i):null}}class Xy extends Vy{processQuery(e,t,i){let n,s,r=this.getQueryRequest(t),o=Ny.filterQueryLists(t.queries,["onSelect","onPage","onSkip","onTake","onRange"]),a=t.params,l=e.dataSource.url,h=null,c=this.options,d={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};"onPage"in o?(n=o.onPage,s=Uy.getValue(n.pageIndex,t),h=Uy.getValue(n.pageSize,t),s=(s-1)*h):"onRange"in o&&(n=o.onRange,s=n.start,h=n.end-n.start);for(let m=0;m<r.sorts.length;m++)n=Uy.getValue(r.sorts[m].e.fieldName,t),d.sorts.push(Uy.callAdaptorFunction(this,"onEachSort",{name:n,direction:r.sorts[m].e.direction},t));i&&(n=this.getFiltersFrom(i,t),n&&d.filters.push(Uy.callAdaptorFunction(this,"onEachWhere",n.toJson(),t)));for(let m=0;m<r.filters.length;m++){let e=Uy.callAdaptorFunction(this,"onEachWhere",r.filters[m].e.toJson(),t);this.getModuleName&&"ODataV4Adaptor"===this.getModuleName()&&!jp(r.filters[m].e.key)&&r.filters.length>1&&(e="("+e+")"),d.filters.push(e);let i="object"==typeof d.filters[m]?Object.keys(d.filters[m]):[];for(let t of i)Uy.isNull(d[t])&&delete d[t]}for(let m=0;m<r.searches.length;m++)n=r.searches[m].e,d.searches.push(Uy.callAdaptorFunction(this,"onEachSearch",{fields:n.fieldNames,operator:n.operator,key:n.searchKey,ignoreCase:n.ignoreCase},t));for(let m=0;m<r.groups.length;m++)d.groups.push(Uy.getValue(r.groups[m].e.fieldName,t));for(let m=0;m<r.aggregates.length;m++)n=r.aggregates[m].e,d.aggregates.push({type:n.type,field:Uy.getValue(n.field,t)});let p={};if(this.getRequestQuery(c,t,o,d,p),Uy.callAdaptorFunction(this,"addParams",{dm:e,query:t,params:a,reqParams:p}),t.lazyLoad.length)for(let m=0;m<t.lazyLoad.length;m++)p[t.lazyLoad[m].key]=t.lazyLoad[m].value;let u=Object.keys(p);for(let m of u)(Uy.isNull(p[m])||""===p[m]||0===p[m].length)&&delete p[m];c.skip in p&&c.take in p||null===h||(p[c.skip]=Uy.callAdaptorFunction(this,"onSkip",s,t),p[c.take]=Uy.callAdaptorFunction(this,"onTake",h,t));let g=this.pvt;return this.pvt={},"json"===this.options.requestType?{data:JSON.stringify(p,Uy.parse.jsonDateReplacer),url:l,pvtData:g,type:"POST",contentType:"application/json; charset=utf-8"}:(n=this.convertToQueryString(p,t,e),n=(-1!==e.dataSource.url.indexOf("?")?"&":"/")+n,{type:"GET",url:n.length?l.replace(/\/*$/,n):l,pvtData:g})}getRequestQuery(e,t,i,n,s){let r=s;r[e.from]=t.fromTable,e.apply&&t.distincts.length&&(r[e.apply]="onDistinct"in this?Uy.callAdaptorFunction(this,"onDistinct",t.distincts):""),!t.distincts.length&&e.expand&&(r[e.expand]="onExpand"in this&&"onSelect"in i?Uy.callAdaptorFunction(this,"onExpand",{selects:Uy.getValue(i.onSelect.fieldNames,t),expands:t.expands},t):t.expands),r[e.select]="onSelect"in i&&!t.distincts.length?Uy.callAdaptorFunction(this,"onSelect",Uy.getValue(i.onSelect.fieldNames,t),t):"",r[e.count]=t.isCountRequired?Uy.callAdaptorFunction(this,"onCount",t.isCountRequired,t):"",r[e.search]=n.searches.length?Uy.callAdaptorFunction(this,"onSearch",n.searches,t):"",r[e.skip]="onSkip"in i?Uy.callAdaptorFunction(this,"onSkip",Uy.getValue(i.onSkip.nos,t),t):"",r[e.take]="onTake"in i?Uy.callAdaptorFunction(this,"onTake",Uy.getValue(i.onTake.nos,t),t):"",r[e.where]=n.filters.length||n.searches.length?Uy.callAdaptorFunction(this,"onWhere",n.filters,t):"",r[e.sortBy]=n.sorts.length?Uy.callAdaptorFunction(this,"onSortBy",n.sorts,t):"",r[e.group]=n.groups.length?Uy.callAdaptorFunction(this,"onGroup",n.groups,t):"",r[e.aggregates]=n.aggregates.length?Uy.callAdaptorFunction(this,"onAggregates",n.aggregates,t):"",r.param=[]}convertToQueryString(e,t,i){return""}processResponse(e,t,i,n,s,r){if(n&&n.getResponseHeader("Content-Type")&&-1!==n.getResponseHeader("Content-Type").indexOf("application/json")){let i=Uy.timeZoneHandling;t&&!t.timeZoneHandling&&(Uy.timeZoneHandling=!1),e=Uy.parse.parseJson(e),Uy.timeZoneHandling=i}let o=s,a=o.pvtData||{},l=e?e.groupDs:[];if(n&&n.getResponseHeader("Content-Type")&&-1!==n.getResponseHeader("Content-Type").indexOf("xml"))return i.isCountRequired?{result:[],count:0}:[];let h=JSON.parse(o.data);if(h&&"batch"===h.action&&e&&e.addedRecords)return r.addedRecords=e.addedRecords,r;e&&e.d&&(e=e.d);let c={};e&&"count"in e&&(c.count=e.count),c.result=e&&e.result?e.result:e;let d=!1;if(Array.isArray(e.result)&&e.result.length){let t="key",n="value",s="level";if(jp(e.result[0][t])||(c.result=this.formRemoteGroupedData(c.result,1,a.groups.length-1)),i&&i.lazyLoad.length&&a.groups.length)for(let e=0;e<i.lazyLoad.length;e++)"onDemandGroupInfo"===i.lazyLoad[e][t]&&a.groups.length===i.lazyLoad[e][n][s]&&(d=!0)}return d||this.getAggregateResult(a,e,c,l,i),Uy.isNull(c.count)?c.result:{result:c.result,count:c.count,aggregates:c.aggregates}}formRemoteGroupedData(e,t,i){for(let s=0;s<e.length;s++)e[s].items.length&&Object.keys(e[s].items[0]).indexOf("key")>-1&&this.formRemoteGroupedData(e[s].items,t+1,i-1);let n="GroupGuid";return e[n]=Fy[n],e.level=t,e.childLevels=i,e.records=e[0].items.length?this.getGroupedRecords(e,!jp(e[0].items.records)):[],e}getGroupedRecords(e,t){let i=[];for(let n=0;n<e.length;n++)if(t)i=i.concat(e[n].items.records);else for(let t=0;t<e[n].items.length;t++)i.push(e[n].items[t]);return i}onGroup(e){return this.pvt.groups=e,e}onAggregates(e){this.pvt.aggregates=e}batchRequest(e,t,i,n,s){return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.removeUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(kp({},{changed:t.changedRecords,added:t.addedRecords,deleted:t.deletedRecords,action:"batch",table:i[void 0],key:i[void 0]},Uy.getAddParams(this,e,n)))}}beforeSend(e,t){}insert(e,t,i,n){return{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(kp({},{value:t,table:i,action:"insert"},Uy.getAddParams(this,e,n)))}}remove(e,t,i,n,s){return{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(kp({},{key:i,keyColumn:t,table:n,action:"remove"},Uy.getAddParams(this,e,s)))}}update(e,t,i,n,s){return{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(kp({},{value:i,action:"update",keyColumn:t,key:Uy.getObject(t,i),table:n},Uy.getAddParams(this,e,s)))}}getFiltersFrom(e,t){let i,n=t.fKey,s=n,r=t.key,o=[];"object"!=typeof e[0]&&(s=null);for(let a=0;a<e.length;a++)i="object"==typeof e[0]?Uy.getObject(r||s,e[a]):e[a],o.push(new By(n,"equal",i));return By.or(o)}getAggregateResult(e,t,i,n,s){let r=t;if(t&&t.result&&(r=t.result),e&&e.aggregates&&e.aggregates.length){let n,s=e.aggregates,o=r,a={};t.aggregate&&(o=t.aggregate);for(let e=0;e<s.length;e++)n=Uy.aggregates[s[e].type],n&&(a[s[e].field+" - "+s[e].type]=n(o,s[e].field));i.aggregates=a}let o=Array.isArray(t.result)&&t.result.length&&!jp(t.result[0].key);if(e&&e.groups&&e.groups.length&&!o){let t=e.groups;for(let i=0;i<t.length;i++){let o=null;jp(n)||(n=Uy.group(n,t[i]));let a=Ny.filterQueries(s.queries,"onGroup")[i].e;r=Uy.group(r,t[i],e.aggregates,o,n,a.comparer)}i.result=r}return i}getQueryRequest(e){let t={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return t.sorts=Ny.filterQueries(e.queries,"onSortBy"),t.groups=Ny.filterQueries(e.queries,"onGroup"),t.filters=Ny.filterQueries(e.queries,"onWhere"),t.searches=Ny.filterQueries(e.queries,"onSearch"),t.aggregates=Ny.filterQueries(e.queries,"onAggregates"),t}addParams(e){let t=e.reqParams;e.params.length&&(t.params={});for(let i of e.params){if(t[i.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");t[i.key]=i.value,i.fn&&(t[i.key]=i.fn.call(e.query,i.key,e.query,e.dm)),t.params[i.key]=t[i.key]}}}class Gy extends Xy{constructor(e){super(),this.options=kp({},this.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PUT"}),kp(this.options,e||{})}getModuleName(){return"ODataAdaptor"}onPredicate(e,t,i){let n,s,r="",o=e.value,a=typeof o,l=e.field?Gy.getField(e.field):null;if(o instanceof Date&&(o="datetime'"+Uy.parse.replacer(o)+"'"),"string"===a&&(o=encodeURIComponent(o),o="'"+o+"'",i&&(l="cast("+l+", 'Edm.String')"),Uy.parse.isGuid(o)&&(s="guid"),e.ignoreCase&&(s||(l="tolower("+l+")"),o=o.toLowerCase())),n=Uy.odBiOperator[e.operator],n)return r+=l,r+=n,s&&(r+=s),r+o;if(n=jp(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?Uy.odUniOperator[e.operator]:Uy.odv4UniOperator[e.operator],"substringof"===n){let e=o;o=l,l=e}return r+=n+"(",r+=l+",",s&&(r+=s),r+=o+")",r}addParams(e){super.addParams(e),delete e.reqParams.params}onComplexPredicate(e,t,i){let n=[];for(let s=0;s<e.predicates.length;s++)n.push("("+this.onEachWhere(e.predicates[s],t,i)+")");return n.join(" "+e.condition+" ")}onEachWhere(e,t,i){return e.isComplex?this.onComplexPredicate(e,t,i):this.onPredicate(e,t,i)}onWhere(e){return this.pvt.search&&e.push(this.onEachWhere(this.pvt.search,null,!0)),e.join(" and ")}onEachSearch(e){e.fields&&0===e.fields.length&&Uy.throwError("Query() - Search : oData search requires list of field names to search");let t=this.pvt.search||[];for(let i=0;i<e.fields.length;i++)t.push(new By(e.fields[i],e.operator,e.key,e.ignoreCase));this.pvt.search=t}onSearch(e){return this.pvt.search=By.or(this.pvt.search),""}onEachSort(e){let t=[];if(e.name instanceof Array)for(let i=0;i<e.name.length;i++)t.push(Gy.getField(e.name[i])+("descending"===e.direction?" desc":""));else t.push(Gy.getField(e.name)+("descending"===e.direction?" desc":""));return t.join(",")}onSortBy(e){return e.reverse().join(",")}onGroup(e){return this.pvt.groups=e,[]}onSelect(e){for(let t=0;t<e.length;t++)e[t]=Gy.getField(e[t]);return e.join(",")}onAggregates(e){return this.pvt.aggregates=e,""}onCount(e){return!0===e?"allpages":""}beforeSend(e,t,i){Uy.endsWith(i.url,this.options.batch)&&"post"===i.type.toLowerCase()?(t.setRequestHeader("Accept",this.options.multipartAccept),t.setRequestHeader("DataServiceVersion","2.0"),t.overrideMimeType("text/plain; charset=x-user-defined")):t.setRequestHeader("Accept",this.options.accept),t.setRequestHeader("DataServiceVersion","2.0"),t.setRequestHeader("MaxDataServiceVersion","2.0")}processResponse(e,t,i,n,s,r){let o="odata.metadata";if(s&&"GET"===s.type&&!this.rootUrl&&e[o]){let t=e[o].split("/$metadata#");this.rootUrl=t[0],this.resourceTableName=t[1]}if(!jp(e.d)){let t=i&&i.isCountRequired?e.d.results:e.d,n="__metadata";if(!jp(t))for(let e=0;e<t.length;e++)jp(t[e][n])||delete t[e][n]}let a=s&&s.pvtData,l=this.processBatchResponse(e,i,n,s,r);if(l)return l;let h=n&&s.getResponseHeader("DataServiceVersion"),c=null,d=h&&parseInt(h,10)||2;if(i&&i.isCountRequired){let t="__count";(e[t]||e["odata.count"])&&(c=e[t]||e["odata.count"]),e.d&&(e=e.d),(e[t]||e["odata.count"])&&(c=e[t]||e["odata.count"])}3===d&&e.value&&(e=e.value),e.d&&(e=e.d),d<3&&e.results&&(e=e.results);let p={};return p.count=c,p.result=e,this.getAggregateResult(a,e,p,null,i),Uy.isNull(c)?p.result:{result:p.result,count:p.count,aggregates:p.aggregates}}convertToQueryString(e,t,i){let n=[],s=e.table||"";delete e.table,i.dataSource.requiresFormat&&(e.$format="json");let r=Object.keys(e);for(let o of r)n.push(o+"="+e[o]);return n=n.join("&"),i.dataSource.url&&-1!==i.dataSource.url.indexOf("?")&&!s?n:n.length?s+"?"+n:s||""}localTimeReplacer(e,t){for(let i of jp(t)?[]:Object.keys(t))t[i]instanceof Date&&(t[i]=Uy.dateParse.toLocalTime(t[i]));return t}insert(e,t,i){return{url:(e.dataSource.insertUrl||e.dataSource.url).replace(/\/*$/,i?"/"+i:""),data:JSON.stringify(t,this.options.localTime?this.localTimeReplacer:null)}}remove(e,t,i,n){let s;return s="string"!=typeof i||Uy.parse.isGuid(i)?`(${i})`:`('${i}')`,{type:"DELETE",url:(e.dataSource.removeUrl||e.dataSource.url).replace(/\/*$/,n?"/"+n:"")+s}}update(e,t,i,n,s,r){let o;return"PATCH"!==this.options.updateType||jp(r)||(i=this.compareAndRemove(i,r,t)),o="string"!=typeof i[t]||Uy.parse.isGuid(i[t])?`(${i[t]})`:`('${i[t]}')`,{type:this.options.updateType,url:(e.dataSource.updateUrl||e.dataSource.url).replace(/\/*$/,n?"/"+n:"")+o,data:JSON.stringify(i,this.options.localTime?this.localTimeReplacer:null),accept:this.options.accept}}batchRequest(e,t,i,n,s){let r=i.guid=Uy.getGuid(this.options.batchPre),o=this.rootUrl?this.rootUrl+"/"+this.options.batch:e.dataSource.url.replace(/\/*$/,"/"+this.options.batch);i.url=this.resourceTableName?this.resourceTableName:i.url;let a={url:i.url,key:i.key,cid:1,cSet:Uy.getGuid(this.options.changeSet)},l="--"+r+"\n";return l+="Content-Type: multipart/mixed; boundary="+a.cSet.replace("--","")+"\n",this.pvt.changeSet=0,l+=this.generateInsertRequest(t.addedRecords,a,e),l+=this.generateUpdateRequest(t.changedRecords,a,e,s?s.changedRecords:[]),l+=this.generateDeleteRequest(t.deletedRecords,a,e),l+=a.cSet+"--\n",l+="--"+r+"--",{type:"POST",url:o,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+r,data:l}}generateDeleteRequest(e,t,i){if(!e)return"";let n="";return n=this.generateBodyContent(e,t,{method:"DELETE ",url:(e,t,i)=>{let n=Uy.getObject(i,e[t]);return"number"==typeof n||Uy.parse.isGuid(n)?"("+n+")":n instanceof Date?"("+e[t][i].toJSON()+")":`('${n}')`},data:(e,t)=>""},i),n+"\n"}generateInsertRequest(e,t,i){if(!e)return"";let n="";return n=this.generateBodyContent(e,t,{method:"POST ",url:(e,t,i)=>"",data:(e,t)=>JSON.stringify(e[t])+"\n\n"},i),n}generateUpdateRequest(e,t,i,n){if(!e)return"";let s="";return e.forEach(e=>e=this.compareAndRemove(e,n.filter(i=>Uy.getObject(t.key,i)===Uy.getObject(t.key,e))[0],t.key)),s=this.generateBodyContent(e,t,{method:this.options.updateType+" ",url:(e,t,i)=>"number"==typeof e[t][i]||Uy.parse.isGuid(e[t][i])?"("+e[t][i]+")":e[t][i]instanceof Date?"("+e[t][i].toJSON()+")":`('${e[t][i]}')`,data:(e,t)=>JSON.stringify(e[t])+"\n\n"},i),s}static getField(e){return e.replace(/\./g,"/")}generateBodyContent(e,t,i,n){let s="";for(let r=0;r<e.length;r++)s+="\n"+t.cSet+"\n",s+=this.options.changeSetContent+"\n\n",s+=i.method,"POST "===i.method?s+=(n.dataSource.insertUrl||n.dataSource.crudUrl||t.url)+i.url(e,r,t.key)+" HTTP/1.1\n":"PUT "===i.method||"PATCH "===i.method?s+=(n.dataSource.updateUrl||n.dataSource.crudUrl||t.url)+i.url(e,r,t.key)+" HTTP/1.1\n":"DELETE "===i.method&&(s+=(n.dataSource.removeUrl||n.dataSource.crudUrl||t.url)+i.url(e,r,t.key)+" HTTP/1.1\n"),s+="Accept: "+this.options.accept+"\n",s+="Content-Id: "+this.pvt.changeSet+++"\n",s+=this.options.batchChangeSetContentType+"\n",jp(e[r]["@odata.etag"])?s+="\n":(s+="If-Match: "+e[r]["@odata.etag"]+"\n\n",delete e[r]["@odata.etag"]),s+=i.data(e,r);return s}processBatchResponse(e,t,i,n,s){if(i&&i.getResponseHeader("Content-Type")&&-1!==i.getResponseHeader("Content-Type").indexOf("xml"))return t.isCountRequired?{result:[],count:0}:[];if(n&&this.options.batch&&Uy.endsWith(n.url,this.options.batch)&&"post"===n.type.toLowerCase()){let t,n,r=i.getResponseHeader("Content-Type"),o=e+"";if(r=r.substring(r.indexOf("=batchresponse")+1),o=o.split(r),o.length<2)return{};o=o[1];let a=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(o);a&&o.replace(a[0],""),o=o.split(a?a[1]:"");for(let e=o.length;e>-1;e--)/\bContent-ID:/i.test(o[e])&&/\bHTTP.+201/.test(o[e])&&(t=parseInt(/\bContent-ID: (\d+)/i.exec(o[e])[1],10),s.addedRecords[t]&&(n=Uy.parse.parseJson(/^\{.+\}/m.exec(o[e])[0]),kp({},s.addedRecords[t],this.processResponse(n))));return s}return null}compareAndRemove(e,t,i){return jp(t)||Object.keys(e).forEach(n=>{n!==i&&"@odata.etag"!==n&&(Uy.isPlainObject(e[n])?(this.compareAndRemove(e[n],t[n]),0===Object.keys(e[n]).filter(e=>"@odata.etag"!==e).length&&delete e[n]):(e[n]===t[n]||e[n]&&t[n]&&e[n].valueOf()===t[n].valueOf())&&delete e[n])}),e}}class qy extends Yy{constructor(){super(),Rp("beforeSend",Xy.prototype.beforeSend,this)}insert(e,t,i,n,s){return this.pvt.position=s,this.updateType="add",{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(kp({},{value:t,table:i,action:"insert"},Uy.getAddParams(this,e,n)))}}remove(e,t,i,n,s){return super.remove(e,t,i),{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(kp({},{key:i,keyColumn:t,table:n,action:"remove"},Uy.getAddParams(this,e,s)))}}update(e,t,i,n,s){return this.updateType="update",this.updateKey=t,{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(kp({},{value:i,action:"update",keyColumn:t,key:i[t],table:n},Uy.getAddParams(this,e,s)))}}processResponse(e,t,i,n,s,r,o){let a;if(e="batch"===(s?JSON.parse(s.data):e).action?Uy.parse.parseJson(e):e,"add"===this.updateType&&super.insert(t,e,null,null,this.pvt.position),"update"===this.updateType&&super.update(t,this.updateKey,e),this.updateType=void 0,e.added)for(a=0;a<e.added.length;a++)super.insert(t,e.added[a]);if(e.changed)for(a=0;a<e.changed.length;a++)super.update(t,o.key,e.changed[a]);if(e.deleted)for(a=0;a<e.deleted.length;a++)super.remove(t,o.key,e.deleted[a]);return e}batchRequest(e,t,i,n,s){return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(kp({},{changed:t.changedRecords,added:t.addedRecords,deleted:t.deletedRecords,action:"batch",table:i.url,key:i.key},Uy.getAddParams(this,e,n)))}}addParams(e){(new Xy).addParams(e)}}class Zy extends Xy{constructor(e){super(),this.options=kp({},this.options,{getData:new Function,addRecord:new Function,updateRecord:new Function,deleteRecord:new Function,batchUpdate:new Function}),kp(this.options,e||{})}getModuleName(){return"CustomDataAdaptor"}}class $y extends Xy{constructor(e,t,i){super(),this.isCrudAction=!1,this.isInsertAction=!1,jp(e)||(this.cacheAdaptor=e),this.pageSize=i,this.guidId=Uy.getGuid("cacheAdaptor"),window.localStorage.setItem(this.guidId,JSON.stringify({keys:[],results:[]}));let n=this.guidId;jp(t)||setInterval(()=>{let e;e=Uy.parse.parseJson(window.localStorage.getItem(n));let i=[];for(let n=0;n<e.results.length;n++){let s=+new Date,r=+new Date(e.results[n].timeStamp);e.results[n].timeStamp=s-r,s-r>t&&i.push(n)}for(let t=0;t<i.length;t++)e.results.splice(i[t],1),e.keys.splice(i[t],1);window.localStorage.removeItem(n),window.localStorage.setItem(n,JSON.stringify(e))},t)}generateKey(e,t){let i=this.getQueryRequest(t),n=Ny.filterQueryLists(t.queries,["onSelect","onPage","onSkip","onTake","onRange"]),s=e,r="onPage";r in n&&(s+=n[r].pageIndex),i.sorts.forEach(e=>{s+=e.e.direction+e.e.fieldName}),i.groups.forEach(e=>{s+=e.e.fieldName}),i.searches.forEach(e=>{s+=e.e.searchKey});for(let o=0;o<i.filters.length;o++){let n=i.filters[o];if(n.e.isComplex){let i=t.clone();i.queries=[];for(let e=0;e<n.e.predicates.length;e++)i.queries.push({fn:"onWhere",e:n.e.predicates[e],filter:t.queries.filter});s+=n.e.condition+this.generateKey(e,i)}else s+=n.e.field+n.e.operator+n.e.value}return s}processQuery(e,t,i){let n,s=this.generateKey(e.dataSource.url,t);n=Uy.parse.parseJson(window.localStorage.getItem(this.guidId));let r=n?n.results[n.keys.indexOf(s)]:null;return null==r||this.isCrudAction||this.isInsertAction?(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0))):r}processResponse(e,t,i,n,s,r){if(this.isInsertAction||s&&this.cacheAdaptor.options.batch&&Uy.endsWith(s.url,this.cacheAdaptor.options.batch)&&"post"===s.type.toLowerCase())return this.cacheAdaptor.processResponse(e,t,i,n,s,r);e=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));let o=i?this.generateKey(t.dataSource.url,i):t.dataSource.url,a={};a=Uy.parse.parseJson(window.localStorage.getItem(this.guidId));let l=a.keys.indexOf(o);for(-1!==l&&(a.results.splice(l,1),a.keys.splice(l,1)),a.results[a.keys.push(o)-1]={keys:o,result:e.result,timeStamp:new Date,count:e.count};a.results.length>this.pageSize;)a.results.splice(0,1),a.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(a)),e}beforeSend(e,t,i){!jp(this.cacheAdaptor.options.batch)&&Uy.endsWith(i.url,this.cacheAdaptor.options.batch)&&"post"===i.type.toLowerCase()&&t.setRequestHeader("Accept",this.cacheAdaptor.options.multipartAccept),e.dataSource.crossDomain||t.setRequestHeader("Accept",this.cacheAdaptor.options.accept)}update(e,t,i,n){return this.isCrudAction=!0,this.cacheAdaptor.update(e,t,i,n)}insert(e,t,i){return this.isInsertAction=!0,this.cacheAdaptor.insert(e,t,i)}remove(e,t,i,n){return this.isCrudAction=!0,this.cacheAdaptor.remove(e,t,i,n)}batchRequest(e,t,i){return this.cacheAdaptor.batchRequest(e,t,i)}}class Qy{constructor(e,t,i){let n;return this.dateParse=!0,this.timeZoneHandling=!0,this.requests=[],e||this.dataSource||(e=[]),i=i||e.adaptor,e&&!1===e.timeZoneHandling&&(this.timeZoneHandling=e.timeZoneHandling),e instanceof Array?n={json:e,offline:!0}:"object"==typeof e?(e.json||(e.json=[]),n={url:e.url,insertUrl:e.insertUrl,removeUrl:e.removeUrl,updateUrl:e.updateUrl,crudUrl:e.crudUrl,batchUrl:e.batchUrl,json:e.json,headers:e.headers,accept:e.accept,data:e.data,timeTillExpiration:e.timeTillExpiration,cachingPageSize:e.cachingPageSize,enableCaching:e.enableCaching,requestType:e.requestType,key:e.key,crossDomain:e.crossDomain,jsonp:e.jsonp,dataType:e.dataType,offline:void 0!==e.offline?e.offline:!(e.adaptor instanceof qy||e.adaptor instanceof Zy||e.url),requiresFormat:e.requiresFormat}):Uy.throwError("DataManager: Invalid arguments"),void 0!==n.requiresFormat||Uy.isCors()||(n.requiresFormat=!!jp(n.crossDomain)||n.crossDomain),void 0===n.dataType&&(n.dataType="json"),this.dataSource=n,this.defaultQuery=t,n.url&&n.offline&&!n.json.length?(this.isDataAvailable=!1,this.adaptor=i||new Gy,this.dataSource.offline=!1,this.ready=this.executeQuery(t||new Ny),this.ready.then(e=>{this.dataSource.offline=!0,this.isDataAvailable=!0,n.json=e.result,this.adaptor=new Yy})):this.adaptor=n.offline?new Yy:new Gy,!n.jsonp&&this.adaptor instanceof Gy&&(n.jsonp="callback"),this.adaptor=i||this.adaptor,n.enableCaching&&(this.adaptor=new $y(this.adaptor,n.timeTillExpiration,n.cachingPageSize)),this}setDefaultQuery(e){return this.defaultQuery=e,this}executeLocal(e){this.defaultQuery||e instanceof Ny||Uy.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||Uy.throwError("DataManager - executeLocal() : Json data is required to execute");let t=this.adaptor.processQuery(this,e=e||this.defaultQuery);if(e.subQuery){let i=e.subQuery.fromTable,n=e.subQuery.lookups,s=e.isCountRequired?t.result:t;n&&n instanceof Array&&Uy.buildHierarchy(e.subQuery.fKey,i,s,n,e.subQuery.key);for(let t=0;t<s.length;t++)s[t][i]instanceof Array&&(s[t]=kp({},{},s[t]),s[t][i]=this.adaptor.processResponse(e.subQuery.using(new Qy(s[t][i].slice(0))).executeLocal(),this,e))}return this.adaptor.processResponse(t,this,e)}executeQuery(e,t,i,n){"function"==typeof e&&(n=i,i=t,t=e,e=null),e||(e=this.defaultQuery),e instanceof Ny||Uy.throwError("DataManager - executeQuery() : A query is required to execute");let s=new Jy,r={query:e};if(!this.dataSource.offline&&void 0!==this.dataSource.url&&""!==this.dataSource.url||!jp(this.adaptor.makeRequest)||this.isCustomDataAdaptor(this.adaptor)){let t=this.adaptor.processQuery(this,e);jp(this.adaptor.makeRequest)?!jp(t.url)||this.isCustomDataAdaptor(this.adaptor)?this.makeRequest(t,s,r,e):(r=Qy.getDeferedArgs(e,t,r),s.resolve(r)):this.adaptor.makeRequest(t,s,r,e)}else Qy.nextTick(()=>{let t=this.executeLocal(e);r=Qy.getDeferedArgs(e,t,r),s.resolve(r)});return(t||i)&&s.promise.then(t,i),n&&s.promise.then(n,n),s.promise}static getDeferedArgs(e,t,i){return e.isCountRequired?(i.result=t.result,i.count=t.count,i.aggregates=t.aggregates):i.result=t,i}static nextTick(e){(window.setImmediate||window.setTimeout)(e,0)}extendRequest(e,t,i){return kp({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:t,onFailure:i},e)}makeRequest(e,t,i,n){let s=!!n.subQuerySelector,r=e=>{i.error=e,t.reject(i)},o=(e,n,s,r,o,a,l)=>{i.xhr=s,i.count=n?parseInt(n.toString(),10):0,i.result=e,i.request=r,i.aggregates=a,i.actual=o,i.virtualSelectRecords=l,t.resolve(i)},a=(e,t)=>{let a=new Jy,l={parent:i};n.subQuery.isChild=!0;let h=this.adaptor.processQuery(this,n.subQuery,e?this.adaptor.processResponse(e):t),c=this.makeRequest(h,a,l,n.subQuery);return s||a.then(t=>{e&&(Uy.buildHierarchy(n.subQuery.fKey,n.subQuery.fromTable,e,t,n.subQuery.key),o(e,t.count,t.xhr))},r),c},l=this.extendRequest(e,(e,t)=>{if(this.isGraphQLAdaptor(this.adaptor)&&!jp(e.errors))return r(e.errors);this.isCustomDataAdaptor(this.adaptor)&&(t=kp({},this.ajaxReqOption,t)),-1===t.httpRequest.getResponseHeader("Content-Type").indexOf("xml")&&this.dateParse&&(e=Uy.parse.parseJson(e));let i=this.adaptor.processResponse(e,this,n,t.httpRequest,t),l=0,h=null,c=e.virtualSelectRecords;n.isCountRequired&&(l=i.count,h=i.aggregates,i=i.result),n.subQuery?s||a(i,t):o(i,l,t.httpRequest,t.type,e,h,c)},r);if(this.isCustomDataAdaptor(this.adaptor))this.ajaxReqOption=l,this.adaptor.options.getData({data:l.data,onSuccess:l.onSuccess,onFailure:l.onFailure});else{let e=new cu(l);e.beforeSend=()=>{this.beforeSend(e.httpRequest,e)},l=e.send(),l.catch(e=>!0),this.requests.push(e)}if(s){let e,t=n.subQuerySelector.call(this,{query:n.subQuery,parent:n});t&&t.length?(e=Promise.all([l,a(null,t)]),e.then((...e)=>{let t=e[0],i=this.adaptor.processResponse(t[0],this,n,this.requests[0].httpRequest,this.requests[0]),r=0;n.isCountRequired&&(r=i.count,i=i.result);let a=this.adaptor.processResponse(t[1],this,n.subQuery,this.requests[1].httpRequest,this.requests[1]);r=0,n.subQuery.isCountRequired&&(r=a.count,a=a.result),Uy.buildHierarchy(n.subQuery.fKey,n.subQuery.fromTable,i,a,n.subQuery.key),s=!1,o(i,r,this.requests[0].httpRequest)})):s=!1}return l}beforeSend(e,t){this.adaptor.beforeSend(this,e,t);let i,n=this.dataSource.headers;for(let s=0;n&&s<n.length;s++){i=[];let t=Object.keys(n[s]);for(let r of t)i.push(r),e.setRequestHeader(r,n[s][r])}}saveChanges(e,t,i,n,s){i instanceof Ny&&(n=i,i=null);let r={url:i,key:t||this.dataSource.key},o=this.adaptor.batchRequest(this,e,r,n||new Ny,s);if(this.dataSource.offline)return o;if(jp(this.adaptor.doAjaxRequest)){if(this.isCustomDataAdaptor(this.adaptor))return this.doAjaxRequest(o,this.adaptor.options.batchUpdate);{let t=new Jy,i=new cu(o);return i.beforeSend=()=>{this.beforeSend(i.httpRequest,i)},i.onSuccess=(n,s)=>{this.isGraphQLAdaptor(this.adaptor)&&(jp(n.errors)||i.onFailure(JSON.stringify(n.errors))),t.resolve(this.adaptor.processResponse(n,this,null,s.httpRequest,s,e,r))},i.onFailure=e=>{t.reject([{error:e}])},i.send().catch(e=>!0),t.promise}}return this.adaptor.doAjaxRequest(o)}insert(e,t,i,n){t instanceof Ny&&(i=t,t=null);let s=this.adaptor.insert(this,e,t,i,n);return this.dataSource.offline?s:jp(this.adaptor.doAjaxRequest)?this.doAjaxRequest(s,this.adaptor.options.addRecord):this.adaptor.doAjaxRequest(s)}remove(e,t,i,n){"object"==typeof t&&(t=Uy.getObject(e,t)),i instanceof Ny&&(n=i,i=null);let s=this.adaptor.remove(this,e,t,i,n);return this.dataSource.offline?s:jp(this.adaptor.doAjaxRequest)?this.doAjaxRequest(s,this.adaptor.options.deleteRecord):this.adaptor.doAjaxRequest(s)}update(e,t,i,n,s){i instanceof Ny&&(n=i,i=null);let r=this.adaptor.update(this,e,t,i,n,s);return this.dataSource.offline?r:jp(this.adaptor.doAjaxRequest)?this.doAjaxRequest(r,this.adaptor.options.updateRecord):this.adaptor.doAjaxRequest(r)}isCustomDataAdaptor(e){return this.adaptor.getModuleName&&"CustomDataAdaptor"===this.adaptor.getModuleName()}isGraphQLAdaptor(e){return this.adaptor.getModuleName&&"GraphQLAdaptor"===this.adaptor.getModuleName()}successFunc(e,t){if(this.isGraphQLAdaptor(this.adaptor)){let t=JSON.parse(e);jp(t.errors)||this.failureFunc(JSON.stringify(t.errors))}this.isCustomDataAdaptor(this.adaptor)&&(t=kp({},this.ajaxReqOption,t));try{Uy.parse.parseJson(e)}catch(i){e=[]}e=this.adaptor.processResponse(Uy.parse.parseJson(e),this,null,t.httpRequest,t),this.ajaxDeffered.resolve(e)}failureFunc(e){this.ajaxDeffered.reject([{error:e}])}doAjaxRequest(e,t){if(e=kp({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},e),this.ajaxDeffered=new Jy,this.isCustomDataAdaptor(this.adaptor))this.ajaxReqOption=e,t.call(this,{data:e.data,onSuccess:this.successFunc.bind(this),onFailure:this.failureFunc.bind(this)});else{let t=new cu(e);t.beforeSend=()=>{this.beforeSend(t.httpRequest,t)},t.onSuccess=this.successFunc.bind(this),t.onFailure=this.failureFunc.bind(this),t.send().catch(e=>!0)}return this.ajaxDeffered.promise}}class Jy{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}}let Ky={li:"e-list-item",ul:"e-list-parent e-ul",group:"e-list-group-item",icon:"e-list-icon",text:"e-list-text",check:"e-list-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-list-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-list-img",iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"};var eb;function tb(e,t){const i={};if(jp(e)||"string"==typeof e||"number"==typeof e||!jp(e.isHeader))return e;for(const n of Object.keys(t)){const s=t[n],r=jp(s)||"string"!=typeof s?void 0:Mp(s,e);jp(r)||(i[s]=r)}return i}function ib(e){if(e)try{if(document.querySelector(e))return am(document.querySelector(e).innerHTML.trim())}catch(t){return am(e)}}!function(e){e.defaultMappedFields={id:"id",text:"text",url:"url",value:"value",isChecked:"isChecked",enabled:"enabled",expanded:"expanded",selected:"selected",iconCss:"iconCss",child:"child",isVisible:"isVisible",hasChildren:"hasChildren",tooltip:"tooltip",htmlAttributes:"htmlAttributes",urlAttributes:"urlAttributes",imageAttributes:"imageAttributes",imageUrl:"imageUrl",groupBy:null,sortBy:null};const t={level:1,listRole:"presentation",itemRole:"presentation",groupItemRole:"group",itemText:"list-item",wrapperRole:"presentation"},i={showCheckBox:!1,showIcon:!1,enableHtmlSanitizer:!1,expandCollapse:!1,fields:e.defaultMappedFields,ariaAttributes:t,listClass:"",itemClass:"",processSubChild:!1,sortOrder:"None",template:null,groupTemplate:null,headerTemplate:null,expandIconClass:"e-icon-collapsible",moduleName:"list",expandIconPosition:"Right",itemNavigable:!1};function n(e,t,i,n,r){return v(e,s(e,t,i,n,r),null,n)}function s(e,t,n,s,r){const o=[],a=kp({},i,s);Ky=f(a.moduleName);const l=u();for(let i=0;i<t.length;i++){if(jp(t[i]))continue;let h;a.itemCreating&&"function"==typeof a.itemCreating&&a.itemCreating({dataSource:t,curData:t[i],text:t[i],options:a}),h=n?m(e,t[i],void 0,null,null,[],null,l,i,s):b(e,t[i],void 0,null,null,s,r),a.itemCreated&&"function"==typeof a.itemCreated&&a.itemCreated({dataSource:t,curData:t[i],text:t[i],item:h,options:a}),o.push(h)}return o}function r(n,s,r,o,a,l){const h=kp({},i,r);Ky=f(h.moduleName);const p=kp({},e.defaultMappedFields,h.fields),y=kp({},t,h.ariaAttributes);let v,w=[];o&&(y.level=o);const x=[];let S,C;s&&s.length&&!jp(c(s).item)&&!c(s).item.hasOwnProperty(p.id)&&(v=u());for(let e=0;e<s.length;e++){let t=tb(s[e],p);if(jp(s[e]))continue;h.itemCreating&&"function"==typeof h.itemCreating&&h.itemCreating({dataSource:s,curData:s[e],text:t[p.text],options:h,fields:p});const i=s[e];h.itemCreating&&"function"==typeof h.itemCreating&&(t=tb(s[e],p)),t.hasOwnProperty(p.id)&&!jp(t[p.id])&&(v=t[p.id]);const o=[];if(h.showCheckBox&&(h.itemNavigable&&(t[p.url]||t[p.urlAttributes])?w.push(n("input",{className:Ky.check,attrs:{type:"checkbox"}})):o.push(n("input",{className:Ky.check,attrs:{type:"checkbox"}}))),!0===a)h.showIcon&&t.hasOwnProperty(p.iconCss)&&!jp(t[p.iconCss])&&o.push(n("span",{className:Ky.icon+" "+t[p.iconCss]})),S=m(n,i,t,p,h.itemClass,o,!(!i.hasOwnProperty("isHeader")||!i.isHeader),v,e,r),C=S.querySelector("."+Ky.anchorWrap),h.itemNavigable&&w.length&&Au(w,S.firstElementChild);else{if(S=b(n,i,t,p,h.itemClass,r,l),S.classList.add(Ky.level+"-"+y.level),S.setAttribute("aria-level",y.level.toString()),C=S.querySelector("."+Ky.anchorWrap),t.hasOwnProperty(p.tooltip)&&S.setAttribute("title",t[p.tooltip]),t.hasOwnProperty(p.htmlAttributes)&&t[p.htmlAttributes]&&d(S,t[p.htmlAttributes]),t.hasOwnProperty(p.enabled)&&!1===t[p.enabled]&&S.classList.add(Ky.disabled),t.hasOwnProperty(p.isVisible)&&!1===t[p.isVisible]&&(S.style.display="none"),t.hasOwnProperty(p.imageUrl)&&!jp(t[p.imageUrl])&&!h.template){const e={src:t[p.imageUrl]};Lp(e,t[p.imageAttributes]);const i=n("img",{className:Ky.image,attrs:e});C?C.insertAdjacentElement("afterbegin",i):Au([i],S.firstElementChild)}if(h.showIcon&&t.hasOwnProperty(p.iconCss)&&!jp(t[p.iconCss])&&!h.template){const e=n("div",{className:Ky.icon+" "+t[p.iconCss]});C?C.insertAdjacentElement("afterbegin",e):Au([e],S.firstElementChild)}o.length&&Au(o,S.firstElementChild),h.itemNavigable&&w.length&&Au(w,S.firstElementChild),g(n,t,p,0,h,S,y.level)}C&&Pu([S],[Ky.navigable]),h.itemCreated&&"function"==typeof h.itemCreated&&h.itemCreated({dataSource:s,curData:s[e],text:t[p.text],item:S,options:h,fields:p}),w=[],x.push(S)}return x}function o(e,t,n,s,o,a){const l=kp({},i,n);return v(e,r(e,t,n,s,o,a),l.listClass,n)}function a(e,t){if(t&&e){let i=t;return i=Array.prototype.slice.call(t),i.indexOf(e)}}function l(e,t,i=new Ny){if("Ascending"===e)i.sortBy(t,"ascending",!0);else if("Descending"===e)i.sortBy(t,"descending",!0);else for(let n=0;n<i.queries.length;n++)"onSortBy"===i.queries[n].fn&&i.queries.splice(n,1);return i}function h(e,t){return new Qy(e).executeLocal(t)}function c(e){for(let t=0;t<e.length;t++)if(!jp(e[t]))return{typeof:typeof e[t],item:e[t]};return{typeof:null,item:null}}function d(e,t){const i={};Lp(i,t),i.class&&(Pu([e],i.class.split(" ")),delete i.class),zu(e,i)}function p(e){const t={},i=e.attributes;for(let n=0;n<i.length;n++)t[i[n].nodeName]=i[n].nodeValue;return t}function u(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function g(e,t,i,n,s,r,a){const l=t[i.child]||[];let h=t[i.hasChildren];if(l.length&&(h=!0,r.classList.add(Ky.hasChild),s.processSubChild)){const t=o(e,l,s,++a);r.appendChild(t)}s.expandCollapse&&h&&!s.template&&(r.firstElementChild.classList.add(Ky.iconWrapper),("Left"===s.expandIconPosition?Au:Iu)([e("div",{className:"e-icons "+s.expandIconClass})],r.querySelector("."+Ky.textContent)))}function m(e,n,s,r,o,a,l,h,c,p){const u=kp({},i,p),g=kp({},t,u.ariaAttributes);let m,f,b=n,v=n;"string"!=typeof n&&"number"!=typeof n&&"boolean"!=typeof n&&(m=n,b="boolean"==typeof s[r.text]||"number"==typeof s[r.text]?s[r.text]:s[r.text]||"",v=s[r.value]),f=jp(m)||jp(s[r.id])||""===s[r.id]?h+"-"+c:h;const w=e("li",{className:(!0===l?Ky.group:Ky.li)+" "+(jp(o)?"":o),id:f,attrs:""!==g.groupItemRole&&""!==g.itemRole?{role:!0===l?g.groupItemRole:g.itemRole}:{}});return m&&s.hasOwnProperty(r.enabled)&&"false"===s[r.enabled].toString()&&w.classList.add(Ky.disabled),l?w.innerText=b:(w.setAttribute("data-value",jp(v)?"null":v),w.setAttribute("role","option"),m&&s.hasOwnProperty(r.htmlAttributes)&&s[r.htmlAttributes]&&d(w,s[r.htmlAttributes]),a.length&&!u.itemNavigable&&Iu(a,w),m&&(s[r.url]||s[r.urlAttributes]&&s[r.urlAttributes].href)?w.appendChild(y(e,m,r,b,a,u.itemNavigable)):(a.length&&u.itemNavigable&&Iu(a,w),w.appendChild(document.createTextNode(b)))),w}function f(e){return{li:`e-${e}-item`,ul:`e-${e}-parent e-ul`,group:`e-${e}-group-item`,icon:`e-${e}-icon`,text:`e-${e}-text`,check:`e-${e}-check`,checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:`e-${e}-url`,collapsible:"e-icon-collapsible",disabled:"e-disabled",image:`e-${e}-img`,iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"}}function y(e,t,i,n,s,r){const o=tb(t,i),a={href:o[i.url]};let l;if(o.hasOwnProperty(i.urlAttributes)&&o[i.urlAttributes]&&(Lp(a,o[i.urlAttributes]),a.href=o[i.url]?o[i.url]:o[i.urlAttributes].href),r){l=e("a",{className:Ky.text+" "+Ky.url});const t=e("div",{className:Ky.anchorWrap});s&&s.length&&Iu(s,t),t.appendChild(document.createTextNode(n)),Iu([t],l)}else l=e("a",{className:Ky.text+" "+Ky.url,innerHTML:n});return d(l,a),l}function b(e,n,s,r,o,a,l){const h=kp({},i,a),c=kp({},t,h.ariaAttributes);let d,p,g,m=n;"string"!=typeof n&&"number"!=typeof n&&(g=n,m=s[r.text]||"",d=jp(s._id)?s[r.id]:s._id,p=!(!n.hasOwnProperty("isHeader")||!n.isHeader)),a&&a.enableHtmlSanitizer&&(m=m);const f=e("li",{className:(!0===p?Ky.group:Ky.li)+" "+(jp(o)?"":o),attrs:""!==c.groupItemRole&&""!==c.itemRole?{role:!0===p?c.groupItemRole:c.itemRole}:{}});if(1==!jp(d)?f.setAttribute("data-uid",d):f.setAttribute("data-uid",u()),p&&a&&a.groupTemplate){const e=ib(a.groupTemplate);if(l&&"listview"!==l.getModuleName()){const t=e(n,l,"groupTemplate",h.groupTemplateID,!!h.isStringTemplate,null,f);t&&Iu(t,f)}else Iu(e(n,l,"groupTemplate",h.groupTemplateID,!!h.isStringTemplate),f)}else if(!p&&a&&a.template){const e=ib(a.template);if(l&&"listview"!==l.getModuleName()){const t=e(n,l,"template",h.templateID,!!h.isStringTemplate,null,f);t&&Iu(t,f)}else Iu(e(n,l,"template",h.templateID,!!h.isStringTemplate),f)}else{const t=e("div",{className:Ky.textContent,attrs:""!==c.wrapperRole?{role:c.wrapperRole}:{}});if(g&&(s[r.url]||s[r.urlAttributes]&&s[r.urlAttributes].href))t.appendChild(y(e,g,r,m,null,h.itemNavigable));else{const i=e("span",{className:Ky.text,attrs:""!==c.itemText?{role:c.itemText}:{}});a&&a.enableHtmlSanitizer?i.innerText=m:i.innerHTML=m,t.appendChild(i)}f.appendChild(t)}return f}function v(e,n,s,r){const o=kp({},i,r),a=kp({},t,o.ariaAttributes);Ky=f(o.moduleName);const l=e("ul",{className:Ky.ul+" "+(jp(s)?"":s),attrs:""!==a.listRole?{role:a.listRole}:{}});return Iu(n,l),l}e.createList=function(e,s,r,a,l){const h=kp({},i,r),d=kp({},t,h.ariaAttributes),p=c(s).typeof;return"string"===p||"number"===p?n(e,s,a,r,l):o(e,s,r,d.level,a,l)},e.createListFromArray=n,e.createListItemFromArray=s,e.createListItemFromJson=r,e.createListFromJson=o,e.getSiblingLI=function(e,t,n){if(Ky=f(i.moduleName),!e||!e.length)return;let s,r;const o=Array.prototype.slice.call(e);for(r=t?a(t,o):!0===n?o.length:-1,s=o[r+(!0===n?-1:1)];s&&(!Eu(s)||s.classList.contains(Ky.disabled));)r+=!0===n?-1:1,s=o[r];return s},e.indexOf=a,e.groupDataSource=function(t,i,n="None"){const s=kp({},e.defaultMappedFields,i);let r=(new Ny).group(s.groupBy);r=l(n,"key",r);const o=h(t,r);t=[];for(let e=0;e<o.length;e++){const i=o[e].items,n={},r="isHeader";n[s.text]=o[e].key,n[r]=!0;let a=s.text;"id"===a&&(a="text",n[a]=o[e].key),n._id="group-list-item-"+(o[e].key?o[e].key.toString().trim():"undefined"),n.items=i,t.push(n);for(let e=0;e<i.length;e++)t.push(i[e])}return t},e.addSorting=l,e.getDataSource=h,e.createJsonFromElement=function t(n,s){const r=kp({},i,s),o=kp({},e.defaultMappedFields,r.fields),a=n.cloneNode(!0),l=[];a.classList.add("json-parent");const h=a.querySelectorAll(".json-parent>li");a.classList.remove("json-parent");for(let e=0;e<h.length;e++){const i=h[e],n=i.querySelector("a"),r=i.querySelector("ul"),a={},c=n?n.childNodes:i.childNodes,d=Object.keys(c);for(let e=0;e<c.length;e++)c[Number(d[e])].hasChildNodes()||(a[o.text]=c[Number(d[e])].textContent);let g=p(i);g.id?(a[o.id]=g.id,delete g.id):a[o.id]=u(),Object.keys(g).length&&(a[o.htmlAttributes]=g),n&&(g=p(n),Object.keys(g).length&&(a[o.urlAttributes]=g)),r&&(a[o.child]=t(r,s)),l.push(a)}return l},e.renderContentTemplate=function(t,n,s,r,o,a){Ky=f(i.moduleName);const l=t("ul",{className:Ky.ul,attrs:{role:"presentation"}}),h=kp({},i,o),c=kp({},e.defaultMappedFields,r),d=ib(n),p=[];let g;const m=u();for(let e=0;e<s.length;e++){let i=tb(s[e],c);const n=s[e],r=n.isHeader;g="string"==typeof s[e]||"number"==typeof s[e]?n:i[c.value],h.itemCreating&&"function"==typeof h.itemCreating&&h.itemCreating({dataSource:s,curData:n,text:g,options:h,fields:c}),h.itemCreating&&"function"==typeof h.itemCreating&&(i=tb(s[e],c),g="string"==typeof s[e]||"number"==typeof s[e]?n:i[c.value]);const o=t("li",{id:m+"-"+e,className:r?Ky.group:Ky.li,attrs:{role:"presentation"}});if(r)o.innerText="string"==typeof s[e]||"number"==typeof s[e]?n:i[c.text];else{const e=r?h.groupTemplateID:h.templateID;if(r)if(a&&"listview"!==a.getModuleName()){const t=d(n,a,"headerTemplate",e,!!h.isStringTemplate,null,o);t&&Iu(t,o)}else Iu(d(n,a,"headerTemplate",e,!!h.isStringTemplate),o);else if(a&&"listview"!==a.getModuleName()){const t=d(n,a,"template",e,!!h.isStringTemplate,null,o);t&&Iu(t,o)}else Iu(d(n,a,"template",e,!!h.isStringTemplate),o);o.setAttribute("data-value",jp(g)?"null":g),o.setAttribute("role","option")}h.itemCreated&&"function"==typeof h.itemCreated&&h.itemCreated({dataSource:s,curData:n,text:g,item:o,options:h,fields:c}),p.push(o)}return Iu(p,l),l},e.renderGroupTemplate=function(t,n,s,r,o,a){const l=ib(t),h=kp({},e.defaultMappedFields,s),c=kp({},i,o),d=h.groupBy;for(const e of r){const t={};if(t[d]=e.textContent,e.innerHTML="",a&&"listview"!==a.getModuleName()){const i=l(t,a,"groupTemplate",c.groupTemplateID,!!c.isStringTemplate,null,e);i&&Iu(i,e)}else Iu(l(t,a,"groupTemplate",c.groupTemplateID,!!c.isStringTemplate),e)}return r},e.generateId=u,e.generateUL=v,e.generateIcon=function(e,t,n,s){const r=kp({},i,s);return Ky=f(r.moduleName),("Left"===r.expandIconPosition?Au:Iu)([e("div",{className:"e-icons "+r.expandIconClass+" "+(jp(n)?"":n)})],t.querySelector("."+Ky.textContent)),t}}(eb||(eb={}));class nb{constructor(e,t){this.width=e,this.height=t}isEmpty(){return 0===this.height&&0===this.width}clone(){return new nb(this.width,this.height)}}var sb=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let rb=(()=>{class e extends bg{static equals(e,t){return e===t||!(!e||!t)&&(!e||!t||e.x===t.x&&e.y===t.y)}static isEmptyPoint(e){return!e.x||!e.y}static transform(e,t,i){const n={x:0,y:0};return n.x=Math.round(100*(e.x+i*Math.cos(t*Math.PI/180)))/100,n.y=Math.round(100*(e.y+i*Math.sin(t*Math.PI/180)))/100,n}static findLength(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static findAngle(e,t){let i=Math.atan2(t.y-e.y,t.x-e.x);return i=180*i/Math.PI,i%=360,i<0&&(i+=360),i}static distancePoints(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}static getLengthFromListOfPoints(e){let t=0;for(let i=0;i<e.length-1;i++)t+=this.distancePoints(e[i],e[i+1]);return t}static adjustPoint(e,t,i,n){let s,r=i?{x:e.x,y:e.y}:{x:t.x,y:t.y};return e.x===t.x?e.y<t.y&&i||e.y>t.y&&!i?r.y+=n:r.y-=n:e.y===t.y?e.x<t.x&&i||e.x>t.x&&!i?r.x+=n:r.x-=n:i?(s=this.findAngle(e,t),r=this.transform(e,s,n)):(s=this.findAngle(t,e),r=this.transform(t,s,n)),r}static direction(e,t){return Math.abs(t.x-e.x)>Math.abs(t.y-e.y)?e.x<t.x?"Right":"Left":e.y<t.y?"Bottom":"Top"}getClassName(){return"Point"}}return sb([ig(0)],e.prototype,"x",void 0),sb([ig(0)],e.prototype,"y",void 0),e})();function ob(e){const t=[];let i;const n=function(e){const t=/([a-z]+)|([+-]?(?:\d+\.?\d*|\.\d+))/gi;let i=[];const n=[];let s={};t.lastIndex=0;let r=!1;for(s=t.exec(e);s;)"e"===s[1]?r=!0:s[1]?("zm"===s[1].toLowerCase()?(i.length&&n.push(i),n.push(["Z"]),i=[s[1].substring(1,2)]):(i.length&&n.push(i),i=[s[1]]),r=!1):(i.length||(i=[]),r||i.push(Number(s[2])),r=!1),s=t.exec(e);return i.length&&n.push(i),n}(e);if(n.length>0)for(let s=0;s<n.length;s++){const e=n[s];let r="";switch(r=e[0],r.toLowerCase()){case"m":for(i=1;i<e.length;i++)t.push({command:r,x:e[i],y:e[i+1]}),i+=1,"m"===r?r="l":"M"===r&&(r="L");break;case"l":case"t":for(i=1;i<e.length;i++)t.push({command:r,x:e[i],y:e[i+1]}),i+=1;break;case"h":for(i=1;i<e.length;i++)t.push({command:r,x:e[i]});break;case"v":for(i=1;i<e.length;i++)t.push({command:r,y:e[i]});break;case"z":t.push({command:r});break;case"c":for(i=1;i<e.length;i++)t.push({command:r,x1:e[i],y1:e[i+1],x2:e[i+2],y2:e[i+3],x:e[i+4],y:e[i+5]}),i+=5;break;case"s":for(i=1;i<e.length;i++)t.push({command:r,x2:e[i],y2:e[i+1],x:e[i+2],y:e[i+3]}),i+=3;break;case"q":for(i=1;i<e.length;i++)t.push({command:r,x1:e[i],y1:e[i+1],x:e[i+2],y:e[i+3]}),i+=3;break;case"a":for(i=1;i<e.length;i++)t.push({command:r,r1:e[i],r2:e[i+1],angle:e[i+2],largeArc:e[i+3],sweep:e[i+4],x:e[i+5],y:e[i+6]}),i+=6}}return t}function ab(e){let t,i,n="";for(n="M"+e[0].x+" "+e[0].y,i=1;i<e.length;i++)t=e[i],n+="L"+t.x+" "+t.y;return n+="Z",n}function lb(e){let t,i,n,s,r,o,a,l,h,c;const d=[];for(a=0,l=0,c=0,h=e.length;c<h;++c){const h=e[c];let p="";p=h.command,"y1"in h&&(s=h.y1),"y2"in h&&(o=h.y2),"x1"in h&&(n=h.x1),"x2"in h&&(r=h.x2),"x"in h&&(a=h.x),"y"in h&&(l=h.y);const u=d[d.length-1];switch(p){case"M":d.push({command:"M",x:a,y:l});break;case"L":d.push({command:"L",x0:t,y0:i,x:a,y:l});break;case"H":d.push({command:"L",x0:t,y0:i,x:a,y:i});break;case"V":d.push({command:"L",x0:t,y0:i,x:t,y:l});break;case"C":d.push({command:"C",x0:t,y0:i,x1:n,y1:s,x2:r,y2:o,x:a,y:l});break;case"S":if(u){let e;e="C"===u.command||"S"===u.command?{x:u.x2,y:u.y2}:{x:t,y:i};const n={x:2*t-e.x,y:2*i-e.y};d.push({command:"C",x0:t,y0:i,x1:n.x,y1:n.y,x2:r,y2:o,x:a,y:l})}break;case"Q":d.push({command:"Q",x0:t,y0:i,x1:n,y1:s,x:a,y:l});break;case"T":if(u){let e;e="Q"===u.command?{x:u.x1,y:u.y1}:{x:t,y:i};const n={x:2*t-e.x,y:2*i-e.y};d.push({command:"Q",x0:t,y0:i,x1:n.x,y1:n.y,x:a,y:l})}break;case"A":const e=h;e.command="A",d.push(e);break;case"Z":case"z":d.push({command:"Z"}),a=t,l=i}t=a,i=l}return d}function hb(e,t,i,n,s,r,o,a){let l,h,c,d,p,u,g,m,f;for(p=0,u=0,m=0,g=e.length;m<g;++m){const g=e[m],y=g.command;"x"in g&&(p=g.x),"y"in g&&(u=g.y),"y1"in g&&(h=g.y1),"y2"in g&&(d=g.y2),"x1"in g&&(l=g.x1),"x2"in g&&(c=g.x2),n?(void 0!==p&&(p=db(p,t,s,o)),void 0!==u&&(u=db(u,i,r,a)),void 0!==l&&(l=db(l,t,s,o)),void 0!==h&&(h=db(h,i,r,a)),void 0!==c&&(c=db(c,t,s,o)),void 0!==d&&(d=db(d,i,r,a))):(void 0!==p&&(p=Number((p+t).toFixed(2))),void 0!==u&&(u=Number((u+i).toFixed(2))),void 0!==l&&(l=Number((l+t).toFixed(2))),void 0!==h&&(h=Number((h+i).toFixed(2))),void 0!==c&&(c=Number((c+t).toFixed(2))),void 0!==d&&(d=Number((d+i).toFixed(2)))),f=cb(g,y,{x:p,y:u,x1:l,y1:h,x2:c,y2:d,r1:g.r1,r2:g.r2},n,t,i),f&&(e[m]=f)}return ub(e)}function cb(e,t,i,n,s,r){switch(t){case"M":case"L":e.x=i.x,e.y=i.y;break;case"H":e.x=i.x;break;case"V":e.y=i.y;break;case"C":e.x=i.x,e.y=i.y,e.x1=i.x1,e.y1=i.y1,e.x2=i.x2,e.y2=i.y2;break;case"S":e.x=i.x,e.y=i.y,e.x2=i.x2,e.y2=i.y2;break;case"Q":e.x=i.x,e.y=i.y,e.x1=i.x1,e.y1=i.y1;break;case"T":e.x=i.x,e.y=i.y;break;case"A":let t=i.r1,o=i.r2;n&&(i.r1=t*=s,i.r2=o*=r),e.x=i.x,e.y=i.y,e.r1=i.r1,e.r2=i.r2;break;case"z":case"Z":e={command:"Z"}}return e}function db(e,t,i,n){return e!==i?e=n!==i?e*t-(Number(i)*t-Number(i))+(n-Number(i)):Number(e)*t-(Number(i)*t-Number(i)):n!==i&&(e=n),Number(e.toFixed(2))}function pb(e){let t,i,n,s,r,o,a,l,h,c;for(a=0,l=0,c=0,h=e.length;c<h;++c){const h=e[c],d=h.command;if(/[MLHVCSQTA]/.test(d))"x"in h&&(h.x=a=h.x),"y"in h&&(h.y=l=h.y);else{let p;switch("x1"in h&&(h.x1=n=a+h.x1),"x2"in h&&(h.x2=r=a+h.x2),"y1"in h&&(h.y1=s=l+h.y1),"y2"in h&&(h.y2=o=l+h.y2),"x"in h&&(h.x=a+=h.x),"y"in h&&(h.y=l+=h.y),d){case"m":case"M":p={command:"M",x:a,y:l};break;case"l":case"L":p={command:"L",x:a,y:l};break;case"h":case"H":p={command:"H",x:a};break;case"v":case"V":p={command:"V",y:l};break;case"c":case"C":p={command:"C",x:a,y:l,x1:n,y1:s,x2:r,y2:o};break;case"s":case"S":p={command:"S",x:a,y:l,x2:r,y2:o};break;case"q":case"Q":p={command:"Q",x:a,y:l,x1:n,y1:s};break;case"t":case"T":p={command:"T",x:a,y:l};break;case"a":case"A":p={command:"A",x:a,y:l},p.r1=h.r1,p.r2=h.r2,p.angle=h.angle,p.largeArc=h.largeArc,p.sweep=h.sweep;break;case"z":case"Z":p={command:"Z"},a=t,l=i,p=e[c]}p&&(e[c]=p)}"M"!==d&&"m"!==d||(t=a,i=l)}return e}function ub(e){let t,i="";for(t=0;t<e.length;t++)i+=0===t?gb(e[t]):" "+gb(e[t]);return i}function gb(e){let t="";switch(e.command){case"Z":case"z":t=e.command;break;case"M":case"m":case"L":case"l":t=e.command+" "+e.x+" "+e.y;break;case"C":case"c":t=e.command+" "+e.x1+" "+e.y1+" "+e.x2+" "+e.y2+" "+e.x+" "+e.y;break;case"Q":case"q":t=e.command+" "+e.x1+" "+e.y1+" "+e.x+" "+e.y;break;case"A":case"a":t=e.command+" "+e.r1+" "+e.r2+" "+e.angle+" "+(e.largeArc?"1":"0")+" "+(e.sweep?"1":"0")+" "+e.x+" "+e.y;break;case"H":case"h":t=e.command+" "+e.x;break;case"V":case"v":t=e.command+" "+e.y;break;case"S":case"s":t=e.command+" "+e.x2+" "+e.y2+" "+e.x+" "+e.y;break;case"T":case"t":t=e.command+" "+e.x+" "+e.y}return t}let mb=(()=>{class e{constructor(e,t,i,n){this.x=Number.MAX_VALUE,this.y=Number.MAX_VALUE,this.width=0,this.height=0,void 0===e||void 0===t?(e=t=Number.MAX_VALUE,i=n=0):(void 0===i&&(i=0),void 0===n&&(n=0)),this.x=e,this.y=t,this.width=i,this.height=n}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}get topLeft(){return{x:this.left,y:this.top}}get topRight(){return{x:this.right,y:this.top}}get bottomLeft(){return{x:this.left,y:this.bottom}}get bottomRight(){return{x:this.right,y:this.bottom}}get middleLeft(){return{x:this.left,y:this.y+this.height/2}}get middleRight(){return{x:this.right,y:this.y+this.height/2}}get topCenter(){return{x:this.x+this.width/2,y:this.top}}get bottomCenter(){return{x:this.x+this.width/2,y:this.bottom}}get center(){return{x:this.x+this.width/2,y:this.y+this.height/2}}equals(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}uniteRect(e){const t=Math.max(Number.NaN===this.right||this.x===Number.MAX_VALUE?e.right:this.right,e.right),i=Math.max(Number.NaN===this.bottom||this.y===Number.MAX_VALUE?e.bottom:this.bottom,e.bottom);return this.x=Math.min(this.left,e.left),this.y=Math.min(this.top,e.top),this.width=t-this.x,this.height=i-this.y,this}unitePoint(e){if(this.x===Number.MAX_VALUE)return this.x=e.x,void(this.y=e.y);const t=Math.min(this.left,e.x),i=Math.min(this.top,e.y),n=Math.max(this.right,e.x),s=Math.max(this.bottom,e.y);this.x=t,this.y=i,this.width=n-this.x,this.height=s-this.y}Inflate(e){return this.x-=e,this.y-=e,this.width+=2*e,this.height+=2*e,this}intersects(e){return!(this.right<e.left||this.left>e.right||this.top>e.bottom||this.bottom<e.top)}containsRect(e){return this.left<=e.left&&this.right>=e.right&&this.top<=e.top&&this.bottom>=e.bottom}containsPoint(e,t=0){return this.left-t<=e.x&&this.right+t>=e.x&&this.top-t<=e.y&&this.bottom+t>=e.y}static toBounds(t){const i=new e;for(const e of t)i.unitePoint(e);return i}}return e.empty=new e(Number.MAX_VALUE,Number.MIN_VALUE,0,0),e})();var fb=function(e){return e[e.Identity=0]="Identity",e[e.Translation=1]="Translation",e[e.Scaling=2]="Scaling",e[e.Unknown=4]="Unknown",e}({});class yb{constructor(e,t,i,n,s,r,o){this.m11=e,this.m12=t,this.m21=i,this.m22=n,this.offsetX=s,this.offsetY=r,this.type=o}}function bb(){return new yb(1,0,0,1,0,0,fb.Identity)}function vb(e,t){const i=function(e,t,i){switch(e.type){case fb.Identity:break;case fb.Translation:t+=e.offsetX,i+=e.offsetY;break;case fb.Scaling:t*=e.m11,i*=e.m22;break;case fb.Translation|fb.Scaling:t*=e.m11,t+=e.offsetX,i*=e.m22,i+=e.offsetY;break;default:const n=t*e.m12+e.offsetY;t*=e.m11,t+=i*e.m21+e.offsetX,i*=e.m22,i+=n}return{x:t,y:i}}(e,t.x,t.y);return{x:Math.round(100*i.x)/100,y:Math.round(100*i.y)/100}}function wb(e,t,i,n){Cb(e,function(e,t,i){const n=bb(),s=Math.sin(e),r=Math.cos(e),o=t*(1-r)+i*s,a=i*(1-r)-t*s;return n.type=fb.Unknown,Pb(n,r,s,-s,r,o,a),n}(.017453292519943295*(t%=360),i||0,n||0))}function xb(e,t,i,n=0,s=0){Cb(e,function(e,t,i,n){const s=bb();return s.type=i||n?fb.Scaling|fb.Translation:fb.Scaling,Pb(s,e,0,0,t,i-e*i,n-t*n),s}(t,i,n,s))}function Sb(e,t,i){return e.type&fb.Identity?(e.type=fb.Translation,void Pb(e,1,0,0,1,t,i)):e.type&fb.Unknown?(e.offsetX+=t,void(e.offsetY+=i)):(e.offsetX+=t,e.offsetY+=i,void(e.type|=fb.Translation))}function Cb(e,t){const i=e.type,n=t.type;if(n===fb.Identity)return;if(i===fb.Identity)return Ob(e,t),void(e.type=t.type);if(n===fb.Translation)return e.offsetX+=t.offsetX,e.offsetY+=t.offsetY,void(i!==fb.Unknown&&(e.type|=fb.Translation));if(i!==fb.Translation){const s=i<<4|n;switch(s){case 34:return e.m11*=t.m11,void(e.m22*=t.m22);case 35:return e.m11*=t.m11,e.m22*=t.m22,e.offsetX=t.offsetX,e.offsetY=t.offsetY,void(e.type=fb.Translation|fb.Scaling);case 36:break;default:switch(s){case 50:return e.m11*=t.m11,e.m22*=t.m22,e.offsetX*=t.m11,void(e.offsetY*=t.m22);case 51:return e.m11*=t.m11,e.m22*=t.m22,e.offsetX=t.m11*e.offsetX+t.offsetX,void(e.offsetY=t.m22*e.offsetY+t.offsetY);case 52:break;default:switch(s){case 66:case 67:case 68:break;default:return}}}const r=bb();return Pb(r,e.m11*t.m11+e.m12*t.m21,e.m11*t.m12+e.m12*t.m22,e.m21*t.m11+e.m22*t.m21,e.m21*t.m12+e.m22*t.m22,e.offsetX*t.m11+e.offsetY*t.m21+t.offsetX,e.offsetX*t.m12+e.offsetY*t.m22+t.offsetY),r.m21||r.m12?r.type=fb.Unknown:((r.m11&&1!==r.m11||r.m22&&1!==r.m22)&&(r.type=fb.Scaling),(r.offsetX||r.offsetY)&&(r.type|=fb.Translation),(r.type&(fb.Translation|fb.Scaling))===fb.Identity&&(r.type=fb.Identity),r.type=fb.Scaling|fb.Translation),Ob(e,r),void(e.type=r.type)}const s=e.offsetX,r=e.offsetY;e.offsetX=s*t.m11+r*t.m21+t.offsetX,e.offsetY=s*t.m12+r*t.m22+t.offsetY,e.type=n!==fb.Unknown?fb.Translation|fb.Scaling:fb.Unknown}function Pb(e,t,i,n,s,r,o){e.m11=t,e.m12=i,e.m21=n,e.m22=s,e.offsetX=r,e.offsetY=o}function Ob(e,t){e.m11=t.m11,e.m12=t.m12,e.m21=t.m21,e.m22=t.m22,e.offsetX=t.offsetX,e.offsetY=t.offsetY,e.type=t.type}var Tb=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let Eb=e=>{if(e)switch(e.type){case"Linear":return zb;case"Radial":return Lb;default:return zb}return zb};class Ab{constructor(e,t,i,n){this.left=e,this.right=t,this.top=i,this.bottom=n}}let Ib=(()=>{class e extends bg{}return Tb([ig(0)],e.prototype,"left",void 0),Tb([ig(0)],e.prototype,"right",void 0),Tb([ig(0)],e.prototype,"top",void 0),Tb([ig(0)],e.prototype,"bottom",void 0),e})(),Db=(()=>{class e extends bg{}return Tb([ig(45)],e.prototype,"angle",void 0),Tb([ig(5)],e.prototype,"distance",void 0),Tb([ig(.7)],e.prototype,"opacity",void 0),Tb([ig("lightgrey")],e.prototype,"color",void 0),e})(),Mb=(()=>{class e extends bg{getClassName(){return"Stop"}}return Tb([ig("")],e.prototype,"color",void 0),Tb([ig(0)],e.prototype,"offset",void 0),Tb([ig(1)],e.prototype,"opacity",void 0),e})(),Rb=(()=>{class e extends bg{}return Tb([rg([],Mb)],e.prototype,"stops",void 0),Tb([ig("None")],e.prototype,"type",void 0),Tb([ig("")],e.prototype,"id",void 0),e})(),zb=(()=>{class e extends Rb{}return Tb([ig(0)],e.prototype,"x1",void 0),Tb([ig(0)],e.prototype,"x2",void 0),Tb([ig(0)],e.prototype,"y1",void 0),Tb([ig(0)],e.prototype,"y2",void 0),e})(),Lb=(()=>{class e extends Rb{}return Tb([ig(0)],e.prototype,"cx",void 0),Tb([ig(0)],e.prototype,"cy",void 0),Tb([ig(0)],e.prototype,"fx",void 0),Tb([ig(0)],e.prototype,"fy",void 0),Tb([ig(50)],e.prototype,"r",void 0),e})(),kb=(()=>{class e extends bg{}return Tb([ig("white")],e.prototype,"fill",void 0),Tb([ig("black")],e.prototype,"strokeColor",void 0),Tb([ig("")],e.prototype,"strokeDashArray",void 0),Tb([ig(1)],e.prototype,"strokeWidth",void 0),Tb([ig(1)],e.prototype,"opacity",void 0),Tb([sg(Eb)],e.prototype,"gradient",void 0),e})(),jb=(()=>{class e extends kb{}return Tb([ig("transparent")],e.prototype,"fill",void 0),e})(),Hb=(()=>{class e extends kb{}return Tb([ig("black")],e.prototype,"color",void 0),Tb([ig("Arial")],e.prototype,"fontFamily",void 0),Tb([ig(12)],e.prototype,"fontSize",void 0),Tb([ig(!1)],e.prototype,"italic",void 0),Tb([ig(!1)],e.prototype,"bold",void 0),Tb([ig("CollapseSpace")],e.prototype,"whiteSpace",void 0),Tb([ig("WrapWithOverflow")],e.prototype,"textWrapping",void 0),Tb([ig("Center")],e.prototype,"textAlign",void 0),Tb([ig("None")],e.prototype,"textDecoration",void 0),Tb([ig("Wrap")],e.prototype,"textOverflow",void 0),Tb([ig("transparent")],e.prototype,"fill",void 0),e})();var _b=function(e){return e[e.Default=0]="Default",e[e.expandNode=2]="expandNode",e[e.interaction=4]="interaction",e[e.GroupingInProgress=8]="GroupingInProgress",e[e.GroupClipboardInProcess=16]="GroupClipboardInProcess",e[e.ClearObject=32]="ClearObject",e}({}),Nb=function(e){return e[e.Visible=1]="Visible",e[e.Hidden=2]="Hidden",e[e.Hover=4]="Hover",e[e.Connect=8]="Connect",e}({}),Bb=function(e){return e[e.None=0]="None",e[e.ShowHorizontalLines=1]="ShowHorizontalLines",e[e.ShowVerticalLines=2]="ShowVerticalLines",e[e.ShowLines=3]="ShowLines",e[e.SnapToHorizontalLines=4]="SnapToHorizontalLines",e[e.SnapToVerticalLines=8]="SnapToVerticalLines",e[e.SnapToLines=12]="SnapToLines",e[e.SnapToObject=16]="SnapToObject",e[e.All=31]="All",e}({}),Wb=function(e){return e[e.None=1]="None",e[e.ConnectorSourceThumb=2]="ConnectorSourceThumb",e[e.ConnectorTargetThumb=4]="ConnectorTargetThumb",e[e.ResizeSouthEast=8]="ResizeSouthEast",e[e.ResizeSouthWest=16]="ResizeSouthWest",e[e.ResizeNorthEast=32]="ResizeNorthEast",e[e.ResizeNorthWest=64]="ResizeNorthWest",e[e.ResizeEast=128]="ResizeEast",e[e.ResizeWest=256]="ResizeWest",e[e.ResizeSouth=512]="ResizeSouth",e[e.ResizeNorth=1024]="ResizeNorth",e[e.Rotate=2048]="Rotate",e[e.UserHandle=4096]="UserHandle",e[e.ToolTip=8192]="ToolTip",e[e.ResizeAll=2046]="ResizeAll",e[e.All=16382]="All",e}({}),Ub=function(e){return e[e.None=1]="None",e[e.Select=2]="Select",e[e.Delete=4]="Delete",e[e.Drag=8]="Drag",e[e.DragSourceEnd=16]="DragSourceEnd",e[e.DragTargetEnd=32]="DragTargetEnd",e[e.DragSegmentThumb=64]="DragSegmentThumb",e[e.AllowDrop=128]="AllowDrop",e[e.Bridging=256]="Bridging",e[e.BridgeObstacle=512]="BridgeObstacle",e[e.InheritBridging=1024]="InheritBridging",e[e.PointerEvents=2048]="PointerEvents",e[e.Tooltip=4096]="Tooltip",e[e.InheritTooltip=8192]="InheritTooltip",e[e.Interaction=4218]="Interaction",e[e.ReadOnly=16384]="ReadOnly",e[e.LineRouting=32768]="LineRouting",e[e.InheritLineRouting=65536]="InheritLineRouting",e[e.ConnectToNearByNode=131072]="ConnectToNearByNode",e[e.ConnectToNearByPort=262144]="ConnectToNearByPort",e[e.ConnectToNearByElement=393216]="ConnectToNearByElement",e[e.Default=470590]="Default",e}({}),Fb=function(e){return e[e.ReadOnly=2]="ReadOnly",e[e.InheritReadOnly=4]="InheritReadOnly",e[e.Select=8]="Select",e[e.Drag=16]="Drag",e[e.Resize=32]="Resize",e[e.Rotate=64]="Rotate",e[e.Interaction=120]="Interaction",e[e.None=0]="None",e}({}),Vb=function(e){return e[e.None=0]="None",e[e.Select=2]="Select",e[e.Drag=4]="Drag",e[e.Rotate=8]="Rotate",e[e.Shadow=16]="Shadow",e[e.PointerEvents=32]="PointerEvents",e[e.Delete=64]="Delete",e[e.InConnect=128]="InConnect",e[e.OutConnect=256]="OutConnect",e[e.Individual=512]="Individual",e[e.Expandable=1024]="Expandable",e[e.AllowDrop=2048]="AllowDrop",e[e.Inherit=78]="Inherit",e[e.ResizeNorthEast=4096]="ResizeNorthEast",e[e.ResizeEast=8192]="ResizeEast",e[e.ResizeSouthEast=16384]="ResizeSouthEast",e[e.ResizeSouth=32768]="ResizeSouth",e[e.ResizeSouthWest=65536]="ResizeSouthWest",e[e.ResizeWest=131072]="ResizeWest",e[e.ResizeNorthWest=262144]="ResizeNorthWest",e[e.ResizeNorth=524288]="ResizeNorth",e[e.Resize=1044480]="Resize",e[e.AspectRatio=1048576]="AspectRatio",e[e.Tooltip=2097152]="Tooltip",e[e.InheritTooltip=4194304]="InheritTooltip",e[e.ReadOnly=8388608]="ReadOnly",e[e.HideThumbs=16777216]="HideThumbs",e[e.AllowMovingOutsideLane=33554432]="AllowMovingOutsideLane",e[e.Default=5240814]="Default",e}({}),Yb=function(e){return e[e.None=0]="None",e[e.ElementIsPort=2]="ElementIsPort",e[e.ElementIsGroup=4]="ElementIsGroup",e[e.HorizontalLaneHeader=8]="HorizontalLaneHeader",e}({}),Xb=function(e){return e[e.Rotate=2]="Rotate",e[e.ConnectorSource=4]="ConnectorSource",e[e.ConnectorTarget=8]="ConnectorTarget",e[e.ResizeNorthEast=16]="ResizeNorthEast",e[e.ResizeEast=32]="ResizeEast",e[e.ResizeSouthEast=64]="ResizeSouthEast",e[e.ResizeSouth=128]="ResizeSouth",e[e.ResizeSouthWest=256]="ResizeSouthWest",e[e.ResizeWest=512]="ResizeWest",e[e.ResizeNorthWest=1024]="ResizeNorthWest",e[e.ResizeNorth=2048]="ResizeNorth",e[e.Default=4094]="Default",e}({}),Gb=function(e){return e[e.None=1]="None",e[e.Bridging=2]="Bridging",e[e.UndoRedo=4]="UndoRedo",e[e.Tooltip=8]="Tooltip",e[e.UserInteraction=16]="UserInteraction",e[e.ApiUpdate=32]="ApiUpdate",e[e.PageEditable=48]="PageEditable",e[e.Zoom=64]="Zoom",e[e.PanX=128]="PanX",e[e.PanY=256]="PanY",e[e.Pan=384]="Pan",e[e.ZoomTextEdit=512]="ZoomTextEdit",e[e.Virtualization=1024]="Virtualization",e[e.LineRouting=2048]="LineRouting",e[e.Default=500]="Default",e}({}),qb=function(e){return e[e.None=0]="None",e[e.SingleSelect=1]="SingleSelect",e[e.MultipleSelect=2]="MultipleSelect",e[e.ZoomPan=4]="ZoomPan",e[e.DrawOnce=8]="DrawOnce",e[e.ContinuousDraw=16]="ContinuousDraw",e[e.Default=3]="Default",e}({}),Zb=function(e){return e[e.Self=1]="Self",e[e.Parent=2]="Parent",e}({}),$b=function(e){return e[e.None=0]="None",e[e.Control=1]="Control",e[e.Meta=1]="Meta",e[e.Alt=2]="Alt",e[e.Shift=4]="Shift",e}({}),Qb=function(e){return e[e.None=null]="None",e[e.Number0=0]="Number0",e[e.Number1=1]="Number1",e[e.Number2=2]="Number2",e[e.Number3=3]="Number3",e[e.Number4=4]="Number4",e[e.Number5=5]="Number5",e[e.Number6=6]="Number6",e[e.Number7=7]="Number7",e[e.Number8=8]="Number8",e[e.Number9=9]="Number9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.Left=37]="Left",e[e.Up=38]="Up",e[e.Right=39]="Right",e[e.Down=40]="Down",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.Delete=46]="Delete",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.BackSpace=8]="BackSpace",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.Star=56]="Star",e[e.Plus=187]="Plus",e[e.Minus=189]="Minus",e}({}),Jb=function(e){return e[e.Render=2]="Render",e[e.PublicMethod=4]="PublicMethod",e[e.ToolAction=8]="ToolAction",e[e.UndoRedo=16]="UndoRedo",e[e.TextEdit=32]="TextEdit",e[e.Group=64]="Group",e[e.Clear=128]="Clear",e[e.PreventClearSelection=256]="PreventClearSelection",e[e.Interactions=512]="Interactions",e[e.PreventHistory=1024]="PreventHistory",e[e.PreventIconsUpdate=2048]="PreventIconsUpdate",e[e.PreventCollectionChangeOnDragOver=4096]="PreventCollectionChangeOnDragOver",e[e.PreventZIndexOnDragging=8192]="PreventZIndexOnDragging",e[e.isGroupDragging=16384]="isGroupDragging",e[e.DragUsingMouse=32768]="DragUsingMouse",e[e.DecoratorPropertyChange=65536]="DecoratorPropertyChange",e[e.PreventLaneContainerUpdate=131072]="PreventLaneContainerUpdate",e}({}),Kb=function(e){return e[e.None=2]="None",e[e.DrawSelectorBorder=4]="DrawSelectorBorder",e[e.PreventRenderSelector=8]="PreventRenderSelector",e}({}),ev=function(e){return e[e.None=0]="None",e[e.PreventDrag=2]="PreventDrag",e[e.PreventScale=4]="PreventScale",e[e.PreventDataInit=8]="PreventDataInit",e[e.hScrollbarMoved=16]="hScrollbarMoved",e[e.vScrollbarMoved=32]="vScrollbarMoved",e[e.AnimationClick=64]="AnimationClick",e[e.EnableGroupAction=128]="EnableGroupAction",e[e.PanInProgress=256]="PanInProgress",e[e.OverViewAction=512]="OverViewAction",e}({}),tv=function(e){return e[e.None=0]="None",e[e.PropertyChange=1024]="PropertyChange",e[e.Interaction=2048]="Interaction",e}({}),iv=function(e){return e[e.Zero=0]="Zero",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four",e[e.Five=5]="Five",e}({}),nv=function(e){return e[e.collectionChange=0]="collectionChange",e[e.rotateChange=1]="rotateChange",e[e.positionChange=2]="positionChange",e[e.propertyChange=3]="propertyChange",e[e.selectionChange=4]="selectionChange",e[e.sizeChange=5]="sizeChange",e[e.drop=6]="drop",e[e.sourcePointChange=7]="sourcePointChange",e[e.targetPointChange=8]="targetPointChange",e[e.connectionChange=9]="connectionChange",e[e.animationComplete=10]="animationComplete",e[e.click=11]="click",e[e.doubleClick=12]="doubleClick",e[e.scrollChange=13]="scrollChange",e[e.dragEnter=14]="dragEnter",e[e.dragLeave=15]="dragLeave",e[e.dragOver=16]="dragOver",e[e.textEdit=17]="textEdit",e[e.paletteSelectionChange=18]="paletteSelectionChange",e[e.historyChange=19]="historyChange",e[e.mouseEnter=20]="mouseEnter",e[e.mouseLeave=21]="mouseLeave",e[e.mouseOver=22]="mouseOver",e[e.expandStateChange=23]="expandStateChange",e[e.segmentCollectionChange=24]="segmentCollectionChange",e[e.commandExecute=25]="commandExecute",e[e.historyStateChange=26]="historyStateChange",e[e.onUserHandleMouseDown=27]="onUserHandleMouseDown",e[e.onUserHandleMouseUp=28]="onUserHandleMouseUp",e[e.onUserHandleMouseEnter=29]="onUserHandleMouseEnter",e[e.onUserHandleMouseLeave=30]="onUserHandleMouseLeave",e[e.onImageLoad=31]="onImageLoad",e[e.onDoBindingInit=32]="onDoBindingInit",e[e.keyUp=33]="keyUp",e[e.keyDown=34]="keyDown",e[e.fixedUserHandleClick=35]="fixedUserHandleClick",e}({}),sv=function(e){return e[e.None=1]="None",e[e.Drag=2]="Drag",e[e.Draw=4]="Draw",e[e.InConnect=8]="InConnect",e[e.OutConnect=16]="OutConnect",e[e.Default=24]="Default",e}({});class rv{constructor(){this.pivot={x:.5,y:.5},this.isDirt=!0,this.isExport=!1,this.exportScaleValue={x:0,y:0},this.exportScaleOffset={x:0,y:0},this.canApplyStyle=!0,this.visible=!0,this.offsetX=0,this.offsetY=0,this.cornerRadius=0,this.minHeight=void 0,this.minWidth=void 0,this.maxWidth=void 0,this.maxHeight=void 0,this.width=void 0,this.height=void 0,this.rotateAngle=0,this.margin={left:0,right:0,top:0,bottom:0},this.horizontalAlignment="Auto",this.verticalAlignment="Auto",this.flip="None",this.relativeMode="Point",this.transform=Zb.Self|Zb.Parent,this.style={fill:"white",strokeColor:"black",opacity:1,strokeWidth:1},this.desiredSize=new nb,this.actualSize=new nb,this.parentTransform=0,this.preventContainer=!1,this.isSvgRender=!1,this.bounds=new mb(0,0,0,0),this.shadow=null,this.description="",this.staticSize=!1,this.isRectElement=!1,this.isCalculateDesiredSize=!0,this.flipOffset={x:0,y:0},this.elementActions=Yb.None,this.inversedAlignment=!0,this.position=void 0,this.unitMode=void 0,this.float=!1,this.floatingBounds=void 0}setOffsetWithRespectToBounds(e,t,i){this.unitMode=i,this.position={x:e,y:t}}getAbsolutePosition(e){if(void 0!==this.position)return"Absolute"===this.unitMode?this.position:{x:this.position.x*e.width,y:this.position.y*e.height}}get outerBounds(){return this.floatingBounds||this.bounds}set outerBounds(e){this.floatingBounds=e}measure(e,t,i){let n=void 0!==this.height?this.height:(e.height||0)-this.margin.top-this.margin.bottom;return this.id&&0===n&&this.elementActions&Yb.HorizontalLaneHeader&&(n=this.actualSize.height),this.desiredSize=new nb(void 0!==this.width?this.width:(e.width||0)-this.margin.left-this.margin.right,n),this.isCalculateDesiredSize&&(this.desiredSize=this.validateDesiredSize(this.desiredSize,e)),this.desiredSize}arrange(e){return this.actualSize=e,this.updateBounds(),this.actualSize}updateBounds(){this.bounds=$P(this)}validateDesiredSize(e,t){return!this.isRectElement||this.width||this.minWidth||this.maxWidth||(e.width=50),!this.isRectElement||this.height||this.minHeight||this.maxHeight||(e.height=50),(void 0===e||void 0!==this.width&&void 0!==this.height)&&((e=e||new nb).width=void 0===this.width?(t.width||0)-this.margin.left-this.margin.right:this.width,e.height=void 0===this.height?(t.height||0)-this.margin.top-this.margin.bottom:this.height),void 0!==this.minWidth&&(e.width=Math.max(e.width,this.minWidth)),void 0!==this.minHeight&&(e.height=Math.max(e.height,this.minHeight)),void 0!==this.maxWidth&&0!==this.maxWidth&&(e.width=Math.min(e.width,this.maxWidth)),void 0!==this.maxHeight&&0!==this.maxHeight&&(e.height=Math.min(e.height,this.maxHeight)),e}}class ov extends rv{constructor(){super(...arguments),this.padding=new Ab(0,0,0,0),this.desiredBounds=void 0,this.measureChildren=!0,this.prevRotateAngle=0}hasChildren(){return void 0!==this.children&&this.children.length>0}measure(e,t,i){let n,s,r;if(this.desiredBounds=void 0,this.hasChildren()){for(let n=0;n<this.children.length;n++){s=this.children[n],"Stretch"!==s.horizontalAlignment||e.width||(e.width=s.bounds.width),"Stretch"!==s.verticalAlignment||e.height||(e.height=s.bounds.height);const o="Stretch"===s.horizontalAlignment||"Stretch"===s.verticalAlignment;(this.measureChildren||o||s instanceof ov&&void 0!==s.measureChildren)&&s.measure(e,t,i),r=this.GetChildrenBounds(s),"Stretch"!==s.horizontalAlignment&&"Stretch"!==s.verticalAlignment?void 0===this.desiredBounds?this.desiredBounds=r:this.desiredBounds.uniteRect(r):!this.actualSize||this.actualSize.width||this.actualSize.height||s.preventContainer||"Stretch"!==s.horizontalAlignment||"Stretch"!==s.verticalAlignment||(void 0===this.desiredBounds?this.desiredBounds=s.bounds:this.desiredBounds.uniteRect(s.bounds))}if(void 0!==this.desiredBounds&&0!==this.rotateAngle){const e=lO(this.rotateAngle,void 0,void 0,{x:this.desiredBounds.x+this.desiredBounds.width*this.pivot.x,y:this.desiredBounds.y+this.desiredBounds.height*this.pivot.y});this.desiredBounds.x=e.x-this.desiredBounds.width*this.pivot.x,this.desiredBounds.y=e.y-this.desiredBounds.height*this.pivot.y}this.desiredBounds&&(n=new nb(this.desiredBounds.width,this.desiredBounds.height))}return n=this.validateDesiredSize(n,e),this.stretchChildren(n),this.desiredSize=n,n}arrange(e){let t;const i=this.desiredBounds;if(i&&(this.offsetX=i.x+i.width*this.pivot.x,this.offsetY=i.y+i.height*this.pivot.y,this.hasChildren()))for(let n=0;n<this.children.length;n++){t=this.children[n];let e=!1;"Stretch"===t.horizontalAlignment&&(t.offsetX=this.offsetX,t.parentTransform=this.parentTransform+this.rotateAngle,this.flip&&this.elementActions&Yb.ElementIsGroup&&(t.parentTransform="Horizontal"===this.flip||"Vertical"===this.flip?-t.parentTransform:t.parentTransform),e=!0),"Stretch"===t.verticalAlignment&&(t.offsetY=this.offsetY,t.parentTransform=this.parentTransform+this.rotateAngle,e=!0),(e||this.measureChildren||t instanceof ov&&void 0!==t.measureChildren)&&t.arrange(t.desiredSize)}return this.actualSize=e,this.updateBounds(),this.prevRotateAngle=this.rotateAngle,e}stretchChildren(e){if(this.hasChildren())for(const t of this.children)"Stretch"!==t.horizontalAlignment&&void 0!==t.desiredSize.width||(t.desiredSize.width=e.width-t.margin.left-t.margin.right),"Stretch"!==t.verticalAlignment&&void 0!==t.desiredSize.height||(t.desiredSize.height=e.height-t.margin.top-t.margin.bottom),t instanceof ov&&t.stretchChildren(t.desiredSize)}applyPadding(e){e.width+=this.padding.left+this.padding.right,e.height+=this.padding.top+this.padding.bottom}findChildOffsetFromCenter(e,t){let i={x:(n={x:t.x-e.desiredSize.width/2,y:t.y-e.desiredSize.height/2}).x+(s=e).desiredSize.width*s.pivot.x,y:n.y+s.desiredSize.height*s.pivot.y};var n,s;i=lO(e.rotateAngle,t.x,t.y,i),i=lO(this.rotateAngle+this.parentTransform,this.offsetX,this.offsetY,i),e.offsetX=i.x,e.offsetY=i.y}GetChildrenBounds(e){const t=e.desiredSize.clone(),i=e.offsetX-t.width*e.pivot.x,n=e.offsetY-t.height*e.pivot.y,s=i+t.width,r=n+t.height;let o={x:i,y:n},a={x:s,y:n},l={x:i,y:r},h={x:s,y:r};return o=lO(e.rotateAngle,e.offsetX,e.offsetY,o),a=lO(e.rotateAngle,e.offsetX,e.offsetY,a),l=lO(e.rotateAngle,e.offsetX,e.offsetY,l),h=lO(e.rotateAngle,e.offsetX,e.offsetY,h),0!==this.rotateAngle&&(o=lO(-this.rotateAngle,void 0,void 0,o),a=lO(-this.rotateAngle,void 0,void 0,a),l=lO(-this.rotateAngle,void 0,void 0,l),h=lO(-this.rotateAngle,void 0,void 0,h)),mb.toBounds([o,a,l,h])}}class av extends rv{constructor(){super(),this.textContent="",this.canMeasure=!0,this.isLaneOrientation=!1,this.canConsiderBounds=!0,this.hyperlink={color:"blue"},this.doWrap=!0,this.textNodes=[],this.style={color:"black",fill:"transparent",strokeColor:"black",strokeWidth:1,fontFamily:"Arial",fontSize:12,whiteSpace:"CollapseSpace",textWrapping:"WrapWithOverflow",textAlign:"Center",italic:!1,bold:!1,textDecoration:"None",strokeDashArray:"",opacity:5,gradient:null,textOverflow:"Wrap"},this.style.fill="transparent",this.style.strokeColor="transparent"}get content(){return this.textContent}set content(e){this.textContent!==e&&(this.textContent=e,this.isDirt=!0,this.doWrap=!0)}get childNodes(){return this.textNodes}set childNodes(e){this.textNodes=e}get wrapBounds(){return this.textWrapBounds}set wrapBounds(e){this.textWrapBounds=e}refreshTextElement(){this.isDirt=!0}measure(e){let t;return t=this.isDirt&&this.canMeasure?function(e,t,i,n,s){const r=new nb(0,0);let o,a;const l=function(e,t){const i={fill:e.style.fill,stroke:e.style.strokeColor,angle:e.rotateAngle+e.parentTransform,pivotX:e.pivot.x,pivotY:e.pivot.y,strokeWidth:e.style.strokeWidth,dashArray:e.style.strokeDashArray,opacity:e.style.opacity,shadow:e.shadow,gradient:e.style.gradient,visible:e.visible,id:e.id,description:e.description,width:t||e.actualSize.width,height:e.actualSize.height,x:e.offsetX-e.actualSize.width*e.pivot.x+.5,y:e.offsetY-e.actualSize.height*e.pivot.y+.5};return i.fontSize=e.style.fontSize,i.fontFamily=e.style.fontFamily,i.textOverflow=e.style.textOverflow,i.textDecoration=e.style.textDecoration,i.doWrap=e.doWrap,i.whiteSpace=oO(e.style.whiteSpace,e.style.textWrapping),i.content=e.content,i.textWrapping=e.style.textWrapping,i.breakWord=iO(e.style.textWrapping),i.textAlign=tO(e.style.textAlign),i.color=e.style.color,i.italic=e.style.italic,i.bold=e.style.bold,i.dashArray="",i.strokeWidth=0,i.fill="",i}(e,n);return e.childNodes=o=function(e,t,i){let n,s,r=[],o=0;const a=e.content;if("nowrap"!==e.whiteSpace&&"pre"!==e.whiteSpace)if("breakall"===e.breakWord)for(n="",n+=a[0],o=0;o<a.length;o++)if(s=nO(n,e),s>=e.width&&n.length>0)r[r.length]={text:n,x:0,dy:0,width:s},n="";else{n+=a[o+1]||"",n.indexOf("\n")>-1&&(r[r.length]={text:n,x:0,dy:0,width:nO(n,e)},n="");const t=nO(n,e);Math.ceil(t)+2>=e.width&&n.length>0&&(r[r.length]={text:n,x:0,dy:0,width:t},n=""),o===a.length-1&&n.length>0&&(r[r.length]={text:n,x:0,dy:0,width:t},n="")}else r=function(e,t,i){const n=[];let s="",r=0,o=0;const a="nowrap"!==e.whiteSpace,l=e.content.split("\n");let h,c,d,p;for(r=0;r<l.length;r++)for(h="NoWrap"!==e.textWrapping?l[r].split(" "):"NoWrap"===e.textWrapping?[l[r]]:l,o=0;o<h.length;o++){s+=((0!==o||1===h.length)&&a&&s.length>0?" ":"")+h[o],c=s+" "+(h[o+1]||"");const t=nO(c,e);Math.floor(t)>(i||e.width)-2&&s.length>0?(n[n.length]={text:s,x:0,dy:0,width:c===s?t:s===p?d:nO(s,e)},s=""):o===h.length-1&&(n[n.length]={text:s,x:0,dy:0,width:t},s=""),p=c,d=t}return n}(e,0,i);else r[r.length]={text:a,x:0,dy:0,width:nO(a,e)};return r}(l,0,e.isLaneOrientation?n:void 0),e.wrapBounds=a=function(e,t){let i,n,s={x:0,width:0},r=0;for(r=0;r<t.length;r++)i=t[r].width,n=i,i="left"===e.textAlign?0:"center"===e.textAlign?i>e.width&&("Ellipsis"===e.textOverflow||"Clip"===e.textOverflow)?0:-i/2:"right"===e.textAlign?-i:t.length>1?0:-i/2,t[r].dy=1.2*e.fontSize,t[r].x=i,s?(s.x=Math.min(s.x,i),s.width=Math.max(s.width,n)):s={x:i,width:n};return s}(l,o),r.width=a.width,e.wrapBounds.width>=n&&"Wrap"!==l.textOverflow&&(r.width=n),r.height=o.length*e.style.fontSize*1.2,r}(this,0,0,this.isLaneOrientation?e.height:this.width||e.width):this.desiredSize,this.desiredSize=void 0===this.width||void 0===this.height?new nb(t.width,t.height):new nb(this.width,this.height),this.desiredSize=this.validateDesiredSize(this.desiredSize,e),this.desiredSize}arrange(e){return(e.width!==this.actualSize.width||e.height!==this.actualSize.height||this.isDirt)&&(this.doWrap=!0),this.actualSize=e,this.updateBounds(),this.isDirt=!1,this.actualSize}}class lv extends ov{constructor(){super(...arguments),this.measureChildren=void 0}measure(e,t,i){let n,s;if(this.hasChildren()){for(const n of this.children){n instanceof av?n.canMeasure&&(e.width=e.width||this.maxWidth||this.minWidth,n.measure(e)):n instanceof av||n.measure(e,t,i);let r=n.desiredSize.clone();0!==n.rotateAngle&&(r=aO(r,n.rotateAngle));const o=new mb(n.margin.left,n.margin.top,r.width+n.margin.right,r.height+n.margin.bottom);n.float&&void 0!==n.getAbsolutePosition(r)||n instanceof av&&!(n instanceof av&&n.canConsiderBounds)||(void 0===s?s=o:s.uniteRect(o))}if(s){let e=0,t=0;e=Math.max(s.left,0),t=Math.max(s.top,0),n=new nb(s.width+e,s.height+t)}}return n=super.validateDesiredSize(n,e),super.stretchChildren(n),n.width+=this.padding.left+this.padding.right,n.height+=this.padding.top+this.padding.bottom,this.desiredSize=n,n}arrange(e,t){if(this.outerBounds=new mb,this.hasChildren()){const i=this.offsetY-e.height*this.pivot.y+this.padding.top,n=this.offsetX-e.width*this.pivot.x+this.padding.left;for(const s of this.children){if(0!=(s.transform&Zb.Parent)){s.parentTransform=this.parentTransform+this.rotateAngle,("None"!==this.flip||this.elementActions&Yb.ElementIsGroup)&&(s.parentTransform="Horizontal"===this.flip||"Vertical"===this.flip?-s.parentTransform:s.parentTransform);const t=s.desiredSize.clone();let r,o={x:0,y:0},a=n,l=i;if("Point"===s.relativeMode){const t=s.getAbsolutePosition(e);void 0!==t&&(a+=t.x,l+=t.y)}r="Object"===s.relativeMode?this.alignChildBasedOnParent(s,t,e,a,l):this.alignChildBasedOnaPoint(s,a,l),o={x:r.x+t.width/2,y:r.y+t.height/2},super.findChildOffsetFromCenter(s,o)}!t||"Stretch"!==s.horizontalAlignment&&"Stretch"!==s.verticalAlignment?s instanceof av&&s.canMeasure?(s.arrange(s.desiredSize),this.outerBounds.uniteRect(s.outerBounds)):s instanceof av||(s.arrange(s.desiredSize),this.outerBounds.uniteRect(s.outerBounds)):s.arrange(e)}}return this.actualSize=e,this.updateBounds(),this.outerBounds.uniteRect(this.bounds),e}alignChildBasedOnParent(e,t,i,n,s){switch(e.horizontalAlignment){case"Auto":case"Left":n+=e.margin.left;break;case"Right":n+=i.width-t.width-e.margin.right;break;case"Stretch":case"Center":n+=i.width/2-t.width/2}switch(e.verticalAlignment){case"Auto":case"Top":s+=e.margin.top;break;case"Bottom":s+=i.height-t.height-e.margin.bottom;break;case"Stretch":case"Center":s+=i.height/2-t.height/2}return{x:n,y:s}}alignChildBasedOnaPoint(e,t,i){switch(t+=e.margin.left-e.margin.right,i+=e.margin.top-e.margin.bottom,e.horizontalAlignment){case"Auto":case"Left":t=e.inversedAlignment?t:t-e.desiredSize.width;break;case"Stretch":case"Center":t-=e.desiredSize.width*e.pivot.x;break;case"Right":t=e.inversedAlignment?t-e.desiredSize.width:t}switch(e.verticalAlignment){case"Auto":case"Top":i=e.inversedAlignment?i:i-e.desiredSize.height;break;case"Stretch":case"Center":i-=e.desiredSize.height*e.pivot.y;break;case"Bottom":i=e.inversedAlignment?i-e.desiredSize.height:i}return{x:t,y:i}}}function hv(e){return cv[e.toString()]}let cv={Rectangle:"M0,0 L50,0 L50,50 L0,50 z",Ellipse:"M80.5,12.5 C80.5,19.127417 62.59139,24.5 40.5,24.5 C18.40861,24.5 0.5,19.127417 0.5,12.5C0.5,5.872583 18.40861,0.5 40.5,0.5 C62.59139,0.5 80.5,5.872583 80.5,12.5 z",Hexagon:"M30,0 L60,0 L90,30 L60,60 L30,60 L0,30 L30,0 z",Parallelogram:"M30,0 L60,0 L45,30 L15,30 z",Triangle:"M45,0 L90,45 L0,45 L45,0 z",Plus:"M696.6084,158.2656 L674.8074,158.2656 L674.8074,136.4656 L658.4084,136.4656 L658.4084,158.2656 L636.6084,158.2656L636.6084,174.6646 L658.4084,174.6646 L658.4084,196.4656 L674.8074,196.4656 L674.8074,174.6646 L696.6084,174.6646L696.6084,158.2656 z",Star:"M540.3643,137.9336 L546.7973,159.7016 L570.3633,159.7296 L550.7723,171.9366 L558.9053,194.9966 L540.3643,179.4996L521.8223,194.9966 L529.9553,171.9366 L510.3633,159.7296 L533.9313,159.7016 L540.3643,137.9336 z",Pentagon:"M30,0 L60,30 L50,70 L10,70 L0,30 L30,0 z",Heptagon:"M223.7783,195.7134 L207.1303,174.8364 L213.0713,148.8034 L237.1303,137.2174 L261.1883,148.8034 L267.1303,174.8364L250.4813,195.7134 L223.7783,195.7134 z",Octagon:"M98.7319,196.4653 L81.1579,178.8923 L81.1579,154.0393 L98.7319,136.4653 L123.5849,136.4653L141.1579,154.0393 L141.1579,178.8923 L123.5849,196.4653 L98.7319,196.4653 z",Trapezoid:"M127.2842,291.4492 L95.0322,291.4492 L81.1582,256.3152 L141.1582,256.3152 L127.2842,291.4492 z",Decagon:"M657.3379,302.4141 L642.3369,291.5161 L636.6089,273.8821 L642.3369,256.2481 L657.3379,245.3511 L675.8789,245.3511L690.8789,256.2481 L696.6089,273.8821L690.8789,291.5161 L675.8789,302.4141 L657.3379,302.4141 z",RightTriangle:"M836.293,292.9238 L776.293,292.9238 L776.293,254.8408 L836.293,292.9238 z",Cylinder:"M 542.802,362.009C 542.802,368.452 525.341,373.676 503.802,373.676C 482.263,373.676 464.802,368.452 464.802,362.009L 464.802,466.484C 464.802,472.928 482.263,478.151 503.802,478.151C 525.341,478.151 542.802,472.928 542.802,466.484L 542.802,362.016C 542.802,368.459 525.341,373.534 503.802,373.534C 482.263,373.534 464.802,368.31 464.802,361.867L 464.802,362.016C 464.802,355.572 482.263,350.349 503.802,350.349C 525.341,350.349 542.802,355.572 542.802,362.016",Diamond:"M397.784,287.875 L369.5,316.159 L341.216,287.875 L369.5,259.591 L397.784,287.875 z"};class dv extends rv{constructor(){super(),this.pathData="",this.transformPath=!0,this.absolutePath="",this.canMeasurePath=!1,this.absoluteBounds=new mb}get data(){return this.pathData}set data(e){this.pathData!==e&&(this.pathData=e,this.isDirt=!0)}getPoints(){return this.pointTimer||(this.pointTimer=setTimeout(()=>{this.points=null,this.pointTimer=null},200)),this.points=this.points||function(e){const t=[];let i,n;window.measureElement.style.visibility="visible";const s=vP(window.measureElement.children[2])[0];s.setAttributeNS(null,"d",e.data);const r=SP(e,e.absoluteBounds);s.setAttributeNS(null,"d",r);const o=s.getTotalLength();for(n=0;n<=o;n+=10)i=s.getPointAtLength(n),t.push({x:i.x,y:i.y});return window.measureElement.style.visibility="hidden",t}(this),function(e,t){const i=[];for(const n of t){let t,s={x:e.offsetX-e.actualSize.width*e.pivot.x+n.x,y:e.offsetY-e.actualSize.height*e.pivot.y+n.y};const r=e.rotateAngle+e.parentTransform;r&&(t=bb(),wb(t,r,e.offsetX,e.offsetY)),t&&(s=vb(t,s)),i.push(s)}return i}(this,this.points)}measure(e){return this.staticSize&&void 0!==this.width&&void 0!==this.height?this.absoluteBounds=new mb(this.offsetX-this.width*this.pivot.x,this.offsetY-this.height*this.pivot.y,this.width,this.height):(!this.isDirt||!this.transformPath&&void 0!==this.width&&void 0!==this.height||this.absoluteBounds&&0!==this.absoluteBounds.height)&&!this.canMeasurePath||(this.absoluteBounds=wP(this.data?this.data:"")),this.desiredSize=void 0===this.width?new nb(this.absoluteBounds.width,this.height||this.absoluteBounds.height):void 0===this.height?new nb(this.width||this.absoluteBounds.width,this.absoluteBounds.height):new nb(this.width,this.height),this.desiredSize=this.validateDesiredSize(this.desiredSize,e),this.canMeasurePath=!1,this.desiredSize}arrange(e){return(this.isDirt||this.actualSize.width!==e.width||this.actualSize.height!==e.height)&&(this.isDirt=!0,this.absolutePath=this.updatePath(this.data,this.absoluteBounds,e),this.staticSize||(this.points=null)),this.actualSize=this.desiredSize,this.updateBounds(),this.isDirt=!1,this.actualSize}updatePath(e,t,i){let n=!1,s="",r=-t.x,o=-t.y,a=[];return i.width===t.width&&i.height===t.height||(r=i.width/Number(t.width?t.width:1),o=i.height/Number(t.height?t.height:1),n=!0),a=ob(e),a=pb(a),s=(n||this.isDirt)&&this.transformPath?hb(a,r,o,n,t.x,t.y,0,0):ub(a),n=!1,s}}class pv extends rv{constructor(){super(),this.imageSource="",this.imageScale="None",this.imageAlign="None",this.stretch="Stretch"}get source(){return this.imageSource}set source(e){this.imageSource=e,this.isDirt=!0}measure(e,t,i){return this.isDirt&&("Stretch"!==this.stretch||void 0===this.width&&void 0===this.height)&&(this.contentSize=function(e,t,i,n){window.measureElement.style.visibility="visible";const s=window.measureElement.children[1];s.setAttribute("src",e);const r=s.getBoundingClientRect();t=new nb(r.width,r.height),window.measureElement.style.visibility="hidden";const o=document.createElement("img");return o.setAttribute("src",e),FP(o,{id:i+"sf-imageNode",style:"display: none;"}),document.body.appendChild(o),o.onload=e=>{const t=e.currentTarget;n&&n(i,{width:t.width,height:t.height})},t}(this.source,this.contentSize,t,i),this.isDirt=!1),void 0!==this.width&&void 0!==this.height?(this.desiredSize=new nb(this.width,this.height),this.contentSize=this.desiredSize):this.desiredSize=this.contentSize,this.desiredSize=this.validateDesiredSize(this.desiredSize,e),this.desiredSize}arrange(e){return this.actualSize=new nb(this.desiredSize.width,this.desiredSize.height),this.updateBounds(),this.actualSize}}class uv extends rv{constructor(e,t){super(),this.data="",this.nodeId="",this.diagramId="",this.scale="Stretch",this.diagramId=t,this.nodeId=e}get content(){return this.data}set content(e){this.data=e,this.canReset||(this.canReset=!0,this.template=BP(this,!1),this.canReset=!1,this.isDirt=!0)}measure(e){if(this.isDirt){const e=function(e){window.measureElement.style.visibility="visible";let t=window.measureElement.children[2];t.appendChild(e);const i=e.getBoundingClientRect(),n=t.getBoundingClientRect(),s=i;return s.x=i.left-n.left,s.y=i.top-n.top,t.removeChild(e),window.measureElement.style.visibility="hidden",s}(this.template);this.contentSize=new nb,this.contentSize.width=e.width,this.contentSize.height=e.height,this.templatePosition={x:e.x,y:e.y},this.isDirt=!1}if(void 0===this.width||void 0===this.height){const e=function(e){window.measureElement.style.visibility="visible";const t=window.measureElement.children[2];t.appendChild(e);const i=t.getBoundingClientRect();return t.removeChild(e),window.measureElement.style.visibility="hidden",i}(this.template);this.desiredSize=new nb(e.width,e.height)}else this.desiredSize=new nb(this.width,this.height);return this.desiredSize=this.validateDesiredSize(this.desiredSize,e),this.desiredSize}arrange(e){return this.actualSize=new nb(this.desiredSize.width,this.desiredSize.height),this.updateBounds(),this.actualSize}}var gv=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let mv=(()=>{class e extends bg{constructor(e,t,i,n){super(e,t,i,n),this.inEdges=[],this.outEdges=[]}}return gv([ig("")],e.prototype,"id",void 0),gv([ig("Center")],e.prototype,"horizontalAlignment",void 0),gv([ig("Center")],e.prototype,"verticalAlignment",void 0),gv([ng({},Ib)],e.prototype,"margin",void 0),gv([ig(12)],e.prototype,"width",void 0),gv([ig(12)],e.prototype,"height",void 0),gv([ng({},kb)],e.prototype,"style",void 0),gv([ig("Square")],e.prototype,"shape",void 0),gv([ig(Nb.Connect)],e.prototype,"visibility",void 0),gv([ig("")],e.prototype,"pathData",void 0),gv([ig(sv.Default)],e.prototype,"constraints",void 0),gv([ig()],e.prototype,"addInfo",void 0),gv([ig()],e.prototype,"outEdges",void 0),gv([ig()],e.prototype,"inEdges",void 0),e})(),fv=(()=>{class e extends mv{constructor(e,t,i,n){super(e,t,i,n)}getClassName(){return"PointPort"}}return gv([ng({x:.5,y:.5},rb)],e.prototype,"offset",void 0),e})();var yv=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let bv=(()=>{class e extends bg{}return yv([ig("blue")],e.prototype,"color",void 0),yv([ig("")],e.prototype,"content",void 0),yv([ig("")],e.prototype,"link",void 0),yv([ig("None")],e.prototype,"textDecoration",void 0),e})(),vv=(()=>{class e extends bg{constructor(e,t,i,n){super(e,t,i,n),i.id||(this.id=e.parentObj&&e.parentObj.propName&&"phases"===e.parentObj.propName?e.parentObj.id:XP())}}return yv([ig("")],e.prototype,"content",void 0),yv([ig(void 0)],e.prototype,"template",void 0),yv([ig("String")],e.prototype,"annotationType",void 0),yv([ig(!0)],e.prototype,"visibility",void 0),yv([ig(Fb.InheritReadOnly)],e.prototype,"constraints",void 0),yv([ng(void 0,bv)],e.prototype,"hyperlink",void 0),yv([ig("")],e.prototype,"id",void 0),yv([ig()],e.prototype,"width",void 0),yv([ig()],e.prototype,"height",void 0),yv([ig(0)],e.prototype,"rotateAngle",void 0),yv([ng({strokeWidth:0,strokeColor:"transparent",fill:"transparent"},Hb)],e.prototype,"style",void 0),yv([ig("Center")],e.prototype,"horizontalAlignment",void 0),yv([ig("Center")],e.prototype,"verticalAlignment",void 0),yv([ng({},Ib)],e.prototype,"margin",void 0),yv([ng({top:void 0,bottom:void 0,left:void 0,right:void 0},Ib)],e.prototype,"dragLimit",void 0),yv([ig("Shape")],e.prototype,"type",void 0),yv([ig()],e.prototype,"addInfo",void 0),e})(),wv=(()=>{class e extends vv{constructor(e,t,i,n){super(e,t,i,n)}getClassName(){return"ShapeAnnotation"}}return yv([ng({x:.5,y:.5},rb)],e.prototype,"offset",void 0),e})(),xv=(()=>{class e extends vv{constructor(e,t,i,n){super(e,t,i,n)}getClassName(){return"PathAnnotation"}}return yv([ig(.5)],e.prototype,"offset",void 0),yv([ng({x:0,y:0},rb)],e.prototype,"displacement",void 0),yv([ig("Center")],e.prototype,"alignment",void 0),yv([ig(!1)],e.prototype,"segmentAngle",void 0),e})();function Sv(e){return Cv[e.toString()]}let Cv={X:"M14,14 L106,106 M106,14 L14,106",Circle:"M0,50 A50,50,0 1 1 100,50 A50,50,0 1 1 0,50 Z",Square:"M0,0 L10,0 L10,10 L0,10 z"},Pv={OpenArrow:"M15.9,23 L5,16 L15.9,9 L17,10.7 L8.7,16 L17,21.3Z",Square:"M0,0 L10,0 L10,10 L0,10 z",Fletch:"M14.8,10c0,0-3.5,6,0.2,12c0,0-2.5-6-10.9-6C4.1,16,11.3,16,14.8,10z",OpenFetch:"M6,17c-0.6,0-1-0.4-1-1s0.4-1,1-1c10.9,0,11-5,11-5c0-0.6,0.4-1,1-1s1,0.4,1,1C19,10.3,18.9,17,6,17C6,17,6,17,6,17z M18,23c-0.5,0-1-0.4-1-1c0-0.2-0.3-5-11-5c-0.6,0-1-0.5-1-1s0.4-1,1-1c0,0,0,0,0,0c12.9,0,13,6.7,13,7    C19,22.6,18.6,23,18,23z",IndentedArrow:"M17,10c0,0-4.5,5.5,0,12L5,16L17,10z",OutdentedArrow:"M14.6,10c0,0,5.4,6,0,12L5,16L14.6,10z",DoubleArrow:"M19,10 L19,22 L13,16Z M12,10 L12,22 L6,16Z",Arrow:"M15,10 L15,22 L5,16Z",Diamond:"M12,23l-7-7l7-7l6.9,7L12,23z",Circle:"M0,50 A50,50,0 1 1 100,50 A50,50,0 1 1 0,50 Z"};function Ov(e){return Tv[e.toString()]}let Tv={Process:"M419.511,76.687L359.511,76.687L359.511,43.086L419.511,43.086z",Decision:"M 253.005,115.687L 200.567,146.071L 148.097,115.687L 200.534,85.304L 253.005,115.687 Z",Document:"M 60 31.9 c 0 0 -11 -7.7 -30 0 s -30 0 -30 0 V 0 h 60 V 31.9 Z",PreDefinedProcess:"M 0,0 L 50,0 L 50,50 L 0,50 Z  M 8.334,0 L 8.334,50 M 41.667,0 L 41.667,50",Terminator:"M 269.711,29.33C 269.71,44.061 257.77,56 243.04,56L 158.058,56C 143.33,56 131.39,44.061 131.39,29.33L 131.39,29.33C 131.391,14.6057 143.33,2.669 158.058,2.669L 243.044,2.669C 257.772,2.669 269.711,14.6057 269.711,29.333 Z",PaperTap:"M0.0009,17.2042 L0.0009,47.165 C0.001,47.165 14.403,53.5455 25.00,47.165 C35.599,40.7852 44.403,43.5087 50.00,47.165L50.001,17.2042 M50.001,32.7987 L50.001,2.8405 C50.001,2.8405 35.599,-3.5427 25.001,2.8405C14.403,9.2237 5.599,6.494 0.0009,2.8405 L0.0009,32.7987",DirectData:"M 132.62 0 L 17.38 0 C 7.78 0 0 13.43 0 30 C 0 46.57 7.78 60 17.38 60 L 132.62 60 M 132.62 0C 123.02 0 115.24 13.43 115.24 30 C 115.24 46.57 123.02 60 132.62 60 C 142.22 60 150 46.57 150 30 C 150 13.43 142.22 0 132.62 0 z ",SequentialData:"M0.0029,24.999 C0.0029,11.1922 10.433,0.0021 23.295,0.0021 C36.159,0.00216 46.585,11.1922 46.585,24.999C46.585,38.8057 36.159,49.9979 23.295,49.9979 C10.433,49.9979 0.0029,38.8057 0.0029,24.999 z M23.294,49.999 L50.002,49.999",Sort:"M50.001,24.9971 L25.001,49.9971 L0.00097,24.9971 L25.001,-0.00286865 L50.001,24.9971 z M0.000976562,24.9971 L50.001,24.9971",MultiDocument:"M43.6826,40 C44.8746,40.6183 45.8586,41.3502 46.8366,42.1122 L46.8366,4.74487 L3.09857,4.74487 L3.09857,10.9544 M46.837,35.143 C48.027,35.765 49.025,36.604 50.003,37.369 L50.003,0.002 L6.264,0.002 L6.264,4.744 M43.682,47.113 L43.682,10.765 L0.0025,10.7652 L0.0025,47.1132 C0.0025,47.1132 12.5846,53.6101 21.8426,47.1132 C31.1006,40.6163 38.792,43.393 43.6826,47.1132 z",Collate:"M50.001,0.0028 L25.001,25.0029 L0.00097,0.0028 L50.001,0.002 z M0.0009,50.002 L25.001,25.002L50.001,50.002 L0.0009,50.0029 z",SummingJunction:"M7.3252,42.6768 L42.6772,7.3247 M42.6768,42.6768 L7.3248,7.3247 M0.0009,25.001 C0.0009,11.193 11.197,0.0009 25.001,0.0009 C38.809,0.0009 50.001,11.193 50.001,25.001 C50.001,38.809 38.809,50.001 25.001,50.001 C11.197,50.00 0.0009,38.809 0.0009,25.00 z",Or:"M 0 50 L 100 50 M 50 100 L 50 0.0 M 0 50 C 0 22.384 22.392 0 50 0 C 77.616 0 100 22.384 100 50 C 100 77.616 77.616 100 50 100 C 22.392 100 0 77.616 0 50 Z",InternalStorage:"M 0 3.81946A 2.5,3.81946 0 0,1 2.5,0L 47.5 0A 2.5,3.81946 0 0,1 50,3.81946L 50 45.836A 2.5,3.819446 0 0,1 47.5,49.652778L 2.5 49.652778A 2.5,3.819446 0 0,1 0,45.8336L 0 3.819446ZM 0 11.45834L 50 11.4583334M 12.5 0L 12.5 49.652778",Extract:"M0,35 L30,0 L60,35 Z",ManualOperation:"M46.4,28.8 L14.8,28.8 L0,0 L60,0 Z",Merge:"M60,0 L30,35 L0,0 Z",OffPageReference:"M60,33.3 L30.1,39 L0,33.3 L0,0 L60,0 Z",SequentialAccessStorage:"M 60 30 C 60 13.4 46.6 0 30 0 S 0 13.4 0 30 s 13.4 30 30 30 h 28.6 v -6.5 h -9.9C 55.5 48 60 39.5 60 30 Z",Annotation:"M49.9984,50.0029 L-0.00271199,50.0029 L-0.00271199,0.00286865 L49.9984,0.00286865",Annotation2:"M49.9977,50.0029 L25.416,50.0029 L25.416,0.00286865 L49.9977,0.00286865 M25.4166,25.0029 L-0.00227869,25.0029",Data:"M 10 0 L 40 0 L 30 40 L 0 40 Z",Card:"M275,60 L400,60 L400,110 L260,110 L260,75 Z",Delay:"M0,0 L12.029,0 C14.212999,0 16,1.7869979 16,3.9709952 C16,6.1549926 14.212999,7.9409904 12.029,7.9409904 L0,7.9409904 z",Preparation:"M 1048.17 572 C 1051.06 568.86 1055.17 567.05 1059.5 567 L 1094.51 567 C 1098.84 567.05 1102.95 568.86 1105.84 572 L 1126.43 595 C 1127.01 596.28 1127.01 597.72 1126.43 599 L 1105.84 622 C 1102.95 625.14 1098.84 626.95 1094.51 627 L 1059.5 627 C 1055.17 626.95 1051.06 625.14 1048.17 622 L 1027.58 599 C 1027 597.72 1027 596.28 1027.58 595 L 1048.17 572 Z",Display:"M47.8809,19.2914 L32.7968,-0.00594145 L11.3902,-0.00594145 C7.93166,-0.00594145 0.00124586,11.187 0.00124586,24.9968C0.00124586,38.8032 7.93166,49.9962 11.3902,49.9962 L32.7968,49.99 L47.615,31.038 C47.615,31.0388 52.798,24.9968 47.880,19.2914 z",ManualInput:"M 912 732 L 1006.85 707 C 1008.2 707 1009.5 707.53 1010.46 708.46 C 1011.41 709.4 1011.95 710.67 1011.95 712 L 1011.95 762C 1012 764.41 1010.28 766.52 1007.87 767 L 917.1 767 C 915.75 767 914.45 766.47 913.49 765.54 C 912.54 764.6 912 763.33 912 762 L 912 732 Z",LoopLimit:"M 8 9 L 27 9 L 33 15 L 33 26 C 33 27 33 27 32 27 L 4 27 C 3 27 2 27 2 26 L 2 15 L 8 9 Z",StoredData:"M 5.55 0L 50 0A 1.5,30 0 0,1 50,0A 5.555,25 0 0,0 50,50A 1.5,30 0 0,1 50,50L 5.555 50A 5.55,25 0 0,1 5.555,0Z"};function Ev(e,t,i){let n;n="Straight"!==e.type&&e.sourceWrapper?e.sourceWrapper.corners.center:function(e){let t;if(e.sourcePortWrapper){const i=e.sourcePortWrapper;t={x:i.offsetX,y:i.offsetY}}else t=e.sourceID&&e.sourceWrapper&&e.targetWrapper?Zv(e,0,e.sourceWrapper.corners.center,e.targetWrapper.corners.center,!1):e.sourcePoint;return t}(e);const s=function(e,t,i,n,s){const r=e.sourceWrapper,o=e.targetWrapper,a=e.sourcePortWrapper,l=e.targetPortWrapper;let h=[];const c={corners:void 0,point:t,direction:void 0,margin:{left:5,right:5,bottom:5,top:5}},d={corners:void 0,point:i,direction:void 0,margin:{left:5,right:5,bottom:5,top:5}};let p,u;if(void 0!==r&&void 0!==o&&(p=ZP(r),u=ZP(o),c.corners=r.corners,d.corners=o.corners),void 0!==a&&(c.direction=ow({x:a.offsetX,y:a.offsetY},p,r.bounds)),void 0!==l&&(d.direction=ow({x:l.offsetX,y:l.offsetY},u,o.bounds)),void 0!==r&&void 0!==o)return void 0!==c.direction&&void 0!==d.direction||(n?function(e,t,i){"LeftToRight"===i?(e.direction=e.direction?e.direction:"Right",t.direction=t.direction?t.direction:"Left"):"RightToLeft"===i?(e.direction=e.direction?e.direction:"Left",t.direction=t.direction?t.direction:"Right"):"TopToBottom"===i?(e.direction=e.direction?e.direction:"Bottom",t.direction=t.direction?t.direction:"Top"):"BottomToTop"===i&&(e.direction=e.direction?e.direction:"Top",t.direction=t.direction?t.direction:"Bottom")}(c,d,n):c.corners.top>d.corners.bottom&&Math.abs(c.corners.top-d.corners.bottom)>c.margin.top+c.margin.bottom?(c.direction=c.direction?c.direction:"Top",d.direction=d.direction?d.direction:"Bottom"):c.corners.bottom<d.corners.top&&Math.abs(c.corners.bottom-d.corners.top)>c.margin.bottom+c.margin.top?(c.direction=c.direction?c.direction:"Bottom",d.direction=d.direction?d.direction:"Top"):c.corners.right<d.corners.left&&Math.abs(c.corners.right-d.corners.left)>c.margin.right+c.margin.left||c.corners.right+13<d.corners.left||d.corners.right>=c.corners.left-13&&c.corners.left>d.corners.left?(c.direction=c.direction?c.direction:"Right",d.direction=d.direction?d.direction:"Left"):c.corners.left>d.corners.right&&Math.abs(c.corners.left-d.corners.right)>c.margin.left+c.margin.right||d.corners.right+13<c.corners.left||c.corners.right>=d.corners.left-13&&c.corners.left<d.corners.left?(c.direction=c.direction?c.direction:"Left",d.direction=d.direction?d.direction:"Right"):r.id!==o.id&&!p.equals(p,u)&&u.containsPoint(p.topCenter,c.margin.top)?(c.direction=c.direction?c.direction:"Bottom",d.direction=d.direction?d.direction:"Top"):(c.direction=c.direction?c.direction:"Top",d.direction=d.direction?d.direction:"Bottom")),function(e,t,i,n,s,r){const o=e.sourceWrapper,a=e.targetWrapper,l=e.sourcePortWrapper,h=e.targetPortWrapper;let c,d=[];const p=o.corners,u=a.corners,g={corners:p,point:n,direction:t,margin:{left:5,right:5,bottom:5,top:5}};let m={corners:u,point:s,direction:i,margin:{left:5,right:5,bottom:5,top:5}};const f=Hv(o,p,e.sourceWrapper.bounds),y=Hv(a,u,e.targetWrapper.bounds);let b=!1;if(e.sourceWrapper&&e.targetWrapper&&(b=function(e,t,i){const n=jv(e,i.sourcePadding),s=jv(t,i.targetPadding);for(let r=0;r<n.length-1;r++){const e=n[r];for(let t=0;t<s.length-1;t++)if(BS(e,s[t]).enabled)return!0}return!1}(e.sourceWrapper,e.targetWrapper,e)),void 0!==l){switch(g.point={x:l.offsetX,y:l.offsetY},g.direction){case"Bottom":case"Top":g.point.y=g.point.y;break;case"Left":case"Right":g.point.x=g.point.x}e.sourcePadding&&!b&&(h&&(m.point={x:h.offsetX,y:h.offsetY}),g.point=kv(e,g,m,!1))}else"Orthogonal"===e.type?(e.segments&&e.segments.length>0&&e.segments[0].direction&&(g.direction=e.segments[0].direction),g.point=Gv(f,g.direction),c=Gv(f,aw(g.direction)),g.point=Zv(e,0,g.point,c,!1)):g.point=o.corners.center;if(void 0!==h){switch(m.point={x:h.offsetX,y:h.offsetY},m.direction){case"Bottom":case"Top":m.point.y=m.point.y;break;case"Left":case"Right":m.point.x=m.point.x}e.targetPadding&&!b&&(m.point=kv(e,g,m,!0))}else"Orthogonal"===e.type?(m.point=Gv(y,m.direction),c=Gv(y,aw(m.direction)),m.point=Zv(e,0,m.point,c,!0)):m.point=a.corners.center;if("Orthogonal"!==e.type){let t,i;if(Bv(e),void 0===e.sourcePortWrapper){g.point=g.corners.center,e.segments&&e.segments.length>0&&(i=e.segments[0],t=rb.isEmptyPoint(i.point)?void 0:i);let n=void 0!==t?t.point:m.point;if("Bezier"===e.type&&e.segments.length>0&&e.segments[0].vector1.angle&&e.segments[0].vector1.distance){const t=Math.max(g.corners.width,g.corners.height);n=rb.transform(g.point,e.segments[0].vector1.angle,t/2)}g.point=b?e.sourceWrapper.bounds.center:Zv(e,0,g.point,n,!1)}if(void 0===e.targetPortWrapper){m.point=m.corners.center,e.segments&&e.segments.length>1&&(i=e.segments[e.segments.length-2],t=rb.isEmptyPoint(i.point)?void 0:i);let n=t?t.point:g.point;if("Bezier"===e.type&&e.segments.length>0&&e.segments[e.segments.length-1].vector2.angle&&e.segments[e.segments.length-1].vector2.distance){const t=Math.max(g.corners.width,g.corners.height);n=rb.transform(m.point,e.segments[0].vector2.angle,t/2)}m.point=b?e.targetWrapper.bounds.center:Zv(e,0,n,m.point,!0)}d=_v(e,g,m)}else if("Orthogonal"===e.type&&e.segments&&e.segments.length>0&&null!==e.segments[0].direction)d=function(e,t,i,n,s,r,o){let a,l,h,c;Bv(e);for(let d=0;d<e.segments.length;d++){if(l=e.segments[d],n&&t.direction===aw(l.direction)&&(l.direction=t.direction),d>0&&e.segments[d-1].direction===l.direction)d=Wv(e,d,t);else if(l.direction)t.point=Av(t,e.segments[d]);else{const i=e.segments[d-1];t.point=i.points[i.points.length-1]}if(d===e.segments.length-1)if(Fv(e,t),a=void 0===s?Uv(e,t,i):Rv(e,t,i),Lv(a,e),l.points=[],a.length>=2)for(h=0;h<a.length;h++)l.points.push(a[h]);else c=d;if(void 0!==c&&(c===e.segments.length-1&&(e.segments[c-1].direction=null,e.segments[c-1].length=null),e.segments.splice(c,1)),n&&0===d){const i=zv(e,n,r);i&&(t.point=i)}}return Vv(e,[])}(e,g,m,l,h,o);else{if(!e.segments[0]){const t=new kw(e,"segments",{type:"Orthogonal"},!0);e.segments.push(t)}e.segments[0].points=d=function(e,t,i,n,s){let r,o=!1,a=[];return o=function(e,t){let i=!1;switch(e){case"Left":switch(t){case"Right":case"Bottom":i=!0}break;case"Top":switch(t){case"Left":case"Right":case"Bottom":i=!0}break;case"Bottom":switch(t){case"Right":i=!0}}return i}(t.direction,i.direction),o&&rw(t,i),"Right"===t.direction&&"Left"===i.direction?r=function(e,t,i,n){let s;const r=Math.round(Math.abs(t.point.y-i.point.y));let o={x:Math.max(t.point.x,t.corners.right),y:t.point.y},a={x:Math.min(i.point.x,i.corners.left),y:i.point.y},l=10;if(n){const e=a;a=o,o=e}return t.corners.bottom+l<i.corners.top-l||t.corners.top-l>i.corners.bottom+l||(l=0),t.margin={left:l,right:l,top:l,bottom:l},i.margin={left:l,right:l,top:l,bottom:l},s=0===r&&(t.corners.right<i.corners.left||n&&t.corners.right<i.corners.left)?iv.One:t.point.x+t.margin.right<i.point.x-i.margin.left||e.sourceWrapper!==e.targetWrapper&&(ZP(e.sourceWrapper).containsPoint(a)||ZP(e.targetWrapper).containsPoint(o))?iv.Three:iv.Five,s}(e,t,i,o):"Right"===t.direction&&"Right"===i.direction?r=function(e,t,i){const n=e.sourcePortWrapper,s=e.targetPortWrapper;let r;const o=t.point.x-i.point.x,a=t.point.y-i.point.y;return i.margin={left:10,right:10,top:10,bottom:10},t.margin={left:10,right:10,top:10,bottom:10},r=t.corners.right>=i.corners.right?void 0!==n&&(n.offsetY<i.corners.top||n.offsetY>i.corners.bottom)||void 0===n&&t.corners.middleRight.y<i.corners.top||void 0!==n&&n.offsetY>i.corners.bottom+i.margin.bottom&&t.corners.top>i.corners.bottom||void 0===n&&t.corners.middleRight.y>i.corners.bottom||void 0!==n&&n.offsetY<i.corners.top&&t.corners.bottom>i.corners.top||void 0===n&&t.corners.middleRight.y>i.corners.bottom?iv.Three:t.corners.right<i.corners.left||i.corners.right<t.corners.left?iv.Five:0===o||0===a?iv.One:iv.Three:void 0!==s&&t.corners.bottom<s.offsetY||void 0===s&&t.corners.bottom<i.corners.middleRight.y||void 0!==s&&t.corners.top>s.offsetY||void 0===s&&t.corners.top>i.corners.middleRight.y||void 0!==s&&(void 0!==n&&n.offsetX<i.corners.left&&n.offsetX!==s.offsetX&&n.offsetY!==s.offsetY&&Math.abs(t.corners.right-i.corners.left)<=20||void 0===n&&t.corners.right<i.corners.left&&t.corners.center.x!==i.corners.center.x&&t.corners.center.y!==i.corners.center.y)?iv.Three:t.corners.right<i.corners.left?iv.Five:0===o||0===a?iv.One:iv.Three,r}(e,t,i):"Right"===t.direction&&"Top"===i.direction?r=function(e,t,i,n){let s=e.targetPortWrapper,r=e.sourcePortWrapper;const o={x:Math.max(t.point.x,t.corners.right),y:t.point.y},a={x:i.point.x,y:Math.min(i.point.y,i.corners.top)};let l;if(i.margin={left:5,right:5,top:5,bottom:5},t.margin={top:5,bottom:5,left:5,right:5},n){const e=r;r=s,s=e}return l=void 0!==r&&r.offsetY<i.corners.top-i.margin.top||void 0===r&&t.corners.bottom<i.corners.top-i.margin.top?t.corners.bottom<i.corners.top?void 0!==s&&t.corners.right+t.margin.right<s.offsetX||void 0===s&&t.corners.right+t.margin.right<i.corners.topCenter.x?iv.Two:iv.Four:void 0!==s&&t.corners.left>s.offsetX||void 0===s&&t.corners.left>i.corners.topCenter.x?iv.Four:iv.Two:void 0!==r&&Math.abs(t.corners.right-i.corners.left)<=25&&Math.abs(r.offsetY-i.corners.top)<=25||void 0!==s&&Math.abs(s.offsetX-t.corners.topCenter.x)>=25&&t.corners.middleRight.y<s.offsetY?iv.Two:t.corners.right<i.corners.left?iv.Four:e.sourceWrapper!==e.targetWrapper&&(ZP(e.sourceWrapper).containsPoint(a)||ZP(e.targetWrapper).containsPoint(o))?iv.Two:iv.Four,l}(e,t,i,o):"Right"===t.direction&&"Bottom"===i.direction?r=function(e,t,i,n){let s;t.margin={left:10,right:10,top:10,bottom:10},i.margin={left:10,right:10,top:10,bottom:10};let r=e.sourcePortWrapper,o=e.targetPortWrapper;if(n){const e=r;r=o,o=e}return s=void 0!==r&&r.offsetY>i.corners.bottom+i.margin.bottom||void 0===r&&t.corners.middleRight.y>i.corners.bottom+i.margin.bottom?t.corners.top>i.corners.bottom?void 0!==o&&t.corners.right+t.margin.right<o.offsetX||void 0===o&&t.corners.right+t.margin.right<i.corners.bottomCenter.x?iv.Two:iv.Four:void 0!==o&&t.corners.left>o.offsetX||void 0===o&&t.corners.left>i.corners.bottomCenter.x?iv.Four:iv.Two:void 0!==r&&Math.abs(t.corners.right-i.corners.left)<=25&&Math.abs(r.offsetY-i.corners.bottom)<=25?iv.Two:iv.Four,s}(e,t,i,o):"Bottom"===t.direction&&"Top"===i.direction?r=function(e,t){let i;const n=e.point.x-t.point.x;let s=10;return e.corners.right+s<t.corners.left-s||e.corners.left-s>t.corners.right+s||(s=0),e.margin={left:s,right:s,top:s,bottom:s},t.margin={left:s,right:s,top:s,bottom:s},i=0===n&&e.corners.bottom<t.corners.top?iv.One:e.corners.bottom+e.margin.bottom<t.corners.top-t.margin.top?iv.Three:iv.Five,i}(t,i):"Bottom"===t.direction&&"Bottom"===i.direction?(t.margin={left:10,right:10,top:10,bottom:10},i.margin={left:10,right:10,top:10,bottom:10},r=function(e,t,i){const n=e.sourcePortWrapper,s=e.targetPortWrapper,r=Math.round(Math.abs(t.point.x-i.point.x)),o=Math.round(Math.abs(i.point.y-i.point.y));let a;return a=t.corners.bottom<i.corners.bottom?void 0!==n&&n.offsetX<i.corners.left-i.margin.left||void 0===n&&t.corners.bottomCenter.x<i.corners.left-i.margin.left||void 0!==n&&n.offsetX>i.corners.right+i.margin.right||void 0===n&&t.corners.bottomCenter.x>i.corners.right+i.margin.right?iv.Three:t.corners.bottom<i.corners.top?iv.Five:0===r||0===o?iv.One:iv.Three:void 0!==s&&t.corners.left>s.offsetX||void 0===s&&t.corners.left>i.corners.left||void 0!==s&&t.corners.right<s.offsetX||void 0===s&&t.corners.right<i.corners.right?iv.Three:t.corners.top>i.corners.bottom?iv.Five:0===r||0===o?iv.One:iv.Three,a}(e,t,i)):"Bottom"===t.direction&&"Left"===i.direction?r=function(e,t,i,n){let s,r=e.sourcePortWrapper,o=e.targetPortWrapper;if(n){const e=r;r=o,o=e}return s=void 0!==r&&r.offsetX<i.corners.left-i.margin.left||void 0===r&&t.corners.bottomCenter.x<i.corners.bottomLeft.x-i.margin.left?t.corners.right<i.corners.left?void 0!==o&&t.corners.bottom+t.margin.bottom<o.offsetY||void 0===o&&t.corners.bottom+t.margin.bottom<i.corners.middleLeft.y?iv.Two:iv.Four:void 0!==o&&t.corners.top>o.offsetY||void 0===o&&t.corners.top>i.corners.middleLeft.y?iv.Four:iv.Two:void 0!==o&&Math.abs(t.corners.right-i.corners.left)<=25&&Math.abs(o.offsetY-t.corners.bottom)<=25?iv.Two:iv.Four,s}(e,t,i,o):"Left"===t.direction&&"Left"===i.direction?r=function(e,t,i){const n=e.sourcePortWrapper,s=e.targetPortWrapper;t.margin={left:10,right:10,top:10,bottom:10},i.margin={left:10,right:10,top:10,bottom:10};const r=Math.round(Math.abs(t.point.x-i.point.x)),o=Math.round(Math.abs(t.point.y-i.point.y));let a;return a=t.corners.left<i.corners.left?void 0!==s&&t.corners.bottom+t.margin.bottom<s.offsetY||void 0===s&&t.corners.bottom+t.margin.bottom<i.corners.middleLeft.y||void 0!==s&&t.corners.top-t.margin.top>s.offsetY||void 0===s&&t.corners.top-t.margin.top>i.corners.middleLeft.y?iv.Three:t.corners.right<i.corners.left||i.corners.right<t.corners.left?iv.Five:0===r||0===o?iv.One:iv.Three:void 0!==n&&n.offsetY<i.corners.top-i.margin.top||void 0===n&&t.corners.middleLeft.y<i.corners.top||void 0!==n&&n.offsetY>i.corners.bottom+i.margin.bottom||void 0===n&&t.corners.middleLeft.y>i.corners.bottom+i.margin.bottom?iv.Three:t.corners.left>i.corners.right?iv.Five:0===r||0===o?iv.One:iv.Three,a}(e,t,i):"Left"===t.direction&&"Top"===i.direction?r=function(e,t,i,n){let s,r=e.sourcePortWrapper,o=e.targetPortWrapper;const a={x:Math.min(t.point.x,t.corners.left),y:t.point.y},l={x:i.point.x,y:Math.min(i.point.y,i.corners.top)};if(n){const e=r;r=o,o=e}return s=void 0!==r&&r.offsetY<i.corners.top-i.margin.top||void 0===r&&(t.corners.bottom<i.corners.top-i.margin.top||t.corners.middleLeft.y<i.corners.top-i.margin.top)?t.corners.bottom<i.corners.top?void 0!==o&&t.corners.left-t.margin.left>o.offsetX||void 0===o&&t.corners.left-t.margin.left>i.corners.topCenter.x?iv.Two:iv.Four:void 0!==o&&t.corners.right<o.offsetX||void 0===o&&t.corners.right<i.corners.topCenter.x?iv.Four:iv.Two:void 0!==r&&Math.abs(t.corners.left-i.corners.right)<=25&&Math.abs(r.offsetY-i.corners.top)<=25||e.sourceWrapper!==e.targetWrapper&&(ZP(e.sourceWrapper).containsPoint(l)||ZP(e.targetWrapper).containsPoint(a))?iv.Two:iv.Four,s}(e,t,i,o):"Top"===t.direction&&"Top"===i.direction&&(r=function(e,t,i){const n=e.sourcePortWrapper,s=e.targetPortWrapper,r=Math.round(Math.abs(t.point.x-i.point.x)),o=Math.round(Math.abs(t.point.y-i.point.y));let a;return t.margin={left:10,right:10,top:10,bottom:10},i.margin={left:10,right:10,top:10,bottom:10},a=t.corners.top<i.corners.top?void 0!==s&&t.corners.left>s.offsetX||void 0===s&&t.corners.left>i.corners.left||void 0!==s&&t.corners.right<s.offsetX||void 0===s&&t.corners.right<i.corners.right?iv.Three:t.corners.bottom<i.corners.top?iv.Five:0===r||0===o?iv.One:iv.Three:void 0!==n&&n.offsetX>i.corners.right||void 0===n&&t.corners.left>i.corners.right||void 0!==n&&n.offsetX<i.corners.left||void 0===n&&t.corners.bottomRight.x<i.corners.left?iv.Three:t.corners.top>i.corners.bottom?iv.Five:0===r||0===o?iv.One:iv.Three,a}(e,t,i)),o&&rw(t,i),a=function(e,t,i,n,s,r){let o;const a=e.sourceWrapper.corners,l=e.targetWrapper.corners;let h,c=20;if(!(i.direction===n.direction&&t!==iv.Five||i.direction!==aw(n.direction)&&t!==iv.Three))switch(i.direction){case"Left":a.middleLeft.x>l.middleRight.x&&(h=(a.middleLeft.x-l.middleRight.x)/2,c=r?h:Math.min(c,h));break;case"Right":a.middleRight.x<l.middleLeft.x&&(h=(l.middleLeft.x-a.middleRight.x)/2,c=r?h:Math.min(c,h));break;case"Top":a.topCenter.y>l.bottomCenter.y&&(h=(a.topCenter.y-l.bottomCenter.y)/2,c=r?h:Math.min(c,h));break;case"Bottom":a.bottomCenter.y<l.topCenter.y&&(h=(l.topCenter.y-a.bottomCenter.y)/2,c=r?h:Math.min(c,h))}return c=ew(a,i,c),t===iv.One&&(o=[i.point,n.point]),t===iv.Two&&(o=tw(i,n)),t===iv.Three&&(o=iw(e,i,n,c)),t===iv.Four&&(o=nw(i,n,void 0,o,c)),t===iv.Five&&(o=function(e,t,i=20){let n,s=i;const r=e.corners.left-e.margin.left,o=e.corners.right+e.margin.right,a=e.corners.bottom+e.margin.bottom,l=e.corners.top-e.margin.top,h=t.corners.left-t.margin.left,c=t.corners.right+t.margin.right,d=t.corners.bottom+t.margin.bottom,p=t.corners.top-t.margin.top;let u;switch(e.direction){case"Left":(l>p&&l<d||a<d&&a>p)&&r>h&&r<=c&&i>=20&&(s=e.point.x-t.corners.left+s),u=qv(e.point,s,180);break;case"Top":(r>h&&r<c||o<c&&o>h)&&l>p&&l<=d&&i>=20&&(s=e.point.y-t.corners.top+s),u=qv(e.point,s,270);break;case"Right":(l>p&&l<d||a<d&&a>p)&&o<c&&o>=h&&i>=20&&(s=t.corners.right-e.point.x+s),u=qv(e.point,s,0);break;case"Bottom":(r>h&&r<c||o<c&&o>h)&&a<d&&a>=p&&i>=20&&(s=t.corners.bottom-e.point.y+s),u=qv(e.point,s,90)}if(n=[e.point,u],"Top"===e.direction||"Bottom"===e.direction){const i=e.direction;e.direction=u.x>t.point.x?"Left":"Right",e.point=u,n=nw(e,t,i,n)}else{const i=e.direction;e.direction=u.y>t.point.y?"Top":"Bottom",e.point=u,n=nw(e,t,i,n)}return n}(i,n,c)),o}(e,r,t,i,0,s),a}(e,g,m,0,r)}return d}(e,c.direction,d.direction,c.point,d.point,s);if(Bv(e),(e.sourceWrapper||e.targetWrapper)&&function(e,t,i){const n=e.sourcePortWrapper,s=e.targetPortWrapper;let r,o=e.sourceWrapper,a=t.point,l={left:0,right:0,top:0,bottom:0},h={x:0,y:0},c="Top";if(o?(a=i.point,l=t.margin):(o=e.targetWrapper,l=i.margin),"Orthogonal"===e.type)if(e.segments&&e.segments.length>0&&e.sourceWrapper&&e.segments[0].direction)t.direction=e.segments[0].direction,h=Gv(o.corners,t.direction),r=Gv(o.corners,aw(t.direction)),h=Zv(e,0,h,r,!1);else{const t={corners:null,direction:null,point:null,margin:null};Yv(o,{corners:null,direction:null,point:a,margin:l},t,e),h=t.point,c=t.direction}else{let t;e.segments&&e.segments.length>1&&(t=o===e.sourceWrapper?e.segments[0].point:e.segments[e.segments.length-2].point),h=Zv(e,0,o.bounds.center,e.segments&&e.segments.length>1?t:a,o===e.targetWrapper)}o===e.sourceWrapper?(t.direction=t.direction||c,t.point=h,e.sourcePortWrapper&&(t.point={x:n.offsetX,y:n.offsetY},e.sourcePadding&&(t.point=kv(e,t,i,!1)))):(i.direction=i.direction||c,i.point=h,e.targetPortWrapper&&(i.point={x:s.offsetX,y:s.offsetY},e.targetPadding&&(i.point=kv(e,t,i,!0))))}(e,c,d),"Straight"===e.type||"Bezier"===e.type)h=_v(e,c,d);else if("Orthogonal"===e.type&&e.segments&&e.segments.length>0&&null!==e.segments[0].length&&null!==e.segments[0].direction)h=function(e,t,i,n,s,r,o){let a,l,h,c,d,p=[];if(Bv(e),e.segments.length>0){for(let p=0;p<e.segments.length;p++){const u=e.segments[p];if(0===p&&void 0!==e.sourcePortWrapper&&(c={x:r.offsetX,y:r.offsetY},h=ow(c,ZP(n),n.bounds),u.direction===aw(h)&&(u.direction=h)),p>0&&e.segments[p-1].direction===u.direction)p=Wv(e,p,t);else{const i=e.segments[p-1];t.point=u.direction?Av(t,u):i.points[i.points.length-1]}if(p===e.segments.length-1&&(o||s?e.targetWrapper&&void 0===e.targetPortWrapper?(Fv(e,t),l=Dv(e,t,i)):l=Rv(e,t,i):l=Iv(e,t,i),l))if(Lv(l,e),u.points=[],l.length>=2)for(a=0;a<l.length;a++)u.points.push(l[a]);else d=p;if(r&&0===p){const i=zv(e,r,n);i&&(t.point=i)}}void 0!==d&&(d===e.segments.length-1&&(e.segments[d-1].direction=null,e.segments[d-1].length=null),e.segments.splice(d,1)),p=Vv(e,p)}return p}(e,c,d,r,o,a,l);else{let t;c.direction?t=ew(r.bounds,c,20):c.direction=d.direction?void 0!==e.targetPortWrapper?d.direction:aw(d.direction):rb.direction(c.point,d.point),e.segments[0].points=h=iw(e,c,d,t)}return h}(e,n,e.targetPoint,t,i);return $v(e,s[0],!1),$v(e,s[s.length-1],!0),s}function Av(e,t){e.direction=t.direction,t.points=[],t.points.push(e.point);const i=qv(e.point,"Left"===t.direction||"Top"===t.direction?-t.length:t.length,"Left"===t.direction||"Right"===t.direction?0:90);return t.points.push(i),i}function Iv(e,t,i){let n,s,r;if(t.corners=e.sourceWrapper?e.sourceWrapper.corners:void 0,e.sourcePortWrapper&&(r=ow({x:e.sourcePortWrapper.offsetX,y:e.sourcePortWrapper.offsetY},ZP(e.sourceWrapper),e.sourceWrapper.bounds),!t.corners||"Bottom"!==t.direction&&"Top"!==t.direction?!t.corners||"Left"!==t.direction&&"Right"!==t.direction||i.point.y>t.corners.top&&i.point.y<t.corners.bottom&&(s=t.point.x>i.point.x?"Left":"Right"):i.point.x>t.corners.left&&i.point.x<t.corners.right&&(s=t.point.y>i.point.y?"Top":"Bottom")),e.sourcePortWrapper&&r===aw(s)){let s;("Left"===r||"Right"===r)&&t.point.y>=t.corners.top&&t.point.y<=t.corners.center.y&&i.point.y>=t.corners.top&&i.point.y<=t.corners.center.y?(t.direction="Top",s=t.point.y-t.corners.top+20):("Left"===r||"Right"===r)&&t.point.y>t.corners.center.y&&t.point.y<=t.corners.bottom&&i.point.y>t.corners.center.y&&i.point.y<=t.corners.bottom?(t.direction="Bottom",s=t.corners.bottom-t.point.y+20):("Top"===r||"Bottom"===r)&&t.point.x>=t.corners.left&&t.point.x<=t.corners.center.x&&i.point.x>=t.corners.left&&i.point.x<=t.corners.center.x?(t.direction="Left",s=t.point.x-t.corners.left+20):("Top"===r||"Bottom"===r)&&t.point.x<=t.corners.right&&t.point.x>t.corners.center.x&&i.point.x<=t.corners.right&&i.point.x<t.corners.center.x&&(t.direction="Right",s=t.corners.right-t.point.x+20),t.direction&&s&&(n=iw(e,t,i,s,!0))}else t.direction=s||Nv(t.direction,t.point,i.point),n=tw(t,i);return n}function Dv(e,t,i){let n;i.corners=e.targetWrapper.corners,Yv(e.targetWrapper,t,i,e);const s=Nv(i.direction,t.point,i.point);return t.direction!==i.direction||"Left"!==t.direction&&"Right"!==t.direction?(t.direction=s,n=tw(t,i)):(t.direction=s,n=iw(e,t,i,e.targetWrapper.width/2+20),t.point=n[1],Yv(e.targetWrapper,t,i,e),n=iw(e,t,i)),n}function Mv(e,t,i){let n,s;i.corners=e.targetWrapper.corners,"Left"!==t.direction&&"Right"!==t.direction?i.corners.center.y!==t.point.y||i.corners.left<=t.point.x&&t.point.x<=i.corners.right?i.corners.center.y===t.point.y&&"Bottom"===e.segments[e.segments.length-2].direction||i.corners.center.y>t.point.y&&t.point.y>=i.corners.top?(n="Top",s=t.point.y-i.corners.top+20):i.corners.center.y===t.point.y&&"Top"===e.segments[e.segments.length-2].direction||i.corners.center.y<t.point.y&&t.point.y<=i.corners.bottom?(n="Bottom",s=i.corners.bottom-t.point.y+20):void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&t.corners.top<=t.point.y&&t.point.y<=t.corners.bottom&&(n=t.direction,s=t.point.y>i.point.y?t.point.y-t.corners.top+20:t.corners.bottom-t.point.y+20):(n="Top",s=i.corners.height/2+20):i.corners.center.x!==t.point.x||i.corners.top<t.point.y&&t.point.y<=i.corners.bottom?i.corners.center.x===t.point.x&&"Right"===e.segments[e.segments.length-2].direction||i.corners.center.x>t.point.x&&t.point.x>=i.corners.left?(n="Left",s=t.point.x-i.corners.left+20):i.corners.center.x===t.point.x&&"Left"===e.segments[e.segments.length-2].direction||i.corners.center.x<=t.point.x&&t.point.x<=i.corners.right?(n="Right",s=i.corners.right-t.point.x+20):void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&t.corners.left<=t.point.x&&t.point.x<=t.corners.right&&(n=t.direction,s=t.point.x>i.point.x?t.point.x-t.corners.left+20:t.corners.right-t.point.x+20):(n="Left",s=i.corners.width/2+20);const r=t.point;t.point=qv(t.point,"Left"===n||"Top"===n?-s:s,"Left"===n||"Right"===n?0:90),t.direction=rb.direction(t.point,i.point),void 0===e.sourcePortWrapper||void 0===e.targetPortWrapper||t.corners.center.x!==i.corners.center.x&&t.corners.center.y!==i.corners.center.y||(t.direction=i.direction);const o=iw(e,t,i);return o.splice(0,0,r),o}function Rv(e,t,i){let n,s,r;i.corners=e.targetWrapper.corners,void 0!==e.sourcePortWrapper&&(s=ow({x:e.sourcePortWrapper.offsetX,y:e.sourcePortWrapper.offsetY},ZP(e.sourceWrapper),e.sourceWrapper.bounds));const o=function(e,t,i,n){let s=!1;switch(i.direction){case"Left":void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&"Right"===n&&t.point.x>i.point.x&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom||("Bottom"===n&&t.point.y>i.point.y||"Top"===n&&t.point.y<i.point.y)&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right?(t.direction="Right"===n?t.point.y>i.point.y?"Top":"Bottom":t.point.x<i.point.x?"Right":"Left",s=!0):t.point.x>i.point.x&&(t.point.y>i.point.y||t.point.y<i.point.y)&&!(i.corners.top>t.point.y&&i.corners.bottom<t.point.y)?t.direction="Left":t.point.x<i.point.x&&t.point.y>i.point.y||t.point.x>i.point.x&&t.point.y<=i.point.y&&i.corners.top<t.point.y&&i.corners.center.y>=t.point.y?t.direction="Top":t.point.x<i.point.x&&t.point.y<i.point.y||t.point.x>i.point.x&&t.point.y>i.point.y&&i.corners.bottom<t.point.y&&i.corners.center.y>t.point.y?t.direction="Bottom":t.point.y===i.point.y&&t.point.x<i.point.x&&(t.direction="Right");break;case"Right":void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&("Bottom"===n&&t.point.y>i.point.y||"Top"===n&&t.point.y<i.point.y)&&t.point.x>i.point.x&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right?(t.direction=t.point.x>i.point.x?"Left":"Right",s=!0):void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&"Left"===n&&t.point.x<i.point.x&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom?(t.direction=t.point.y>i.point.y?"Top":"Bottom",s=!0):t.point.x<i.point.x&&i.corners.top<=t.point.y&&i.corners.bottom>=t.point.y&&t.point.y===i.point.y||t.point.y>i.point.y&&t.point.x>i.point.x?t.direction="Top":t.point.y<i.point.y&&t.point.x>i.point.x?t.direction="Bottom":t.point.x<i.point.x&&(t.point.y>i.point.y||t.point.y<i.point.y)?t.direction="Right":t.point.y===i.point.y&&t.point.x>i.point.x&&(t.direction="Left");break;case"Top":void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&"Bottom"===n&&t.point.y>i.point.y&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right||("Right"===n&&t.point.x>i.point.x||"Left"===n&&i.point.y>t.point.y&&i.point.x>t.point.x)&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom?(t.direction="Bottom"===n?t.point.x>i.point.x?"Left":"Right":t.point.y<i.point.y?"Bottom":"Top",s=!0):t.point.x===i.point.x&&t.point.y<i.point.y?t.direction="Bottom":t.point.y>i.point.y&&t.point.x>i.corners.left&&t.point.x<i.corners.right?t.direction="Left":t.point.y>=i.point.y?t.direction="Top":t.point.y<i.point.y&&t.point.x>i.point.x?t.direction="Left":t.point.y<i.point.y&&t.point.x<i.point.x&&(t.direction="Right");break;case"Bottom":void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&(("Right"===n||"Left"===n&&i.point.x>t.point.x)&&t.point.y>i.point.y&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom||"Top"===n&&t.point.y<i.point.y&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right)?(t.direction="Right"===n||"Left"===n?t.point.y>i.point.y?"Top":"Bottom":t.point.x>i.point.x?"Left":"Right",s=!0):t.point.y<i.point.y&&t.point.x>i.corners.left&&i.corners.right>t.point.x?t.point.y<i.point.y&&t.point.x>i.corners.left&&i.corners.center.x>=t.point.x?t.direction="Left":t.point.y<i.point.y&&t.point.x<i.corners.right&&i.corners.center.x<t.point.x&&(t.direction="Right"):t.point.y>i.point.y&&t.point.x>i.point.x?t.direction="Left":t.point.y>i.point.y&&t.point.x<i.point.x?t.direction="Right":t.point.y<=i.point.y&&(t.point.x>i.point.x||i.point.x>t.point.x)&&(t.direction="Bottom")}return s}(e,t,i,s);return void 0!==e.sourcePortWrapper&&void 0!==e.targetPortWrapper&&i.direction===aw(s)&&(("Left"===i.direction&&t.point.x>i.point.x||"Right"===i.direction&&t.point.x<i.point.x)&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom||"Bottom"===i.direction&&t.point.y<i.point.y&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right)?n=Mv(e,t,i):t.direction===i.direction?n=iw(e,t,i):("Left"===i.direction&&t.point.x>i.point.x||"Right"===i.direction&&t.point.x<i.point.x)&&("Top"===t.direction||"Bottom"===t.direction)&&t.point.y<=i.point.y&&i.corners.top<=t.point.y&&i.corners.bottom>=t.point.y||"Top"===i.direction&&t.point.y>i.point.y||"Bottom"===i.direction&&t.point.y<i.point.y&&i.corners.left<=t.point.x&&i.corners.right>=t.point.x?n=Mv(e,t,i):void 0!==e.sourceWrapper&&void 0!==e.targetWrapper&&void 0!==e.targetPortWrapper&&("Left"===t.direction||"Right"===t.direction)&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom&&("Top"===i.direction||"Bottom"===i.direction)&&i.corners.center.x===t.corners.center.x?(t.direction="Top"===i.direction?"Bottom":"Top",r="Top"===i.direction?t.corners.bottom-t.point.y+20:t.point.y-t.corners.top+20,n=iw(e,t,i,r)):void 0!==e.sourceWrapper&&void 0!==e.targetWrapper&&void 0!==e.targetPortWrapper&&("Top"===t.direction||"Bottom"===t.direction)&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right&&("Left"===i.direction||"Right"===i.direction)&&i.corners.center.y===t.corners.center.y?(t.direction="Left"===i.direction?"Right":"Left",r="Left"===i.direction?t.corners.right-t.point.x+20:t.point.x-t.corners.left+20,n=iw(e,t,i,r)):o?(r="Left"===t.direction||"Right"===t.direction?"Left"===t.direction?t.point.x-t.corners.left+20:t.corners.right-t.point.x+20:"Top"===t.direction?t.point.y-t.corners.top+20:t.corners.bottom-t.point.y+20,n=iw(e,t,i,r)):n=tw(t,i),n}function zv(e,t,i){const n={x:t.offsetX,y:t.offsetY};let s;const r=ZP(i),o=ow(n,r,i.bounds),a=e.segments[0];return a.direction!==o&&(function(e,t,i,n,s,r){const o=13;let a;const l=[];let h;l.push(n),n.y===s.y&&("Left"===t&&s.x<n.x||"Right"===t&&s.x>n.x)||n.x===s.x&&("Top"===t&&s.y<n.y||"Bottom"===t&&s.y>n.y)||("Top"===t||"Bottom"===t?"Top"===t&&s.y<n.y&&s.y>n.y-o||"Bottom"===t&&s.y>n.y&&s.y<n.y+o?(h="Top"===t?i.top-o:i.bottom+o,l.push({x:n.x,y:h}),l.push({x:n.x+(s.x-n.x)/2,y:h}),l.push({x:n.x+(s.x-n.x)/2,y:s.y})):Math.abs(n.x-s.x)>o&&("Top"===t&&s.y<n.y||"Bottom"===t&&s.y>n.y)?l.push({x:n.x,y:s.y}):(h="Top"===t?i.top-o:i.bottom+o,a=s.x<n.x?i.left-o:i.right+o,l.push({x:n.x,y:h}),l.push({x:s.x,y:h})):"Left"===t&&s.x<n.x&&s.x>n.x-o||"right"===t&&s.x>n.x&&s.x<n.x+o?(a="Left"===t?i.left-o:i.right+o,l.push({x:a,y:n.y}),l.push({x:a,y:n.y+(s.y-n.y)/2}),l.push({x:s.x,y:n.y+(s.y-n.y)/2})):Math.abs(n.y-s.y)>o&&("Left"===t&&s.x<n.x||"Right"===t&&s.x>n.x)?l.push({x:s.x,y:n.y}):(a="Left"===t?i.left-o:i.right+o,l.push({x:a,y:n.y}),l.push({x:a,y:s.y})),e.points=l)}(a,o,r,a.points[0],a.points[a.points.length-1]),s=a.points[a.points.length-1],a.direction=rb.direction(a.points[a.points.length-2],a.points[a.points.length-1])),s}function Lv(e,t,i){const n=t.segments[t.segments.length-2],s=n.points[n.points.length-1];let r;("Top"!==n.direction&&"Bottom"!==n.direction||s.x!==e[1].x)&&("Left"!==n.direction&&"Right"!==n.direction||s.y!==e[1].y)||(n.points[n.points.length-1]=e[1],r=rb.direction(n.points[0],n.points[n.points.length-1]),void 0!==t.sourceWrapper&&void 0===t.sourcePortWrapper&&r===aw(n.direction)&&("Left"===n.direction||"Right"===n.direction?n.points[0].x="Right"===n.direction?n.points[0].x-t.sourceWrapper.corners.width:n.points[0].x+t.sourceWrapper.corners.width:n.points[0].y="Bottom"===n.direction?n.points[0].y-t.sourceWrapper.corners.height:n.points[0].y+t.sourceWrapper.corners.height),n.direction=r,n.length=rb.distancePoints(n.points[0],n.points[n.points.length-1]),e.splice(0,1))}function kv(e,t,i,n){const s=n?e.targetPadding:e.sourcePadding,r=n?e.targetPortWrapper:e.sourcePortWrapper,o=new mb(r.bounds.x-s,r.bounds.y-s,r.actualSize.width+2*s,r.actualSize.height+2*s),a=[o.topLeft,o.topRight,o.bottomRight,o.bottomLeft];a[a.length]=a[0];const l=n?i.point:t.point;return Qv({x1:t.point.x,y1:t.point.y,x2:i.point.x,y2:i.point.y},a,0,l)||l}function jv(e,t){const i=[],n=FS(0,e.corners,t);n.push(n[0]);for(let o=0;o<n.length-1;o++)i.push({x1:(s=n[o]).x,y1:s.y,x2:(r=n[o+1]).x,y2:r.y});var s,r;return i}function Hv(e,t,i){let n;const s=e.rotateAngle+e.parentTransform;if(s){if(s<45)return t;if(s<=135)n={width:t.width,height:t.height,topLeft:t.bottomLeft,topCenter:t.middleLeft,topRight:t.topLeft,middleLeft:t.bottomCenter,center:i.center,middleRight:t.topCenter,bottomLeft:t.bottomRight,bottomCenter:t.middleRight,bottomRight:t.topRight,left:i.left,right:i.right,top:i.top,bottom:i.bottom};else if(s<=225)n={width:t.width,height:t.height,topLeft:t.bottomLeft,topCenter:t.bottomCenter,topRight:t.bottomRight,middleLeft:t.middleRight,center:i.center,middleRight:t.middleLeft,bottomLeft:t.topLeft,bottomCenter:t.topCenter,bottomRight:t.topRight,left:i.left,right:i.right,top:i.top,bottom:i.bottom};else{if(!(s<=315))return t;n={width:t.width,height:t.height,topLeft:t.topRight,topCenter:t.middleRight,topRight:t.bottomRight,middleLeft:t.topCenter,center:i.center,middleRight:t.bottomCenter,bottomLeft:t.topLeft,bottomCenter:t.middleLeft,bottomRight:t.bottomLeft,left:i.left,right:i.right,top:i.top,bottom:i.bottom}}return n}return t}function _v(e,t,i){const n=[];if(e.segments&&e.segments.length>0){let s,r=[],o=t.point;for(s=0;s<e.segments.length;s++){const t=e.segments[s];if(r=[],r.push(o),s!==e.segments.length-1?(r.push(t.point),o=t.point):r.push(i.point),e.segments[s].points=r,e.segments.length>1&&rb.equals(t.points[0],t.points[1])&&e.segments.splice(s,1),t)for(let e=0;e<t.points.length;e++)(e>0||0===s)&&n.push(t.points[e])}}return n}function Nv(e,t,i){return"Top"===e||"Bottom"===e?i.x>t.x?"Right":"Left":i.y>t.y?"Bottom":"Top"}function Bv(e){if("Straight"===e.type||"Bezier"===e.type){if(0===e.segments.length||e.segments.length>0&&!rb.isEmptyPoint(e.segments[e.segments.length-1].point)){const t="Bezier"===e.type?new Lw(e,"segments",{type:"Bezier"},!0):new zw(e,"segments",{type:"Straight"},!0);e.segments.push(t)}}else if(0===e.segments.length||e.segments[e.segments.length-1].direction){const t=new kw(e,"segments",{type:"Orthogonal"},!0);e.segments.push(t)}}function Wv(e,t,i){const n=e.segments[t],s=qv(i.point,"Left"===n.direction||"Top"===n.direction?-n.length:n.length,"Left"===n.direction||"Right"===n.direction?0:90);return e.segments[t-1].length+=n.length,e.segments[t-1].points[1]=i.point=s,e.segments.splice(t,1),--t}function Uv(e,t,i){let n,s;e.sourcePortWrapper&&(s=ow({x:e.sourcePortWrapper.offsetX,y:e.sourcePortWrapper.offsetY},ZP(e.sourceWrapper),e.sourceWrapper.bounds)),Yv(e.targetWrapper,t,i,e);const r=Nv(i.direction,t.point,i.point);if(void 0===e.sourcePortWrapper||t.direction!==i.direction||("Top"!==t.direction&&"Bottom"!==t.direction||t.corners.center.x!==i.corners.center.x)&&("Left"!==t.direction&&"Right"!==t.direction||t.corners.center.y!==i.corners.center.y))if(i.point.x>=t.corners.left&&i.point.x<=t.corners.right&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom)t.direction=i.point.y>t.point.y?"Bottom":"Top",n=iw(e,t,i,"Top"===t.direction?t.point.y-t.corners.top+20:t.corners.bottom-t.point.y+20);else if(e.sourcePortWrapper&&s===aw(r)){let o;("Left"===s||"Right"===s)&&t.point.y>=t.corners.top&&t.point.y<=t.corners.bottom?(t.direction=i.point.y>t.point.y?"Bottom":"Top",o=t.corners.height/2+20):("Top"===s||"Bottom"===s)&&t.point.x>=t.corners.left&&t.point.x<=t.corners.right&&(t.direction=i.point.x>t.point.x?"Right":"Left",o=t.corners.width/2+20),t.direction&&o?n=iw(e,t,i,o,!0):(t.direction=r,n=tw(t,i))}else!e.sourcePortWrapper||s!==i.direction||"Top"!==s&&"Bottom"!==s||t.corners.center.x!==i.corners.center.x?(t.direction=r,n=tw(t,i)):(t.direction=i.point.y>t.point.y?"Bottom":"Top",n=iw(e,t,i,"Bottom"===t.direction?t.corners.bottom-t.point.y+20:t.point.y-t.corners.top+20));else t.direction=r,n=iw(e,t,i,"Top"===r||"Bottom"===r?e.sourceWrapper.height/2+20:e.sourceWrapper.width/2+20),t.point=n[1],"Left"===r||"Right"===r?(i.direction=r,i.point="Left"===r?i.corners.middleLeft:i.corners.middleRight):Yv(e.targetWrapper,t,i,e),n=iw(e,t,i);return n}function Fv(e,t){if(void 0!==e.targetWrapper&&void 0===e.targetPortWrapper){const i=1;if(ZP(e.targetWrapper).containsPoint(t.point,i)){const n=e.targetWrapper,s=e.segments[e.segments.length-2],r=s.points[s.points.length-1],o=aw(s.direction);"Bottom"===o?r.y<n.corners.bottom+i&&(s.points[s.points.length-1].y=n.corners.bottom+20,s.length=rb.distancePoints(s.points[0],s.points[s.points.length-1])):"Top"===o?r.y>n.corners.top-i&&(s.points[s.points.length-1].y=n.corners.top-20,s.length=rb.distancePoints(s.points[0],s.points[s.points.length-1])):"Left"===o?r.x>n.corners.left-i&&(s.points[s.points.length-1].x=n.corners.left-20,s.length=rb.distancePoints(s.points[0],s.points[s.points.length-1])):"Right"===o&&r.x<n.corners.right+i&&(s.points[s.points.length-1].x=n.corners.right+20,s.length=rb.distancePoints(s.points[0],s.points[s.points.length-1])),t.point=s.points[s.points.length-1]}}}function Vv(e,t){for(let i=0;i<e.segments.length;i++){const n=e.segments[i];for(let e=0;e<n.points.length;e++)(e>0||0===i)&&t.push(n.points[e])}return t}function Yv(e,t,i,n){let s,r={x:0,y:0};const o=Hv(e,e.corners,e.bounds),a=t.margin,l=t.point;if(o.bottomCenter.y+a.bottom<l.y)s="Bottom",r=o.bottomCenter;else if(o.topCenter.y-a.top>l.y)s="Top",r=o.topCenter;else if(o.middleLeft.x-a.left>l.x)s="Left",r=o.middleLeft;else if(o.middleRight.x+a.right<l.x)s="Right",r=o.middleRight;else{const e=Math.abs(l.y-o.topCenter.y),t=Math.abs(l.x-o.middleRight.x),i=Math.abs(l.y-o.bottomCenter.y),n=Math.abs(l.x-o.middleLeft.x);let a=Number.MAX_VALUE;a=e,s="Top",r=o.topCenter,a>t&&(a=t,s="Right",r=o.middleRight),a>i&&(a=i,s="Bottom",r=o.bottomCenter),a>n&&(s="Left",r=o.middleLeft)}i.point=r,i.direction=s;const h=Gv(o,aw(i.direction));i.point=Zv(n,0,i.point,h,e===n.targetWrapper)}function Xv(e,t){const i=rb.findLength({x:t.x,y:e.y},t),n=rb.findLength(t,e);let s=Math.asin(i/n);return s=180*s/Math.PI,e.x<t.x?e.y>t.y&&(s=360-s):s=e.y<t.y?180-s:180+s,s}function Gv(e,t){let i;switch(t){case"Left":i=e.middleLeft;break;case"Top":i=e.topCenter;break;case"Right":i=e.middleRight;break;case"Bottom":i=e.bottomCenter}return i}function qv(e,t,i){return rb.transform(e,i,t)}function Zv(e,t,i,n,s){i={x:i.x,y:i.y},n={x:n.x,y:n.y};const r=s?e.targetWrapper:e.sourceWrapper,o=s?e.targetPadding:e.sourcePadding;let a,l;const h=s||"Orthogonal"===e.type?i:n,c=r,d=lO(-r.parentTransform,r.offsetX,r.offsetY,i),p=lO(-r.parentTransform,r.offsetX,r.offsetY,n);if("Orthogonal"===e.type){const e=5;d.x===p.x&&(d.y<p.y?d.y-=e:d.y+=e),d.y===p.y&&(d.x<p.x?d.x-=e:d.x+=e),i=lO(r.parentTransform,r.offsetX,r.offsetY,d)}else if(s){const e=rb.findAngle(i,n);n=rb.transform({x:n.x,y:n.y},e,Math.max(r.actualSize.width,r.actualSize.height))}else{const e=rb.findAngle(n,i);i=rb.transform({x:i.x,y:i.y},e,Math.max(r.actualSize.width,r.actualSize.height))}return(e.sourcePadding||e.targetPadding)&&(a=new mb(r.bounds.x-o,r.bounds.y-o,r.actualSize.width+2*o,r.actualSize.height+2*o)),r instanceof dv&&r.data?(l=a?[a.topLeft,a.topRight,a.bottomRight,a.bottomLeft]:c.getPoints(),c.data.split("m").length-1+(c.data.split("M").length-1)==1&&(l[l.length]=l[0])):(l=a?[a.topLeft,a.topRight,a.bottomRight,a.bottomLeft]:FS(0,r.corners),l[l.length]=l[0]),Qv({x1:i.x,y1:i.y,x2:n.x,y2:n.y},l,0,h)||i}function $v(e,t,i){return t.x=Math.round(100*t.x)/100,t.y=Math.round(100*t.y)/100,i?e.targetPoint=t:e.sourcePoint=t,t}function Qv(e,t,i,n){const s=t.length;let r,o={x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y},a=Jv(e,o);if(a&&(r=rb.distancePoints(a,n)),isNaN(r)||r>0)for(let l=1;l<s-1;l++){o={x1:t[l].x,y1:t[l].y,x2:t[l+1].x,y2:t[l+1].y};const i=Jv(e,o);if(i){const e=rb.distancePoints(i,n);if((isNaN(r)||r>e)&&(r=e,a=i),r>=0&&r<=1)break}}return a}function Jv(e,t){const i=e.x1,n=e.y1,s=e.x2,r=e.y2,o=t.x1,a=t.y1,l=t.x2,h=t.y2;let c,d,p,u,g,m,f,y,b,v,w,x,S,C;if(c=r-n,p=i-s,g=s*n-i*r,w=c*o+p*a+g,x=c*l+p*h+g,0!==w&&0!==x&&Kv(w,x))return null;if(d=h-a,u=o-l,m=l*a-o*h,b=d*i+u*n+m,v=d*s+u*r+m,0!==b&&0!==v&&Kv(b,v))return null;const P=c*u-d*p;return 0===P?null:(S=P<0?-P/2:P/2,S=0,C=p*m-u*g,f=C<0?(C-0)/P:(C+0)/P,C=d*g-c*m,y=C<0?(C-0)/P:(C+0)/P,{x:f,y:y})}function Kv(e,t){return e*t>=0}function ew(e,t,i){switch(t.direction){case"Left":t.point.x>e.left&&(i=t.point.x-e.left>i?t.point.x-e.left+i:i);break;case"Right":t.point.x<e.right&&(i=e.right-t.point.x>i?e.right-t.point.x+i:i);break;case"Top":t.point.y>e.top&&(i=t.point.y-e.top>i?t.point.y-e.top+i:i);break;case"Bottom":t.point.y<e.bottom&&(i=e.bottom-t.point.y>i?e.bottom-t.point.y+i:i)}return i}function tw(e,t){let i;switch(e.direction){case"Left":case"Right":let n={x:t.point.x,y:e.point.y};i=rb.equals(e.point,n)||rb.equals(t.point,n)?[e.point,t.point]:[e.point,n,t.point];break;case"Top":case"Bottom":const s={x:e.point.x,y:t.point.y};i=rb.equals(e.point,s)||rb.equals(t.point,s)?[e.point,t.point]:[e.point,s,t.point]}return i}function iw(e,t,i,n,s){n||(n=20);const r=e.sourcePortWrapper;let o,a,l;const h=i.point.x-t.point.x,c=i.point.y-t.point.y;let d;if(!s&&(Math.abs(h)<.001||Math.abs(c)<.001)&&void 0===i.direction)return o=[t.point,i.point],o;if(void 0===e.targetWrapper&&Math.abs(h)<=31&&Math.abs(c)<=31){if("Left"===t.direction||"Right"===t.direction?Math.abs(c)<12&&(t.direction=t.point.y>i.point.y?"Top":"Bottom"):Math.abs(h)<12&&(t.direction=t.point.x>i.point.x?"Left":"Right"),Math.abs(h)>12||Math.abs(c)>12)return tw(t,i);n+=5}return"Left"===t.direction||"Right"===t.direction?("Right"===t.direction?(void 0!==i.direction&&"Right"===i.direction&&(n=Math.max(t.point.x,i.point.x)-t.point.x+n),t.point.x>i.point.x&&void 0===r&&(n=-n)):(void 0!==i.direction&&"Left"===i.direction&&(n=t.point.x-Math.min(t.point.x,i.point.x)+n),(t.point.x>i.point.x||void 0!==r||"Left"===t.direction)&&(n=-n)),d=i.point.y-t.point.y,a=qv(t.point,n,0),d=i.point.y-a.y,0!==d&&(l=qv(a,i.point.y-a.y,90))):"Top"!==t.direction&&"Bottom"!==t.direction||("Bottom"===t.direction?void 0!==i.direction&&"Bottom"===i.direction&&(n=Math.max(t.point.y,i.point.y)-t.point.y+n):(void 0!==i.direction&&"Top"===i.direction&&(n=t.point.y-Math.min(t.point.y,i.point.y)+n),(t.point.y>i.point.y||void 0!==r||"Top"===t.direction)&&(n=-n)),d=i.point.x-t.point.x,a=qv(t.point,n,90),d=i.point.x-a.x,0!==d&&(l=qv(a,i.point.x-a.x,0))),0===d?[t.point,i.point]:(o=[t.point,a,l,i.point],o)}function nw(e,t,i,n,s=20){let r;switch(void 0===i?(e.margin={left:2,right:2,top:2,bottom:2},t.margin={left:0,right:5,top:0,bottom:5}):"Bottom"===e.direction?t.corners.top>e.corners.bottom&&t.corners.top-e.corners.bottom<20&&(s=(t.corners.top-e.corners.bottom)/2):"Top"===e.direction?t.corners.bottom<e.corners.top&&e.corners.top-t.corners.bottom<20&&(s=(e.corners.top-t.corners.bottom)/2):"Right"===e.direction?t.corners.left>e.corners.right&&t.corners.left-e.corners.right<20&&(s=(t.corners.left-e.corners.right)/2):"Left"===e.direction&&t.corners.right<e.corners.left&&e.corners.left-t.corners.right<20&&(s=(e.corners.left-t.corners.right)/2),e.direction){case"Left":s=function(e,t,i,n){return e.corners.left-e.margin.left>t.corners.left-t.margin.left&&e.corners.left-e.margin.left<=t.corners.right+t.margin.right?(("Bottom"===t.direction&&e.point.y<t.point.y||"Top"===t.direction&&e.point.y>t.point.y)&&(n+=e.corners.left-t.corners.left),n+=e.point.x-e.corners.left):n+=void 0!==i&&"Top"!==i&&"Bottom"===t.direction&&e.point.y<t.point.y||void 0!==i&&"Bottom"!==i&&"Top"===t.direction&&t.point.y<e.point.y?Math.abs(e.point.x-t.corners.right):e.point.x-e.corners.left,n}(e,t,i,s),r=qv(e.point,s,180);break;case"Right":s=function(e,t,i,n){return e.corners.right+e.margin.right<t.corners.right+t.margin.right&&e.corners.right+e.margin.right>=t.corners.left-t.margin.left?(("Bottom"===t.direction&&e.point.y<t.point.y||"Top"===t.direction&&e.point.y>t.point.y)&&(i+=t.corners.right-e.corners.right),i+=e.corners.right-e.point.x):i+=void 0!==n&&"Top"!==n&&"Bottom"===t.direction&&e.point.y<t.point.y||void 0!==n&&"Bottom"!==n&&"Top"===t.direction&&t.point.y<e.point.y?Math.abs(e.point.x-t.corners.right):e.corners.right-e.point.x,i}(e,t,s,i),r=qv(e.point,s,0);break;case"Top":s=function(e,t,i,n){return e.corners.top-e.margin.top>t.corners.top+t.margin.top&&e.corners.top-e.margin.top<=t.corners.bottom+t.margin.bottom?(("Right"===t.direction&&e.point.x<t.point.x||"Left"===t.direction&&e.point.x>t.point.x)&&(n+=e.corners.top-t.corners.top),n+=e.point.y-e.corners.top):n+=void 0!==i&&"Left"!==i&&"Right"===t.direction&&e.point.x<t.point.x||void 0!==i&&"Right"!==i&&"Left"===t.direction&&t.point.x<e.point.x?Math.abs(e.point.y-t.corners.bottom):e.point.y-e.corners.top,n}(e,t,i,s),r=qv(e.point,s,270);break;case"Bottom":s=function(e,t,i,n){return e.corners.bottom+e.margin.bottom<t.corners.bottom+t.margin.bottom&&e.corners.bottom+e.margin.bottom>=t.corners.top-t.margin.top?(("Right"===t.direction&&e.point.x<t.point.x||"Left"===t.direction&&e.point.x>t.point.x)&&(i+=t.corners.bottom-e.corners.bottom),i+=e.corners.bottom-e.point.y):i+=void 0!==n&&"Left"!==n&&"Right"===t.direction&&e.point.x<t.point.x||void 0!==n&&"Right"!==n&&"Left"===t.direction&&t.point.x<e.point.x?Math.abs(e.point.y-t.corners.bottom):e.corners.bottom-e.point.y,i}(e,t,s,i),r=qv(e.point,s,90)}return void 0!==n?n.push(r):n=[e.point,r],"Top"===e.direction||"Bottom"===e.direction?sw(r,"horizontal",e,t,n):"Right"!==e.direction&&"Left"!==e.direction||sw(r,"vertical",e,t,n),n}function sw(e,t,i,n,s){let r,o,a;"horizontal"===t?(i.margin={left:0,right:10,top:0,bottom:10},n.margin={left:0,right:10,top:0,bottom:10}):"vertical"===t&&(i.margin={left:10,right:0,top:10,bottom:0},n.margin={left:10,right:0,top:10,bottom:0});let l=20;if("horizontal"===t){switch(n.direction){case"Left":if(i.corners.right+i.margin.right<n.corners.left-n.margin.left&&(n.corners.left-i.corners.right>l||i.corners.top-i.margin.top<=n.point.y&&i.corners.bottom+i.margin.bottom>=n.point.y)){const t=Math.min(Math.abs(n.corners.left-i.corners.right)/2,20);l=i.corners.right-e.x+t}else l="Top"===i.direction&&e.y>n.point.y||"Bottom"===i.direction&&e.y<n.point.y?Math.min(n.corners.left,e.x)-e.x-20:e.x>=i.corners.left-i.margin.left&&e.x<=i.corners.right+i.margin.right?Math.min(n.corners.left,i.corners.left)-e.x-20:n.corners.left-e.x-20;break;case"Right":if(i.corners.left-i.margin.left>n.corners.right+n.margin.right&&(i.corners.left-n.corners.right>l||i.corners.top-i.margin.top<=n.point.y&&i.corners.bottom+i.margin.bottom>=n.point.y)){const t=Math.min(Math.abs(i.corners.left-n.corners.right)/2,20);l=i.corners.left-e.x-t}else l="Top"===i.direction&&e.y>n.point.y||"Bottom"===i.direction&&e.y<n.point.y?Math.max(n.corners.right,e.x)-e.x+20:e.x>=i.corners.left-i.margin.left&&e.x<=i.corners.right+i.margin.right?Math.max(n.corners.right,i.corners.right)-e.x+20:n.corners.right-e.x+20}r=qv(e,l,0),o=qv(r,n.point.y-e.y,90),a=n.point}else if("vertical"===t){switch(n.direction){case"Top":if(i.corners.bottom+i.margin.bottom<n.corners.top-n.margin.top&&(n.corners.top-i.corners.bottom>l||i.corners.left-i.margin.left<=n.point.x&&i.corners.right+i.margin.right>=n.point.x)){const t=Math.min(Math.abs(n.corners.top-i.corners.bottom)/2,20);l=i.corners.bottom-e.y+t}else l="Left"===i.direction&&e.x>n.point.x||"Right"===i.direction&&e.x<n.point.x?Math.min(n.corners.top,e.y)-e.y-20:e.y>=i.corners.top-i.margin.top&&e.y<=i.corners.bottom+i.margin.bottom?Math.min(n.corners.top,i.corners.top)-e.y-20:n.corners.top-e.y-20;break;case"Bottom":if(i.corners.top-i.margin.top>n.corners.bottom+n.margin.bottom&&(i.corners.top-n.corners.bottom>l||i.corners.left-i.margin.left<=n.point.x&&i.corners.right+i.margin.right>=n.point.x)){const t=Math.min(Math.abs(i.corners.top-n.corners.bottom)/2,20);l=i.corners.top-e.y-t}else l="Left"===i.direction&&e.x>n.point.x||"Right"===i.direction&&e.x<n.point.x?Math.max(n.corners.bottom,e.y)-e.y+20:e.y>=i.corners.top-i.margin.top&&e.y<=i.corners.bottom+i.margin.bottom?Math.max(n.corners.bottom,i.corners.bottom)-e.y+20:n.corners.bottom-e.y+20}r=qv(e,l,90),o=qv(r,n.point.x-e.x,0),a=n.point}s.push(r),s.push(o),s.push(a)}function rw(e,t){const i=e.direction;e.direction=t.direction,t.direction=i;const n=e.point;e.point=t.point,t.point=n;const s=e.corners;e.corners=t.corners,t.corners=s}function ow(e,t,i,n){let s;const r=void 0===t?i:t,o=r.topLeft,a=r.topRight,l=r.bottomRight,h=r.bottomLeft,c=r.center,d=Xv(c,e),p=Xv(c,l),u=Xv(c,h),g=Xv(c,o),m=Xv(c,a);return s=d>g&&d<m?"Top":d>=p&&d<u?"Bottom":d>=u&&d<=g?"Left":"Right",s}function aw(e){switch(e){case"Top":return"Bottom";case"Bottom":return"Top";case"Left":return"Right";case"Right":return"Left"}return"auto"}var lw=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let hw=(()=>{class e extends bg{}return lw([ig("")],e.prototype,"content",void 0),lw([ig("TopLeft")],e.prototype,"position",void 0),lw([ig("Mouse")],e.prototype,"relativeMode",void 0),lw([ig(!0)],e.prototype,"showTipPointer",void 0),lw([ig("auto")],e.prototype,"width",void 0),lw([ig("auto")],e.prototype,"height",void 0),lw([ig("Auto")],e.prototype,"openOn",void 0),lw([ig()],e.prototype,"animation",void 0),e})();function cw(e){let t;{let i=new _y;i=uw(e.tooltip,i),t=new _y(i),t.beforeCollision=pw,t.beforeOpen=dw,t.cssClass="e-diagram-tooltip",t.opensOn="custom",t.appendTo("#"+e.element.id),t.close()}return t}function dw(e){""!==this.content&&void 0!==this.content||(e.element.style.display="none")}function pw(e){e.collidedPosition&&e.collidedPosition!==this.position&&(e.element.style.display="none")}function uw(e,t){return e.content?(t.content=e.content,t.position=e.position,t.showTipPointer=e.showTipPointer,t.width=e.width,t.height=e.height,t.animation=e.animation?e.animation:{close:{effect:"None"}}):t.close(),t}var gw=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let mw=(()=>{class e extends bg{}return gw([ig()],e.prototype,"width",void 0),gw([ig()],e.prototype,"height",void 0),e})(),fw=(()=>{class e extends bg{}return gw([ig()],e.prototype,"width",void 0),gw([ig()],e.prototype,"height",void 0),gw([ig()],e.prototype,"fit",void 0),gw([ig()],e.prototype,"description",void 0),gw([ig()],e.prototype,"template",void 0),gw([ig()],e.prototype,"tooltip",void 0),e})();var yw=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let bw=(()=>{class e extends bg{}return yw([ig("")],e.prototype,"id",void 0),yw([ig(-1)],e.prototype,"zIndex",void 0),yw([ng({},Ib)],e.prototype,"margin",void 0),yw([ig(!0)],e.prototype,"visible",void 0),yw([ng({},hw)],e.prototype,"tooltip",void 0),yw([ig(!1)],e.prototype,"excludeFromLayout",void 0),yw([ig()],e.prototype,"addInfo",void 0),yw([ig("None")],e.prototype,"flip",void 0),yw([ng({},fw)],e.prototype,"symbolInfo",void 0),e})();class vw extends rv{constructor(e,t,i,n){super(),this.data="",this.nodeId="",this.annotationId="",this.diagramId="",this.diagramId=t,this.nodeId=e,this.annotationId=i,this.templateFn=qP(n)}getNodeTemplate(){return this.templateFn}get content(){return this.data}set content(e){this.data=e,this.canReset||(this.canReset=!0,this.isTemplate||(this.template=BP(this,!0)),this.canReset=!1,this.isDirt=!0)}}var ww=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let xw=(()=>{class e extends bg{}return ww([ig("")],e.prototype,"id",void 0),ww([ig("transparent")],e.prototype,"fill",void 0),ww([ig("black")],e.prototype,"iconStrokeColor",void 0),ww([ig(0)],e.prototype,"iconStrokeWidth",void 0),ww([ig(!0)],e.prototype,"visibility",void 0),ww([ig(10)],e.prototype,"width",void 0),ww([ig(10)],e.prototype,"height",void 0),ww([ig("transparent")],e.prototype,"handleStrokeColor",void 0),ww([ig(1)],e.prototype,"handleStrokeWidth",void 0),ww([ig("")],e.prototype,"pathData",void 0),ww([ig(0)],e.prototype,"cornerRadius",void 0),ww([ng({left:0,right:0,top:0,bottom:0},Ib)],e.prototype,"padding",void 0),e})(),Sw=(()=>{class e extends xw{}return ww([ng({x:0,y:0},rb)],e.prototype,"offset",void 0),ww([ng({},Ib)],e.prototype,"margin",void 0),e})(),Cw=(()=>{class e extends xw{}return ww([ig(.5)],e.prototype,"offset",void 0),ww([ig("Center")],e.prototype,"alignment",void 0),ww([ng({x:0,y:0},rb)],e.prototype,"displacement",void 0),e})();var Pw=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};const Ow=e=>{if(e)switch(e.type){case"Bpmn":return Mw;case"UmlActivity":return Dw;case"UmlClassifier":return Fw;default:return Iw}return Iw},Tw=e=>{if(e)switch(e.type){case"Straight":return zw;case"Bezier":return Lw;case"Orthogonal":return kw;default:return zw}};let Ew=(()=>{class e extends bg{}return Pw([ig(10)],e.prototype,"width",void 0),Pw([ig(10)],e.prototype,"height",void 0),Pw([ig("Arrow")],e.prototype,"shape",void 0),Pw([ng({fill:"black",strokeColor:"black",strokeWidth:1},kb)],e.prototype,"style",void 0),Pw([ng({x:0,y:.5},rb)],e.prototype,"pivot",void 0),Pw([ig("")],e.prototype,"pathData",void 0),e})(),Aw=(()=>{class e extends bg{}return Pw([ig(0)],e.prototype,"angle",void 0),Pw([ig(0)],e.prototype,"distance",void 0),e})(),Iw=(()=>{class e extends bg{}return Pw([ig("None")],e.prototype,"type",void 0),e})(),Dw=(()=>{class e extends Iw{}return Pw([ig("Object")],e.prototype,"flow",void 0),Pw([ig(30)],e.prototype,"exceptionFlowHeight",void 0),e})(),Mw=(()=>{class e extends Iw{}return Pw([ig("Sequence")],e.prototype,"flow",void 0),Pw([ig("Normal")],e.prototype,"sequence",void 0),Pw([ig("Default")],e.prototype,"message",void 0),Pw([ig("Default")],e.prototype,"association",void 0),e})(),Rw=(()=>{class e extends bg{constructor(e,t,i,n){super(e,t,i,n),this.points=[]}}return Pw([ig("Straight")],e.prototype,"type",void 0),Pw([ig(!0)],e.prototype,"allowDrag",void 0),e})(),zw=(()=>{class e extends Rw{getClassName(){return"StraightSegment"}}return Pw([ng({x:0,y:0},rb)],e.prototype,"point",void 0),e})(),Lw=(()=>{class e extends zw{getClassName(){return"BezierSegment"}}return Pw([ng({x:0,y:0},rb)],e.prototype,"point1",void 0),Pw([ng({x:0,y:0},rb)],e.prototype,"point2",void 0),Pw([ng({angle:0,distance:0},Aw)],e.prototype,"vector1",void 0),Pw([ng({angle:0,distance:0},Aw)],e.prototype,"vector2",void 0),e})(),kw=(()=>{class e extends Rw{getClassName(){return"OrthogonalSegment"}}return Pw([ig(null)],e.prototype,"length",void 0),Pw([ig(null)],e.prototype,"direction",void 0),e})();function jw(e,t,i){const n=i?45:180/(2+2/(e.height/e.width)),s=n,r=180-n,o=r+2*n,a=360-n,l=Xv(t,e.center);return l>s&&l<r?"top":l>r&&l<o?"right":l>o&&l<a?"bottom":"left"}function Hw(e){return!e.distance&&!e.angle}function _w(e,t,i){let n=60,s={x:0,y:0};switch(i||(i=Math.abs(t.x-e.x)>Math.abs(t.y-e.y)?e.x<t.x?"right":"left":e.y<t.y?"bottom":"top"),i){case"bottom":case"top":n=Math.min(.45*Math.abs(e.y-t.y),n),s={x:e.x,y:e.y+("bottom"===i?n:-n)};break;case"right":case"left":n=Math.min(.45*Math.abs(e.x-t.x),n),s={x:e.x+("right"===i?n:-n),y:e.y}}return s}function Nw(e,t,i,n,s){let r=0,o=0,a=0,l=0;const h=Number((s.distance(t,e)+s.distance(i,t)+s.distance(n,i))/3);if(0!==h)for(let c=0;c<=h;c++){const s=c/h,d=(1-s)*(1-s)*(1-s)*e.x+3*s*(1-s)*(1-s)*t.x+3*s*s*(1-s)*i.x+s*s*s*n.x,p=(1-s)*(1-s)*(1-s)*e.y+3*s*(1-s)*(1-s)*t.y+3*s*s*(1-s)*i.y+s*s*s*n.y;0===c?(r=a=d,o=l=p):(r=Math.min(d,r),o=Math.min(p,o),a=Math.max(d,a),l=Math.max(p,l))}return{x:r,y:o,width:a-r,height:l-o,left:r,top:o,right:r+(a-r),bottom:o+(l-o),center:{x:(r+(a-r))/2,y:(o+(l-o))/2}}}function Bw(e,t,i,n,s,r,o){const a={x:0,y:0},l=r/o;return a.x=(1-l)*(1-l)*(1-l)*t.x+3*l*(1-l)*(1-l)*i.x+3*l*l*(1-l)*n.x+l*l*l*s.x,a.y=(1-l)*(1-l)*(1-l)*t.y+3*l*(1-l)*(1-l)*i.y+3*l*l*(1-l)*n.y+l*l*l*s.y,a}let Ww=(()=>{class e extends bg{}return Pw([ig(!0)],e.prototype,"optional",void 0),Pw([ig(void 0)],e.prototype,"lowerBounds",void 0),Pw([ig(void 0)],e.prototype,"upperBounds",void 0),e})(),Uw=(()=>{class e extends bg{}return Pw([ig("OneToOne")],e.prototype,"type",void 0),Pw([ng({},Ww)],e.prototype,"target",void 0),Pw([ng({},Ww)],e.prototype,"source",void 0),e})(),Fw=(()=>{class e extends Iw{}return Pw([ig("UmlClassifier")],e.prototype,"type",void 0),Pw([ig("Aggregation")],e.prototype,"relationship",void 0),Pw([ig("Directional")],e.prototype,"associationType",void 0),Pw([ng({},Uw)],e.prototype,"multiplicity",void 0),e})(),Vw=(()=>{class e extends bw{constructor(e,t,i,n){super(e,t,i,n),this.parentId="",this.bridges=[],this.status="None",this.shape&&"UmlActivity"===this.shape.type&&LS(i,this),i&&i.shape&&"None"!==i.shape.type&&kS(i,this)}setPortID(e,t){if(this.targetID&&this.sourceID){const i=e.nameTable[this.targetID],n=e.nameTable[this.sourceID],s=t?i&&i.ports:n&&n.ports;let r;for(let e=0;s&&e<s.length;e++)r=s[e],this.targetPortID===r.id&&t?!(r.constraints&sv.None)&&r.constraints&sv.InConnect||(this.targetPortID=""):this.sourcePortID!==r.id||t||!(r.constraints&sv.None)&&r.constraints&sv.OutConnect||(this.sourcePortID="")}}init(e){let t;this.id||(this.id=XP()),this.sourcePortID&&this.setPortID(e),this.targetPortID&&this.setPortID(e,!0);const i=new lv;let n=new dv;n.id=this.id+"_path";let s=new dv,r=new dv;n=this.getSegmentElement(this,n);let o=[];o=this.getConnectorPoints(this.type),o=this.clipDecorators(this,o);const a=mb.toBounds(o);switch(i.width=a.width,i.height=a.height,i.offsetX=a.x+i.pivot.x*a.width,i.offsetY=a.y+i.pivot.y*a.height,this.shape.type){case"Bpmn":switch(this.shape.flow){case"Sequence":t=this.getBpmnSequenceFlow();break;case"Association":t=new dv,t.visible=!1,this.getBpmnAssociationFlow();break;case"Message":t=this.getBpmnMessageFlow(),n=this.getSegmentElement(this,n),this.updateShapePosition(this,t)}break;case"UmlActivity":switch(this.shape.flow){case"Object":this.getUMLObjectFlow();break;case"Exception":this.getUMLExceptionFlow(n)}break;case"UmlClassifier":this.getConnectorRelation()}let l=this.intermediatePoints;if("Bezier"===this.type){const e=this.segments[0],t=this.segments[this.segments.length-1];l=[rb.isEmptyPoint(t.point2)?t.bezierPoint2:t.point2,rb.isEmptyPoint(e.point1)?e.bezierPoint1:e.point1]}const h=e.getDescription;if(s=this.getDecoratorElement(o[0],l[1],this.sourceDecorator,!0,h),r=this.getDecoratorElement(o[o.length-1],l[l.length-2],this.targetDecorator,!1,h),s.id=this.id+"_srcDec",r.id=this.id+"_tarDec",n.style=this.style,n.style.fill="transparent",void 0!==h){const t=h(this,e);n.description=t||this.id}i.style.strokeColor="transparent",i.style.fill="transparent",i.style.strokeWidth=0,i.children=[n,s,r],i.id=this.id,void 0!==t&&i.children.push(t),i.offsetX=n.offsetX,i.offsetY=n.offsetY,i.width=n.width,i.height=n.height;for(let c=0;c<this.annotations.length;c++)i.children.push(this.getAnnotationElement(this.annotations[c],this.intermediatePoints,a,h,e.element.id,e.annotationTemplate));for(let c=0;c<this.fixedUserHandles.length;c++)i.children.push(this.getfixedUserHandle(this.fixedUserHandles[c],this.intermediatePoints,a));return this.wrapper=i,i}getConnectorRelation(){const e=this.shape;"Association"===e.relationship?(this.segments[0].type="Straight",this.sourceDecorator.shape="None",this.targetDecorator.shape="Arrow"):"Inheritance"===e.relationship?(this.segments[0].type="Orthogonal",this.sourceDecorator.shape="None",this.targetDecorator.shape="Arrow"):"Composition"===e.relationship||"Aggregation"===e.relationship?(this.segments[0].type="Orthogonal",this.sourceDecorator.shape="Diamond",this.targetDecorator.shape="None"):"Dependency"===e.relationship?(this.segments[0].type="Orthogonal",this.sourceDecorator.shape="None",this.targetDecorator.shape="OpenArrow"):"Realization"===e.relationship&&(this.segments[0].type="Orthogonal",this.sourceDecorator.shape="None",this.targetDecorator.shape="Arrow"),"BiDirectional"===e.associationType&&(this.sourceDecorator.shape="None",this.targetDecorator.shape="None");let t="",i="",n="",s="";e.multiplicity.source&&(e.multiplicity.source.lowerBounds=e.multiplicity.source.lowerBounds,e.multiplicity.source.upperBounds=e.multiplicity.source.upperBounds),e.multiplicity.target&&(e.multiplicity.target.lowerBounds=e.multiplicity.target.lowerBounds,e.multiplicity.target.upperBounds=e.multiplicity.target.upperBounds);const r=e.multiplicity.source,o=e.multiplicity.target;s=r.upperBounds?r.lowerBounds+"..."+r.upperBounds:r.lowerBounds,t=o.upperBounds?o.lowerBounds+"..."+o.upperBounds:o.lowerBounds,"ManyToOne"===e.multiplicity.type&&(e.multiplicity.target.optional=!1,i=s||"*",n="1"),"OneToMany"===e.multiplicity.type&&(e.multiplicity.source.optional=!1,n=t||"*",i="1"),"ManyToOne"===e.multiplicity.type&&(i=s||"*",n=t||"*"),"OneToOne"===e.multiplicity.type&&(e.multiplicity.target.optional=!1,e.multiplicity.source.optional=!1,i="1",n="1"),this.annotations=[{id:this.id+"sourcelabel",content:i,offset:0,alignment:"Before",margin:{right:5,bottom:5}},{id:this.id+"targetlabel",content:n,offset:1,alignment:"Before",margin:{right:5,bottom:5}}]}getBpmnSequenceFlow(){let e=new dv,t=new dv;return"Normal"===this.shape.sequence&&"Bezier"!==this.type&&(this.targetDecorator.shape="Arrow"),"Default"===this.shape.sequence&&(e=this.getSegmentElement(this,e),t=SC(this.intermediatePoints,this),this.targetDecorator.shape="Arrow"),"Conditional"===this.shape.sequence&&(this.targetDecorator.shape="Arrow",this.sourceDecorator.shape="Diamond",t.id=this.id+this.shape.type),t}getUMLObjectFlow(){if(this.annotations)for(let e=0;e<this.annotations.length;e++)this.annotations[e].content="["+this.annotations[e].content+"]"}getUMLExceptionFlow(e){this.type="Straight";const t={x:(this.targetPoint.x+this.sourcePoint.x)/2,y:(this.targetPoint.y+this.sourcePoint.y)/2},i=t.x-this.sourcePoint.x,n=t.y-this.sourcePoint.y,s=this.shape.exceptionFlowHeight/2/Math.sqrt(i*i+n*n),r={x:t.x-i*s,y:t.y-n*s},o={x:t.x+i*s,y:t.y+n*s},a=bb();wb(a,315,t.x,t.y),this.segments=[];let l=new zw(this,"segments",{type:"Straight",point:vb(a,o)},!0);this.segments.push(l),l=new zw(this,"segments",{type:"Straight",point:vb(a,r)},!0),this.segments.push(l),e=this.getSegmentElement(this,e)}getBpmnAssociationFlow(){"Default"===this.shape.association&&(this.targetDecorator.shape="Arrow"),"Directional"===this.shape.association&&(this.targetDecorator.shape="Arrow"),"BiDirectional"===this.shape.association&&(this.targetDecorator.shape="Arrow",this.sourceDecorator.shape="Arrow")}getfixedUserHandle(e,t,i){const n=new lv;n.float=!0,e.id=e.id||XP(),n.id=this.id+"_"+e.id,n.children=[],n.visible=e.visibility,n.width=e.width,n.height=e.height,n.style.strokeWidth=e.handleStrokeWidth,n.style.fill=e.fill,n.style.strokeColor=e.handleStrokeColor,n.cornerRadius=e.cornerRadius,this.updateAnnotation(e,t,i,n);const s=VS(e,n);return n.children.push(s),n.description=n.id,n}getBpmnMessageFlow(){const e=new dv;return this.targetDecorator.shape="Arrow",this.targetDecorator.width=5,this.targetDecorator.height=10,this.sourceDecorator.shape="Circle","InitiatingMessage"!==this.shape.message&&"NonInitiatingMessage"!==this.shape.message||(e.id=this.id+"_"+this.shape.message,e.width=25,e.height=15,e.data="M0,0 L19.8,12.8 L40,0 L0, 0 L0, 25.5 L40, 25.5 L 40, 0",e.horizontalAlignment="Center",e.verticalAlignment="Center",e.transform=Zb.Self,e.style.fill="NonInitiatingMessage"===this.shape.message?"lightgrey":"white"),e}distance(e,t){return OC(e,t)}findPath(e,t){return PC(e,t)}getAnnotationElement(e,t,i,n,s,r){let o,a;e.id=e.id||XP(),s&&(e.template||"Template"===e.annotationType||r&&""===e.content)?(o=new vw(this.id,s,e.id,r),o=YP(o,e,r)):(o=new av,o.content=e.content,o.style.textOverflow="Wrap"),o.constraints=e.constraints,o.visible=e.visibility,o.rotateAngle=e.rotateAngle,o.horizontalAlignment=e.horizontalAlignment,o.verticalAlignment=e.verticalAlignment,o.width=e.width,o.height=e.height,void 0===i.width||e.template||(o.width=(e.width||i.width)-e.margin.left-e.margin.right),o.margin=e.margin,o.id=this.id+"_"+e.id,0===i.width&&(i.width=this.style.strokeWidth),0===i.height&&(i.height=this.style.strokeWidth),o.style=e.style;const l=hO(n);return l&&(a=l(e,this)),o.description=a||o.id,this.updateAnnotation(e,t,i,o),o}updateAnnotation(e,t,i,n,s){const r={x:0,y:0};n instanceof vw||rv||s||n.refreshTextElement(),n.width=e.width||i.width;const o=YS(t,e),a=o.point;e instanceof xv&&e.segmentAngle&&(n.rotateAngle=e.rotateAngle+o.angle,n.rotateAngle=(n.rotateAngle+360)%360),0===i.width&&(i.width=this.style.strokeWidth),0===i.height&&(i.height=this.style.strokeWidth);const l=(a.y-i.y)/i.height;r.x=i.width*((a.x-i.x)/i.width),r.y=i.height*l;const h=function(e,t,i){t%=360;const n=225;let s,r;switch(e.alignment){case"Before":t>=45&&t<=135?(r="right",s=.5===e.offset?"center":"top"):t>=n&&t<=315?(r="left",s=.5===e.offset?"center":"bottom"):t>45&&t<n?(s="top",r=.5===e.offset?"center":"right"):(s="bottom",r=.5===e.offset?"center":"left");break;case"After":t>=45&&t<=135?(r="left",s=.5===e.offset?"center":"top"):t>=n&&t<=315?(r="right",s=.5===e.offset?"center":"bottom"):t>45&&t<n?(s="bottom",r=.5===e.offset?"center":"right"):(s="top",r=.5===e.offset?"center":"left");break;case"Center":r=jp(e.horizontalAlignment)?"center":e.horizontalAlignment.toLowerCase(),s=jp(e.verticalAlignment)?"center":e.verticalAlignment.toLowerCase()}if(0===e.offset||1===e.offset)switch(o=i[0],a=i[1],Math.abs(a.x-o.x)>Math.abs(a.y-o.y)?o.x<a.x?"right":"left":o.y<a.y?"bottom":"top"){case"left":r=0===e.offset?"right":"left";break;case"right":r=0===e.offset?"left":"right";break;case"bottom":s=0===e.offset?"top":"bottom";break;case"top":s=0===e.offset?"bottom":"top"}var o,a;return{hAlign:r,vAlign:s}}(e,o.angle,t),c=h.hAlign,d=h.vAlign;let p,u;"left"===c?(p="Left",r.x+=e.displacement.x):"right"===c?(p="Right",r.x-=e.displacement.x):"center"===c&&(p="Center"),"top"===d?(u="Top",r.y+=e.displacement.y):"bottom"===d?(u="Bottom",r.y-=e.displacement.y):"center"===d&&(u="Center"),n.horizontalAlignment=p,n.verticalAlignment=u,n.setOffsetWithRespectToBounds(r.x,r.y,"Absolute"),n.relativeMode="Point"}getConnectorPoints(e,t,i,n){const s=Ev(this,i,n).slice(0);return s&&s.length>0&&(this.sourcePoint=s[0],this.targetPoint=s[s.length-1]),s}clipDecorator(e,t,i,n){let s={x:0,y:0},r={x:0,y:0},o={x:0,y:0};const a=t.length;r=i?t[0]:t[a-1],o=i?t[1]:t[a-2];let l=rb.distancePoints(r,o);l=0===l?1:l;let h=1;const c=i?e.sourceWrapper:e.targetWrapper;c&&(h=c.style.strokeWidth,n&&n&Jb.DecoratorPropertyChange&&(h=1));const d=h-1;return s.x=Math.round(r.x+d*(o.x-r.x)/l),s.y=Math.round(r.y+d*(o.y-r.y)/l),(i&&"None"!==e.sourceDecorator.shape||!i&&"None"!==e.targetDecorator.shape)&&(s=rb.adjustPoint(s,o,!0,n&Jb.DecoratorPropertyChange?0:h/2)),s}clipDecorators(e,t,i){return"None"!==e.sourceDecorator.shape&&(t[0]=this.clipDecorator(e,t,!0,i)),"None"!==e.targetDecorator.shape&&(t[t.length-1]=this.clipDecorator(e,t,!1,i)),t}updateSegmentElement(e,t,i,n){let s=new mb;const r=this.getSegmentPath(e,t,n);if("Bezier"===e.type){if(this.segments.length>0)for(let o=0;o<this.segments.length;o++){const t=this.segments[o],i=e.segments[o],n=rb.isEmptyPoint(t.point1)?i.bezierPoint1:i.point1,r=rb.isEmptyPoint(t.point2)?i.bezierPoint2:i.point2;s.uniteRect(Nw(t.points[0],n,r,t.points[1],e))}}else s=mb.toBounds(t);return i.width=s.width,i.height=s.height,i.offsetX=s.x+i.width/2,i.offsetY=s.y+i.height/2,i.data=r,e.wrapper&&(e.wrapper.offsetX=i.offsetX,e.wrapper.offsetY=i.offsetY,e.wrapper.width=s.width,e.wrapper.height=s.height),i}getSegmentElement(e,t,i,n,s=!0){let r=[];return s&&bC(e),r=this.getConnectorPoints(e.type,void 0,i),this.intermediatePoints=r,t.staticSize=!0,this.updateSegmentElement(e,r,t,n)}getDecoratorElement(e,t,i,n,s){const r=new dv;if(r.transform=Zb.Self,this.updateDecoratorElement(r,e,t,i),void 0!==s){const e=s(i,this);r.description=e||"source"}return r}bridgePath(e,t,i){let n=t;if(e.bridges.length>0)if("Straight"===e.type&&e.segments.length<2)for(let s=0;s<e.bridges.length;s++){const t=e.bridges[s];t.rendered||(n+=" L"+t.startPoint.x+" "+t.startPoint.y,n+=t.path,t.rendered=!0)}else if("Orthogonal"===e.type||"Straight"===e.type&&e.segments.length>1)for(let s=0;s<e.bridges.length;s++){const t=e.bridges[s];t.segmentPointIndex===i&&(t.rendered||t.segmentPointIndex===i&&(n+=" L"+t.startPoint.x+" "+t.startPoint.y,n+=t.path,t.rendered=!0))}return n}updateDecoratorElement(e,t,i,n){e.offsetX=t.x,e.offsetY=t.y;const s=rb.findAngle(t,i),r=function(e,t){return"Custom"===e?t.pathData:Pv[e]}(n.shape,n),o=new nb(n.width,n.height);e.pivot.x=n.pivot.x,e.pivot.y=n.pivot.y,e.style=n.style,e.rotateAngle=s,e.data=r,e.canMeasurePath=!0,e.width=o.width,e.height=o.height}getSegmentPath(e,t,i){let n,s,r,o="",a=[],l=0;for(;l<t.length;)a.push({x:t[l].x,y:t[l].y}),l++;for(let h=0;h<e.bridges.length;h++)e.bridges[h].rendered=!1;if(a=this.clipDecorators(e,a,i),this.cornerRadius>0&&"Bezier"!==this.type)for(let h=0;h<a.length-1;h++){n=a[h],0===h&&(o="M"+n.x+" "+n.y);const t=rb.distancePoints(a[h],a[h+1]);t>0&&(s=h<a.length-2?rb.adjustPoint(a[h],a[h+1],!1,t<2*this.cornerRadius?t/2:this.cornerRadius):a[h+1],h>0&&(t<2*this.cornerRadius?(r=rb.adjustPoint(a[h],a[h+1],!0,t/2),h<a.length-2&&(s=null)):r=rb.adjustPoint(a[h],a[h+1],!0,this.cornerRadius)),r&&(o+="Q"+n.x+" "+n.y+" "+r.x+" "+r.y),s&&(e.bridges.length>0&&(o=this.bridgePath(e,o,h),"Orthogonal"===e.type&&(o=this.bridgePath(e,o,h+1))),o+=" L"+s.x+" "+s.y))}else if("Bezier"===this.type){let t;const n=this.segments;for(let i=0;i<n.length;i++)a.length>2&&(n[i].bezierPoint1={x:0,y:0},n[i].bezierPoint2={x:0,y:0}),!rb.isEmptyPoint(n[i].point1)||n[i].vector1.angle||n[i].vector1.distance?n[i].bezierPoint1=n[i].vector1.angle||n[i].vector1.distance?rb.transform(a[i],n[i].vector1.angle,n[i].vector1.distance):{x:n[i].point1.x||n[i].bezierPoint1.x,y:n[i].point1.y||n[i].bezierPoint1.y}:((e.sourceID||this.sourcePortID)&&this.sourceWrapper&&(t=jw(this.sourceWrapper.bounds,a[i],!0)),n[i].bezierPoint1=_w(a[i],a[i+1],t)),!rb.isEmptyPoint(n[i].point2)||n[i].vector2.angle||n[i].vector2.distance?n[i].bezierPoint2=n[i].vector2.angle||n[i].vector2.distance?rb.transform(a[i+1],n[i].vector2.angle,n[i].vector2.distance):{x:n[i].point2.x||n[i].bezierPoint2.x,y:n[i].point2.y||n[i].bezierPoint2.y}:((e.targetID||this.targetPortID)&&this.targetWrapper&&(t=jw(this.targetWrapper.bounds,a[i+1],!0)),n[i].bezierPoint2=_w(a[i+1],a[i],t));a.splice(1,0,{x:n[0].bezierPoint1.x,y:n[0].bezierPoint1.y}),a.splice(a.length-1,0,{x:n[n.length-1].bezierPoint2.x,y:n[n.length-1].bezierPoint2.y}),a=this.clipDecorators(e,a,i);for(let e=0;e<n.length;e++)0===e&&(o="M"+a[0].x+" "+a[0].y),o+="C"+n[e].bezierPoint1.x+" "+n[e].bezierPoint1.y+" "+n[e].bezierPoint2.x+" "+n[e].bezierPoint2.y+" "+(e===n.length-1?a[a.length-1].x+" "+a[a.length-1].y:n[e].points[n[e].points.length-1].x+" "+n[e].points[n[e].points.length-1].y)}else for(let h=0;h<a.length;h++)n=a[h],0===h&&(o="M"+n.x+" "+n.y),h>0&&(o=this.bridgePath(e,o,h),o+=" L"+n.x+" "+n.y);return o}updateShapeElement(e){let t;switch(e.shape.type){case"Bpmn":e.wrapper.children[3]instanceof dv&&(t=e.wrapper.children[3]),"Message"===e.shape.flow&&this.updateShapePosition(e,t);break;case"UmlActivity":"Exception"===e.shape.flow&&this.getUMLExceptionFlow(e.wrapper.children[0])}}updateShapePosition(e,t){let i,n,s=0;const r=this.intermediatePoints;for(let o=0;o<r.length-1;o++){s+=this.distance(r[o],r[o+1]);const e=.5*s;s>=e&&(i=Xv(r[o],r[o+1]),n=rb.transform(r[o],i,e))}t.offsetX=n.x,t.offsetY=n.y}scale(e,t,i,n,s){let r=0,o=0;if(this.wrapper&&this.wrapper.outerBounds){const s=function(e){const t=e.wrapper.children[0].bounds;return"None"!==e.sourceDecorator.shape&&t.uniteRect(e.wrapper.children[1].bounds),"None"!==e.targetDecorator.shape&&t.uniteRect(e.wrapper.children[2].bounds),t}(this),a=(this.wrapper.bounds.width||this.style.strokeWidth||1)-2,l=(this.wrapper.bounds.height||this.style.strokeWidth||1)-2;r=s.width-a,o=s.height-l,e=(i-Math.max(r,o))/a,t=(n-Math.max(r,o))/l,r=o=Math.min(r,o)}e=t=Math.min(e,t);const a=bb();wb(a,-(s=s||this.wrapper).rotateAngle,s.offsetX,s.offsetY),xb(a,e,t,s.offsetX,s.offsetY),wb(a,s.rotateAngle,s.offsetX,s.offsetY);let l=function(e,t){const i=[];for(const n of t)i.push(vb(e,n));return i}(a,this.intermediatePoints);return this.sourcePoint=l[0],this.targetPoint=l[l.length-1],l=this.intermediatePoints=Ev(this),sC(this,l),{x:r,y:o}}getClassName(){return"Connector"}}return Pw([sg(Ow)],e.prototype,"shape",void 0),Pw([ig(Ub.Default)],e.prototype,"constraints",void 0),Pw([ig(10)],e.prototype,"bridgeSpace",void 0),Pw([rg([],xv)],e.prototype,"annotations",void 0),Pw([ng({},rb)],e.prototype,"sourcePoint",void 0),Pw([ng({},rb)],e.prototype,"targetPoint",void 0),Pw([rg([],Cw)],e.prototype,"fixedUserHandles",void 0),Pw([(t=Tw,(e,i)=>{const n={set:Ju([],i,t),get:Ku([],i,t),enumerable:!0,configurable:!0};Object.defineProperty(e,i,n),lg(e,i,"colProp",{},t)})],e.prototype,"segments",void 0),Pw([ig("")],e.prototype,"sourceID",void 0),Pw([ig("")],e.prototype,"targetID",void 0),Pw([ig(10)],e.prototype,"hitPadding",void 0),Pw([ig(0)],e.prototype,"connectionPadding",void 0),Pw([ig("Straight")],e.prototype,"type",void 0),Pw([ig(0)],e.prototype,"cornerRadius",void 0),Pw([ng({shape:"None"},Ew)],e.prototype,"sourceDecorator",void 0),Pw([ng({shape:"Arrow"},Ew)],e.prototype,"targetDecorator",void 0),Pw([ng({},hw)],e.prototype,"tooltip",void 0),Pw([ig("")],e.prototype,"sourcePortID",void 0),Pw([ig("")],e.prototype,"targetPortID",void 0),Pw([ig(0)],e.prototype,"sourcePadding",void 0),Pw([ng({},mw)],e.prototype,"previewSize",void 0),Pw([ng({},mw)],e.prototype,"dragSize",void 0),Pw([ig(0)],e.prototype,"targetPadding",void 0),Pw([ng({strokeWidth:1,strokeColor:"black"},jb)],e.prototype,"style",void 0),Pw([ig(null)],e.prototype,"wrapper",void 0),e;var t})();var Yw=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let Xw=(()=>{class e extends Cg{constructor(e,t){super(e,t),this.offset=0,this.scale=1}preRender(){this.unWireEvents(),this.wireEvents()}render(){this.updateRulerGeometry(),this.renderComplete()}getModuleName(){return"Ruler"}destroy(){this.unWireEvents(),this.notify("destroy",{}),super.destroy(),this.element.classList.remove("e-ruler")}getPersistData(){return this.addOnPersist(["loaded"])}onPropertyChanged(e,t){for(const i of Object.keys(e))switch(i){case"length":case"interval":case"segmentWidth":case"tickAlignment":case"markerColor":case"thickness":this.updateRuler()}}updateRulerGeometry(){this.element.style.textAlign="left",this.renderRulerSpace(),this.updateRuler()}renderRulerSpace(){const e=this.getRulerGeometry();let t=document.getElementById(this.element.id+"_ruler_space");return t||(t=kP("div",{id:this.element.id+"_ruler_space",style:"height:"+e.height+"px;width:"+e.width+"px;cssFloat:left;"}),this.element.appendChild(t)),t}updateRuler(){const e=this.getRulerSize(),t=this.getRulerGeometry();let i=0,n=0;const s=new nb,r=this.getRulerSVG(t);r&&(i=this.length,s.height=e,n=this.offset,i&&i!==1/0)&&this.updateSegments(n,i+this.segmentWidth+Math.abs(n),r,e)}updateSegments(e,t,i,n){let s=e;const r={trans:0};for(;s<t;){const o=this.getNewSegment(s,i);o&&(i.appendChild(o.segment),s=this.updateSegment(e,t,o,s,r,n))}}updateSegment(e,t,i,n,s,r){const o=this.updateSegmentWidth(this.scale);return n===e?(this.startValue=Math.floor(e/o)*o/this.scale,this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue,i.label.textContent=this.startValue.toString(),this.defStartValue=n=this.startValue*this.scale,"Horizontal"===this.orientation?this.hRulerOffset=e-n:this.vRulerOffset=e-n):(this.startValue=n/this.scale,this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue,i.label.textContent=this.startValue.toString()),this.updateTickLabel(i,r),i.segment.setAttribute("transform","translate("+("Horizontal"===this.orientation?s.trans+.5+",0.5":"0.5,"+(s.trans+.5))+")"),s.trans+=o,n+o}updateTickLabel(e,t){const i=e.segment.lastChild.getBBox(),n="Horizontal"===this.orientation,s="RightOrBottom"===this.tickAlignment,r=n?2:0,o=n?s?t/2+5.5-5.5:t/2+5.5:i.height;WP(e.segment.lastChild,n?{x:r,y:o}:{x:r,y:o,transform:"rotate(270)translate("+(s?-(i.width+2)+","+(t/2-i.height):-(i.width+2)+","+(t/2-i.height/2))+")"})}getNewSegment(e,t){const i=this.createNewTicks(e,t);return{segment:i,label:this.createTickLabel(t,i)}}createNewTicks(e,t){let i,n;const s=this.updateSegmentWidth(this.scale),r=jP("g",{class:"e-ruler-segment"});for(let o=0;o<this.interval;o++)n=s/this.interval,i=this.createTick(t,n,o+1,e),r.appendChild(i);return r}getLinePoint(e,t,i){const n=this.updateSegmentWidth(this.scale),s=this.getRulerSize();return(t*=i-1)%n==0?s:.3*s}createTick(e,t,i,n){let s=this.getLinePoint(e,t,i);const r=this.getRulerSize(),o="Horizontal"===this.orientation,a="RightOrBottom"===this.tickAlignment,l=hO(this.arrangeTick),h={ruler:void 0,tickLength:s,tickInterval:this.segmentWidth/this.interval*(i-1)};l&&l(h),s=h.tickLength;const c=t*(i-1),d=jP("line",{x1:o?c:a?r:0,y1:o?a?r:r-(r-s):c,x2:o?c:a?r-s:r-(r-s),y2:o?a?r-s:0:c,"stroke-width":"1",stroke:"black"});return d.setAttribute("class","e-ruler-tick"),d}createTickLabel(e,t){let i;return t&&(i=jP("text",{class:"e-ruler-tick-label"}),t.appendChild(i)),i}updateSegmentWidth(e){if(100!==this.segmentWidth)return this.segmentWidth;let t,i=1;for(t=100,t=100/Math.pow(2,Math.round(Math.log(e)/Math.log(2)));t>100;)i/=10,t/=10;for(;t<25;)i*=10,t*=10;return t>=25&&t%25!=0&&(t=25*Math.round(t/25)),t*e/i}createMarkerLine(e,t,i){let n;return t&&(n=e.getElementById(t.id+"_marker"),n&&n.parentNode.removeChild(n),n=jP("line",i)),n}drawRulerMarker(e,t,i){let n,s,r,o,a,l,h;const c="Horizontal"===this.orientation,d=e.getElementsByTagName("svg");for(a=0;a<d.length;a++){d[a]&&(n=d[a]);break}if(n){s=this.getRulerSize(),l={id:e.id+"_marker",x1:0,y1:0,x2:c?0:s,y2:c?s:0,stroke:this.markerColor,"stroke-width":1.5,class:"e-d-ruler-marker"},h=this.createMarkerLine(n,e,l),r=this.scale,o=this.offset-this.defStartValue;const a=(c?t.x:t.y)*r+i+o;h.setAttribute("transform","translate("+(c?a+.5+" 0.5":"0.5 "+(a+.5))+")"),n.appendChild(h)}}getRulerGeometry(){return new nb(this.element?this.element.getBoundingClientRect().width:0,this.element?this.element.getBoundingClientRect().height:0)}getRulerSize(){return this.thickness}getRulerSVG(e){let t;const i=this.getRulerSize();let n;if(this.element&&(t=document.getElementById(this.element.id+"_ruler_space"),t)){if(n=jP("svg",{id:this.element.id+"_Ruler_svg",width:"Horizontal"===this.orientation?e.width+200:i+"px",height:"Horizontal"===this.orientation?i:e.height+200+"px",style:"position:inherit;"}),t.childNodes.length>0)for(let e=t.childNodes.length-1;e>=0;e--)t.childNodes[e].parentNode.removeChild(t.childNodes[e]);t.appendChild(n)}return n}wireEvents(){}unWireEvents(){}}return Yw([ig(5)],e.prototype,"interval",void 0),Yw([ig(100)],e.prototype,"segmentWidth",void 0),Yw([ig("Horizontal")],e.prototype,"orientation",void 0),Yw([ig("RightOrBottom")],e.prototype,"tickAlignment",void 0),Yw([ig("red")],e.prototype,"markerColor",void 0),Yw([ig(25)],e.prototype,"thickness",void 0),Yw([ig(null)],e.prototype,"arrangeTick",void 0),Yw([ig(400)],e.prototype,"length",void 0),e})();function Gw(e,t){let i=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler"));const n=$w(e),s=Qw(e);i||(i=kP("div",{id:e.element.id+(t?"_hRuler":"_vRuler"),style:"height:"+(t?n.height:s.height+100)+"px;overflow:hidden;width:"+(t?s.width+100:n.width)+"px;position:absolute;font-size:11px;"+(t?"margin-left:"+n.width+"px;":"margin-top:"+n.height+"px;")})),e.element.insertBefore(i,e.element.firstChild);const r=t?e.rulerSettings.horizontalRuler:e.rulerSettings.verticalRuler,o=new Xw(r);o.orientation=t?"Horizontal":"Vertical",o.length=(t?s.width:s.height)+r.segmentWidth,o.appendTo("#"+e.element.id+(t?"_hRuler":"_vRuler")),t?e.hRuler=o:e.vRuler=o;const a=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler"));t?e.hRuler.element=a:e.vRuler.element=a}function qw(e){const t=-e.scroller.horizontalOffset,i=-e.scroller.verticalOffset;e&&e.rulerSettings.showRulers?(e.hRuler.length=0,e.vRuler.length=0,void 0!==t&&e.hRuler.element&&Jw(e,e.hRuler,t,!0),void 0!==i&&e.vRuler.element&&Jw(e,e.vRuler,i,!1)):Zw(e)}function Zw(e){NP(e.element.id+"_hRuler"),NP(e.element.id+"_vRuler"),NP(e.element.id+"_overlapRuler")}function $w(e){let t=0,i=0;return e.rulerSettings.showRulers&&(t=e.rulerSettings.horizontalRuler.thickness,i=e.rulerSettings.verticalRuler.thickness),new nb(i,t)}function Qw(e){const t=$w(e);let i=e.scroller.viewPortHeight,n=e.scroller.viewPortWidth;return n<e.element.clientWidth-t.width&&(n=e.element.clientWidth-t.width),i<e.element.clientHeight-t.height&&(i=e.element.clientHeight-t.height),e.hRuler&&e.hRuler.length&&(n=e.hRuler.length),e.vRuler&&e.vRuler.length&&(i=e.vRuler.length),new nb(n,i)}function Jw(e,t,i,n){const s=$w(e),r=Qw(e),o=n?e.rulerSettings.horizontalRuler:e.rulerSettings.verticalRuler;!function(e,t,i){let n=document.getElementById(e.element.id+(i?"_hRuler":"_vRuler"));const s=i?e.hRuler:e.vRuler;n&&e&&t&&(n.style.width=(i?t.width+s.segmentWidth:s.thickness)+"px",n.style.height=(i?s.thickness:t.height+s.segmentWidth)+"px",n=document.getElementById(e.element.id+"_overlapRuler"),n&&(i?n.style.height=s.thickness+"px":n.style.width=s.thickness+"px"))}(e,r,n),function(e,t,i){const n=document.getElementById(e.element.id+(i?"_hRuler_ruler_space":"_vRuler_ruler_space")),s=i?e.hRuler:e.vRuler;n&&e&&t&&(n.style.width=(i?t.width+2*s.segmentWidth:s.thickness)+"px",n.style.height=(i?s.thickness:t.height+2*s.segmentWidth)+"px")}(e,r,n),t.offset=i,t.scale=e.scroller.currentZoom,t.length=(n?r.width:r.height)+100,t.arrangeTick=hO(o.arrangeTick),t.dataBind();const a=n?e.hRuler.element:e.vRuler.element;n?a.style.marginLeft=s.width-t.hRulerOffset+"px":a.style.marginTop=s.height-t.vRulerOffset+"px"}function Kw(e){if(e){let t=0;return t=e instanceof wv||e instanceof xv?e.constraints&Fb.Select:e instanceof Vw?e.constraints&Ub.Select:e.constraints&Vb.Select,t}return 1}function ex(e){if(e){let t=0;return t=e instanceof wv||e instanceof xv?e.constraints&Fb.Drag:e instanceof Vw?e.constraints&Ub.Drag:e instanceof bP?1:e.constraints&Vb.Drag,t}return 1}function tx(e,t){let i=0;return i=e instanceof Vw?e.constraints&Ub.PointerEvents:e.constraints&Vb.PointerEvents,i}function ix(e){let t=0;return t=e instanceof Vw?e.constraints&Ub.Delete:e.constraints&Vb.Delete,t}function nx(e){return e.constraints&Ub.DragSourceEnd}function sx(e){return e.constraints&Ub.DragTargetEnd}function rx(e){return e.constraints&Ub.DragSegmentThumb}function ox(e){return e instanceof wv||e instanceof xv?e.constraints&Fb.Rotate:e.constraints&Vb.Rotate}function ax(e){return e.constraints&Vb.Shadow}function lx(e){return e instanceof pP&&e.constraints&Vb.InConnect?e.constraints&Vb.InConnect:0}function hx(e){return e&&e.constraints&&!(e.constraints&sv.None)&&e.constraints&sv.InConnect?e.constraints&sv.InConnect:0}function cx(e){return e instanceof pP&&e.constraints&Vb.OutConnect?e.constraints&Vb.OutConnect:0}function dx(e){return e&&e.constraints&&!(e.constraints&sv.None)&&e.constraints&sv.OutConnect?e.constraints&sv.OutConnect:0}function px(e,t){let i=0;return e instanceof wv||e instanceof xv?i=e.constraints&Fb.Resize:e&&("SouthEast"===t?i=e.constraints&Vb.ResizeSouthEast:"East"===t?i=e.constraints&Vb.ResizeEast:"NorthEast"===t?i=e.constraints&Vb.ResizeNorthEast:"South"===t?i=e.constraints&Vb.ResizeSouth:"North"===t?i=e.constraints&Vb.ResizeNorth:"SouthWest"===t?i=e.constraints&Vb.ResizeSouthWest:"West"===t?i=e.constraints&Vb.ResizeWest:"NorthWest"===t&&(i=e.constraints&Vb.ResizeNorthWest)),i}function ux(e){let t=0;return t=e instanceof Vw?e.constraints&Ub.AllowDrop:e.constraints&Vb.AllowDrop,t}function gx(e){return e.constraints&Gb.Virtualization}function mx(e){return e.tool&qb.SingleSelect}function fx(e){return e.tool&qb.MultipleSelect}function yx(e){return e.tool&qb.ZoomPan}function bx(e){return e.tool&qb.ContinuousDraw}function vx(e){return e.tool&qb.DrawOnce}function wx(e){return e.tool&qb.SingleSelect||e.tool&qb.MultipleSelect}function xx(e){return e.constraints&Gb.UserInteraction}function Sx(e){return e.constraints&Gb.ZoomTextEdit}function Cx(e){return function(e){return e.constraints&Gb.ApiUpdate}(e)||e.diagramActions&Jb.ToolAction}function Px(e,t){return e.constraints&sv.Draw}function Ox(e,t){return e.constraints&sv.Drag}function Tx(e){return!(e&Kb.DrawSelectorBorder)}function Ex(e){return!!(e&Kb.PreventRenderSelector)}var Ax=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let Ix=(()=>{class e extends bg{getClassName(){return"UserHandle"}}return Ax([ig("")],e.prototype,"name",void 0),Ax([ig("")],e.prototype,"pathData",void 0),Ax([ig("")],e.prototype,"content",void 0),Ax([ig("")],e.prototype,"source",void 0),Ax([ig("#000000")],e.prototype,"backgroundColor",void 0),Ax([ig("Top")],e.prototype,"side",void 0),Ax([ig("")],e.prototype,"borderColor",void 0),Ax([ig(.5)],e.prototype,"borderWidth",void 0),Ax([ig(25)],e.prototype,"size",void 0),Ax([ig("white")],e.prototype,"pathColor",void 0),Ax([ig(10)],e.prototype,"displacement",void 0),Ax([ig(!0)],e.prototype,"visible",void 0),Ax([ig(0)],e.prototype,"offset",void 0),Ax([ng({},Ib)],e.prototype,"margin",void 0),Ax([ig("Center")],e.prototype,"horizontalAlignment",void 0),Ax([ig("Center")],e.prototype,"verticalAlignment",void 0),Ax([ig(!1)],e.prototype,"disableNodes",void 0),Ax([ig(!1)],e.prototype,"disableConnectors",void 0),Ax([ig("")],e.prototype,"template",void 0),e})();function Dx(e){return Mx[e.toString()]}let Mx={Action:"M 90 82.895 C 90 86.819 86.776 90 82.8 90 H 7.2 C 3.224 90 0 86.819 0 82.895 V 7.105 C 0 3.181 3.224 0 7.2 0 h 75.6 C 86.776 0 90 3.181 90 7.105 V 82.895 Z",Decision:"M10,19.707L0.293,10L10,0.293L19.707,10L10,19.707z",MergeNode:"M10,19.707L0.293,10L10,0.293L19.707,10L10,19.707z",InitialNode:"M10,19.5c-5.238,0-9.5-4.262-9.5-9.5S4.762,0.5,10,0.5s9.5,4.262,9.5,9.5S15.238,19.5,10,19.5z",ForkNode:"m0.75,0.75l636.00002,0l0,290l-636.00002,0l0,-290z",JoinNode:"m0.75,0.75l636.00002,0l0,290l-636.00002,0l0,-290z",TimeEvent:"M50.001,0.00286865 L25.001,25.0029 L0.000976562,0.00286865 L50.001,0.00286865 z M0.000976562,50.0029 L25.001,25.0029 L50.001,50.0029 L0.000976562,50.0029 z",AcceptingEvent:"M17.8336 32.164 L29.64 24 L17.32 16 L48.1664 16 L48.5 32 Z",SendSignal:"M48.164 31.8336 L56 23.832 L47.836 16 L16.168 16 L16.1668 31.8336 Z",ReceiveSignal:"M48.1664 31.8336 L39.836 24 L47.836 16 L16.168 16 L16.168 31.836 Z",StructuredNode:"M0,0 L50,0 L50,50 L0,50 z",Note:"M20 12 L4 12 L4 22 L22 22 L22 14 L20 14 L20 12 L22 14 Z"};var Rx=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let zx=(()=>{class e extends bg{}return Rx([ig()],e.prototype,"key",void 0),Rx([ig()],e.prototype,"keyModifiers",void 0),e})(),Lx=(()=>{class e extends bg{getClassName(){return"Command"}}return Rx([ig("")],e.prototype,"name",void 0),Rx([ig()],e.prototype,"canExecute",void 0),Rx([ig()],e.prototype,"execute",void 0),Rx([ng({},zx)],e.prototype,"gesture",void 0),Rx([ig("")],e.prototype,"parameter",void 0),e})(),kx=(()=>{class e extends bg{}return Rx([rg([],Lx)],e.prototype,"commands",void 0),e})(),jx=(()=>{class e extends bg{}return Rx([ig()],e.prototype,"show",void 0),Rx([ig()],e.prototype,"showCustomMenuOnly",void 0),Rx([ig()],e.prototype,"items",void 0),e})();class Hx extends ov{constructor(){super(...arguments),this.childTable=[],this.cellStyle={},this.desiredRowHeight=[],this.desiredCellWidth=[]}rowDefinitions(){return this.rowDefns}columnDefinitions(){return this.colDefns}addObject(e,t,i,n,s){if(this.rows.length>=t){const r=this.rows[t];if(r.cells.length>i){s=s||1,n=n||1;const o=r.cells[i];o.columnSpan=Math.max(s,o.columnSpan),o.rowSpan=Math.max(n,o.rowSpan);let a=new Ux;a=e,a.rowId=t,a.columnId=i,a.columnSpan=s,this.childTable[a.id]=a,this.addObjectToCell(a,o)}}}addObjectToCell(e,t){t.children||(t.children=[]),e.style.strokeColor="black",e.style.strokeWidth=1,e.style.fill="white",t.children.push(e)}updateProperties(e,t,i,n){this.offsetX=e,this.offsetY=t,this.width=i,this.height=n}setDefinitions(e,t){this.rowDefns=e,this.colDefns=t,this.children=[],this.rows=this.rows||[];for(let i=0;i<e.length;i++){const t=e[i],n=new Bx;n.cells=[];const s=new Nx;s.width=this.width;let r=this.colDefns;(void 0===r||r.length<1)&&(r=[s]),this.addCellInRow(r,t,n),this.rows.push(n)}}addCellInRow(e,t,i){for(let n=0;n<e.length;n++){const s=e[n],r=new Wx;r.children=[],this.cellStyle.fill="none",this.cellStyle.strokeColor="none",r.id=XP(),r.style=this.cellStyle,r.desiredCellWidth=r.minWidth=s.width,r.desiredCellHeight=r.minHeight=t.height,i.cells.push(r),this.children.push(r)}}calculateSize(){const e=this.rows||[];let t=0,i=0;for(let n=0;n<e.length;n++){const s=this.rows[n];i=0;for(let r=0;r<s.cells.length;r++)if(i+=s.cells[r].desiredCellWidth,r===s.cells.length-1&&(this.width&&this.width!==i&&(s.cells[r].desiredCellWidth+=this.width-i,s.cells[r].minWidth=s.cells[r].desiredCellWidth,s.cells[r].children&&s.cells[r].children.length&&(s.cells[r].children[0].width=s.cells[r].desiredCellWidth),this.colDefns[r].width=s.cells[r].desiredCellWidth),t+=s.cells[r].desiredCellHeight,n===e.length-1&&this.height&&this.height!==t)){const e=this.height-t;if(e>0){for(let t=0;t<s.cells.length;t++)s.cells[t].desiredCellHeight+=e,s.cells[t].minHeight=s.cells[t].desiredCellHeight=s.cells[t].desiredCellHeight,s.cells[t].children&&s.cells[t].children.length&&(s.cells[t].children[0].height=s.cells[t].desiredCellHeight);this.rowDefns[n].height+=e}}}}updateRowHeight(e,t,i,n){const s=this.rows[e];this.rowDefns[e].height=t,void 0!==this.height&&(this.height+=t-s.cells[0].desiredCellHeight);for(let r=0;r<s.cells.length;r++)s.cells[r].desiredCellHeight=s.cells[r].minHeight=t,s.cells[r].children&&s.cells[r].children.length&&(s.cells[r].children[0].height=t,this.setTextRefresh(s.cells[r].children[0]));if(this.desiredRowHeight[e]=t,this.measure(new nb(this.width,this.height)),this.arrange(this.desiredSize),i){const i=void 0!==n?this.calculateCellHeightBasedOnChildren(e,n):this.calculateCellHeight(e);i>t&&this.updateRowHeight(e,i,!1)}}setTextRefresh(e){if(e.children&&e.children.length){const t=e.children;for(let e=0;e<t.length;e++)t[e]instanceof av&&t[e].refreshTextElement(),t[e]instanceof lv&&this.setTextRefresh(t[e])}}updateColumnWidth(e,t,i,n){this.colDefns[e].width=t,void 0!==this.width&&(this.width+=t-this.rows[this.rows.length-1].cells[e].desiredCellWidth);for(let s=0;s<this.rows.length;s++)this.setTextRefresh(this.rows[s].cells[0]),this.rows[s].cells[e].desiredCellWidth=this.rows[s].cells[e].minWidth=t,this.rows[s].cells[e].children&&this.rows[s].cells[e].children.length&&(this.rows[s].cells[e].children[0].width=t);if(this.desiredCellWidth[e]=t,this.measure(new nb(this.width,this.height)),this.arrange(this.desiredSize),i){const i=void 0!==n?this.calculateCellWidthBasedOnChildren(e,n):this.calculateCellWidth(e);i>t&&this.updateColumnWidth(e,i,!1)}}calculateCellWidth(e){let t,i,n;for(let s=0;s<this.rows.length;s++)n=this.rows[s].cells[e],1===n.columnSpan&&(i=n.outerBounds.width>n.bounds.width&&(0===n.children.length||void 0===n.children[0].maxWidth)?n.outerBounds.width:n.bounds.width,t=t?t<i?i:t:i);return t}calculateCellHeight(e){let t,i,n;const s=this.rows[e];for(let r=0;r<s.cells.length;r++)n=s.cells[r],i=n.outerBounds.height>n.bounds.height?n.outerBounds.height:n.bounds.height,t=t?t<i?i:t:i;return t}calculateCellSizeBasedOnChildren(e,t,i,n){let s;const r=e&&e.children.length>0?e.children[0]:void 0;if(r&&1===e.columnSpan){s="Width"===t?r.bounds.right:r.bounds.bottom,n||(n="Width"===t?r.bounds.width:r.bounds.height);for(let e=0;e<r.children.length;e++){const o=r.children[e];if(o instanceof lv&&-1===o.id.indexOf("header")){const e=("Width"===t?o.bounds.right:o.bounds.bottom)+i;if(e>s){const i=e-s+("Width"===t?r.bounds.width:r.bounds.height);n&&(n=n<i?i:n)}}}}return n}calculateCellWidthBasedOnChildren(e,t){let i,n;for(let s=0;s<this.rows.length;s++)n=this.rows[s].cells[e],i=this.calculateCellSizeBasedOnChildren(n,"Width",t,i);return i}calculateCellHeightBasedOnChildren(e,t){let i,n;const s=this.rows[e];for(let r=0;r<s.cells.length;r++)n=s.cells[r],i=this.calculateCellSizeBasedOnChildren(n,"Height",t,i);return i}addRow(e,t,i){this.rowDefns.length>0?this.rowDefns.splice(e,0,t):this.rowDefns.push(t);const n=new Bx;n.cells=[],(new Nx).width=this.width,this.addCellInRow(this.colDefns,t,n),e>this.rows.length-1?this.rows.push(n):this.rows.splice(e,0,n),i&&(this.measure(new nb(this.width,this.height)),this.arrange(this.desiredSize))}addColumn(e,t,i){let n,s,r,o;const a=this.rows;this.colDefns.length>0?this.colDefns.splice(e,0,t):this.colDefns.push(t),void 0!==this.width&&(this.width+=t.width);for(let l=0;l<a.length;l++)n=a[l],s=this.rowDefns[l],r=t,o=new Wx,o.style=this.cellStyle,o.desiredCellWidth=o.minWidth=r.width,o.desiredCellHeight=o.minHeight=s.height,o.children=[],e>n.cells.length-1?n.cells.push(o):n.cells.splice(e,0,o),this.children.push(o);i&&(this.measure(new nb(this.width,this.height)),this.arrange(this.desiredSize))}removeRow(e){let t,i;const n=this.rows[e];this.height-=this.rowDefns[e].height;for(let s=0;s<n.cells.length;s++)t=n.cells[s],this.children.splice(this.children.indexOf(t),1),i=document.getElementById(t.id+"_groupElement"),i&&i.parentElement&&i.parentElement.removeChild(i);this.rows.splice(e,1),this.rowDefns.splice(e,1),this.measure(new nb(this.width,this.height)),this.arrange(this.desiredSize)}removeColumn(e){let t,i;const n=this.rows;this.width-=this.colDefns[e].width;for(let s=0;s<n.length;s++)t=n[s].cells[e],this.children.splice(this.children.indexOf(t),1),i=document.getElementById(t.id+"_groupElement"),i&&i.parentElement&&i.parentElement.removeChild(i),n[s].cells.splice(e,1);this.colDefns.splice(e,1),this.measure(new nb(this.width,this.height)),this.arrange(this.desiredSize)}updateRowIndex(e,t){const i=this.rows[e];this.rows.splice(e,1),this.rows.splice(t,0,i);const n=this.rowDefns[e];this.rowDefns.splice(e,1),this.rowDefns.splice(t,0,n),this.measure(new nb(this.width,this.height)),this.arrange(this.desiredSize)}updateColumnIndex(e,t,i){let n,s;for(let a=e;a<this.rows.length;a++)n=this.rows[a],s=this.rows[a].cells[t],n.cells.splice(t,1),n.cells.splice(i,0,s);const r=this.colDefns[t];this.colDefns.splice(t,1),this.colDefns.splice(i,0,r);const o=this.desiredCellWidth[t];this.desiredCellWidth.splice(t,1),this.desiredCellWidth.splice(i,0,o),this.measure(new nb(this.width,this.height)),this.arrange(this.desiredSize)}measure(e){let t;if(void 0!==this.rows&&this.rows.length>0){let e=0,i=0;t=new nb(0,0),this.calculateSize();for(const s of this.rows){i=0;for(const n of s.cells){const s=n.measure(new nb(n.desiredCellWidth,n.desiredCellHeight));1===n.rowSpan&&(this.desiredRowHeight[e]=0===i||void 0===this.desiredRowHeight[e]?s.height:Math.max(s.height,this.desiredRowHeight[e])),1===n.columnSpan&&(this.desiredCellWidth[i]=0===e||void 0===this.desiredCellWidth[i]?s.width:Math.max(s.width,this.desiredCellWidth[i]),e===this.rows.length-1&&(t.width+=this.desiredCellWidth[i])),i++}t.height+=this.desiredRowHeight[e],e++}e=i=0;let n=0;for(const t of this.rows){i=0;let s=0;for(const r of t.cells){if(1!==r.columnSpan){r.desiredSize.width=0;for(let e=0;e<r.columnSpan;e++)e+i<t.cells.length&&(r.desiredSize.width+=this.desiredCellWidth[e+i],r.minWidth=r.desiredSize.width,r.measure(r.desiredSize));i++}else r.desiredSize.width=this.desiredCellWidth[s],r.measure(r.desiredSize);if(1!==r.rowSpan){r.desiredSize.height=0;for(let e=0;e<r.rowSpan;e++)e+n<this.rows.length&&(r.desiredSize.height+=this.desiredRowHeight[e+n],r.minHeight=r.desiredSize.height,r.measure(r.desiredSize))}else r.desiredSize.height=this.desiredRowHeight[n],r.measure(r.desiredSize);e++,s++}n++}}return void 0===t&&(t=super.validateDesiredSize(t,e)),super.stretchChildren(t),this.desiredSize=t,t}arrange(e,t){let i=0,n=0;if(void 0!==this.rows&&this.rows.length>0){const s=this.offsetX-e.width*this.pivot.x;let r=this.offsetY-e.height*this.pivot.y,o=s;for(const e of this.rows){o=s,i=0;for(const t of e.cells){const e=Math.max(this.desiredCellWidth[i],t.desiredSize.width),s=Math.max(this.desiredRowHeight[n],t.desiredSize.height);t.offsetX=o+e*t.pivot.x,t.offsetY=r+s*t.pivot.y,o+=this.desiredCellWidth[i],t.arrange(new nb(e,s)),i++}r+=this.desiredRowHeight[n],n++}if(t){let e,t,s,r,o;for(n=0;n<this.rows.length;n++)for(t=this.rows[n],i=0;i<t.cells.length;i++)if(e=t.cells[i],e.columnSpan>1&&this.children.splice(this.children.indexOf(e)+1,e.columnSpan-1),e.rowSpan>1)for(s=n,r=0;s+e.rowSpan-1<this.rows.length&&r<e.rowSpan-1;s++,r++)o=this.rows[s+1].cells[i],this.children.splice(this.children.indexOf(o),1)}}return this.actualSize=e,this.updateBounds(),e}}class _x{constructor(){this.height=void 0}}class Nx{constructor(){this.width=void 0}}class Bx{constructor(){this.cells=null}}class Wx extends lv{constructor(){super(...arguments),this.columnSpan=1,this.rowSpan=1}}class Ux extends rv{constructor(){super(...arguments),this.rowId=0,this.columnId=0,this.rowSpan=1,this.columnSpan=1}}function Fx(e,t,i,n){let s;if(Yx(e,t,!0)){const r=e.isProtectedOnChange;e.protectPropertyChange(!0),s=e.nameTable[t.parentId];const o=s.wrapper;if(s&&"Canvas"===s.container.type&&!(n||o.bounds.x<=i.x&&o.bounds.right>=i.x&&o.bounds.y<=i.y&&o.bounds.bottom>=i.y||t.constraints&Vb.AllowMovingOutsideLane)){const i=QP(t);e.clearSelection(),Gx(e,t),t.parentId="";const n={type:"ChildCollectionChanged",category:"Internal",undoObject:i,redoObject:QP(t)};e.addHistoryEntry(n),e.commandHandler.isContainer&&(e.commandHandler.isContainer=!1,e.endGroupAction()),Zx(t,e)}e.protectPropertyChange(r)}}function Vx(e,t){let i,n,s;return e.enableServerDataBinding(!1),e.selectedObject.helperObject?s=e.selectedObject.helperObject:(e.selectedItems.nodes.length>0||e.selectedItems.connectors.length>0)&&(t instanceof bP&&t.nodes.length+t.connectors.length===1?(i=t.nodes.length>0?t.nodes[0]:t.connectors[0],n=e.selectedItems.wrapper.children[0]):(i=t,n=e.selectedItems.wrapper),e.selectedObject.actualObject=i,!e.currentSymbol&&(i.isLane&&IS(i,e)&&Yx(e,i)||!i.isLane&&Yx(e,i)||e.constraints&Gb.LineRouting&&e.selectedItems.nodes.length>0))&&(s=function(e,t){let i;const n={};for(const s of Object.keys(t))n[s]=t[s];return yC(t)===pP&&(i=new pP(e,"nodes",n,!0),i.id=t.id,e.initObject(i)),e.updateDiagramObject(i),i}(e,{id:"helper",rotateAngle:n.rotateAngle,offsetX:n.offsetX,offsetY:n.offsetY,minWidth:n.minWidth,minHeight:n.minHeight,maxWidth:n.maxWidth,maxHeight:n.maxHeight,width:n.actualSize.width,height:n.actualSize.height,style:{strokeDashArray:"2 2",fill:"transparent",strokeColor:"#7D7D7D",strokeWidth:2}}),e.selectedObject.helperObject=s),e.enableServerDataBinding(!0),s}function Yx(e,t,i){const n=i?e.nameTable[t.parentId]:e.nameTable[t.parentId]||t;return!(!n||!n.container)}function Xx(e,t){const i=e.nameTable[t.parentId];"Canvas"===i.container.type&&(t.margin.left=t.offsetX-i.wrapper.bounds.x-t.width/2,t.margin.top=t.offsetY-i.wrapper.bounds.y-t.height/2),e.nodePropertyChange(t,{},{width:t.width,height:t.height,offsetX:t.offsetX,offsetY:t.offsetY,margin:{left:t.margin.left,right:t.margin.right,top:t.margin.top,bottom:t.margin.bottom},rotateAngle:t.rotateAngle}),i.isLane||(i.wrapper.measure(new nb),i.wrapper.arrange(i.wrapper.desiredSize))}function Gx(e,t){if(t.parentId&&""!==t.parentId){const i=e.nameTable[t.parentId];if(i.isLane&&i.parentId){const n=e.nameTable[i.parentId],s=i.id.slice(n.id.length),r=s.substring(0,s.length-1),o=n.shape.lanes;let a;for(let e=0;e<o.length;e++)if(a=o[e],r===a.id)for(let i=0;i<a.children.length;i++)a.children[i].id===t.id&&(a.children.splice(i,1),i--)}e.deleteChild(t)}}function qx(e,t,i,n,s){if(!e.currentSymbol){e.protectPropertyChange(!0);let r=e.nameTable[t.parentId];i=e.getObject(i.id)||i;const o=-1!==e.nodes.indexOf(i)?i.id:i;if("Canvas"!==t.container.type||s){if(r){const n=r.wrapper.bounds,s=t.wrapper.bounds;"Horizontal"===r.shape.orientation?i.margin.left-=s.x-n.x:i.margin.top-=s.y-n.y-e.nameTable[t.parentId+r.shape.lanes[0].id+"_0_header"].wrapper.bounds.height}}else{const e=i.wrapper.offsetY-i.wrapper.actualSize.height/2-(t.wrapper.offsetY-t.wrapper.actualSize.height/2);i.margin.left=i.wrapper.offsetX-i.wrapper.actualSize.width/2-(t.wrapper.offsetX-t.wrapper.actualSize.width/2),i.margin.top=e}const a=e.nameTable[t.id];if(a.children||(a.children=[]),-1===a.children.indexOf(i.id)){Gx(e,i),e.getObject(i.id)&&e.removeElements(i);const t=QP(i);if(e.addChild(a,o),i=e.getObject(i.id),a.isLane&&a.parentId){r=e.nameTable[a.parentId];const t=r.shape.lanes,n=a.id.slice(r.id.length),s=n.substring(0,n.length-1);for(let e=0;e<t.length;e++)a.isLane&&s===t[e].id&&(i.parentObj instanceof wT||(i.parentObj=t[e]),t[e].children.push(i))}if(e.updateDiagramObject(i),Zx(i,e),a.parentId?n||$x(a,r,i,e):e.updateDiagramObject(a),!(e.diagramActions&Jb.UndoRedo)){const n={type:"ChildCollectionChanged",category:"Internal",undoObject:t,redoObject:QP(i),historyAction:s?"AddNodeToLane":void 0};e.addHistoryEntry(n)}}e.protectPropertyChange(!1)}}function Zx(e,t){const i=PP(e.id+"_groupElement",t.element.id),n=PP(e.parentId?e.parentId+"_groupElement":t.element.id+"_diagramLayer",t.element.id);i&&n&&n.appendChild(i)}function $x(e,t,i,n,s){const r=QP(e);let o,a=!1;const l=t.shape.padding,h=e.wrapper.bounds,c=e.wrapper.outerBounds,d=i.wrapper.bounds;if(t&&"SwimLane"===t.shape.type&&(h.right<d.right+l||h.bottom<d.bottom+l)){const i=t.wrapper.children[0],p=i.bounds.x,u=i.bounds.y;let g;if(h.right<d.right+l&&c.x<=h.x&&(g=d.right-h.right,o=!1,i.updateColumnWidth(e.columnIndex,h.width+g,!0,l)),h.bottom<d.bottom+l&&c.y<=h.y&&(g=d.bottom-h.bottom,o=!0,i.updateRowHeight(e.rowIndex,h.height+g,!0,l)),!(n.diagramActions&Jb.UndoRedo)&&(s&&(n.startGroupAction(),a=!0),void 0!==o)){const t={category:"Internal",type:o?"RowHeightChanged":"ColumnWidthChanged",undoObject:r,redoObject:QP(e)};n.addHistoryEntry(t)}t.width=t.wrapper.width=i.width,t.height=t.wrapper.height=i.height,sS(t),"Horizontal"===t.shape.orientation&&uS(t,n,e.wrapper,e.columnIndex),gS(n,t),n.drag(t,p-i.bounds.x,u-i.bounds.y),lS(t,n),aS(t)}return function(e,t,i){const n=e.nameTable[t.parentId];if(n&&n.isLane){const s=e.nameTable[n.parentId],r=s.wrapper.children[0];r.updateColumnWidth(n.columnIndex,r.columnDefinitions()[n.columnIndex].width,!0,i),r.updateRowHeight(n.rowIndex,r.rowDefinitions()[n.rowIndex].height,!0,i);const o=n.wrapper;let a;t.margin.left<i&&(t.margin.left=i),t.margin.top<i&&(t.margin.top=i);for(let t=0;t<o.children.length;t++){const i=o.children[t];if(i instanceof lv){const t=e.nameTable[i.id];if(t.isLane){a=t.wrapper;break}}}a&&("Horizontal"===s.shape.orientation?t.margin.left<i+a.actualSize.width&&(t.margin.left=i+a.actualSize.width):t.margin.top<i+a.actualSize.height&&(t.margin.top=i+a.actualSize.height)),s.wrapper.measure(new nb(s.width,s.height)),s.wrapper.arrange(s.wrapper.desiredSize),t.offsetX=t.wrapper.offsetX,t.offsetY=t.wrapper.offsetY,e.nodePropertyChange(t,{},{margin:{left:t.margin.left,top:t.margin.top}}),r.measure(new nb(r.width,r.height)),r.arrange(r.desiredSize),s.width=s.wrapper.width=s.wrapper.children[0].actualSize.width,s.height=s.wrapper.height=s.wrapper.children[0].actualSize.height}}(n,i,l),n.updateDiagramElementQuad(),a}function Qx(e,t,i,n,s,r){const o=TP(n.element.id);n.diagramRenderer.renderStackHighlighter(e,o,n.scroller.transform,t,i,s,r)}function Jx(e,t,i,n,s,r,o,a){const l=new pP(e,"nodes",n,!0);if(l.parentId=i.id,l.isHeader=!!s,l.isPhase=!!r,l.isLane=!!o,a&&(l[r?"PhaseHeaderParent":"LaneHeaderParent"]=a),l.constraints&=~(Vb.InConnect|Vb.OutConnect),l.constraints|=Vb.HideThumbs,e.initObject(l),e.nodes.push(l),l.wrapper.children.length>0){for(let e=0;e<l.wrapper.children.length;e++){const t=l.wrapper.children[e];t instanceof rv&&(t.isCalculateDesiredSize=!1),t instanceof av&&(t.canConsiderBounds=!1,(!s&&"Vertical"===i.shape.orientation&&r||"Vertical"!==i.shape.orientation&&o)&&(t.isLaneOrientation=!0,t.refreshTextElement()))}l.wrapper.measure(new nb(void 0,void 0)),l.wrapper.arrange(l.wrapper.desiredSize)}return l.wrapper}function Kx(e,t,i,n,s,r){let o,a=0,l=0;const h=i.shape;s?(l=r,a=n,o=e.columnDefinitions()[r].width):a=h.header&&h.hasHeader?r+1:r;const c={annotations:[QP(h.phases[r].header.annotation)],maxWidth:o,id:i.id+h.phases[r].id+"_header",offsetX:i.offsetX,offsetY:i.offsetY,style:h.phases[r].style,rowIndex:a,columnIndex:l,container:{type:"Canvas",orientation:s?"Horizontal":"Vertical"}};c.annotations[0].rotateAngle=s?0:270,Kw(i)||(c.constraints&=~Vb.Select),h.phases[r].header.id=c.id;const d=Jx(t,0,i,c,!1,!0,!1,h.phases[r].id);e.addObject(d,a,l)}function eS(e,t,i,n,s,r){let o,a,l,h,c;const d=i.shape,p=d.phases.length||1;let u=r?n:d.header&&d.hasHeader?1:0;const g=d.phaseSize&&d.phases.length>0?1:0;for(let m=0;m<p;m++){let n=r?m:s+g;l=e.rows[u].cells[n],h={id:i.id+d.lanes[s].id+m,rowIndex:u,columnIndex:n,width:l.minWidth,height:l.minHeight,offsetX:i.offsetX,offsetY:i.offsetY,style:d.lanes[s].style,constraints:Vb.Default|Vb.ReadOnly|Vb.AllowDrop,container:{type:"Canvas",orientation:r?"Horizontal":"Vertical"}},Kw(i)||(h.constraints&=~Vb.Select),a=Jx(t,0,i,h,!1,!1,!0),a.children[0].isCalculateDesiredSize=!1,0===m&&(o={id:i.id+d.lanes[s].id+"_"+m+"_header",style:d.lanes[s].header.style,annotations:[QP(d.lanes[s].header.annotation)],offsetX:i.offsetX,offsetY:i.offsetY,rowIndex:u,columnIndex:n,container:{type:"Canvas",orientation:r?"Horizontal":"Vertical"}},o.annotations[0].rotateAngle=r?270:0,d.lanes[s].header.id=o.id,r?o.width=d.lanes[s].header.width:o.height=d.lanes[s].header.height,Kw(i)||(o.constraints&=~Vb.Select),c=Jx(t,0,i,o,!1,!1,!0,d.lanes[s].id),r&&(c.children[0].elementActions=c.children[0].elementActions|Yb.HorizontalLaneHeader),a.children.push(c)),e.addObject(a,u,n),r||u++,n=r?m:s+1}}function tS(e,t){const i=new _x;i.height=t,e.push(i)}function iS(e){const t=new Nx;return t.width=e,t}function nS(e,t,i,n){const s=[];let r,o,a,l,h,c,d=0;const p=t.rowDefinitions().length;let u;for(let g=0;g<p;g++)for(c=t.rows[g],l=0;l<c.cells.length;l++)if(h=c.cells[l].children[0],h&&h.children&&h.children.length)for(a=1;a<h.children.length;a++)if(r=h.children[a],o=e.getObject(r.id),o&&(o.inEdges.length>0||o.outEdges.length>0))for(u=o.inEdges.concat(o.outEdges),d=0;d<u.length;d++)-1===s.indexOf(u[d])&&s.push(u[d]);return s}function sS(e){const t=e.wrapper;if(t.measure(new nb(e.width,e.height)),t.children[0]instanceof Hx){const e=t.children[0];let i=!1;e.width&&e.width<e.desiredSize.width&&(i=!0,e.width=e.desiredSize.width),e.height&&e.height<e.desiredSize.height&&(i=!0,e.height=e.desiredSize.height),i&&e.measure(new nb(e.width,e.height))}t.arrange(t.desiredSize)}function rS(e,t,i){const n=t.wrapper.children[0];let s,r,o,a,l,h,c,d;for(s=i;s<n.rows.length;s++)for(h=n.rows[s],r=0;r<h.cells.length;r++)if(c=h.cells[r],c.children&&c.children.length>0)for(o=0;o<c.children.length;o++)d=c.children[o],a=e.nameTable[d.id],a.isLane&&d.children.length>1&&(l=e.nameTable[d.children[1].id],l&&l.isLane&&(l.rowIndex=s,l.columnIndex=r)),a.rowIndex=s,a.columnIndex=r}function oS(e,t,i){e.measure(new nb(t.width,t.height)),e.arrange(e.desiredSize);const n=i.getObject(t.parentId);i.addChild(n,t.id)}function aS(e){if("SwimLane"===e.shape.type&&!e.shape.isLane&&!e.shape.isPhase){let t,i,n,s;const r=e.shape.lanes;let o=pS(e);const a=e.wrapper.children[0].rowDefinitions();for(i=0;i<r.length;i++,o++)t=r[i],"Horizontal"===e.shape.orientation?(s=a[o].height,t.height!==s&&(t.height=s)):(n=e.wrapper.children[0].columnDefinitions(),s=n[o].width,t.width!==s&&(t.width=s))}}function lS(e,t){const i=e.shape,n=i.phases;let s,r,o,a;const l=i.header&&i.hasHeader?1:0;let h=e.wrapper.children[0];const c=h.bounds.y+(i.header&&i.hasHeader?i.header.height:0);if("SwimLane"===e.shape.type&&(e=t.getObject(e.id)||e,n.length>0))if(h=e.wrapper.children[0],"Horizontal"===i.orientation)for(o=i.header&&i.hasHeader?h.rows[1]:h.rows[0],s=0;s<n.length;s++)a=o.cells[s].children[0],r=a.bounds.right-h.bounds.x,n[s].offset!==r&&(n[s].offset=r),t.nameTable[a.id].maxWidth=a.maxWidth;else for(s=0;s<n.length;s++)a=h.rows[l+s].cells[0].children[0],r=a.bounds.bottom-c,n[s].offset!==r&&(n[s].offset=r),t.nameTable[a.id].maxWidth=a.maxWidth}function hS(e,t){if(e&&e.length>0){let i;t.lineRoutingModule&&t.constraints&Gb.LineRouting&&t.lineRoutingModule.renderVirtualRegion(t,!0);for(let n=0;n<e.length;n++)i=t.getObject(e[n]),t.lineRoutingModule&&t.constraints&Gb.LineRouting&&"Orthogonal"===i.type?t.lineRoutingModule.refreshConnectorSegments(t,i,!0):t.connectorPropertyChange(i,{},{sourceID:i.sourceID,targetID:i.targetID})}}function cS(e,t,i,n){const s=e.getObject(i.id),r=s.shape;let o=r.header&&r.hasHeader?1:0;const a=r.lanes,l=r.phases,h=n.wrapper.actualSize.width,c=n.wrapper.actualSize.height,d=t.wrapper.actualSize.width,p=t.wrapper.actualSize.height;"SwimLane"===s.shape.type&&("Horizontal"===r.orientation?t.isPhase?l[t.columnIndex].offset+=h-d:(o=r.phaseSize&&r.phases.length>0?o+1:o,a[t.rowIndex-o].height+=c-p):t.isPhase?l[t.rowIndex-o].offset+=c-p:(o=r.phaseSize&&r.phases.length>0?1:0,a[t.columnIndex-o].width+=h-d))}function dS(e,t){let i;const n=e.shape;let s=n.header&&n.hasHeader?1:0;return"Horizontal"===n.orientation?(s+=n.phases.length>0?1:0,i=t.rowIndex-s):i=t.columnIndex-(n.phaseSize&&n.phases.length>0?1:0),i}function pS(e){let t=0;const i=e.shape;return"Horizontal"===i.orientation&&(t=i.header&&i.hasHeader?1:0),i.phases.length>0&&i.phaseSize&&(t+=1),t}function uS(e,t,i,n){const s=e.shape;if(s.phases.length>0){const e=t.nameTable[s.phases[n].header.id];e&&e.maxWidth<i.outerBounds.width&&(e.maxWidth=i.outerBounds.width,e.wrapper.maxWidth=i.outerBounds.width)}}function gS(e,t){if(t.shape.header&&t.shape.hasHeader){const i=e.nameTable[t.wrapper.children[0].rows[0].cells[0].children[0].id];i&&i.isHeader&&i.maxWidth<t.width&&(i.maxWidth=t.width,i.wrapper.maxWidth=t.width)}}function mS(e,t,i,n){let s;const r=e.nameTable[t.id];if("SwimLane"===r.shape.type){e.protectPropertyChange(!0);const t=r.wrapper.children[0],o=t.bounds,a=r.shape;let l,h,c,d,p,u,g,m,f,y,b=!1;const v=new gP(a,"lanes",i,!0);c=a.header&&a.hasHeader?1:0,"Horizontal"===a.orientation&&(b=!0,c=a.phases.length>0?c+1:c);const w=nS(e,t),x=void 0!==n?n:a.lanes.length;if(c+=x,s={element:v,cause:e.diagramActions,state:"Changing",type:"Addition",cancel:!1,laneIndex:x},e.triggerEvent(nv.collectionChange,s),!s.cancel){if(b){const e=new _x;e.height=i.height,t.addRow(c,e,!1),r.height=void 0!==r.height?r.height+i.height:r.height,r.wrapper.height=t.height=r.height}else{const n=new Nx;n.width=i.width,t.addColumn(x+1,n,!1),r.width&&(r.width+=i.width,r.wrapper.width=t.width=r.width),e.diagramActions&Jb.UndoRedo||(t.rows[0].cells[0].columnSpan+=1)}if(e.diagramActions&Jb.UndoRedo||(v.id=""===v.id?XP():v.id),void 0!==n?a.lanes.splice(n,0,v):a.lanes.push(v),s={element:v,cause:e.diagramActions,state:"Changed",type:"Addition",cancel:!1,laneIndex:x},e.triggerEvent(nv.collectionChange,s),eS(t,e,r,c,x,b),l="Horizontal"===a.orientation?e.nameTable[t.rows[c].cells[0].children[0].id]:a.header&&a.hasHeader?e.nameTable[t.rows[1].cells[c].children[0].id]:e.nameTable[t.rows[0].cells[c].children[0].id],e.diagramActions&Jb.UndoRedo||(h={type:"LaneCollectionChanged",changeType:"Insert",undoObject:QP(v),redoObject:QP(l),category:"Internal"},e.addHistoryEntry(h)),rS(e,r,"Horizontal"===a.orientation?c:a.header&&a.hasHeader?1:0),sS(r),gS(e,r),d=i.children,d&&d.length>0)for(p=0;p<d.length;p++)if(f=d[p],y={x:f.wrapper.offsetX,y:f.wrapper.offsetY},"Horizontal"===a.orientation)for(m=t.rows[c].cells[u],u=0;u<t.rows[c].cells.length;u++)fS(e,t.rows[c].cells[u],y,f);else for(g=0;g<t.rows.length;g++)m=t.rows[g].cells[c],fS(e,m,y,f);hS(w,e),e.drag(r,o.x-t.bounds.x,o.y-t.bounds.y)}e.protectPropertyChange(!1)}}function fS(e,t,i,n){if(t.children&&t.children.length>0){const s=t.children[0],r=e.nameTable[s.id];s.bounds.containsPoint(i)&&e.addChild(r,n)}}function yS(e,t,i){if("SwimLane"===t.shape.type){let n,s,r,o,a,l,h;const c=t.wrapper.bounds.x,d=t.wrapper.bounds.y,p=t.shape,u=p.padding,g=p.phases;let m;const f=t.wrapper.children[0],y="Horizontal"===p.orientation;if(n=p.header&&p.hasHeader?0:-1,p.phases.length>0&&(n+=1),i.offset>(y?p.lanes[0].header.width:p.lanes[0].header.height)){for(h=0;h<g.length;h++)if(r=g[h],o=h>0?g[h-1]:r,r.offset>i.offset){if(m=h>0?i.offset-o.offset:i.offset,y){const t=f.columnDefinitions()[h];t.width-=m,a=e.nameTable[p.phases[h].header.id],a.maxWidth=a.wrapper.maxWidth=t.width,f.updateColumnWidth(h,t.width,!1);const i=new Nx;i.width=m,l=h,f.addColumn(h,i,!1);break}{const t=f.rowDefinitions()[h+n];t.height-=m,a=e.nameTable[p.phases[h].header.id],f.updateRowHeight(h+n,t.height,!1);const i=new _x;i.height=m,l=h,f.addRow(h+n,i,!1);break}}if(e.diagramActions&Jb.UndoRedo&&void 0===l){const i=e.historyManager.currentEntry.next;i.isLastPhase&&(l=g.length,function(e,t,i,n,s,r){const o=t.shape.phases[e-2],a=i.previousPhase.offset;if(s){const t=n.columnDefinitions()[e-1],i=new Nx;e>1?(i.width=t.width-(a-o.offset),t.width=a-o.offset):(i.width=t.width-a,t.width=a),n.updateColumnWidth(e-1,t.width,!1),n.addColumn(e,i,!1)}else{const t=n.rowDefinitions()[e],s=new _x;e>1?(s.height=i.undoObject.offset-a,t.height=a-o.offset):(s.height=t.height-a,t.height=a),n.updateRowHeight(e,t.height,!1),n.addRow(1+e,s,!1)}}(l,t,i,f,y))}const b=new mP(t.shape,"phases",i,!0);if(e.diagramActions&Jb.UndoRedo||(b.id+=XP()),p.phases.splice(l,0,b),Kx(f,e,t,n,y,l),y){if(s=e.nameTable[f.rows[n].cells[l].children[0].id],0===l&&p.header&&p.hasHeader){f.rows[0].cells[0].children=f.rows[0].cells[1].children,f.rows[0].cells[1].children=[];const e=f.rows[0];for(let t=0;t<e.cells.length;t++)e.cells[t].minWidth=void 0,e.cells[t].columnSpan=0===t?f.rows[0].cells.length:1}!function(e,t,i,n,s){const r=t.shape;let o,a,l,h,c;const d=pS(t);for(r.header&&r.hasHeader&&(i.rows[0].cells[0].columnSpan=i.rows[0].cells.length),a=d;a<i.rows.length;a++)c=i.rows[a],l=c.cells[n-1],h=c.cells[n],o=c.cells[n+1],bS(e,t,l,h,o,a,n);rS(e,t,1)}(e,t,f,l);const i=f.columnDefinitions();if(f.updateColumnWidth(l,i[l].width,!0,u),s.maxWidth=s.wrapper.maxWidth=i[l].width,i.length>l+1){const t=e.nameTable[f.rows[n].cells[l+1].children[0].id];f.updateColumnWidth(l+1,i[l+1].width,!0,u),t.maxWidth=t.wrapper.maxWidth=i[l+1].width}t.width=t.wrapper.width=t.wrapper.children[0].width=f.width}else{s=e.nameTable[f.rows[n+l].cells[0].children[0].id];const i=f.rowDefinitions();let r=i[n+l].height;!function(e,t,i,n,s){let r,o,a;const l=i.rows[n],h=i.rows[n+1],c=i.rows[n-1];for(let d=1;d<l.cells.length;d++)o=l.cells[d],a=h?h.cells[d]:void 0,r=c.cells[d],bS(e,t,r,o,a,n,d);rS(e,t,1)}(e,t,f,n+l),f.updateRowHeight(n+l,r,!0,u),i.length>n+l+1&&(r=i[n+l+1].height,f.updateRowHeight(n+l+1,r,!0,u)),t.height=t.wrapper.height=t.wrapper.children[0].height=f.actualSize.height}if(sS(t),t.width=t.wrapper.actualSize.width,gS(e,t),e.drag(t,c-t.wrapper.bounds.x,d-t.wrapper.bounds.y),lS(t,e),!(e.diagramActions&Jb.UndoRedo)){const t={type:"PhaseCollectionChanged",changeType:"Insert",undoObject:QP(b),redoObject:QP(s),category:"Internal"};e.addHistoryEntry(t)}e.updateDiagramObject(t)}}}function bS(e,t,i,n,s,r,o){let a,l;const h=t.shape,c="Horizontal"===h.orientation,d=t.wrapper.children[0];let p;const u=c?r:o;i?(a=c?i.bounds.x+i.bounds.width:i.bounds.x,l=c?i.bounds.y:i.bounds.y+i.bounds.height):(a=d.bounds.x,l=s.bounds.y);const g=new mb(a,l,n.desiredCellWidth,n.desiredCellHeight),m=Jx(e,0,t,{id:t.id+(c?h.lanes[u-2]:h.lanes[u-1]).id+XP()[0],rowIndex:r,columnIndex:o,width:n.minWidth,height:n.minHeight,style:(c?h.lanes[u-2]:h.lanes[u-1]).style,constraints:Vb.Default|Vb.AllowDrop,container:{type:"Canvas",orientation:c?"Horizontal":"Vertical"}},!1,!1,!0);if(m.children[0].isCalculateDesiredSize=!1,d.addObject(m,r,o),s&&s.children&&s.children.length)for(p=0;p<s.children.length;p++)c?e.nameTable[s.children[p].id].columnIndex+=1:e.nameTable[s.children[p].id].rowIndex+=1;!function(e,t,i,n,s,r,o){let a,l,h;const c=e.nameTable[s.id],d=t||o,p=e.nameTable[c.parentId].shape.padding;if(d.children&&d.children[0].children.length>1)for(let u=1;u<d.children[0].children.length;u++)a=d.children[0].children[u],h=e.nameTable[a.id],l=r?{x:a.bounds.x,y:a.bounds.center.y}:{x:a.bounds.center.x,y:a.bounds.top},n.containsPoint(l)?(i.children[0].children.push(a),d.children[0].children.splice(u,1),u--,e.deleteChild(h),h.isLane||(h.parentId=s.id),c.children||(c.children=[]),t||(r?h.margin.left=h.wrapper.bounds.x-d.children[0].bounds.right:h.margin.top=h.wrapper.bounds.y-d.children[0].bounds.bottom),c.children.push(a.id),h.zIndex=c.zIndex+1,e.removeElements(h)):t&&(r?(h.margin.left-=i.desiredCellWidth,p>h.margin.left&&(h.margin.left=p)):(h.margin.top-=i.desiredCellHeight,p>h.margin.top&&(h.margin.top=p)))}(e,s,n,g,m,c,i)}function vS(e,t,i){if("SwimLane"===t.shape.type&&("ResizeSouth"===i||"ResizeEast"===i)){const n=t.shape,s=t.wrapper.children[0];let r,o;"ResizeSouth"===i?"Vertical"===n.orientation?r=s.rows[s.rows.length-1].cells[0]:(o=s.rows.length-1,r=s.rows[o].cells[s.rows[o].cells.length-1]):(o=n.header&&n.hasHeader?1:0,r=s.rows[o].cells[s.rows[o].cells.length-1]),e.commandHandler.select(e.nameTable[r.children[0].id])}}function wS(e,t,i,n,s,r){let o,a,l,h,c;const d=XP();let p,u,g;const m=e.shape,f=m.phases,y=e.offsetX-e.wrapper.actualSize.width/2;let b=e.offsetY-e.wrapper.actualSize.height/2;if("Vertical"===m.orientation&&(b+=m.header&&m.hasHeader?m.header.height:0),!r)for(s||(e.id+=d,m&&m.header&&m.hasHeader?m.header.id+=d:m.header=void 0),o=0;f&&o<f.length;o++)h=f[o],h.id+=d;const v=s?[i.childTable[n.id]]:m.lanes;for(o=0;v&&o<v.length;o++)for(l=v[o],r||(l.id+=d),a=0;l.children&&a<l.children.length;a++)c=l.children[a],u=c.wrapper.offsetX-c.width/2,g=c.wrapper.offsetY-c.height/2,c.zIndex=-1,c.inEdges=c.outEdges=[],(r||i&&(1===i.pasteIndex||0===i.pasteIndex))&&("Vertical"===m.orientation?c.margin.top=g-b:c.margin.left=u-y),r||(c.id+=d);if(!r){if(s&&(p={shape:{lanes:v,phases:f,phaseSize:m.phaseSize,type:"SwimLane",orientation:m.orientation,header:{annotation:{content:"Title"},height:50}}},"Horizontal"===m.orientation?(p.width=e.wrapper.actualSize.width,p.height=n.wrapper.actualSize.height+m.header.height+m.phaseSize,p.offsetX=e.wrapper.offsetX+10*i.pasteIndex,p.offsetY=n.wrapper.offsetY+10*i.pasteIndex):(p.width=n.wrapper.actualSize.width,p.height=e.wrapper.actualSize.height,p.offsetX=n.wrapper.offsetX+10*i.pasteIndex,p.offsetY=e.wrapper.offsetY+10*i.pasteIndex),e=p),0!==i.pasteIndex&&(e.offsetX+=10,e.offsetY+=10),e.zIndex=-1,e=t.add(e),!s)for(const e of Object.keys(i.childTable)){const n=i.childTable[e];n.id+=d,n.sourceID+=d,n.targetID+=d,n.zIndex=-1,t.add(n)}"SVG"!==t.mode&&t.refreshDiagramLayer(),t.select([e])}return e}function xS(e,t,i,n){let s,r=t.nodes[0];if(n||Yx(e,r,!0)){let t,o,a;const l=new rv;i&&(a=e.nameTable[i].parentId,t=r=e.nameTable[i]);const h=i?t.wrapper:r.wrapper,c=e.nameTable[a||r.parentId];c&&"Grid"===c.container.type&&(s=new lv,s.children=[],!n&&r.isHeader||("Horizontal"===c.container.orientation&&r.isPhase||"Vertical"===c.container.orientation&&(r.rowIndex>0&&r.columnIndex>0||r.isLane)?(o=function(e,t,i){const n=new mb,s="SwimLane"===e.shape.type?e.wrapper.children[0].rows:e.wrapper.rows;for(let r=i?1:0;r<s.length;r++)n.uniteRect(s[r].cells[t].bounds);return n}(c,t?t.columnIndex:r.columnIndex,!(!c.shape.header||!c.shape.hasHeader)),s.offsetX=o.center.x,s.offsetY=o.center.y,l.width=o.width,l.height=o.height):(s.offsetX=c.offsetX,s.offsetY=h.offsetY,l.width=c.wrapper.actualSize.width,l.height=h.actualSize.height)),s.children.push(l),s.measure(new nb),s.arrange(s.desiredSize))}return s}function SS(e,t,i,n,s){s=void 0!==s?s:dS(t,i);let r=!1;const o=t.shape.lanes[s];for(let a=o.children.length-1;a>=0;a--)n?n.id===o.children[a].id&&o.children.splice(a,1):(e.removeDependentConnector(o.children[a]),e.diagramActions&Jb.UndoRedo||(e.diagramActions=e.diagramActions|Jb.UndoRedo,r=!0),e.remove(o.children[a]),o.children.splice(a,1),r&&(e.diagramActions=e.diagramActions&~Jb.UndoRedo))}function CS(e){return e.children[0]}function PS(e,t){e.nodes.splice(e.nodes.indexOf(t),1),e.removeFromAQuad(t),e.removeObjectsFromLayer(t),delete e.nameTable[t.id],e.removeElements(t)}function OS(e,t,i,n){let s;if("SwimLane"===i.shape.type){const r=i.shape;let o;if(1===r.lanes.length)e.remove(i);else{const a=i.wrapper.bounds.x,l=i.wrapper.bounds.y;let h,c,d,p,u;const g=i.wrapper.children[0];if(o=n?r.lanes.indexOf(n):dS(i,t),s={element:t,cause:e.diagramActions,state:"Changing",type:"Removal",cancel:!1,laneIndex:o},e.triggerEvent(nv.collectionChange,s),!s.cancel){const n=QP(r.lanes[o]);if(SS(e,i,t,void 0,o),!(e.diagramActions&Jb.UndoRedo)){const i={type:"LaneCollectionChanged",changeType:"Remove",undoObject:n,redoObject:QP(t),category:"Internal"};e.addHistoryEntry(i)}r.lanes.splice(o,1);let m=t?"Horizontal"===r.orientation?t.rowIndex:t.columnIndex:pS(i)+o;if("Horizontal"===r.orientation){for(h=g.rows[m],c=0;c<h.cells.length;c++)if(d=h.cells[c],d&&d.children.length>0)for(p=0;p<d.children.length;p++)u=d.children[p],TS(e,u);g.removeRow(m)}else{for(i.width=void 0!==i.width?i.width-g.rows[0].cells[m].actualSize.width:i.width,c=0;c<g.rows.length;c++)if(d=g.rows[c].cells[m],d&&d.children.length>0)for(p=0;p<d.children.length;p++)u=d.children[p],TS(e,u);g.removeColumn(m)}s={element:t,cause:e.diagramActions,state:"Changed",type:"Removal",cancel:!1,laneIndex:o},e.triggerEvent(nv.collectionChange,s),i.width=i.wrapper.width=g.width,i.height=i.wrapper.height=g.height,sS(i),"Vertical"===i.shape.orientation&&(m=0),rS(e,i,m),e.drag(i,a-i.wrapper.bounds.x,l-i.wrapper.bounds.y),e.updateDiagramObject(i)}}}}function TS(e,t){let i,n;if(t instanceof lv){if(t.children.length>0)for(i=0;i<t.children.length;i++)t.children[i]instanceof lv&&TS(e,t.children[i]);n=e.getObject(t.id),PS(e,n)}}function ES(e,t,i,n){e.protectPropertyChange(!0);let s,r=!1;const o=i.shape,a=i.wrapper.children[0],l=n?o.phases.indexOf(n):function(e,t){const i=t.shape;return"Horizontal"===i.orientation?e.columnIndex:e.rowIndex-(i.header&&i.hasHeader?1:0)}(t,i);if(o.phases.length>1){l===o.phases.length-1&&(r=!0,s=QP(o.phases[l-1]));const n=QP(o.phases[l]);if(o.phases.splice(l,1),!(e.diagramActions&Jb.UndoRedo)){const i={type:"PhaseCollectionChanged",changeType:"Remove",undoObject:n,previousPhase:s,redoObject:QP(t),category:"Internal",isLastPhase:r};e.addHistoryEntry(i)}"Horizontal"===o.orientation?function(e,t,i,n){let s,r,o,a,l,h,c,d,p,u,g,m;for(n=void 0!==n?n:i.columnIndex,c=0;c<t.rows.length;c++)if(s=t.rows[c],s.cells.length>1&&(r=s.cells[n],o=s.cells.length-1===n?s.cells[n-1]:s.cells[n+1],l=o.children[0],r.children.length>0))if(a=r.children[0],g=e.nameTable[a.id],0===o.children.length&&r.children.length>0)o.children=r.children,o.columnSpan=r.columnSpan-1;else{for(d=0;d<a.children.length;d++){if(u=a.children[d],u instanceof lv){if(m=e.nameTable[u.id],m.isLane||(m.parentId=l.id),s.cells.length-1===n&&(m.margin.left=m.wrapper.bounds.x-l.bounds.x,u.margin.left=m.wrapper.bounds.x-l.bounds.x),l.children.push(u),e.nameTable[l.id]){const t=e.nameTable[l.id];t.children||(t.children=[]),t.children.push(u.id)}a.children.splice(d,1),d--,g&&g.children&&-1!==g.children.indexOf(m.id)&&g.children.splice(g.children.indexOf(m.id),1)}if(s.cells.length-1!==n)for(p=0;p<l.children.length;p++){const t=l.children[p];if(t instanceof lv){const i=e.nameTable[t.id];i.margin.left=i.wrapper.bounds.x-a.bounds.x,t.margin.left=i.wrapper.bounds.x-a.bounds.x}}}if(g&&g.isPhase){const t=e.nameTable[l.id];t&&(l.maxWidth=t.wrapper.maxWidth=t.wrapper.maxWidth+=g.wrapper.maxWidth)}PS(e,g)}const f=t.columnDefinitions()[n].width;t.removeColumn(n),n<t.columnDefinitions().length?(h=t.columnDefinitions()[n].width,h+=f,t.updateColumnWidth(n,h,!0)):(h=t.columnDefinitions()[n-1].width,h+=f,t.updateColumnWidth(n-1,h,!0))}(e,a,t,l):function(e,t,i,n,s){let r,o,a,l,h,c,d;const p=s.shape;let u,g;const m=void 0!==n?p.header?n+1:n:i.rowIndex,f=t.rows[m];let y=s.wrapper.bounds.y;const b=p.phases.length;void 0!==p.header&&p.hasHeader&&(y+=t.rowDefinitions()[0].height);const v=n===b?t.rows[m-1]:t.rows[m+1];for(a=0;a<f.cells.length;a++)if(r=f.cells[a],c=v.cells[a],d=c.children[0],r.children.length>0){const t=r.children[0],i=e.nameTable[t.id];if(n<b)for(h=0;h<d.children.length;h++)u=d.children[h],u instanceof lv&&(g=e.nameTable[u.id],g.margin.top=g.wrapper.bounds.y-(0===n?y:t.bounds.y),u.margin.top=g.wrapper.bounds.y-(0===n?y:t.bounds.y));for(l=0;l<t.children.length;l++)u=t.children[l],u instanceof lv&&(g=e.nameTable[u.id],g.parentId=d.id,n===b&&(g.margin.top=g.wrapper.bounds.y-(0===n?y:d.bounds.y),u.margin.top=g.wrapper.bounds.y-(0===n?y:d.bounds.y)),d.children.push(u),t.children.splice(l,1),l--,i.children&&-1!==i.children.indexOf(g.id)&&i.children.splice(i.children.indexOf(g.id),1));PS(e,i)}const w=t.rowDefinitions()[m].height;t.removeRow(m),m<t.rowDefinitions().length?(o=t.rowDefinitions()[m].height,o+=w,t.updateRowHeight(m,o,!0)):(o=t.rowDefinitions()[m-1].height,o+=w,t.updateRowHeight(m-1,o,!0))}(e,a,t,l,i),gS(e,i),rS(e,i,1),lS(i,e),e.protectPropertyChange(!1),e.updateDiagramObject(i)}}function AS(e,t){let i;if(e.isLane){const n=t.getObject(e.parentId);if(n&&"SwimLane"===n.shape.type&&e.isLane){const t=dS(n,e);i=n.shape.lanes[t]}}return i}function IS(e,t){if(e.isLane){const i=AS(e,t);if(t.eventHandler.action.includes("Resize")||i.canMove)return!0}return!1}function DS(e,t){for(let i=0;i<e.length;i++)if(e[i].id===t)return!0;return!1}function MS(e,t){t instanceof pP&&(e.shape.header||(t.shape.hasHeader=!1))}function RS(e,t,i,n){return t?n:void 0!==e[i-1]?e[i-1]+n:0}function zS(e,t){let i=[];if(t)i=e;else{for(let t=0;t<e.length;t++)i.push(e[t]);i.push(e[i.length-2]),i.push(e[i.length-2])}return i}function LS(e,t){if(t instanceof pP)switch(e.shape.shape){case"JoinNode":e.width||(t.width=20),e.height||(t.height=90),e.style&&e.style.fill||(t.style.fill="black");break;case"ForkNode":e.width||(t.width=90),e.height||(t.height=20),e.style&&e.style.fill||(t.style.fill="black");break;case"InitialNode":case"FinalNode":e.style&&e.style.fill||(t.style.fill="black")}else switch(e.shape.flow){case"Object":e.style&&e.style.strokeDashArray||(t.style.strokeDashArray="8 4"),e.style&&e.style.strokeWidth||(t.style.strokeWidth=2),e.targetDecorator&&e.targetDecorator.shape||(t.targetDecorator.shape="OpenArrow");break;case"Control":e.style&&e.style.strokeWidth||(t.style.strokeWidth=2),e.targetDecorator&&e.targetDecorator.shape||(t.targetDecorator.shape="OpenArrow"),e.sourceDecorator&&e.sourceDecorator.shape||(t.sourceDecorator.shape="None")}}function kS(e,t){switch(e.shape.type){case"Bpmn":switch(e.shape.flow){case"Sequence":("Normal"===e.shape.sequence&&"Bezier"!==e.type||"Default"===e.shape.sequence||"Conditional"===e.shape.sequence)&&(t.targetDecorator&&t.targetDecorator.style&&(t.targetDecorator.style.fill=e.targetDecorator&&e.targetDecorator.style&&e.targetDecorator.style.fill||"black"),"Conditional"===e.shape.sequence&&t.sourceDecorator&&(t.sourceDecorator.style&&(t.sourceDecorator.style.fill=e.sourceDecorator&&e.sourceDecorator.style&&e.sourceDecorator.style.fill||"white"),t.sourceDecorator.width=e.sourceDecorator&&e.sourceDecorator.width||20,t.sourceDecorator.height=e.sourceDecorator&&e.sourceDecorator.width||10));break;case"Association":"Default"!==e.shape.association&&"Directional"!==e.shape.association&&"BiDirectional"!==e.shape.association||(t.targetDecorator&&t.targetDecorator.style&&(t.targetDecorator.style.fill=e.targetDecorator&&e.targetDecorator.style&&e.targetDecorator.style.fill||"black"),"BiDirectional"===e.shape.association&&t.sourceDecorator&&t.sourceDecorator.style&&(t.sourceDecorator.style.fill=e.sourceDecorator&&e.sourceDecorator.style&&e.sourceDecorator.style.fill||"white",t.sourceDecorator.width=e.sourceDecorator&&e.sourceDecorator.width||5,t.sourceDecorator.height=e.sourceDecorator&&e.sourceDecorator.height||10));break;case"Message":t.style&&!t.style.strokeDashArray&&(t.style.strokeDashArray=e.style&&e.style.strokeDashArray||"4 4")}break;case"UmlActivity":switch(e.shape.flow){case"Exception":"Directional"!==e.shape.association&&"BiDirectional"!==e.shape.association||(t.style.strokeDashArray=e.style&&e.style.strokeDashArray||"2 2")}break;case"UmlClassifier":let i=!1;"Association"===e.shape.relationship?i=!0:"Inheritance"===e.shape.relationship?(t.targetDecorator&&t.targetDecorator.style&&(t.targetDecorator.style.fill=e.targetDecorator&&e.targetDecorator.style&&e.targetDecorator.style.fill||"white"),t.style&&(i=!0,t.style.strokeDashArray=e.style&&e.style.strokeDashArray||"4 4")):"Composition"===e.shape.relationship?(t.sourceDecorator&&t.sourceDecorator.style&&(t.sourceDecorator.style.fill=e.sourceDecorator&&e.sourceDecorator.style&&e.sourceDecorator.style.fill||"black"),i=!0):"Aggregation"===e.shape.relationship||void 0===e.shape.relationship?(t.sourceDecorator&&t.sourceDecorator.style&&(t.sourceDecorator.style.fill=e.sourceDecorator&&e.sourceDecorator.style&&e.sourceDecorator.style.fill||"white"),i=!0):"Dependency"===e.shape.relationship?(t.sourceDecorator&&t.sourceDecorator.style&&(t.sourceDecorator.style.fill=e.sourceDecorator&&e.sourceDecorator.style&&e.sourceDecorator.style.fill||"white"),i=!0,t.style.strokeDashArray="4 4"):"Realization"===e.shape.relationship&&(t.sourceDecorator&&t.sourceDecorator.style&&(t.sourceDecorator.style.fill=e.sourceDecorator&&e.sourceDecorator.style&&e.sourceDecorator.style.fill||"white"),i=!0),i&&(t.style.strokeWidth=e.style&&e.style.strokeWidth||2)}}function jS(e,t,i){let n;n=rb.findLength(t,e)>rb.findLength(i,e)?i:t;const s=rb.findAngle(t,i),r=rb.findAngle(n,e),o=rb.findLength(n,e),a=r+2*(s-r);return{x:n.x+o*Math.cos(a*Math.PI/180),y:n.y+o*Math.sin(a*Math.PI/180)}}function HS(e,t,i){if(e&&e.children&&e.children.length>0){let n,s=0;for(;s<e.children.length;s++)return n=i[e.children[s]],n.shape.type===t||HS(n,t,i)}return!1}function _S(e,t,i,n,s){if(i&&(e instanceof Vw||e&&(e.shape&&"SwimLane"!==e.shape.type||void 0===e.shape))){let r;for(const o of Object.keys(i))if(r=i[o],"shape"===o&&r.type&&(e.shape={type:r.type}),r)if(Array.isArray(r)&&r.length&&r.length>0&&"annotations"!==s&&"ports"!==s)if(e[o].length>0)for(let n=0;n<=e[o].length;n++)_S(e[o],t?t[o]:void 0,i[o],"annotations"===o||"ports"===o?e:void 0,o);else _S(e[o],t?t[o]:void 0,i[o],"annotations"===o||"ports"===o?e:void 0,o);else if(r instanceof Object&&t&&"annotations"!==s&&"ports"!==s)_S(e[o],t[o],i[o]);else if("annotations"!==s&&"ports"!==s&&t&&!t[o]||!t&&e&&(e[o]||void 0!==e[o]))e[o]=i[o];else{let r;"annotations"!==s&&"ports"!==s||("annotations"===s?(e[o]&&_S(e[o],t[o],i[o]),e[o]||(yC(n)===Vw?(r=new xv(n,"annotations",i[o]),n.annotations.push(r)):(r=new wv(n,"annotations",i[o]),n.annotations.push(r)))):e[o]?_S(e[o],t[o],i[o]):(r=new fv(n,"ports",i[o]),n.ports.push(r)))}}}function NS(e,t){const i="Bezier"===e.type?function(e){const t=[];if("Bezier"===e.type){let i=0;for(let n=0;n<e.segments.length;n++){const s=1.5,r=e.segments[n],o=rb.isEmptyPoint(r.point1)?r.bezierPoint1:r.point1,a=rb.isEmptyPoint(r.point2)?r.bezierPoint2:r.point2,l=Number((e.distance(o,r.points[0])+e.distance(a,o)+e.distance(r.points[1],a))/s);for(let e=0;e<l-1;e+=10)t[i]=Bw(0,r.points[0],rb.isEmptyPoint(r.point1)?r.bezierPoint1:r.point1,rb.isEmptyPoint(r.point2)?r.bezierPoint2:r.point2,r.points[1],e,l),i++}}return t}(e):e.intermediatePoints;for(let n=0;n<i.length-1;n++){const s=i[n],r=i[n+1],o=mb.toBounds([s,r]);if(o.Inflate(e.hitPadding),o.containsPoint(t)){const i=jS(t,s,r),n=BS({x1:s.x,x2:r.x,y1:s.y,y2:r.y},{x1:t.x,x2:i.x,y1:t.y,y2:i.y});if(n.enabled){const i=rb.findLength(t,n.intersectPt);if(Math.abs(i)<e.hitPadding)return!0}else{const e=mb.toBounds([t,t]);if(e.Inflate(3),e.containsPoint(s)||e.containsPoint(r))return!0}if(rb.equals(t,i))return!0}}if(e.annotations.length>0){const i=e.wrapper.children;for(let e=3;e<i.length;e++)if(i[e].bounds.containsPoint(t))return!0}return!1}function BS(e,t){const i={x:0,y:0},n=e,s=(t.y2-t.y1)*(n.x2-n.x1)-(t.x2-t.x1)*(n.y2-n.y1),r=(t.x2-t.x1)*(n.y1-t.y1)-(t.y2-t.y1)*(n.x1-t.x1),o=(n.x2-n.x1)*(n.y1-t.y1)-(n.y2-n.y1)*(n.x1-t.x1);if(0===s||(e.x1===t.x1||e.y1===t.y1)&&(e.x2===t.x2||e.y2===t.y2)&&(0===r||0===o)&&s>0)return{enabled:!1,intersectPt:i};const a=r/s,l=o/s;return a>=0&&a<=1&&l>=0&&l<=1?(i.x=n.x1+a*(n.x2-n.x1),i.y=n.y1+a*(n.y2-n.y1),{enabled:!0,intersectPt:i}):{enabled:!1,intersectPt:i}}function WS(e,t,i,n){const s=BS(US(e.x,e.y,t.x,t.y),US(i.x,i.y,n.x,n.y));return s.enabled?s.intersectPt:{x:0,y:0}}function US(e,t,i,n){return{x1:Number(e)||0,y1:Number(t)||0,x2:Number(i)||0,y2:Number(n)||0}}function FS(e,t,i){const n=[],s={x:t.topRight.x+(i=i||0),y:t.topRight.y},r={x:t.bottomRight.x,y:t.bottomRight.y-i},o={x:t.bottomLeft.x,y:t.bottomLeft.y+i};return n.push({x:t.topLeft.x-i,y:t.topLeft.y}),n.push(s),n.push(r),n.push(o),n}function VS(e,t){const i=new dv;return i.data=e.pathData,i.height=e.height>10?e.height-(e.padding.bottom+e.padding.top):e.height,i.width=e.width>10?e.width-(e.padding.left+e.padding.right):e.width,i.visible=t.visible,i.id=t.id+"_shape",i.inversedAlignment=!1,i.horizontalAlignment="Center",i.verticalAlignment="Center",i.style={fill:e.iconStrokeColor,strokeColor:e.iconStrokeColor,strokeWidth:e.iconStrokeWidth},i.setOffsetWithRespectToBounds(.5,.5,"Fraction"),i.relativeMode="Object",i.description=t.description||"",i}function YS(e,t,i){const n=XS(e,t),s=rb.findAngle(e[n.index],e[n.index+1]),r=function(e){let t;t=e instanceof Cw?0:void 0===e.content?10:0;let i=0;switch(e.alignment){case"Center":i=0;break;case"Before":i=-(0+t);break;case"After":i=0+t}return i}(t),o=rb.transform(n.point,s+45,r);return n.point=o,n.angle=s,n}function XS(e,t){let i,n,s=0,r=t.offset;const o=[];let a,l;for(let c=0;c<e.length-1;c++)s+=rb.distancePoints(e[c],e[c+1]),o.push(s);const h=r*s;for(let c=0;c<o.length;c++){if(o[c]>=h)return n=rb.findAngle(e[c],e[c+1]),i=rb.transform(e[c],n,h-(a||0)),l=c,{point:i,index:l};a=o[c]}return{point:i,index:l}}function GS(e,t){if(e instanceof pP&&e.children)for(let i=0;i<e.children.length;i++)t.nameTable[e.children[i]].children&&GS(e,t),t.removeFromAQuad(t.nameTable[e.children[i]]),t.removeObjectsFromLayer(t.nameTable[e.children[i]]),delete t.nameTable[e.children[i]]}function qS(e,t){if(e&&e.children&&e.children.length>0)for(let i=0;i<e.children.length;i++){const n=e.children[i];n instanceof lv&&qS(n,t)}return-1===t.indexOf(e.id)&&t.push(e.id),t}function ZS(e,t,i,n){i=function(e,t){const i=[];let n;const s=new wT;if(e.getClassName)switch(e.getClassName()){case"Diagram":n=new wT;break;case"Node":n=new pP(s,"",i);break;case"Path":n=new BC(s,"",i);break;case"Native":n=new WC(s,"",i);break;case"Html":n=new UC(s,"",i);break;case"Image":n=new FC(s,"",i);break;case"Text":n=new VC(s,"",i);break;case"BasicShape":n=new YC(s,"",i);break;case"FlowShape":n=new XC(s,"",i);break;case"BpmnShape":n=new iP(s,"",i);break;case"UmlActivityShape":n=new nP(s,"",i);break;case"UmlClassifierShape":n=new dP(s,"",i);break;case"SwimLane":n=new fP(s,"",i),e.header&&(n.header=new uP(s,"",i),n.header.style.fill="");break;case"ShapeAnnotation":n=new wv(s,"",i);break;case"PointPort":n=new fv(s,"",i);break;case"BpmnGateway":n=new GC(s,"",i);break;case"BpmnDataObject":n=new qC(s,"",i);break;case"BpmnEvent":n=new $C(s,"",i);break;case"BpmnSubEvent":n=new QC(s,"",i);break;case"BpmnActivity":n=new eP(s,"",i);break;case"BpmnAnnotation":n=new tP(s,"",i);break;case"MethodArguments":n=new sP(s,"",i);break;case"UmlClassAttribute":n=new rP(s,"",i);break;case"UmlClassMethod":n=new oP(s,"",i);break;case"UmlClass":n=new aP(s,"",i);break;case"UmlInterface":n=new lP(s,"",i);break;case"UmlEnumerationMember":n=new hP(s,"",i);break;case"UmlEnumeration":n=new cP(s,"",i);break;case"Lane":n=new gP(s,"",i);break;case"Phase":n=new mP(s,"",i);break;case"ChildContainer":n=new yP;break;case"Connector":n=new Vw(s,"",i);break;case"StraightSegment":n=new zw(s,"",i);break;case"BezierSegment":n=new Lw(s,"",i);break;case"OrthogonalSegment":n=new kw(s,"",i);break;case"PathAnnotation":n=new xv(s,"",i);break;case"Stop":n=new Mb(s,"",i);break;case"Point":n=t||new rb(s,"",i);break;case"UserHandle":n=new Ix(s,"",i);break;case"Command":n=new Lx(s,"",i)}else n=t;return n}(t,i);let s=[];s=s.concat(Object.keys(e));for(const r of s)t instanceof pP&&(n="shape"===r),e[r]instanceof Array?$S(e,i,t,r):e[r]instanceof Object&&i&&i[r]?"wrapper"!==r&&(e[r]=ZS(e[r],t[r],i[r],n)):(i&&e[r]===i[r]||void 0===e[r])&&(n&&"type"===r||t instanceof fP&&"orientation"===r||delete e[r]),"[]"!==JSON.stringify(e[r])&&"{}"!==JSON.stringify(e[r])&&void 0!==e[r]||delete e[r];return e}function $S(e,t,i,n){if(0===e[n].length)delete e[n];else if(e[n].every(e=>"number"==typeof e)){let i,s=!0;for(i=0;i<e[n].length;i++)s=!(!s||e[n][i]!==t[n][i]);s&&delete e[n]}else{let s;if("layers"===n&&(e[n].splice(0,1),0===e[n].length&&delete e[n]),e[n])for(s=e[n].length-1;s>=0;s--)"nodes"!==n&&"connectors"!==n||(e[n][s].wrapper=null),"dataManager"!==n&&(e[n][s]=ZS(e[n][s],i[n][s],void 0!==t[n]?t[n][s]:[]),"[]"!==JSON.stringify(e[n][s])&&"{}"!==JSON.stringify(e[n][s])&&void 0!==e[n][s]||e[n].splice(s,1))}}function QS(e,t){t.enableServerDataBinding(!1);const i=t.blazorActions;t.blazorActions=t.addConstraints(i,_b.ClearObject),t.clear(),t.blazorActions=t.removeConstraints(i,_b.ClearObject),t.protectPropertyChange(!0);const n=t.dataSourceSettings.doBinding,s=t.setNodeTemplate,r=t.getDescription,o=t.getCustomProperty,a={};for(let f of t.commandManager.commands)a[f.name]={execute:f.execute,canExecute:f.canExecute};const l=t.rulerSettings.horizontalRuler.arrangeTick,h=t.rulerSettings.verticalRuler.arrangeTick,c=t.layout.getLayoutInfo,d=t.layout.getBranch,p=t.getNodeDefaults,u=t.getConnectorDefaults;let g,m=JSON.parse(e);m=function(e){if(e&&(void 0===e.version||e.version<17.1)&&e.nodes){const t=e.nodes;for(const e of t)if(e&&e.ports&&e.ports.length>0)for(const t of e.ports)t&&t.constraints&&t.constraints===sv.None&&(t.constraints=sv.Default)}return e}(m),t.contextMenuSettings=m.contextMenuSettings||{},t.constraints=m.constraints||Gb.Default,t.tool=m.tool||qb.Default,t.bridgeDirection=m.bridgeDirection||"Top",t.pageSettings=m.pageSettings||{},t.drawingObject=m.drawingObject||void 0,t.tooltip=m.tooltip||{},t.addInfo=m.addInfo||void 0,t.getDescription=r,t.scrollSettings=m.scrollSettings||{},t.commandManager=m.commandManager||{},t.layers=m.layers||[],t.rulerSettings.horizontalRuler.arrangeTick=l,t.rulerSettings.verticalRuler.arrangeTick=h;for(const f of t.commandManager.commands)a[f.name]&&(f.execute=a[f.name].execute,f.canExecute=a[f.name].canExecute);if(t.backgroundColor=m.backgroundColor||"transparent",t.basicElements=m.basicElements||[],t.connectors=m.connectors||[],t.dataSourceSettings=m.dataSourceSettings||{},t.dataSourceSettings.doBinding=n,t.height=m.height||"100%",t.setNodeTemplate=s,t.getConnectorDefaults=u,t.getNodeDefaults=p,t.getCustomProperty=o,t.mode=m.mode||"SVG",m.nodes)for(let f=0;f<m.nodes.length;f++)m.nodes[f].shape&&"SwimLane"===m.nodes[f].shape.type&&(null==m.nodes[f].wrapper&&(m.nodes[f].wrapper={actualSize:{width:m.nodes[f].width,height:m.nodes[f].height},offsetX:m.nodes[f].offsetX,offsetY:m.nodes[f].offsetY}),wS(m.nodes[f],void 0,void 0,void 0,void 0,!0));t.nodes=m.nodes||[],t.rulerSettings=m.rulerSettings||{},t.snapSettings=m.snapSettings||{},t.width=m.width||"100%",t.layout=m.layout||{},m.layout&&"None"!==m.layout.type&&(t.canLayout=!1),t.layout.getLayoutInfo=hO(c),t.layout.getBranch=hO(d),t.diagramActions=0,t.isLoading=!0,t.protectPropertyChange(!1);for(let f=0;f<t.views.length;f++)g=t.views[t.views[f]],t.blazorActions=t.addConstraints(i,_b.ClearObject),g.refresh(),t.blazorActions=t.removeConstraints(i,_b.ClearObject),g instanceof wT&&t.element.classList.add("e-diagram");return m.selectedItems&&(m.selectedItems.nodes=[],m.selectedItems.connectors=[]),t.selectedItems=m.selectedItems,t.enableServerDataBinding(!0),t.canLayout=!0,t.swimlaneChildTable={},t.swimlaneZIndexTable={},m}function JS(e,t){const i=t.style,n=t;t.canApplyStyle=!0;for(const s of Object.keys(e))switch(s){case"fill":i.fill=e.fill,i instanceof jb&&(i.fill="transparent");break;case"textOverflow":i.textOverflow=e.textOverflow;break;case"opacity":i.opacity=e.opacity;break;case"strokeColor":i.strokeColor=e.strokeColor;break;case"strokeDashArray":i.strokeDashArray=e.strokeDashArray;break;case"strokeWidth":i.strokeWidth=e.strokeWidth;break;case"bold":i.bold=e.bold;break;case"color":i.color=e.color;break;case"textWrapping":i.textWrapping=e.textWrapping;break;case"fontFamily":i.fontFamily=e.fontFamily;break;case"fontSize":i.fontSize=e.fontSize;break;case"italic":i.italic=e.italic;break;case"textAlign":i.textAlign=e.textAlign;break;case"whiteSpace":i.whiteSpace=e.whiteSpace;break;case"textDecoration":i.textDecoration=e.textDecoration;break;case"gradient":if(i.gradient){KS(e.gradient,i.gradient);break}}t instanceof av&&n.refreshTextElement()}function KS(e,t){for(const i of Object.keys(e))switch(i){case"type":t.type=e.type;break;case"x1":t.x1=e.x1;break;case"x2":t.x2=e.x2;break;case"y1":t.y1=e.y1;break;case"y2":t.y2=e.y2;break;case"cx":t.cx=e.cx;break;case"cy":t.cy=e.cy;break;case"fx":t.fx=e.fx;break;case"fy":t.fy=e.fy;break;case"r":t.r=e.r;break;case"stops":t.stops=e.stops}}function eC(e,t,i){e.width=t.width,e.height=t.height,e.minHeight=t.minHeight,e.maxHeight=t.maxHeight,e.minWidth=t.minWidth,e.maxWidth=t.maxWidth,e.horizontalAlignment=t.wrapper.children[0].horizontalAlignment,e.verticalAlignment=t.wrapper.children[0].verticalAlignment,e.relativeMode=t.wrapper.children[0].relativeMode,e.visible=t.wrapper.children[0].visible,t.shape instanceof VC&&(e.margin=t.shape.margin),e.id=t.wrapper.children[0].id,e.style=t.style;for(const n of i.views)NP(t.id+"_groupElement",n),NP(t.id+"_content_groupElement",n),NP(t.id+"_html_element",n);t.wrapper.children.splice(0,1),t.wrapper.children.splice(0,0,e)}function tC(e){const t=new lv;t.style.fill="transparent";const i="M 25 50 C 11.21 50 0 38.79 0 25 C 0 11.21 11.21 0 25 0 C 38.78 0 50 11.21 50 25 C 50 38.79 38.78 50 25 50",n=new dv;n.data=i,n.id=e.id+"_0_finalNode",n.horizontalAlignment="Center",n.verticalAlignment="Center",n.relativeMode="Object",n.style.strokeColor=e.style.strokeColor,n.style.strokeWidth=e.style.strokeWidth;const s=new dv;return s.data=i,s.id=e.id+"_1_finalNode",s.horizontalAlignment="Center",s.verticalAlignment="Center",s.relativeMode="Object",s.style.fill=e.style.fill,s.style.strokeColor=e.style.strokeColor,s.style.strokeWidth=e.style.strokeWidth,t.children=[n,s],t.children[0].width=e.width,t.children[0].height=e.height,t.children[1].height=e.height/1.5,t.children[1].width=e.width/1.5,t.style.strokeWidth=0,t.style.strokeColor="transparent",t}function iC(e){NP(e+"_linear"),NP(e+"_radial")}function nC(e,t){const i=e.indexOf(t);i>=0&&e.splice(i,1)}function sC(e,t,i){let n;e.intermediatePoints=t,e.updateSegmentElement(e,t,e.wrapper.children[0],i);const s=e.sourceDecorator;if("Bezier"===e.type){const t=e.segments[0],i=e.segments[e.segments.length-1];n=[rb.isEmptyPoint(i.point2)?i.bezierPoint2:i.point2,rb.isEmptyPoint(t.point1)?t.bezierPoint1:t.point1]}else n=e.intermediatePoints;t=e.clipDecorators(e,t,i);let r=e.wrapper.children[0];r.canMeasurePath=!0,r=e.wrapper.children[1],e.updateDecoratorElement(r,t[0],n[1],s),r=e.wrapper.children[2],e.updateDecoratorElement(r,t[t.length-1],n[n.length-2],e.targetDecorator),e.updateShapeElement(e)}function rC(e,t,i){const n=e.wrapper,s=n.bounds,r=t.offset,o=t.size/i.scale,a=t.margin;let l;const h=n.offsetX-n.actualSize.width*n.pivot.x,c=n.offsetY-n.actualSize.height*n.pivot.y;if(l={x:0,y:0},e.nodes.length>0){switch(t.side){case"Top":l.x+=h+s.width*r,l.y+=c-(o/2+12.5);break;case"Bottom":l.x+=h+r*s.width,l.y+=c+n.actualSize.height+(o/2+12.5);break;case"Left":l.x+=h-(o/2+12.5),l.y+=c+r*s.height;break;case"Right":l.x+=h+n.actualSize.width+(o/2+12.5),l.y+=c+r*s.height}l.x+=(a.left-a.right)/i.scale+o/2*("Center"===t.horizontalAlignment?0:"Right"===t.horizontalAlignment?-1:1),l.y+=(a.top-a.bottom)/i.scale+o/2*("Center"===t.verticalAlignment?0:"Top"===t.verticalAlignment?-1:1)}else if(e.connectors.length>0){const i=e.connectors[0],n={offset:r},s=XS(i.intermediatePoints,n),h=s.index;l=s.point;const c=YS(i.intermediatePoints,n).angle;let d=bb();wb(d,-c,i.intermediatePoints[h].x,i.intermediatePoints[h].y),l=vb(d,l),l.x+=a.left-a.right+o/2*("Center"===t.horizontalAlignment?0:"Right"===t.horizontalAlignment?-1:1),l.y+=a.top-a.bottom+o/2*("Center"===t.verticalAlignment?0:"Top"===t.verticalAlignment?-1:1),d=bb(),wb(d,c,i.intermediatePoints[h].x,i.intermediatePoints[h].y),l=vb(d,l)}if(0!==n.rotateAngle||0!==n.parentTransform){const e=bb();wb(e,n.rotateAngle+n.parentTransform,n.offsetX,n.offsetY),l=vb(e,l)}return l}function oC(e,t,i,n){if(n.annotation){if(px(n.annotation))return!0}else if(Wb[t]&e&&Xb[t]&i)return!0;return!1}function aC(e,t){return!!(Wb[t]&e)}function lC(e,t){return e.visibility&t}function hC(e,t){let i;if("Text"===e.shape.type)i=e.shape;else{const n=t.split("_");t=n[n.length-1];for(let s=0;s<e.annotations.length;s++)t===e.annotations[s].id&&(i=e.annotations[s])}return i}function cC(e,t){let i={},n=0;if(e.ports){const s=e.ports;for(n=0;n<s.length;n++)t?s[n].constraints&sv.InConnect&&(i=s[n]):s[n].constraints&sv.OutConnect&&(i=s[n])}return i}function dC(e,t,i){const n=i?e.annotations:e.ports;for(let s=0;s<n.length;s++)if(n[s].id===t)return s.toString();return"-1"}function pC(e,t){let i;for(i=0;i<e.length;i++)if(t===e[i].id)return!0;return!1}function uC(e,t,i,n,s,r){const o=e.children;let a;for(let l=0;l<o.length;l++)if(a=n[o[l]],a)if(a.children)uC(a,t,i,n,s,r);else if(a.offsetX-=t,a.offsetY-=i,!s){n[a.id]=a;const e=a.initContainer();e.children||(e.children=[]);const t=a.init(r);e.children.push(t),e.measure(new nb(a.width,a.height)),e.arrange(e.desiredSize)}}function gC(e,t,i){if(0===i.length)i.push(e);else if(1===i.length)i[0][t]>e[t]?i.splice(0,0,e):i.push(e);else if(i.length>1){let n=0,s=i.length-1,r=Math.floor((n+s)/2);for(;r!==n;)if(i[r][t]<e[t])n=r,r=Math.floor((n+s)/2);else{if(!(i[r][t]>e[t]))break;s=r,r=Math.floor((n+s)/2)}i[s][t]<e[t]?i.push(e):i[n][t]>e[t]?i.splice(n,0,e):i[n][t]<e[t]&&i[s][t]>e[t]&&i.splice(s,0,e)}}function mC(e){const t=document.getElementById(e.diagramId),i="ej2_instances";let n=t[i][0].nodes;void 0===n&&(n=function(e){const t=[];for(let i=0;i<e.palettes.length;i++){const n=e.palettes[i].symbols;for(let e=0;e<n.length;e++)n[e]instanceof pP&&t.push(n[e])}return t}(t[i][0]));for(let o=0;n&&o<n.length;o++)if(n[o].id===e.nodeId)return fC(n[o],e);const s=t[i][0].connectors;for(let o=0;s&&o<s.length;o++)if(s[o].id===e.nodeId)return fC(s[o],e);const r=t[i][0].enterObject;return r&&(r.id===e.nodeId||r.children)?r.children&&HS(r,"HTML",t[i][0].enterTable)?t[i][0].enterTable[e.nodeId]:r:null}function fC(e,t){const i=e.annotations;let n;for(n=0;i&&n<i.length;n++)if(t.annotationId&&i[n].id===t.annotationId)return i[n];return e}let yC=e=>(e&&(e=void 0!==e.sourceID||void 0!==e.sourcePoint||void 0!==e.targetID||void 0!==e.targetPoint||void 0!==e.type?Vw:pP),e),bC=e=>{if(!e.sourceID&&!e.targetID){let t={x:e.sourcePoint.x,y:e.sourcePoint.y},i={x:e.targetPoint.x,y:e.targetPoint.y};"Horizontal"===e.flip?(e.sourcePoint.x=i.x,e.targetPoint.x=t.x):"Vertical"===e.flip?(e.sourcePoint.y=i.y,e.targetPoint.y=t.y):"Both"===e.flip&&(e.sourcePoint=i,e.targetPoint=t)}},vC=(e,t,i)=>{let n=i.offset.x,s=i.offset.y;return"Horizontal"===t?(n=1-i.offset.x,s=i.offset.y):"Vertical"===t?(n=i.offset.x,s=1-i.offset.y):"Both"===t&&(n=1-i.offset.x,s=1-i.offset.y),e.setOffsetWithRespectToBounds(n,s,"Fraction"),e},wC=(e,t,i,n,s)=>{if(e.hasChildren())for(let r of e.children){let e=t-r.offsetX+t,o=i-r.offsetY+i;"Horizontal"!==s&&"Both"!==s||(r.offsetX=e,r.flipOffset.x=e-r.desiredSize.width/2),"Vertical"!==s&&"Both"!==s||(r.offsetY=o,r.flipOffset.y=o-r.desiredSize.height/2),(r instanceof lv||r instanceof ov)&&wC(r,t,i,n,s),r.measure(new nb(r.bounds.width,r.bounds.height)),r.arrange(r.desiredSize);let a=n.nameTable[r.id];a&&n.updateConnectorEdges(a)}},xC=e=>{let t=e.selectedItems.nodes,i=e.selectedItems.connectors,n=e.allowServerDataBinding,s=e.isProtectedOnChange;e.protectPropertyChange(!0),e.allowServerDataBinding=!1,e.selectedItems.nodes=[],e.selectedItems.connectors=[],e.allowServerDataBinding=n,e.protectPropertyChange(s);let r=QP(e.selectedItems);for(let o=0;o<t.length;o++)e.selectedItems.nodes.push(e.nameTable[t[o].id]);for(let o=0;o<i.length;o++)e.selectedItems.connectors.push(e.nameTable[i[o].id]);return r},SC=(e,t)=>{let i,n=new dv;for(let s=0;s<e.length-1;s++)i=PC(e[s],e[s+1]),n.data=i[0],n.id=t.id+"_"+t.shape.sequence,n.offsetX=i[1].x,n.offsetY=i[1].y,n.rotateAngle=45,n.transform=Zb.Self;return n},CC=(e,t)=>{if(e instanceof pP)for(let i=0;i<e.ports.length;i++)if(e.ports[i].id===t.id.split("_")[1])return!0;return!1},PC=(e,t)=>{let i={x:e.x,y:e.y},n=OC(e,t);n=Math.min(30,n/2);let s=Xv(e,t),r=rb.transform({x:i.x,y:i.y},s,n),o=rb.transform({x:r.x,y:r.y},s,-12),a=rb.transform({x:o.x,y:o.y},s,24);return["M"+o.x+" "+o.y+" L"+a.x+" "+a.y,r]},OC=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function TC(){return(navigator.platform.indexOf("Mac")>=0||navigator.platform.indexOf("iPad")>=0||navigator.platform.indexOf("iPhone")>=0||navigator.platform.indexOf("MacIntel")>=0)&&("safari"===wu.info.name||"webkit"===wu.info.name)}function EC(e,t,i,n){let s=0;return s=void 0!==t.previewSize[n]?t.previewSize[n]:void 0!==e.symbolPreview[n]?e.symbolPreview[n]:t[n]||i.actualSize[n],s}function AC(e,t,i){return e&&e.parentId&&(i=(e=t.nameTable[e.parentId]).parentId?AC(e,t,i):e.id),i}function IC(e,t){return e.selectedItems.connectors.length>1&&0===e.selectedItems.nodes.length&&0!==t.rotateAngle}var DC=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let MC=(()=>{class e extends bg{}return DC([ig("None")],e.prototype,"shape",void 0),DC([ig("white")],e.prototype,"fill",void 0),DC([ig("Auto")],e.prototype,"horizontalAlignment",void 0),DC([ig("Auto")],e.prototype,"verticalAlignment",void 0),DC([ig(10)],e.prototype,"width",void 0),DC([ig(10)],e.prototype,"height",void 0),DC([ng({x:.5,y:1},rb)],e.prototype,"offset",void 0),DC([ig("#1a1a1a")],e.prototype,"borderColor",void 0),DC([ig(1)],e.prototype,"borderWidth",void 0),DC([ng({},Ib)],e.prototype,"margin",void 0),DC([ig("")],e.prototype,"pathData",void 0),DC([ig("")],e.prototype,"content",void 0),DC([ig(0)],e.prototype,"cornerRadius",void 0),DC([ng({left:2,right:2,top:2,bottom:2},Ib)],e.prototype,"padding",void 0),e})();class RC extends ov{constructor(){super(...arguments),this.orientation="Vertical",this.measureChildren=void 0,this.considerPadding=!0}measure(e){return this.desiredSize=this.measureStackPanel(e,"Horizontal"===this.orientation?this.updateHorizontalStack:this.updateVerticalStack),this.desiredSize}arrange(e){return this.actualSize=this.arrangeStackPanel(e,"Horizontal"===this.orientation?this.arrangeHorizontalStack:this.arrangeVerticalStack),this.updateBounds(),this.actualSize}measureStackPanel(e,t){let i;if(void 0!==this.children&&this.children.length>0)for(const n of this.children){n.parentTransform=this.rotateAngle+this.parentTransform,n.measure(this.measureChildren?n.desiredSize:e);let s=n.desiredSize.clone();this.applyChildMargin(n,s),0!==n.rotateAngle&&(s=aO(s,n.rotateAngle)),void 0===i?i=s:n.preventContainer||t(s,i)}return i=super.validateDesiredSize(i,e),this.stretchChildren(i),this.considerPadding&&this.applyPadding(i),i}arrangeStackPanel(e,t){if(void 0!==this.children&&this.children.length>0){let i,n;i=this.offsetX-e.width*this.pivot.x+this.padding.left,n=this.offsetY-e.height*this.pivot.y+this.padding.top;for(const s of this.children){const r=s.desiredSize.clone();let o=r;"Vertical"===this.orientation?n+=s.margin.top:i+=s.margin.left,0!==s.rotateAngle&&(o=aO(r,s.rotateAngle));const a=t(i,n,s,this,e,o);super.findChildOffsetFromCenter(s,a),s.arrange(r,!0),"Vertical"===this.orientation?n+=o.height+s.margin.bottom:i+=o.width+s.margin.right}}return e}updateHorizontalStack(e,t){t.height=Math.max(e.height,t.height),t.width+=e.width}updateVerticalStack(e,t){t.width=Math.max(e.width,t.width),t.height+=e.height}arrangeHorizontalStack(e,t,i,n,s,r){let o=0;return"Top"===i.verticalAlignment?o=t+i.margin.top+r.height/2:"Bottom"===i.verticalAlignment?o=n.offsetY+s.height*(1-n.pivot.y)-n.padding.bottom-i.margin.bottom-r.height/2:(o=n.offsetY-s.height*n.pivot.y+s.height/2,i.margin.top&&(o=t+i.margin.top+r.height/2)),{x:e+r.width/2,y:o}}arrangeVerticalStack(e,t,i,n,s,r){let o=0;return"Left"===i.horizontalAlignment?o=e+i.margin.left+r.width/2:"Right"===i.horizontalAlignment?o=n.offsetX+s.width*(1-n.pivot.x)-n.padding.right-i.margin.right-r.width/2:(o=n.offsetX-s.width*n.pivot.x+s.width/2,i.margin.left&&(o=e+i.margin.left+r.width/2)),{x:o,y:t+r.height/2}}stretchChildren(e){if(void 0!==this.children&&this.children.length>0)for(const t of this.children)"Vertical"===this.orientation?"Stretch"===t.horizontalAlignment&&(t.desiredSize.width=e.width-(t.margin.left+t.margin.right)):"Stretch"===t.verticalAlignment&&(t.desiredSize.height=e.height-(t.margin.top+t.margin.bottom))}applyChildMargin(e,t){t.height+=e.margin.top+e.margin.bottom,t.width+=e.margin.left+e.margin.right}}function zC(e,t){const i=new pP(t,"nodes",{id:XP()+"_path",height:1,constraints:Vb.Default&~Vb.Select,verticalAlignment:"Stretch",horizontalAlignment:"Stretch",style:{strokeColor:"black"===e.style.strokeColor?"#ffffff00":e.style.strokeColor}},!0);t.initObject(i),t.nodes.push(i),e.children.push(i.id)}function LC(e,t){const i={},n=t.style;return i.fill="transparent"!==n.fill?n.fill:e.style.fill,i.color=n.color,i.fontSize=12!==n.fontSize?n.fontSize:e.style.fontSize,i.strokeColor="black"!==n.strokeColor?n.strokeColor:e.style.strokeColor,i.strokeWidth=1!==n.strokeWidth?n.strokeWidth:e.style.strokeWidth,i}var kC=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let jC=(()=>{class e extends bg{}return kC([ig("Horizontal")],e.prototype,"orientation",void 0),kC([ig("Center")],e.prototype,"type",void 0),kC([ig(void 0)],e.prototype,"offset",void 0),kC([ig(!1)],e.prototype,"enableRouting",void 0),kC([ig([])],e.prototype,"children",void 0),kC([ig("")],e.prototype,"assistants",void 0),kC([ig("")],e.prototype,"level",void 0),kC([ig("")],e.prototype,"hasSubTree",void 0),kC([ig("")],e.prototype,"rows",void 0),e})();var HC=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};const _C=e=>{if(e)switch(e.type){case"Basic":return YC;case"Flow":return XC;case"Path":return BC;case"Image":return FC;case"Text":return VC;case"Bpmn":return iP;case"Native":return WC;case"HTML":return UC;case"UmlActivity":return nP;case"UmlClassifier":return dP;case"SwimLane":return fP;default:return YC}return YC};let NC=(()=>{class e extends bg{}return HC([ig("Basic")],e.prototype,"type",void 0),e})(),BC=(()=>{class e extends NC{getClassName(){return"Path"}}return HC([ig("Path")],e.prototype,"type",void 0),HC([ig("")],e.prototype,"data",void 0),e})(),WC=(()=>{class e extends NC{getClassName(){return"Native"}}return HC([ig("Native")],e.prototype,"type",void 0),HC([ig("")],e.prototype,"content",void 0),HC([ig("Stretch")],e.prototype,"scale",void 0),e})(),UC=(()=>{class e extends NC{getClassName(){return"Html"}}return HC([ig("HTML")],e.prototype,"type",void 0),HC([ig("")],e.prototype,"content",void 0),e})(),FC=(()=>{class e extends NC{getClassName(){return"Image"}}return HC([ig("Image")],e.prototype,"type",void 0),HC([ig("")],e.prototype,"source",void 0),HC([ig("None")],e.prototype,"scale",void 0),HC([ig("None")],e.prototype,"align",void 0),e})(),VC=(()=>{class e extends NC{getClassName(){return"Text"}}return HC([ig("Text")],e.prototype,"type",void 0),HC([ig("")],e.prototype,"content",void 0),HC([ng({},Ib)],e.prototype,"margin",void 0),e})(),YC=(()=>{class e extends NC{getClassName(){return"BasicShape"}}return HC([ig("Basic")],e.prototype,"type",void 0),HC([ig("Rectangle")],e.prototype,"shape",void 0),HC([ig(0)],e.prototype,"cornerRadius",void 0),HC([rg([],rb)],e.prototype,"points",void 0),e})(),XC=(()=>{class e extends NC{getClassName(){return"FlowShape"}}return HC([ig("Flow")],e.prototype,"type",void 0),HC([ig("Terminator")],e.prototype,"shape",void 0),e})(),GC=(()=>{class e extends bg{getClassName(){return"BpmnGateway"}}return HC([ig("None")],e.prototype,"type",void 0),e})(),qC=(()=>{class e extends bg{getClassName(){return"BpmnDataObject"}}return HC([ig("None")],e.prototype,"type",void 0),HC([ig(!1)],e.prototype,"collection",void 0),e})(),ZC=(()=>{class e extends bg{}return HC([ig("None")],e.prototype,"type",void 0),HC([ig("None")],e.prototype,"loop",void 0),HC([ig(!1)],e.prototype,"call",void 0),HC([ig(!1)],e.prototype,"compensation",void 0),e})(),$C=(()=>{class e extends bg{getClassName(){return"BpmnEvent"}}return HC([ig("Start")],e.prototype,"event",void 0),HC([ig("None")],e.prototype,"trigger",void 0),e})(),QC=(()=>{class e extends bg{getClassName(){return"BpmnSubEvent"}}return HC([ig("None")],e.prototype,"trigger",void 0),HC([ig("Start")],e.prototype,"event",void 0),HC([ig("")],e.prototype,"id",void 0),HC([ng({},rb)],e.prototype,"offset",void 0),HC([rg([],wv)],e.prototype,"annotations",void 0),HC([rg([],fv)],e.prototype,"ports",void 0),HC([ig()],e.prototype,"width",void 0),HC([ig()],e.prototype,"height",void 0),HC([ng({},Ib)],e.prototype,"margin",void 0),HC([ig("Center")],e.prototype,"horizontalAlignment",void 0),HC([ig("Center")],e.prototype,"verticalAlignment",void 0),HC([ig(!0)],e.prototype,"visible",void 0),e})(),JC=(()=>{class e extends bg{}return HC([ng({id:"success",event:"End",offset:{x:1,y:.5}},QC)],e.prototype,"success",void 0),HC([ng({id:"failure",event:"Intermediate",trigger:"Error",offset:{x:.25,y:1}},QC)],e.prototype,"failure",void 0),HC([ng({id:"cancel",event:"Intermediate",trigger:"Cancel",offset:{x:.75,y:1}},QC)],e.prototype,"cancel",void 0),e})(),KC=(()=>{class e extends bg{}return HC([ig("None")],e.prototype,"type",void 0),HC([ig(!1)],e.prototype,"adhoc",void 0),HC([ig("Default")],e.prototype,"boundary",void 0),HC([ig(!1)],e.prototype,"compensation",void 0),HC([ig("None")],e.prototype,"loop",void 0),HC([ig(!0)],e.prototype,"collapsed",void 0),HC([rg([],QC)],e.prototype,"events",void 0),HC([ng({},JC)],e.prototype,"transaction",void 0),HC([ig(void 0)],e.prototype,"processes",void 0),e})(),eP=(()=>{class e extends bg{getClassName(){return"BpmnActivity"}}return HC([ig("Task")],e.prototype,"activity",void 0),HC([ng({},ZC)],e.prototype,"task",void 0),HC([ng({},KC)],e.prototype,"subProcess",void 0),e})(),tP=(()=>{class e extends bg{constructor(e,t,i,n){super(e,t,i,n)}getClassName(){return"BpmnAnnotation"}}return HC([ig("")],e.prototype,"text",void 0),HC([ig("")],e.prototype,"id",void 0),HC([ig(0)],e.prototype,"angle",void 0),HC([ig()],e.prototype,"height",void 0),HC([ig()],e.prototype,"width",void 0),HC([ig(0)],e.prototype,"length",void 0),e})(),iP=(()=>{class e extends NC{getClassName(){return"BpmnShape"}}return HC([ig("Bpmn")],e.prototype,"type",void 0),HC([ig("Event")],e.prototype,"shape",void 0),HC([ng({},$C)],e.prototype,"event",void 0),HC([ng({},GC)],e.prototype,"gateway",void 0),HC([ng({},qC)],e.prototype,"dataObject",void 0),HC([ng({},eP)],e.prototype,"activity",void 0),HC([ng({},tP)],e.prototype,"annotation",void 0),HC([rg([],tP)],e.prototype,"annotations",void 0),e})(),nP=(()=>{class e extends NC{getClassName(){return"UmlActivityShape"}}return HC([ig("UmlActivity")],e.prototype,"type",void 0),HC([ig("Action")],e.prototype,"shape",void 0),e})(),sP=(()=>{class e extends bg{getClassName(){return"MethodArguments"}}return HC([ig("")],e.prototype,"name",void 0),HC([ig("")],e.prototype,"type",void 0),HC([ng({},Hb)],e.prototype,"style",void 0),e})(),rP=(()=>{class e extends sP{getClassName(){return"UmlClassAttribute"}}return HC([ig("Public")],e.prototype,"scope",void 0),HC([ig(!1)],e.prototype,"isSeparator",void 0),e})(),oP=(()=>{class e extends rP{getClassName(){return"UmlClassMethod"}}return HC([rg([],sP)],e.prototype,"parameters",void 0),e})(),aP=(()=>{class e extends bg{getClassName(){return"UmlClass"}}return HC([ig("")],e.prototype,"name",void 0),HC([rg([],rP)],e.prototype,"attributes",void 0),HC([rg([],oP)],e.prototype,"methods",void 0),HC([ng({},Hb)],e.prototype,"style",void 0),e})(),lP=(()=>{class e extends aP{getClassName(){return"UmlInterface"}}return HC([ig(!1)],e.prototype,"isSeparator",void 0),e})(),hP=(()=>{class e extends bg{getClassName(){return"UmlEnumerationMember"}}return HC([ig("")],e.prototype,"name",void 0),HC([ig("")],e.prototype,"value",void 0),HC([ig(!1)],e.prototype,"isSeparator",void 0),HC([ng({},Hb)],e.prototype,"style",void 0),e})(),cP=(()=>{class e extends bg{getClassName(){return"UmlEnumeration"}}return HC([ig("")],e.prototype,"name",void 0),HC([rg([],hP)],e.prototype,"members",void 0),HC([ng({},Hb)],e.prototype,"style",void 0),e})(),dP=(()=>{class e extends NC{getClassName(){return"UmlClassifierShape"}}return HC([ig("UmlClassifier")],e.prototype,"type",void 0),HC([ng({},aP)],e.prototype,"classShape",void 0),HC([ng({},lP)],e.prototype,"interfaceShape",void 0),HC([ng({},cP)],e.prototype,"enumerationShape",void 0),HC([ig("Class")],e.prototype,"classifier",void 0),e})(),pP=(()=>{class e extends bw{constructor(e,t,i,n){let s;super(e,t,i,n),this.isCanvasUpdate=!1,this.status="None",this.parentId="",this.processId="",this.umlIndex=-1,this.outEdges=[],this.inEdges=[],this.isHeader=!1,this.isLane=!1,this.isPhase=!1,this.children&&this.children.length>0&&(s=i,s.style&&s.style.fill||(this.style.fill="transparent"),s.style&&s.style.strokeColor||(this.style.strokeColor="transparent")),this.shape&&"UmlActivity"===this.shape.type&&LS(i,this),this.shape&&"SwimLane"===this.shape.type&&MS(i,this),this.ports&&this.ports.length&&function(e){for(let t=0;t<e.ports.length;t++)e.ports[t].inEdges=[],e.ports[t].outEdges=[]}(this)}get actualSize(){return null!==this.wrapper?this.wrapper.actualSize:new nb(this.width||0,this.height||0)}init(e){let t,i;switch(t="SwimLane"!==this.shape.type?new rv:new Hx,this.shape.changedProperties={},this.shape.oldProperties={},this.shape.type){case"Path":const n=new dv;n.data=this.shape.data,t=n;break;case"Image":const s=new pv;s.source=this.shape.source,s.imageAlign=this.shape.align,s.imageScale=this.shape.scale,t=s;break;case"Text":const r=new av;r.content=this.shape.content,t=r,i=this.style,t.style=i;break;case"Basic":if("Rectangle"===this.shape.shape)t=new rv,t.cornerRadius=this.shape.cornerRadius;else if("Polygon"===this.shape.shape){const e=new dv;e.data=ab(this.shape.points),t=e}else{const e=new dv,i=hv(this.shape.shape);e.data=i,t=e}break;case"Flow":const o=new dv,a=Ov(this.shape.shape);o.data=a,t=o;break;case"UmlActivity":t=function(e,t,i){const n=i.shape.shape,s=Dx(n);switch(e.data=s,t=e,n){case"StructuredNode":if(i.annotations)for(let e=0;e<i.annotations.length;e++)i.annotations[e].content="<<"+i.annotations[e].content+">>";t=e;break;case"FinalNode":t=tC(i)}return t}(new dv,t,this);break;case"Bpmn":if(e.bpmnModule){t=e.bpmnModule.initBPMNContent(t,this,e),this.wrapper.elementActions=this.wrapper.elementActions|Yb.ElementIsGroup;const i=this.shape.activity.subProcess;if(i.processes&&i.processes.length){const n=this.shape.activity.subProcess.processes;for(const s of n)!e.nameTable[s]||e.nameTable[s].processId&&e.nameTable[s].processId!==this.id||(e.nameTable[s].processId=this.id,i.collapsed&&e.updateElementVisibility(e.nameTable[s].wrapper,e.nameTable[s],!i.collapsed),t.children.push(e.nameTable[s].wrapper))}}break;case"Native":const l=new uv(this.id,e.element.id);l.content=this.shape.content,l.scale=this.shape.scale,t=l;break;case"HTML":const h=new vw(this.id,e.element.id,void 0,e.nodeTemplate);this.shape.content?h.content=this.shape.content:e.nodeTemplate&&(h.isTemplate=!0,h.template=h.content=BP(h,!0,this)),t=h;break;case"UmlClassifier":t=function(e,t,i){let n,s="NoWrap";"Class"===t.shape.classifier?n=t.shape.classShape:"Enumeration"===t.shape.classifier?n=t.shape.enumerationShape:"Interface"===t.shape.classifier&&(n=t.shape.interfaceShape),t.container={type:"Stack",orientation:"Vertical"},t.constraints=(Vb.Default|Vb.HideThumbs)&~(Vb.Rotate|Vb.Resize),t.style={fill:t.style.fill,strokeColor:t.style.strokeColor,strokeWidth:1.5},t.children=[],t.maxWidth&&(s="Wrap");const r=new pP(i,"nodes",{id:t.id+"_umlClass_header",annotations:[{id:"name",content:n.name,offset:{x:.5,y:.65},margin:{left:10,right:10},style:{bold:!0,fontSize:14,color:n.style.color,fill:n.style.fill,textWrapping:s}},{content:"<<"+t.shape.classifier+">>",margin:{left:10,right:10},id:"class",style:{fontSize:n.style.fontSize,color:n.style.color,fill:n.style.fill,textWrapping:s},offset:{x:.5,y:.3},constraints:Fb.ReadOnly}],constraints:(Vb.Default|Vb.HideThumbs)&~(Vb.Rotate|Vb.Drag|Vb.Resize),verticalAlignment:"Stretch",horizontalAlignment:"Stretch",style:{fill:t.style.fill,strokeColor:"black"===t.style.strokeColor?"#ffffff00":t.style.strokeColor}},!0);return i.initObject(r),i.nodes.push(r),i.UpdateBlazorDiagramModel(r,"Node"),t.children.push(r.id),function(e,t,i,n){if("Enumeration"===e.shape.classifier){const s=i.members;if(s&&s.length){zC(e,t);let i="";for(let r=0;r<s.length;r++){const o=s[r];if(""!==o.name&&(i+=o.name),r!==s.length){const a=LC(e,o),l=new pP(t,"nodes",{id:XP()+"_umlMember",annotations:[{id:"name",content:i,offset:{x:0,y:.5},style:{bold:!0,fontSize:a.fontSize,color:a.color,fill:a.fill,textWrapping:n},margin:{left:14,right:5},horizontalAlignment:"Left"}],verticalAlignment:"Stretch",horizontalAlignment:"Stretch",style:{fill:e.style.fill,strokeColor:"black"===e.style.strokeColor?"#ffffff00":e.style.strokeColor,textWrapping:n},constraints:(Vb.Default|Vb.HideThumbs)&~(Vb.Rotate|Vb.Drag|Vb.Resize),minHeight:25},!0);t.initObject(l),t.nodes.push(l),t.UpdateBlazorDiagramModel(l,"Node"),e.children.push(l.id),i="",o.isSeparator&&r!==s.length-1&&zC(e,t)}}}}else{const s=i.attributes;if(s.length){let i="";zC(e,t);for(let r=0;r<s.length;r++){let o;const a=s[r];if(o=a.scope&&"Public"===a.scope?" +":a.scope&&"Private"===a.scope?"-":a.scope&&"Protected"===a.scope?"#":"~",""!==a.name&&o&&(i+=o+" "+a.name+" : "+a.type),r!==s.length){const o=LC(e,a),l=new pP(t,"nodes",{id:XP()+"_umlProperty",style:{fill:e.style.fill,strokeColor:"black"===e.style.strokeColor?"#ffffff00":e.style.strokeColor},annotations:[{id:"name",content:i,offset:{x:0,y:.5},style:{bold:!0,fontSize:o.fontSize,color:o.color,fill:o.fill,textWrapping:n},margin:{left:14,right:5},horizontalAlignment:"Left"}],verticalAlignment:"Stretch",horizontalAlignment:"Stretch",constraints:(Vb.Default|Vb.HideThumbs)&~(Vb.Rotate|Vb.Drag|Vb.Resize),minHeight:25},!0);t.initObject(l),t.nodes.push(l),t.UpdateBlazorDiagramModel(l,"Node"),e.children.push(l.id),i="",a.isSeparator&&r!==s.length-1&&zC(e,t)}}}}}(t,i,n,s),function(e,t,i,n){if(i.methods&&i.methods.length){const s=i.methods;zC(e,t);let r,o="",a="";for(let i=0;i<s.length;i++){const l=s[i];if(r=l.scope&&"Public"===l.scope?" +":l.scope&&"Private"===l.scope?"-":l.scope&&"Protected"===l.scope?"#":"~",l.parameters)for(let e=0;e<l.parameters.length;e++)o+=l.parameters[e].type?l.parameters[e].name+":"+l.parameters[e].type:l.parameters[e].name,e!==l.parameters.length-1&&(o+=",");if(""!==l.name&&r&&(a+=r+" "+l.name+"("+o+") : "+l.type),i!==s.length){const r=LC(e,l),o=new pP(t,"nodes",{id:XP()+"_umlMethods",verticalAlignment:"Stretch",horizontalAlignment:"Stretch",annotations:[{id:"name",content:a,offset:{x:0,y:.5},style:{bold:!0,fontSize:r.fontSize,color:r.color,fill:r.fill,textWrapping:n},margin:{left:14,right:5},horizontalAlignment:"Left"}],style:{fill:e.style.fill,strokeColor:"black"===e.style.strokeColor?"#ffffff00":e.style.strokeColor},minHeight:25,constraints:(Vb.Default|Vb.HideThumbs)&~(Vb.Rotate|Vb.Drag|Vb.Resize)},!0);t.initObject(o),t.nodes.push(o),t.UpdateBlazorDiagramModel(o,"Node"),e.children.push(o.id),a="",l.isSeparator&&i!==s.length-1&&zC(e,t)}}}}(t,i,n,s),t.offsetX=t.offsetX,t.offsetY=t.offsetY,t.style.fill=t.style.fill,t.borderColor=t.borderColor,i.initObject(t),e}(t,this,e);break;case"SwimLane":this.annotations=[],this.ports=[],t.cellStyle.fill="none",t.cellStyle.strokeColor="none",this.container={type:"Grid",orientation:this.shape.orientation},t.id=this.id,this.container.orientation=this.shape.orientation,this.constraints|=Vb.HideThumbs,function(e,t,i){i.width||0!==i.shape.phases.length||(i.width=100);const n=[],s=[];let r=0;const o=i.shape,a="Horizontal"===o.orientation;if(o.header&&o.hasHeader&&tS(n,o.header.height),function(e,t,i){let n,s=0;const r=i.shape;if(e.length>0)for(let o=0;o<e.length;o++)s+=e[o].height;if(t){if(r.phases.length>0&&r.phaseSize&&(s+=r.phaseSize,tS(e,r.phaseSize)),r.lanes.length>0)for(let o=0;o<r.lanes.length;o++)n=r.lanes[o].height,s+=n,o===r.lanes.length-1&&s<i.height&&(n+=i.height-s),tS(e,n)}else if(r.phases.length>0){let t=0;for(let o=0;o<r.phases.length;o++){let a=r.phases[o].offset;0===o||(a-=t),t+=a,n=a,s+=n,o===r.phases.length-1&&s<i.height&&(n+=i.height-s),tS(e,n)}}else tS(e,i.height)}(n,a,i),function(e,t,i){let n=0;const s=i.shape;let r,o,a,l,h;if(s.phases.length>0&&"Horizontal"===s.orientation)for(l=0;l<s.phases.length;l++)r=s.phases[l].offset,0===l||(r-=n),n+=r,o=iS(r),l===s.phases.length-1&&n<i.width&&(o.width+=i.width-n),e.push(o);else if(t)o=iS(i.width),e.push(o);else{for(h=s.phaseSize&&s.phases.length>0?s.lanes.length+1:s.lanes.length,s.phaseSize&&s.phases.length>0&&(n+=s.phaseSize,o=iS(s.phaseSize),e.push(o)),a=0;a<s.lanes.length;a++)n+=s.lanes[a].width,o=iS(s.lanes[a].width),a===s.lanes.length-1&&n<i.width&&(o.width+=i.width-n),e.push(o);0===s.phases.length&&0===s.lanes.length&&(o=iS(i.width),e.push(o))}}(s,a,i),e.setDefinitions(n,s),o.header&&o.hasHeader&&(function(e,t,i){let n=0;const s=e.columnDefinitions(),r=i.shape;for(let l=0;l<s.length;l++)n+=s[l].width;r.header.id=r.header.id||XP();const o={id:i.id+r.header.id,annotations:[QP(r.header.annotation)],style:r.header.style?r.header.style:void 0,offsetX:i.offsetX,offsetY:i.offsetY,rowIndex:0,columnIndex:0,maxWidth:n,container:{type:"Canvas",orientation:"Horizontal"}};Kw(i)||(o.constraints&=~Vb.Select);const a=Jx(t,0,i,o,!0);e.addObject(a,0,0,1,e.columnDefinitions().length)}(e,t,i),r++),o.phases.length>0&&o.phaseSize){for(let n=0;n<o.phases.length;n++)""===o.phases[n].id&&(o.phases[n].id=XP()),Kx(e,t,i,r,a,n);r++}if(o.lanes.length>0)for(let l=0;l<o.lanes.length;l++)""===o.lanes[l].id&&(o.lanes[l].id=XP()),eS(e,t,i,r,l,a),r++}(t,e,this)}return t.id=this.id+"_content",t.relativeMode="Object",void 0!==this.width&&(t.width=this.width),t.horizontalAlignment="Stretch",void 0!==this.height&&(t.height=this.height),void 0!==this.minHeight&&(t.minHeight=this.minHeight),void 0!==this.maxHeight&&(t.maxHeight=this.maxHeight),void 0!==this.minWidth&&(t.minWidth=this.minWidth),void 0!==this.maxWidth&&(t.maxWidth=this.maxWidth),"Rectangle"===this.shape.shape&&!this.shape.cornerRadius&&(t.isRectElement=!0),t.verticalAlignment="Stretch",this.shape instanceof VC&&(t.margin=this.shape.margin),ax(this)&&0!=(this.constraints&Vb.Shadow)&&(t.shadow=this.shadow),!("Bpmn"===this.shape.type&&"Message"!==this.shape.shape&&"DataSource"!==this.shape.shape||"UmlActivity"===this.shape.type&&"FinalNode"===this.shape.shape)&&"Text"!==this.shape.type&&(t.style=this.style,this.oldGradientValue=this.style.gradient?QP(this.style.gradient):null),(this.wrapper.elementActions&Yb.ElementIsGroup||"Horizontal"!==this.flip)&&"Vertical"!==this.flip||(t.flip=this.flip),t}initContainer(){let e;if(this.id||(this.id=XP()),!this.container||this.shape instanceof fP)e=this.children?new ov:new lv;else switch(this.container.type){case"Canvas":e=new lv;break;case"Stack":e=new RC;break;case"Grid":e=new Hx,e.setDefinitions(this.rows,this.columns)}return e.id=this.id,e.offsetX=this.offsetX,e.offsetY=this.offsetY,e.visible=this.visible,e.horizontalAlignment=this.horizontalAlignment,e.verticalAlignment=this.verticalAlignment,this.container&&(e.width=this.width,e.height=this.height,"Stack"===this.container.type&&(e.orientation=this.container.orientation)),e.style.fill=this.backgroundColor,e.style.strokeColor=this.borderColor,e.style.strokeWidth=this.borderWidth,e.rotateAngle=this.rotateAngle,e.minHeight=this.minHeight,e.minWidth=this.minWidth,e.maxHeight=this.maxHeight,e.maxWidth=this.maxWidth,e.pivot=this.pivot,e.margin=this.margin,e.flip=this.flip,this.wrapper=e,e}initPorts(e,t){for(let i=0;i<this.ports.length;i++)this.initPort(e,t,this.ports[i])}initPort(e,t,i){const n=this.wrapper;let s,r;s=this.initPortWrapper(i);const o=hO(e);o&&(r=o(s,this)),s.description=r||s.id,s.inversedAlignment=n.inversedAlignment,s.elementActions=s.elementActions|Yb.ElementIsPort,t.children.push(s)}getIconOffet(e,t){let i,n;return"BottomToTop"===e.orientation?(i=t.offset.x,n=1-t.offset.y):"LeftToRight"===e.orientation?(i=t.offset.y,n=t.offset.x):"RightToLeft"===e.orientation?(i=1-t.offset.y,n=t.offset.x):(i=t.offset.x,n=t.offset.y),{x:i,y:n}}initIcons(e,t,i,n){const s=this.wrapper;let r;const o=this.isExpanded?this.expandIcon:this.collapseIcon;if("None"!==o.shape){const a=new lv;a.float=!0;const l=[];let h;a.id=this.id+"_icon_content",a.children=l,a.height=o.height,a.width=o.width,a.style.strokeColor="transparent",a.margin=o.margin,a.horizontalAlignment="Center",a.verticalAlignment="Center",a.visible=this.visible,r=this.getIconOffet(t,o),a.setOffsetWithRespectToBounds(r.x,r.y,"Fraction"),a.relativeMode="Point",this.initIconSymbol(o,a,e,n);const c=hO(e);c&&(h=c(o,this)),a.description=h||a.id,a.inversedAlignment=s.inversedAlignment,i.children.push(a)}}initfixedUserHandles(e){const t=this.wrapper,i=new lv;i.float=!0,e.id=e.id||XP(),i.id=this.id+"_"+e.id,i.children=[],i.height=e.height,i.width=e.width,i.style.strokeColor=e.handleStrokeColor,i.style.fill=e.fill,i.style.strokeWidth=e.handleStrokeWidth,i.margin=e.margin,i.visible=e.visibility,i.cornerRadius=e.cornerRadius,i.horizontalAlignment="Center",i.verticalAlignment="Center";const n=this.getfixedUserHandleOffet(e);i.setOffsetWithRespectToBounds(n.x,n.y,"Fraction"),i.relativeMode="Point";const s=VS(e,i);return i.children.push(s),i.description=i.id,i.inversedAlignment=t.inversedAlignment,i}getfixedUserHandleOffet(e){return{x:e.offset.x,y:e.offset.y}}initAnnotations(e,t,i,n,s){let r;for(let o=0;o<this.annotations.length;o++){let a;r=this.initAnnotationWrapper(this.annotations[o],i,n,o,s);const l=hO(e);l&&(a=l(r,this)),r.description=a||r.id,r.inversedAlignment=t.inversedAlignment,t.children.push(r)}}initPortWrapper(e){e.id=e.id||XP();let t=new dv;t.height=e.height,t.width=e.width;const i="Custom"===e.shape?e.pathData:Sv(e.shape);t.id=this.id+"_"+e.id,t.margin=e.margin,t.data=i;const n=e.style;return t.style={fill:n.fill,strokeColor:n.strokeColor,gradient:null,opacity:n.opacity,strokeDashArray:n.strokeDashArray,strokeWidth:n.strokeWidth},t.horizontalAlignment=e.horizontalAlignment,t.verticalAlignment=e.verticalAlignment,t=vC(t,this.flip,e),void 0===this.width&&void 0===this.height||(t.float=!0),t.relativeMode="Point",t.visible=!(!lC(e,Nb.Visible)||lC(e,Nb.Hover)||lC(e,Nb.Connect)),t.elementActions=t.elementActions|Yb.ElementIsPort,t}initAnnotationWrapper(e,t,i,n,s){e.id=e.id||n+"annotation"||XP();const r=e;let o;if(t&&(e.template||"Template"===e.annotationType||s&&""===e.content))o=new vw(this.id,t,e.id,s),o=YP(o,e,s);else{o=new av,o.canMeasure=!i;const t=e.style,n=e.hyperlink.link?e.hyperlink:void 0;o.style={fill:t.fill,strokeColor:t.strokeColor,strokeWidth:t.strokeWidth,bold:t.bold,textWrapping:t.textWrapping,color:n?n.color||o.hyperlink.color:t.color,whiteSpace:t.whiteSpace,fontFamily:t.fontFamily,fontSize:t.fontSize,italic:t.italic,gradient:null,opacity:t.opacity,strokeDashArray:t.strokeDashArray,textAlign:t.textAlign,textOverflow:e.style.textOverflow,textDecoration:n?n.textDecoration||o.hyperlink.textDecoration:t.textDecoration},o.hyperlink.link=e.hyperlink.link||void 0,o.hyperlink.content=e.hyperlink.content||void 0,o.hyperlink.textDecoration=e.hyperlink.textDecoration||void 0,o.content=n?n.content||o.hyperlink.link:e.content}return o.constraints=e.constraints,o.height=e.height,o.width=e.width,o.visible=e.visibility,o.rotateAngle=e.rotateAngle,o.id=this.id+"_"+e.id,void 0===this.width||e.template||(void 0===e.width||e.width>this.width&&("Wrap"===e.style.textWrapping||"WrapWithOverflow"===e.style.textWrapping))&&(o.width=this.width),o.margin=e.margin,o.horizontalAlignment=e.horizontalAlignment,o.verticalAlignment=e.verticalAlignment,o.setOffsetWithRespectToBounds(r.offset.x,r.offset.y,"Fraction"),void 0===this.width&&void 0===this.height||(o.float=!0),o.relativeMode="Point",o}initIconContainer(e,t){const i=new rv;return i.id=t.id+"_rect",i.height=e.height,i.width=e.width,i.visible=t.visible,i.margin=e.margin,i.cornerRadius=e.cornerRadius,i.style={fill:e.fill,strokeColor:e.borderColor,strokeWidth:e.borderWidth},i.setOffsetWithRespectToBounds(.5,.5,"Fraction"),i.horizontalAlignment="Center",i.verticalAlignment="Center",i.relativeMode="Object",i.description=i.description||"Click here to expand or collapse",i}initIconSymbol(e,t,i,n){let s;if(t.children.push(this.initIconContainer(e,t)),"Template"===e.shape)s=new uv(this.id,n),s.content=e.content,s.height=10,s.width=10;else{s=new dv,s.data=function(e){let t;switch(e.shape){case"Minus":t="M0,50 L100,50";break;case"Plus":t="M0,-50 L0,50 M-50,0 L50,0";break;case"ArrowUp":t="M0,100 L50,0 L100,100 Z";break;case"ArrowDown":t="M0,0 L50,100 L100,0 Z";break;case"Path":t=e.pathData}return t}(e);const t=wP(s.data);s.height=t.height<10?t.height:10-(e.padding.bottom+e.padding.top),s.width=t.width<10?t.width:10-(e.padding.left+e.padding.right)}s.id=t.id+"_shape",s.horizontalAlignment="Center",s.verticalAlignment="Center",s.visible=t.visible,s.visible=t.visible,s.style={fill:"black",strokeColor:e.borderColor,strokeWidth:e.borderWidth},s.setOffsetWithRespectToBounds(.5,.5,"Fraction"),s.relativeMode="Object",s.description=t.description||"Click here to expand or collapse",t.children.push(s)}getClassName(){return"Node"}}return HC([rg([],wv)],e.prototype,"annotations",void 0),HC([ig(0)],e.prototype,"offsetX",void 0),HC([ng({},jC)],e.prototype,"layoutInfo",void 0),HC([ig(0)],e.prototype,"offsetY",void 0),HC([rg([],fv)],e.prototype,"ports",void 0),HC([ig(!0)],e.prototype,"isExpanded",void 0),HC([rg([],Sw)],e.prototype,"fixedUserHandles",void 0),HC([ng({},MC)],e.prototype,"expandIcon",void 0),HC([ng({},MC)],e.prototype,"collapseIcon",void 0),HC([ng({x:.5,y:.5},rb)],e.prototype,"pivot",void 0),HC([ig()],e.prototype,"width",void 0),HC([ig()],e.prototype,"height",void 0),HC([ig()],e.prototype,"minWidth",void 0),HC([ig()],e.prototype,"minHeight",void 0),HC([ig()],e.prototype,"maxWidth",void 0),HC([ig()],e.prototype,"maxHeight",void 0),HC([ig(0)],e.prototype,"rotateAngle",void 0),HC([ng({fill:"white"},Hb)],e.prototype,"style",void 0),HC([ig("transparent")],e.prototype,"backgroundColor",void 0),HC([ig("none")],e.prototype,"borderColor",void 0),HC([ig(0)],e.prototype,"borderWidth",void 0),HC([ig()],e.prototype,"data",void 0),HC([sg(_C)],e.prototype,"shape",void 0),HC([ng({},mw)],e.prototype,"previewSize",void 0),HC([ng({},mw)],e.prototype,"dragSize",void 0),HC([ig(null)],e.prototype,"wrapper",void 0),HC([ig(Vb.Default)],e.prototype,"constraints",void 0),HC([ng({},Db)],e.prototype,"shadow",void 0),HC([ig()],e.prototype,"children",void 0),HC([ig(null)],e.prototype,"container",void 0),HC([ig("Left")],e.prototype,"horizontalAlignment",void 0),HC([ig("Top")],e.prototype,"verticalAlignment",void 0),HC([ig()],e.prototype,"rows",void 0),HC([ig()],e.prototype,"columns",void 0),HC([ig()],e.prototype,"rowIndex",void 0),HC([ig()],e.prototype,"columnIndex",void 0),HC([ig()],e.prototype,"rowSpan",void 0),HC([ig()],e.prototype,"columnSpan",void 0),HC([ig("")],e.prototype,"branch",void 0),e})(),uP=(()=>{class e extends bg{}return HC([ig("")],e.prototype,"id",void 0),HC([ng({},vv)],e.prototype,"annotation",void 0),HC([ng({fill:"#E7F4FF",strokeColor:"#CCCCCC"},kb)],e.prototype,"style",void 0),HC([ig(50)],e.prototype,"height",void 0),HC([ig(50)],e.prototype,"width",void 0),e})(),gP=(()=>{class e extends bg{getClassName(){return"Lane"}}return HC([ig("")],e.prototype,"id",void 0),HC([ng({fill:"#F9F9F9",strokeColor:"#CCCCCC"},kb)],e.prototype,"style",void 0),HC([rg([],pP)],e.prototype,"children",void 0),HC([ig(100)],e.prototype,"height",void 0),HC([ig(100)],e.prototype,"width",void 0),HC([ng({style:{fill:"#E7F4FF",strokeColor:"#CCCCCC"},annotation:{content:"Function"}},uP)],e.prototype,"header",void 0),HC([ig(!0)],e.prototype,"canMove",void 0),e})(),mP=(()=>{class e extends bg{getClassName(){return"Phase"}}return HC([ig("")],e.prototype,"id",void 0),HC([ng({strokeColor:"#CCCCCC"},kb)],e.prototype,"style",void 0),HC([ng({annotation:{content:"Phase"}},uP)],e.prototype,"header",void 0),HC([ig(100)],e.prototype,"offset",void 0),e})(),fP=(()=>{class e extends NC{constructor(){super(...arguments),this.padding=20,this.hasHeader=!0}getClassName(){return"SwimLane"}}return HC([ig("SwimLane")],e.prototype,"type",void 0),HC([ig(20)],e.prototype,"phaseSize",void 0),HC([rg([],mP)],e.prototype,"phases",void 0),HC([ig("Horizontal")],e.prototype,"orientation",void 0),HC([rg([],gP)],e.prototype,"lanes",void 0),HC([ng({style:{fill:"#E7F4FF",strokeColor:"#CCCCCC"},annotation:{content:"Function"}},uP)],e.prototype,"header",void 0),HC([ig(!1)],e.prototype,"isLane",void 0),HC([ig(!1)],e.prototype,"isPhase",void 0),e})(),yP=(()=>{class e{getClassName(){return"ChildContainer"}}return HC([ig("Canvas")],e.prototype,"type",void 0),HC([ig("Vertical")],e.prototype,"orientation",void 0),e})(),bP=(()=>{class e extends bg{init(e){const t=new ov;if(t.measureChildren=!1,t.children=[],this.annotation){const i=e.getWrapper(this.nodes.length>0?e.nameTable[this.nodes[0].id].wrapper:e.nameTable[this.connectors[0].id].wrapper,this.annotation.id);t.children.push(i)}else if(this.nodes||this.connectors){for(let i=0;i<this.nodes.length;i++)t.children.push(e.nameTable[this.nodes[i].id].wrapper);for(let i=0;i<this.connectors.length;i++)t.children.push(e.nameTable[this.connectors[i].id].wrapper)}const i=e.isProtectedOnChange;return e.protectPropertyChange(!1),this.wrapper=t,e.protectPropertyChange(i),t}}return HC([ig(null)],e.prototype,"wrapper",void 0),HC([rg([],pP)],e.prototype,"nodes",void 0),HC([rg([],Vw)],e.prototype,"connectors",void 0),HC([ig()],e.prototype,"width",void 0),HC([ig()],e.prototype,"height",void 0),HC([ig(0)],e.prototype,"rotateAngle",void 0),HC([ig(0)],e.prototype,"offsetX",void 0),HC([ig(0)],e.prototype,"offsetY",void 0),HC([ng({x:.5,y:.5},rb)],e.prototype,"pivot",void 0),HC([ig("CompleteIntersect")],e.prototype,"rubberBandSelectionMode",void 0),HC([rg([],Ix)],e.prototype,"userHandles",void 0),HC([ig(Wb.All)],e.prototype,"constraints",void 0),HC([ig()],e.prototype,"setTooltipTemplate",void 0),e})();function vP(e){let t,i=[];if("msie"===wu.info.name||"edge"===wu.info.name)for(let n=0;n<e.childNodes.length;n++)t=e.childNodes[n],1===t.nodeType&&i.push(t);else i=e.children;return i}function wP(e){if(e){const t="measureElement";window[t].style.visibility="visible";const i=vP(window[t].children[2])[0];i.setAttribute("d",e);const n=i.getBBox(),s=new mb(n.x,n.y,n.width,n.height);return window[t].style.visibility="hidden",s}return new mb(0,0,0,0)}function xP(e,t,i,n,s){const r=new nb,o=kP("span",{style:"display:inline-block; line-height: normal"});return e.bold&&(o.style.fontWeight="bold"),e.italic&&(o.style.fontStyle="italic"),void 0!==i&&(o.style.width=i.toString()+"px"),void 0!==n&&(o.style.height=n.toString()+"px"),void 0!==s&&(o.style.maxWidth=s.toString()+"px"),o.style.fontFamily=e.fontFamily,o.style.fontSize=e.fontSize+"px",o.style.color=e.color,o.textContent=t,o.style.whiteSpace=oO(e.whiteSpace,e.textWrapping),o.style.wordBreak=void 0!==s?"break-word":iO(e.textWrapping),document.body.appendChild(o),r.width=o.offsetWidth,r.height=o.offsetHeight,document.body.removeChild(o),r}function SP(e,t,i,n){let s=0,r=0,o=!1,a="",l=[];const h=t;return 0===h.x&&0===h.y||(s=0-Number(h.x),r=0-Number(h.y)),(e.actualSize.width!==h.width||e.actualSize.height!==h.height||n)&&(s=(n&&n.width||e.actualSize.width)/Number(h.width?h.width:1),r=(n&&n.height||e.actualSize.height)/Number(h.height?h.height:1),o=!0),l=ob(e.data),l=pb(l),a=hb(l,s,r,o,h.x,h.y,0,0),o=!1,a}function CP(e){return PP(e).getElementsByClassName("e-diagram-layer")[0]}function PP(e,t){let i,n;return t&&(n=document.getElementById(t)),i="msie"===wu.info.name||"edge"===wu.info.name?n?n.querySelector("#"+e):document.getElementById(e):n?n.querySelector("#"+CSS.escape(e)):document.getElementById(e),i}function OP(e,t,i){let n,s,r,o="";var a;"native"===i?(s=function(e){let t=null;return t=DP(e).getElementById(e+"_nativeLayer"),t}(e),o="_content_groupElement"):"html"===i?(s=LP(e).childNodes[0],o="_html_element"):(s=CP(a=e).getElementById(a+"_diagramLayer"),o="_groupElement");for(let l=0;s.childNodes&&l<s.childNodes.length;l++)if(r=s.childNodes[l],r&&r.id===t+o){n=l;break}return n}function TP(e){let t=null;return t=PP(e).getElementsByClassName("e-adorner-layer")[0],t}function EP(e){let t=null;return t=TP(e).getElementById(e+"_SelectorElement"),t}function AP(e){let t=null;return t=TP(e).getElementById(e+"_diagramAdorner"),t}function IP(e){let t=null;return t=PP(e).getElementsByClassName("e-userHandle-layer")[0],t}function DP(e){let t;return t=PP(e).getElementsByClassName("e-native-layer")[0],t}function MP(e){let t=null;return t=PP(e).getElementsByClassName("e-grid-layer")[0],t}function RP(e){return PP(e).getElementsByClassName("e-background-layer")[0].parentNode}function zP(e){let t=null;return t=PP(e).getElementsByClassName("e-background-layer")[0],t}function LP(e){let t=null;return window.domTable[e+"html_layer"]?t=window.domTable[e+"html_layer"]:(t=PP(e).getElementsByClassName("e-html-layer")[0],window.domTable[e+"html_layer"]=t),t}function kP(e,t){const i=Cu(e);return FP(i,t),i}function jP(e,t){const i=document.createElementNS("http://www.w3.org/2000/svg",e);return WP(i,t),i}function HP(e,t){return(" "+("object"==typeof e.className?e.className.animVal:e.className)+" ").indexOf(" "+t+" ")>-1}function _P(e,t,i){e=[];for(let n=0,s=i.length;n<s;n++)e.push({pageX:i[n].clientX,pageY:i[n].clientY,pointerId:null});return e}function NP(e,t){const i=PP(e,t);i&&i.parentNode.removeChild(i)}function BP(e,t,i){let n;n=t?kP("div",{style:"height: 100%; width: 100%"}):document.createElementNS("http://www.w3.org/2000/svg","g");const s=mC(e);let r,o,a={};if(s instanceof pP){if(a=s,"Native"===s.shape.type){let t;const i=document.createElementNS("http://www.w3.org/2000/svg","svg");document.body.appendChild(i),i.innerHTML=s.shape.content,t=i.getElementsByTagName("svg").length>0?i.getElementsByTagName("svg")[0].outerHTML:i.getElementsByTagName("g")[0].outerHTML,s.shape.content=t,e.content=t,i.parentElement.removeChild(i)}r="nodeTemplate"}else a=s,r="annotationTemplate";const l=document.getElementById(e.diagramId).ej2_instances[0];if("string"!=typeof e.content||e.isTemplate)if(e.isTemplate){let t;t=e.getNodeTemplate()(QP(i),l,r+"_"+("nodeTemplate"===r?i.id:e.nodeId+i.id),void 0,void 0,!1);for(let e=0;e<t.length;e++)n.appendChild(t[e])}else n.appendChild(e.content);else{const t=document.getElementById(e.content);if(t)n.appendChild(t);else{let t;for(o of(t=am(e.content),t(a,l,r,"")))n.appendChild(o)}}return e.isTemplate?n:n.cloneNode(!0)}function WP(e,t){const i=Object.keys(t);for(let n=0;n<i.length;n++)"style"!==i[n]?e.setAttribute(i[n],t[i[n]]):UP(e,t[i[n]])}function UP(e,t){const i=t.split(";");for(let n=0;n<i.length;n++){const t=i[n].split(":");2===t.length&&(e.style[t[0].trim()]=t[1].trim())}}function FP(e,t){const i=Object.keys(t);for(let n=0;n<i.length;n++)"style"!==i[n]?e.setAttribute(i[n],t[i[n]]):UP(e,t[i[n]])}function VP(e,t,i,n){return!(t.length>=1&&0===e.x)||"Clip"!==n.textOverflow&&"Ellipsis"!==n.textOverflow||"Wrap"!==n.textWrapping&&"WrapWithOverflow"!==n.textWrapping||(e.x=t[i-1]?t[i-1].x:-e.width/2),e.x}function YP(e,t,i){return i&&!t.template?(e.isTemplate=!0,e.template=e.content=BP(e,!0,t)):e.content=t.template,e}function XP(){const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";let t,i="";for(let n=0;n<5;n++){if("crypto"in window&&"getRandomValues"in crypto){const i=new Uint16Array(1);t=(window.msCrypto||window.crypto).getRandomValues(i)[0]%(e.length-1)}else t=Math.floor(Math.random()*e.length);0===n&&t<10?n--:i+=e.substring(t,t+1)}return i}function GP(e,t){if(e.nodes&&e.nodes.length>0)for(let i=0;i<e.nodes.length;i++)if(e.nodes[i].id===t)return i;if(e.connectors&&e.connectors.length>0)for(let i=0;i<e.connectors.length;i++)if(e.connectors[i].id===t)return i;return null}function qP(e){if(e)try{if(document.querySelectorAll(e).length)return am(document.querySelector(e).innerHTML.trim())}catch(t){return am(e)}}function ZP(e){let t=new mb;const i=e.offsetY-e.actualSize.height*e.pivot.y,n=e.offsetY+e.actualSize.height*(1-e.pivot.y),s=e.offsetX-e.actualSize.width*e.pivot.x,r=e.offsetX+e.actualSize.width*(1-e.pivot.x);return t=mb.toBounds([{x:s,y:i},{x:r,y:i},{x:s,y:n},{x:r,y:n}]),t}function $P(e){let t=new mb;const i=ZP(e);let n=i.middleLeft,s=i.topCenter,r=i.bottomCenter,o=i.middleRight,a=i.topLeft,l=i.topRight,h=i.bottomLeft,c=i.bottomRight;if(e.corners={topLeft:a,topCenter:s,topRight:l,middleLeft:n,middleRight:o,bottomLeft:h,bottomCenter:r,bottomRight:c},0!==e.rotateAngle||0!==e.parentTransform){const t=bb();wb(t,e.rotateAngle+e.parentTransform,e.offsetX,e.offsetY),e.corners.topLeft=a=vb(t,a),e.corners.topCenter=s=vb(t,s),e.corners.topRight=l=vb(t,l),e.corners.middleLeft=n=vb(t,n),e.corners.middleRight=o=vb(t,o),e.corners.bottomLeft=h=vb(t,h),e.corners.bottomCenter=r=vb(t,r),e.corners.bottomRight=c=vb(t,c)}return t=mb.toBounds([a,l,h,c]),e.corners.left=t.left,e.corners.right=t.right,e.corners.top=t.top,e.corners.bottom=t.bottom,e.corners.center=t.center,e.corners.width=t.width,e.corners.height=t.height,t}function QP(e,t,i,n){const s={},r="properties";if(e){i=e.propName;let o=[];o=o.concat(Object.keys(e[r]||e));let a=[];if(o.push("version"),i){const e=hO(t);a=e?e(i):[],o=o.concat(a)}const l=function(e){switch(e){case"nodes":case"children":return["inEdges","outEdges","parentId","processId","nodeId","umlIndex","isPhase","isLane"];case"connectors":return["parentId"];case"annotation":case"annotations":return["nodeId"];case"shape":return["hasHeader"];case"layers":return["objectZIndex"]}return[]}(i);o=o.concat(l),n&&(o=function(e,t){let i=[];return t instanceof pP?i=["width","height","offsetX","offsetY","container","visible","horizontalAlignment","verticalAlignment","backgroundColor","borderColor","borderWidth","rotateAngle","minHeight","minWidth","maxHeight","maxWidth","pivot","margin","flip","wrapper","constraints","style","annotations","ports","isExpanded","expandIcon"]:t instanceof Vw?i=["constraints","sourcePadding","targetPadding","cornerRadius","flip","type","targetDecorator","sourceDecorator","sourceID","shape","bridgeSpace","annotations","segments","hitPadding","tooltip","previewSize","dragSize","style","sourcePortID","targetID","targetPortID","visible"]:t instanceof Ew?i=["height","width","shape","style","pivot","pathData"]:t instanceof NC||t instanceof MC?(i.push("shape"),t instanceof YC?i.push("cornerRadius"):t instanceof Text?i.push("margin"):t instanceof Image?(i.push("align"),i.push("scale")):t instanceof WC?i.push("scale"):t instanceof iP?(i.push("activity"),i.push("annotations")):t instanceof MC&&(i.push("borderColor"),i.push("borderWidth"),i.push("cornerRadius"),i.push("fill"))):t instanceof eP?i.push("subProcess"):t instanceof ZC?(i.push("call"),i.push("compensation"),i.push("loop")):t instanceof KC?(i.push("adhoc"),i.push("boundary"),i.push("compensation"),i.push("loop"),i.push("processes")):t instanceof mv?(i.push("height"),i.push("width"),i.push("visibility"),i.push("horizontalAlignment"),i.push("verticalAlignment"),i.push("shape")):t instanceof vv?(i.push("constraints"),i.push("height"),i.push("horizontalAlignment"),i.push("rotateAngle"),i.push("template"),i.push("verticalAlignment"),i.push("visibility"),i.push("width"),i.push("margin")):t instanceof Ib?(i.push("left"),i.push("right"),i.push("top"),i.push("bottom")):t instanceof Hb&&(i=["strokeWidth","strokeDashArray","opacity","gradient","fontSize","fontFamily","textOverflow","textDecoration","whiteSpace","textWrapping","textAlign","italic","bold"]),t instanceof kb&&(i.push("strokeColor"),i.push("color")),e.concat(i)}(o,e));for(const i of o)"historyManager"!==i&&("wrapper"!==i?e[i]&&e.hasOwnProperty("observers")||(s[i]=e[i]instanceof Array?JP(-1===l.indexOf(i)&&e[r]?e[r][i]:e[i],t,i,n):e[i]instanceof Array==0&&e[i]instanceof HTMLElement?e[i].cloneNode(!0).innerHtml:e[i]instanceof Array==0&&e[i]instanceof Object?QP(-1===l.indexOf(i)&&e[r]?e[r][i]:e[i],void 0,void 0,n):e[i]):e[i]&&(s[i]={actualSize:{width:e[i].actualSize.width,height:e[i].actualSize.height},offsetX:e[i].offsetX,offsetY:e[i].offsetY}))}return s}function JP(e,t,i,n){let s;if(e){s=[];for(let r=0;r<e.length;r++)s.push(e[r]instanceof Array?e[r]:e[r]instanceof Object?QP(e[r],t,i,n):e[r])}return s}function KP(e,t){if(e){t||(t={properties:{}});for(const i of Object.keys(e))if(e[i]instanceof Array){const n=eO(e[i],t.properties[i]);t.properties[i]&&t.properties[i].length||(t[i]=n)}else if(e[i]instanceof Array==0&&e[i]instanceof HTMLElement)t[i]=e[i].cloneNode(!0).innerHtml;else if(e[i]instanceof Array==0&&e[i]instanceof Object){const n=KP(e[i],t.properties[i]);n.properties&&!Object.keys(n.properties).length&&delete n.properties,t[i]=n}else t[i]=void 0!==t.properties[i]?t[i]:e[i]}return t}function eO(e,t){const i=[];let n=!1;t||(t=[]),t.length||(n=!0);for(let s=0;s<e.length;s++)if(e[s]instanceof Array)eO(e[s],t[s]),n&&i.push(eO);else if(e[s]instanceof Object){const r=KP(e[s],t[s]);n&&i.push(r)}else i.push(e[s]);return i}function tO(e){let t="";switch(e){case"Center":t="center";break;case"Left":t="left";break;case"Right":t="right"}return t}function iO(e){let t="";switch(e){case"Wrap":t="breakall";break;case"NoWrap":t="keepall";break;case"WrapWithOverflow":t="normal";break;case"LineThrough":t="line-through"}return t}function nO(e,t){window.measureElement.style.visibility="visible";const i=vP(window.measureElement.children[2])[1];i.textContent=e,UP(i,"font-size:"+t.fontSize+"px; font-family:"+t.fontFamily+";font-weight:"+(t.bold?"bold":"normal"));const n=i.getBBox().width;return window.measureElement.style.visibility="hidden",n}function sO(e,t){let i=0;return i=(e+t)/2,i}function rO(e,t){let i=0,n=0,s=0,r=0,o="";n=e.length;let a=0;do{r>0&&(i=s),s=Math.floor(sO(i,n)),o+=e.substr(i,s),r=nO(o,t)}while(r<=t.width);for(o=o.substr(0,i),a=i;a<n;a++)if(o+=e[a],r=nO(o,t),r>=t.width){e=e.substr(0,o.length-1);break}return"Ellipsis"===t.textOverflow?(e=e.substr(0,e.length-3),e+="..."):e=e.substr(0,e.length),e}function oO(e,t){if("NoWrap"===t&&"PreserveAll"===e)return"pre";let i="";switch(e){case"CollapseAll":i="nowrap";break;case"CollapseSpace":i="pre-line";break;case"PreserveAll":i="pre-wrap"}return i}function aO(e,t){const i=bb();wb(i,t,0,0);const n=vb(i,{x:0,y:0}),s=vb(i,{x:e.width,y:0}),r=vb(i,{x:0,y:e.height}),o=vb(i,{x:e.width,y:e.height}),a=Math.min(n.x,s.x,r.x,o.x),l=Math.min(n.y,s.y,r.y,o.y),h=Math.max(n.x,s.x,r.x,o.x),c=Math.max(n.y,s.y,r.y,o.y);return new nb(h-a,c-l)}function lO(e,t,i,n){if(0!==e){const s=bb();return wb(s,e,t,i),vb(s,n)}return n}function hO(e){return void 0!==e&&"string"==typeof e&&(e=Mp(e,window)),e}class cO{static getContext(e){return e.getContext("2d")}static setCanvasSize(e,t,i){e&&(e.setAttribute("width",t.toString()),e.setAttribute("height",i.toString()))}renderGradient(e,t,i,n){let s,r,o;if("None"!==e.gradient.type){for(let t=0;t<e.gradient.stops.length;t++)s=void 0!==s?e.gradient.stops[t].offset:Math.max(s,e.gradient.stops[t].offset),r=void 0!==r?e.gradient.stops[t].offset:Math.min(r,e.gradient.stops[t].offset);if("Linear"===e.gradient.type){const s=e.gradient;o=t.createLinearGradient(i+s.x1,n+s.y1,i+s.x2,n+s.y2)}else{const s=e.gradient;o=t.createRadialGradient(i+s.fx,n+s.fy,0,i+s.cx,n+s.cy,s.r)}for(let t=0;t<e.gradient.stops.length;t++){const i=e.gradient.stops[t];o.addColorStop(r<0?(s+i.offset)/(2*s):i.offset/s,i.color)}t.fillStyle=o}return t}renderShadow(e,t,i=null){const n=cO.getContext(t);n.save(),n.beginPath(),n.strokeStyle=n.fillStyle=e.shadow.color,n.globalAlpha=e.shadow.opacity;const s=rb.transform({x:0,y:0},e.shadow.angle,e.shadow.distance),r=e.x+s.x,o=e.y+s.y;this.rotateContext(t,e.angle,r+e.width*e.pivotX,o+e.height*e.pivotY),i?(n.translate(r,o),this.renderPath(t,e,i),n.translate(-r,-o)):(n.rect(r,o,e.width,e.height),n.fillRect(r,o,e.width,e.height)),n.fill(),n.stroke(),n.closePath(),n.restore()}static createCanvas(e,t,i){const n=kP("canvas",{id:e});return this.setCanvasSize(n,t,i),n}setStyle(e,t){const i=cO.getContext(e);"none"===t.fill&&(t.fill="transparent"),"none"===t.stroke&&(t.stroke="transparent"),i.strokeStyle=t.stroke,i.lineWidth=t.strokeWidth,0===t.strokeWidth&&(i.strokeStyle="transparent"),i.globalAlpha=t.opacity;let n=[];t.dashArray&&(n=this.parseDashArray(t.dashArray)),i.setLineDash(n),t.gradient&&"None"!==t.gradient.type?this.renderGradient(t,i,t.x,t.y):i.fillStyle=t.fill}rotateContext(e,t,i,n){const s=cO.getContext(e);s.translate(i,n),s.rotate(t*Math.PI/180),s.translate(-i,-n)}setFontStyle(e,t){const i=cO.getContext(e);let n="";t.italic&&(n+="italic "),t.bold&&(n+="bold "),n+=t.fontSize+"px ",n+=t.fontFamily,i.font=n}parseDashArray(e){const t=[],i=-1!==e.indexOf(" ")?" ":",",n=e.split(i);for(const s of n)t.push(Number(s));return t}drawRoundedRect(e,t){const i=cO.getContext(e);i.beginPath();const n=t.x,s=t.y,r=t.width,o=t.height,a=n+r/2,l=s+o/2;i.beginPath(),this.setStyle(e,t),i.moveTo(n,l),i.quadraticCurveTo(n,s,a,s),i.quadraticCurveTo(n+r,s,n+r,l),i.quadraticCurveTo(n+r,s+o,a,s+o),i.quadraticCurveTo(n,s+o,n,l),i.stroke()}drawRectangle(e,t){if(!0===t.visible)if(t.cornerRadius&&t.cornerRadius<=0)t.width<30||t.height<30?this.drawRoundedRect(e,t):(t.data=function(e,t,i){let n="";const s=[{x:0+e,y:0},{x:0+i-e,y:0},{x:0+i,y:0+e},{x:0+i,y:0+t-e},{x:0+i-e,y:0+t},{x:0+e,y:0+t},{x:0,y:0+t-e},{x:0,y:0+e}],r=[{x:0+i,y:0},{x:0+i,y:0+t},{x:0,y:0+t},{x:0,y:0}];let o,a,l,h=0;for(n="M"+s[0].x+" "+s[0].y,l=0;l<s.length;l+=2)o=s[l+1],n+="L"+o.x+" "+o.y,a=s[l+2]||s[0],n+="Q"+r[h].x+" "+r[h].y+" "+a.x+" "+a.y,h++;return n}(t.cornerRadius,t.height,t.width),this.drawPath(e,t));else{const i=cO.getContext(e);t.shadow&&this.renderShadow(t,e),i.save(),i.beginPath(),this.rotateContext(e,t.angle,t.x+t.width*t.pivotX,t.y+t.height*t.pivotY),this.setStyle(e,t),i.rect(t.x,t.y,t.width,t.height),i.fillRect(t.x,t.y,t.width,t.height),i.fill(),i.stroke(),i.closePath(),i.restore()}}drawPath(e,t){let i=[];i=ob(t.data),i=lb(i),t.shadow&&this.renderShadow(t,e,i);const n=cO.getContext(e);n.save(),n.beginPath();const s=t.y+t.height*t.pivotY,r=t.x+t.width*t.pivotX;"Horizontal"===t.flip||"Vertical"===t.flip?(n.translate(t.x+t.width/2,t.y+t.height/2),n.rotate(-t.angle*Math.PI/180),n.translate(-t.x-t.width/2,-t.y-t.height/2)):this.rotateContext(e,t.angle,r,s),this.setStyle(e,t),n.translate(t.x,t.y),"Horizontal"===t.flip?(n.scale(-1,1),n.translate(-1*t.width,0)):"Vertical"===t.flip?(n.scale(1,-1),n.translate(0,-1*t.height)):"Both"===t.flip&&(n.scale(-1,-1),n.translate(-1*t.width,-1*t.height)),this.renderPath(e,t,i),n.fill(),n.translate(-t.x,-t.y),n.stroke(),n.restore()}renderPath(e,t,i){if(!0===t.visible){const t=cO.getContext(e);let n,s,r,o,a,l,h,c,d,p;const u=i;for(h=0,c=0,p=0,d=u.length;p<d;++p){const e=u[p];switch("x1"in e&&(r=e.x1),"x2"in e&&(a=e.x2),"y1"in e&&(o=e.y1),"y2"in e&&(l=e.y2),"x"in e&&(h=e.x),"y"in e&&(c=e.y),e.command){case"M":t.moveTo(h,c),e.x=h,e.y=c;break;case"L":t.lineTo(h,c),e.x=h,e.y=c;break;case"C":t.bezierCurveTo(r,o,a,l,h,c),e.x=h,e.y=c,e.x1=r,e.y1=o,e.x2=a,e.y2=l;break;case"Q":t.quadraticCurveTo(r,o,h,c),e.x=h,e.y=c,e.x1=r,e.y1=o;break;case"A":let i={x:n,y:s},d=e.r1,p=e.r2;const u=e.angle*(Math.PI/180),g=e.largeArc,m=e.sweep,f={x:h,y:c},y={x:Math.cos(u)*(i.x-f.x)/2+Math.sin(u)*(i.y-f.y)/2,y:-Math.sin(u)*(i.x-f.x)/2+Math.cos(u)*(i.y-f.y)/2},b=Math.pow(y.x,2)/Math.pow(d,2)+Math.pow(y.y,2)/Math.pow(p,2);b>1&&(d*=Math.sqrt(b),p*=Math.sqrt(b));const v=Math.pow(p,2)*Math.pow(y.x,2);let w=(g===m?-1:1)*Math.sqrt((Math.pow(d,2)*Math.pow(p,2)-Math.pow(d,2)*Math.pow(y.y,2)-v)/(Math.pow(d,2)*Math.pow(y.y,2)+Math.pow(p,2)*Math.pow(y.x,2)));isNaN(w)&&(w=0);const x={x:w*d*y.y/p,y:w*-p*y.x/d},S={x:(i.x+f.x)/2+Math.cos(u)*x.x-Math.sin(u)*x.y,y:(i.y+f.y)/2+Math.sin(u)*x.x+Math.cos(u)*x.y},C=this.a([1,0],[(y.x-x.x)/d,(y.y-x.y)/p]),P=[(y.x-x.x)/d,(y.y-x.y)/p],O=[(-y.x-x.x)/d,(-y.y-x.y)/p];let T=this.a(P,O);if(this.r(P,O)<=-1&&(T=Math.PI),this.r(P,O)>=1&&(T=0),e.centp=S,e.xAxisRotation=u,e.rx=d,e.ry=p,e.a1=C,e.ad=T,e.sweep=m,null!=t){const e=d>p?d:p,i=d>p?1:d/p,n=d>p?p/d:1;t.save(),t.translate(S.x,S.y),t.rotate(u),t.scale(i,n),t.arc(0,0,e,C,C+T,!m),t.scale(1/i,1/n),t.rotate(-u),t.translate(-S.x,-S.y),t.restore()}break;case"Z":case"z":t.closePath(),h=n,c=s}n=h,s=c}}}drawText(e,t,i,n,s,r,o){if(t.content&&!0===t.visible){const i=cO.getContext(e);i.save(),this.setStyle(e,t),r&&(t.fontSize*=r),this.rotateContext(e,t.angle,t.x+t.width*t.pivotX,t.y+t.height*t.pivotY),this.setFontStyle(e,t);let n=0,s=[];s=t.childNodes;const a=t.wrapBounds;if(i.fillStyle=t.color,a){const e=this.labelAlign(t,a,s);for(n=0;n<s.length;n++){const l=s[n];l.x=VP(l,s,n,t);const h=e.x+(r?l.x*r:l.x)-a.x,c=e.y+(r?l.dy*r:l.dy)*n+.8*t.fontSize;if(a.width>t.width&&"Wrap"!==t.textOverflow&&"NoWrap"===t.textWrapping&&(l.text=rO(l.text,t)),"Clip"!==t.textOverflow&&"Ellipsis"!==t.textOverflow||"Wrap"!==t.textWrapping?i.fillText(l.text,h,c):c<o.actualSize.height+o.bounds.y&&("Ellipsis"===t.textOverflow&&s[n+1]&&e.y+s[n+1].dy*(n+1)+.8*t.fontSize>o.actualSize.height+o.bounds.y&&(l.text=l.text.slice(0,l.text.length-3),l.text=l.text.concat("...")),i.fillText(l.text,h,c)),"Underline"===t.textDecoration||"Overline"===t.textDecoration||"LineThrough"===t.textDecoration){const s=h;let r;const o=h+i.measureText(l.text).width;let a;switch(t.textDecoration){case"Underline":r=c+2,a=c+2;break;case"Overline":r=e.y+l.dy*n,a=e.y+l.dy*n;break;case"LineThrough":r=(c+e.y+l.dy*n)/2+2,a=(c+e.y+l.dy*n)/2+2}i.beginPath(),i.moveTo(s,r),i.lineTo(o,a),i.strokeStyle=t.color,i.lineWidth=.08*t.fontSize,i.globalAlpha=t.opacity,i.stroke()}}}i.restore()}}loadImage(e,t,i,n,s){this.rotateContext(i,t.angle,n,s);const r=new Image;r.src=t.source,this.image(e,r,t.x,t.y,t.width,t.height,t)}drawImage(e,t,i,n){if(t.visible){const i=cO.getContext(e);i.save();const s=t.x+t.width*t.pivotX,r=t.y+t.height*t.pivotY,o=new Image;o.src=t.source,i.canvas.id.split("_"),n?o.onload=()=>{this.loadImage(i,t,e,s,r)}:this.loadImage(i,t,e,s,r),i.restore()}}image(e,t,i,n,s,r,o){e.beginPath();const a=t.width,l=t.height,h=s,c=r;let d=0,p=0;if(o&&"None"!==o.alignment){const u=o.alignment.toLowerCase().substr(1,3),g=o.alignment.toLowerCase().substr(5,3);if("Slice"===o.scale){const o=()=>{d=h,p=l*h/a},m=()=>{d=a*c/l,p=c};h>c?(o(),c>p&&m()):h===c?a>l?m():o():(m(),h>d&&o());const f=this.getSliceOffset(u,d,h,a),y=this.getSliceOffset(g,p,c,l),b=a-f,v=l-y,w=d-f*(d/a),x=p-y*(p/l),S=kP("canvas",{width:s.toString(),height:r.toString()});S.getContext("2d").drawImage(t,f,y,b,v,0,0,w,x),e.drawImage(S,i,n,s,r)}else if("Meet"===o.scale){const s=l/a,r=c/h;d=r>s?h:c/s,p=r>s?h*s:c,i+=this.getMeetOffset(u,d,h),n+=this.getMeetOffset(g,p,c),e.drawImage(t,0,0,a,l,i,n,d,p)}else e.drawImage(t,i,n,s,r)}else if("None"!==o.flip){let a=1,l=1;"Horizontal"!==o.flip&&"Both"!==o.flip||(i=-i,s=-s,a=-1),"Vertical"!==o.flip&&"Both"!==o.flip||(n=-n,r=-r,l=-1),e.scale(a,l),e.drawImage(t,i,n,s,r)}else e.drawImage(t,i,n,s,r);e.closePath()}getSliceOffset(e,t,i,n){switch(e){case"min":return 0;case"mid":return(t-i)/2*n/t;case"max":return(t-i)*n/t;default:return 0}}getMeetOffset(e,t,i){const n=Math.max(t,i),s=Math.min(t,i);switch(e){case"min":return 0;case"mid":return(n-s)/2;case"max":return n-s;default:return 0}}m(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))}r(e,t){return(e[0]*t[0]+e[1]*t[1])/(this.m(e)*this.m(t))}a(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(this.r(e,t))}labelAlign(e,t,i){const n=new nb(t.width,i.length*(1.2*e.fontSize)),s={x:0,y:0},r=e.y;let o=.5*e.width;const a=.5*e.height;return"left"===e.textAlign?o=0:"center"===e.textAlign?o=t.width>e.width&&("Ellipsis"===e.textOverflow||"Clip"===e.textOverflow)&&"NoWrap"===e.textWrapping?0:.5*e.width:"right"===e.textAlign&&(o=1*e.width),s.x=e.x+o+(t?t.x:0),s.y=r+a-n.height/2,s}}class dO{renderShadow(e,t,i=null,n){const s=rb.transform({x:0,y:0},e.shadow.angle,e.shadow.distance);let r,o;n&&(o=n.getElementById(t.id+"_shadow")),o||(r=i?"path":"rect",o=document.createElementNS("http://www.w3.org/2000/svg",r),t.appendChild(o));const a={id:t.id+"_shadow",fill:e.shadow.color,stroke:e.shadow.color,opacity:e.shadow.opacity.toString(),transform:"rotate("+e.angle+","+(e.x+e.width*e.pivotX)+","+(e.y+e.height*e.pivotY)+")translate("+(e.x+s.x)+","+(e.y+s.y)+")"};if(n){const e=n.getElementById(t.id);e&&e.insertBefore(o,e.firstChild)}WP(o,a),i?i&&this.renderPath(o,e,i):WP(o,{width:e.width,height:e.height})}parseDashArray(e){return[]}drawRectangle(e,t,i,n,s,r,o){let a,l,h;t.shadow&&!n&&this.renderShadow(t,e,void 0,r),a=t.id===e.id?t.id+"_container":t.id,r&&(l=r.getElementById(a)),l&&!s||(l=document.createElementNS("http://www.w3.org/2000/svg","rect"),e.appendChild(l)),r&&!t.shadow&&(h=r.getElementById(t.id+"_groupElement_shadow"),h&&h.parentNode.removeChild(h));const c={id:a,x:t.x.toString(),y:t.y.toString(),width:t.width.toString(),height:t.height.toString(),visibility:t.visible?"visible":"hidden",transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")",rx:t.cornerRadius||0,ry:t.cornerRadius||0,opacity:t.opacity,"aria-label":o||""};t.class&&(c.class=t.class),o||(c["pointer-events"]="none"),WP(l,c),this.setSvgStyle(l,t,i)}updateSelectionRegion(e,t){let i;i=e.parentNode.getElementById(t.id);const n={id:t.id,x:t.x.toString(),y:t.y.toString(),width:t.width.toString(),height:t.height.toString(),transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")",class:"e-diagram-selected-region"};i||(i=document.createElementNS("http://www.w3.org/2000/svg","rect"),e.appendChild(i)),this.setSvgStyle(i,t),WP(i,n)}createGElement(e,t){return jP(e,t)}drawLine(e,t){const i=document.createElementNS("http://www.w3.org/2000/svg","line");this.setSvgStyle(i,t);const n=t.x+t.width*t.pivotX,s=t.y+t.height*t.pivotY,r={id:t.id,x1:t.startPoint.x+t.x,y1:t.startPoint.y+t.y,x2:t.endPoint.x+t.x,y2:t.endPoint.y+t.y,stroke:t.stroke,"stroke-width":t.strokeWidth.toString(),opacity:t.opacity.toString(),transform:"rotate("+t.angle+" "+n+" "+s+")",visibility:t.visible?"visible":"hidden"};t.class&&(r.class=t.class),WP(i,r),e.appendChild(i)}drawCircle(e,t,i,n){const s=document.createElementNS("http://www.w3.org/2000/svg","circle");this.setSvgStyle(s,t);let r=t.class||"";i||(r+=" e-disabled");const o={id:t.id,cx:t.centerX,cy:t.centerY,r:t.radius,visibility:t.visible?"visible":"hidden",class:r,"aria-label":n?n["aria-label"]:""};s.style.display=t.visible?"block":"none",WP(s,o),e.appendChild(s)}drawPath(e,t,i,n,s,r){let o,a,l=[];l=ob(t.data),l=lb(l),t.shadow&&this.renderShadow(t,e,l,s),s&&!t.shadow&&(o=s.getElementById(t.id+"_groupElement_shadow"),o&&o.parentNode.removeChild(o)),s&&(a=s.getElementById(t.id)),a&&!n||(a=document.createElementNS("http://www.w3.org/2000/svg","path"),e.appendChild(a)),this.renderPath(a,t,l);const h={id:t.id,transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")translate("+t.x+","+t.y+")",visibility:t.visible?"visible":"hidden",opacity:t.opacity,"aria-label":r||""};t.class&&(h.class=t.class),WP(a,h),this.setSvgStyle(a,t,i)}renderPath(e,t,i){let n,s,r,o,a,l,h,c;const d=i;let p="";for(a=0,l=0,c=0,h=d.length;c<h;++c){const e=d[c];switch("x1"in e&&(n=e.x1),"x2"in e&&(r=e.x2),"y1"in e&&(s=e.y1),"y2"in e&&(o=e.y2),"x"in e&&(a=e.x),"y"in e&&(l=e.y),e.command){case"M":p=p+"M"+a.toString()+","+l.toString()+" ";break;case"L":p=p+"L"+a.toString()+","+l.toString()+" ";break;case"C":p=p+"C"+n.toString()+","+s.toString()+","+r.toString()+","+o.toString()+",",p+=a.toString()+","+l.toString()+" ";break;case"Q":p=p+"Q"+n.toString()+","+s.toString()+","+a.toString()+","+l.toString()+" ";break;case"A":p=p+"A"+e.r1.toString()+","+e.r2.toString()+","+e.angle.toString()+",",p+=e.largeArc.toString()+","+e.sweep+","+a.toString()+","+l.toString()+" ";break;case"Z":case"z":p+="Z "}}e.setAttribute("d",p)}setSvgFontStyle(e,t){e.style.fontStyle=t.italic?"italic":"normal",e.style.fontWeight=t.bold?"bold":"normal",e.style.fontSize=t.fontSize.toString()+"px",e.style.fontFamily=t.fontFamily}drawText(e,t,i,n,s,r,o){if(void 0!==t.content){let r,a,l,h,c,d,p,u=0,g=0,m=0;if(i&&(p=i.getElementById(t.id+"_text")),p){if(t.doWrap)for(;p.firstChild;)p.removeChild(p.firstChild)}else t.doWrap=!0,p=document.createElementNS("http://www.w3.org/2000/svg","text"),"pre-wrap"===t.whiteSpace&&p.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),e.appendChild(p);let f=t.x+t.width*t.pivotX,y=t.y+t.height*t.pivotY,b=0;if(t.doWrap||"Wrap"!==t.textOverflow){const e=document.getElementById(t.id+"_text");for(e&&(e.innerHTML=""),this.setSvgStyle(p,t,s),this.setSvgFontStyle(p,t),r=document.createTextNode(t.content),a=t.childNodes,l=t.wrapBounds,h=this.svgLabelAlign(t,l,a),l.width>t.width&&"Wrap"!==t.textOverflow&&"NoWrap"===t.textWrapping&&(a[0].text=rO(t.content,t)),m=0;m<a.length;m++)if(d=document.createElementNS("http://www.w3.org/2000/svg","tspan"),r=document.createTextNode(a[m].text),c=a[m],c.x=VP(c,a,m,t),u=h.x+c.x-l.x,g=h.y+c.dy*m+.8*t.fontSize,"Clip"!==t.textOverflow&&"Ellipsis"!==t.textOverflow||"WrapWithOverflow"!==t.textWrapping&&"Wrap"!==t.textWrapping||!o)this.setText(p,d,c,r,u,g);else{const e=t.isHorizontalLane?o.actualSize.width:o.actualSize.height;if(!(g<e))break;"Ellipsis"===t.textOverflow&&a[m+1]&&h.y+a[m+1].dy*(m+1)+.8*t.fontSize>e&&(c.text=c.text.slice(0,c.text.length-3),c.text=c.text.concat("..."),r.data=c.text),this.setText(p,d,c,r,u,g),b+=c.dy}}b&&t.isHorizontalLane&&(f=t.parentOffsetX+t.pivotX,y=t.parentOffsetY+t.pivotY,t.y=t.parentOffsetY-b*t.pivotY+.5),t.textDecoration&&"LineThrough"===t.textDecoration&&(t.textDecoration=iO(t.textDecoration)),WP(p,{id:t.id+"_text",fill:t.color,visibility:t.visible?"visible":"hidden","text-decoration":t.textDecoration,transform:"rotate("+t.angle+","+f+","+y+")translate("+t.x+","+t.y+")",opacity:t.opacity,"aria-label":n||""})}}setText(e,t,i,n,s,r){WP(t,{x:s.toString(),y:r.toString()}),e.setAttribute("fill",i.text),t.appendChild(n),e.appendChild(t)}drawImage(e,t,i,n){let s;i&&(s=i.getElementById(t.id+"image")),s||(s=document.createElementNS("http://www.w3.org/2000/svg","image"),e.appendChild(s));const r=new Image;r.src=t.source;let o="None"!==t.scale?t.scale:"";const a=t.alignment;let l=a.charAt(0).toLowerCase()+a.slice(1);"Stretch"!==o&&(l+=" "+o.charAt(0).toLowerCase()+o.slice(1)),WP(s,{id:t.id+"image",x:t.x.toString(),y:t.y.toString(),transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")",width:t.width.toString(),visibility:t.visible?"visible":"hidden",height:t.height.toString(),preserveAspectRatio:l,opacity:(t.opacity||1).toString()}),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r.src.toString())}drawHTMLContent(e,t,i,n,s){let r,o;if(t){let i,n,s;for(i=0;i<t.childNodes.length;i++)for(s=t.childNodes[i],n=0;n<s.childNodes.length;n++)if(s.childNodes[n].id===e.id+"_html_element"){r=s.childNodes[n];break}}if(!r){o=t.querySelector("#"+e.id+"_html_element")||t.querySelector("#"+e.nodeId+"_html_element"),o||(o=kP("div",{id:e.nodeId+"_html_element",class:"foreign-object"})),r=kP("div",{id:e.id+"_html_element",class:"foreign-object"});let i=!1;t.parentNode&&t.parentNode.parentNode&&t.parentNode.parentNode.parentNode&&t.parentNode.parentNode.parentNode.classList.contains("e-overview")&&(i=!0),r.appendChild(i?e.template.cloneNode(!0):e.isTemplate?e.template:e.template.cloneNode(!0)),void 0!==s&&t.childNodes.length>s&&t.insertBefore(r,t.childNodes[s]),o.appendChild(r),t.appendChild(o)}const a=ZP(e).topLeft;r.setAttribute("style","height:"+e.actualSize.height+"px; width:"+e.actualSize.width+"px;left:"+a.x+"px; top:"+a.y+"px;position:absolute;transform:rotate("+(e.rotateAngle+e.parentTransform)+"deg);pointer-events:"+(n?"all":"none")+";visibility:"+(e.visible?"visible":"hidden")+";opacity:"+e.style.opacity+";")}drawNativeContent(e,t,i,n,s){let r,o;s&&(r=s.getElementById(e.id+"_native_element"),o=s.getElementById(e.id+"_clip")),r||(r=document.createElementNS("http://www.w3.org/2000/svg","g"),r.setAttribute("id",e.id+"_native_element"),r.appendChild(e.template.cloneNode(!0)),t.appendChild(r)),o&&r.removeChild(o),r.setAttribute("style","visibility:"+(e.visible?"visible":"hidden")+";opacity:"+e.style.opacity+";"),this.setNativTransform(e,r,i,n),"Slice"===e.scale&&this.drawClipPath(e,r,i,n,s),WP(r,e.description?{"aria-label":e.description}:{})}setNativTransform(e,t,i,n){const s=0!==e.contentSize.width?e.contentSize.width:1,r=0!==e.contentSize.height?e.contentSize.height:1;t.setAttribute("transform","rotate("+e.parentTransform+","+e.offsetX+","+e.offsetY+") translate("+(e.offsetX-e.templatePosition.x*n/s-n*e.pivot.x)+","+(e.offsetY-e.templatePosition.y*i/r-i*e.pivot.y)+") scale("+n/s+","+i/r+")")}drawClipPath(e,t,i,n,s){const r=e.contentSize.width,o=e.contentSize.height,a=e.width/(n/r),l=e.height/(i/o),h=e.templatePosition.x+(e.width>=e.height?0:(r-a)/2),c=e.templatePosition.y+(e.height>=e.width?0:(o-l)/2);let d=s.getElementById(e.id+"_clip");d=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),d.setAttribute("id",e.id+"_clip"),t.appendChild(d);let p=s.getElementById(e.id+"_clip_rect");return p=document.createElementNS("http://www.w3.org/2000/svg","rect"),d.appendChild(p),WP(p,{id:e.id+"_clip_rect",width:a.toString(),height:l.toString(),x:h.toString(),y:c.toString()}),TC()?t.setAttribute("clip-path","url("+location.protocol+"//"+location.host+location.pathname+"#"+e.id+"_clip)"):t.setAttribute("clip-path","url(#"+e.id+"_clip)"),t}renderGradient(e,t,i){let n,s,r;const o=RP(i);let a,l,h=o.getElementById(i+"gradient_pattern");if(h||(h=jP("defs",{id:i+"gradient_pattern"}),o.insertBefore(h,o.firstChild)),iC(t.id),"None"!==e.gradient.type){for(let t=0;t<e.gradient.stops.length;t++)n=n?Math.max(n,e.gradient.stops[t].offset):e.gradient.stops[t].offset,s=s?Math.min(s,e.gradient.stops[t].offset):e.gradient.stops[t].offset;"Linear"===e.gradient.type?(l=e.gradient,l.id=t.id+"_linear",r=this.createLinearGradient(l),h.appendChild(r)):(a=e.gradient,a.id=t.id+"_radial",r=this.createRadialGradient(a),h.appendChild(r));for(let t=0;t<e.gradient.stops.length;t++){const i=e.gradient.stops[t],o=s<0?(n+i.offset)/(2*n):i.offset/n,a=document.createElementNS("http://www.w3.org/2000/svg","stop");WP(a,{offset:o.toString(),style:"stop-color:"+i.color}),r.appendChild(a)}}return r}createLinearGradient(e){const t=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");return WP(t,{id:e.id,x1:e.x1+"%",y1:e.y1+"%",x2:e.x2+"%",y2:e.y2+"%"}),t}createRadialGradient(e){const t=document.createElementNS("http://www.w3.org/2000/svg","radialGradient");return WP(t,{id:e.id,cx:e.cx+"%",cy:e.cy+"%",r:e.r+"%",fx:e.fx+"%",fy:e.fy+"%"}),t}setSvgStyle(e,t,i){if(t.canApplyStyle||void 0===t.canApplyStyle){"none"===t.fill&&(t.fill="transparent"),"none"===t.stroke&&(t.stroke="transparent");let n,s=[];if(t.dashArray&&(s=(new cO).parseDashArray(t.dashArray)),t.gradient&&"None"!==t.gradient.type&&i){const s=this.renderGradient(t,e,i);n=TC()?"url("+location.protocol+"//"+location.host+location.pathname+"#"+s.id+")":"url(#"+s.id+")"}else n=t.fill;t.stroke&&e.setAttribute("stroke",t.stroke),null!=t.strokeWidth&&e.setAttribute("stroke-width",t.strokeWidth.toString()),s&&e.setAttribute("stroke-dasharray",s.toString()||"none"),n&&e.setAttribute("fill",n)}}svgLabelAlign(e,t,i){const n=new nb(t.width,i.length*(1.2*e.fontSize)),s={x:0,y:0};let r=.5*e.width;const o=.5*e.height;return"left"===e.textAlign?r=0:"center"===e.textAlign?r=t.width>e.width&&("Ellipsis"===e.textOverflow||"Clip"===e.textOverflow)&&"NoWrap"===e.textWrapping?0:.5*e.width:"right"===e.textAlign&&(r=1*e.width),s.x=0+r+(t?t.x:0),s.y=1.2+o-n.height/2,s}}class pO{constructor(e,t,i){this.renderer=null,this.isSvgMode=!0,this.transform={x:0,y:0},this.diagramId=e,this.element=PP(this.diagramId),this.svgRenderer=t,this.isSvgMode=i,this.renderer=i?new dO:new cO}setCursor(e,t){e.style.cursor=t}setLayers(){this.iconSvgLayer=this.element.getElementsByClassName("e-ports-expand-layer")[0],this.adornerSvgLayer=this.element.getElementsByClassName("e-adorner-layer")[0],this.nativeSvgLayer=this.element.getElementsByClassName("e-native-layer")[0],this.diagramSvgLayer=this.element.getElementsByClassName("e-diagram-layer")[0]}getAdornerLayer(){return AP(this.diagramId)}getParentSvg(e,t,i){return this.diagramId&&e&&e.id?e.id.split("_icon_content").length>1||e.id.split("_nodeport").length>1||e.elementActions&Yb.ElementIsPort?this.iconSvgLayer:t&&"selector"===t?this.adornerSvgLayer:e instanceof uv?this.nativeSvgLayer:this.diagramSvgLayer:i}getParentElement(e,t,i,n){let s=t;if(i&&this.diagramId&&e&&e.id){e.id.split("_icon_content").length>1?(s=i.getElementById(this.diagramId+"_diagramExpander"),t=null):e.id.split("_nodeport").length>1?s=i.getElementById(this.diagramId+"_diagramPorts"):e instanceof uv?(s=i.getElementById(this.diagramId+"_nativeLayer"),t=null):e.elementActions&Yb.ElementIsPort?(s=i.getElementById(this.diagramId+"_diagramPorts"),t=null):s=i.getElementById(this.diagramId+"_diagramLayer");const r=this.getGroupElement(e,t||s,n);s=r.g,r.svg&&(i=r.svg)}return{g:s,svg:i}}getGroupElement(e,t,i){let n;const s=this.getParentSvg(e);let r;if(t&&s){if(s&&(n=s.getElementById(e.id+"_groupElement"),!n&&s!==this.nativeSvgLayer)){const t=this.nativeSvgLayer;n=t.getElementById(e.id+"_groupElement"),r=t}n||(n=this.svgRenderer.createGElement("g",{id:e.id+"_groupElement"}),void 0!==i&&t.childNodes.length>i?t.insertBefore(n,t.childNodes[i]):t.appendChild(n))}return{g:n,svg:r}}renderElement(e,t,i,n,s,r,o,a,l){e instanceof ov?(e.id=e.id?e.id:XP(),this.renderContainer(e,t,i,n,s,r,o,a,l)):e instanceof pv?this.renderImageElement(e,t,n,s,o):e instanceof dv?this.renderPathElement(e,t,n,s,o,l):e instanceof av?this.renderTextElement(e,t,n,s,o):e instanceof uv?this.renderNativeElement(e,t,n,s,o):e instanceof vw?this.renderHTMLElement(e,t,i,n,s,o,a):this.renderRect(e,t,n,s,l)}drawSelectionRectangle(e,t,i,n,s,r){const o={width:i*r.scale,height:n*r.scale,x:.5+(e=(e+r.tx)*r.scale),y:.5+(t=(t+r.ty)*r.scale),fill:"transparent",stroke:"gray",angle:0,pivotX:.5,pivotY:.5,strokeWidth:1,dashArray:"6 3",opacity:1,visible:!0,id:s.id+"_selected_region"},a=this.getAdornerLayer();this.svgRenderer.updateSelectionRegion(a,o)}renderHighlighter(e,t,i){const n=e.actualSize.width||2,s=e.actualSize.height||2;let r=e.offsetX-n*e.pivot.x,o=e.offsetY-s*e.pivot.y;r=(r+i.tx)*i.scale,o=(o+i.ty)*i.scale,this.svgRenderer.drawRectangle(t,{width:n*i.scale,height:s*i.scale,x:r,y:o,fill:"transparent",stroke:"#8CC63F",angle:e.rotateAngle,pivotX:e.pivot.x,pivotY:e.pivot.y,strokeWidth:4,dashArray:"",opacity:1,cornerRadius:0,visible:!0,id:t.id+"_highlighter",class:"e-diagram-highlighter"},this.diagramId,void 0,void 0,t)}renderStackHighlighter(e,t,i,n,s,r,o){const a=e.actualSize.width||2;let l=e.offsetX-a*e.pivot.x;const h=e.actualSize.height||2;let c,d=e.offsetY-h*e.pivot.y;l=(l+i.tx)*i.scale;const p=e.bounds;let u="";if(d=(d+i.ty)*i.scale,n)if(r){const t=a*i.scale;c="M 0 0 L "+(t+2)+" 0 Z";let n=-p.x,r=-p.y,o=[];n=e.actualSize.width/Number(p.width?p.width:1)*i.scale,r=e.actualSize.height/Number(p.height?p.height:1)*i.scale,o=ob("M7,4 L8,4 8,7 11,7 11,8 8,8 8,11 7,11 7,8 4,8 4,7 7,7 z M7.5,0.99999994C3.9160004,1 1,3.9160004 0.99999994,7.5 1,11.084 3.9160004,14 7.5,14 11.084,14 14,11.084 14,7.5 14,3.9160004 11.084,1 7.5,0.99999994 z M7.5,0 C11.636002,0 15,3.3639984 15,7.5 15,11.636002 11.636002,15 7.5,15 3.3640003,15 0,11.636002 0,7.5 0,3.3639984 3.3640003,0 7.5,0 z"),o=pb(o),u=hb(o,n+t+2,r-8,!1,p.x,p.y,0,0),s.y>=e.offsetY&&(d+=h)}else{o&&s.y>=e.offsetY&&(d+=h);const t=a*i.scale;c="M -10 -10 L 0 0 Z M -10 10 L 0 0 Z M 0 0 L "+t+" 0 Z M "+t+" 0 L "+(t+10)+" 10 Z L "+(t+10)+" -10 Z"}else{const t=h*i.scale;c="M 10 -10 L 0 0 Z M -10 -10 L 0 0 Z M 0 0 L 0 "+t+" Z M 0  "+t+" L -10  "+(t+10)+" Z L 10  "+(t+10)+" Z",s.x>=e.offsetX&&(l+=a)}this.svgRenderer.drawPath(t,{data:c+u,width:a*i.scale,height:h*i.scale,x:l,y:d,fill:"transparent",stroke:"#8CC63F",angle:e.rotateAngle,pivotX:e.pivot.x,pivotY:e.pivot.y,strokeWidth:1,dashArray:"",opacity:1,visible:!0,id:t.id+"_stack_highlighter",class:"e-diagram-highlighter"},this.diagramId)}drawLine(e,t){this.svgRenderer.drawLine(e,t)}drawPath(e,t){this.svgRenderer.drawPath(e,t,this.diagramId)}renderResizeHandle(e,t,i,n,s,r,o,a,l,h){const c=e.offsetX-e.actualSize.width*e.pivot.x,d=e.offsetY-e.actualSize.height*e.pivot.y,p=e.actualSize.height,u=e.actualSize.width;!h&&i&Xb.Rotate&&Tx(this.rendererActions)&&!Ex(this.rendererActions)&&(this.renderPivotLine(e,t,r,s,o),this.renderRotateThumb(e,t,r,s,o)),this.renderBorder(e,t,r,a,l,h);const g=e.actualSize.width*n,m=e.actualSize.height*n;l||!Tx(this.rendererActions)||Ex(this.rendererActions)||(g>=40&&m>=40&&(s&Wb.ResizeNorthWest&&this.renderCircularHandle("resizeNorthWest",e,c,d,t,aC(s,"ResizeNorthWest"),i&Xb.ResizeNorthWest,r,void 0,o,{"aria-label":"Thumb to resize the selected object on top left side direction"},void 0,"e-diagram-resize-handle e-northwest"),s&Wb.ResizeNorthEast&&this.renderCircularHandle("resizeNorthEast",e,c+u,d,t,aC(s,"ResizeNorthEast"),i&Xb.ResizeNorthEast,r,void 0,o,{"aria-label":"Thumb to resize the selected object on top right side direction"},void 0,"e-diagram-resize-handle e-northeast"),s&Wb.ResizeSouthWest&&this.renderCircularHandle("resizeSouthWest",e,c,d+p,t,aC(s,"ResizeSouthWest"),i&Xb.ResizeSouthWest,r,void 0,o,{"aria-label":"Thumb to resize the selected object on bottom left side direction"},void 0,"e-diagram-resize-handle e-southwest"),s&Wb.ResizeSouthEast&&this.renderCircularHandle("resizeSouthEast",e,c+u,d+p,t,aC(s,"ResizeSouthEast"),i&Xb.ResizeSouthEast,r,void 0,o,{"aria-label":"Thumb to resize the selected object on bottom right side direction"},void 0,"e-diagram-resize-handle e-southeast")),s&Wb.ResizeNorth&&this.renderCircularHandle("resizeNorth",e,c+u/2,d,t,aC(s,"ResizeNorth"),i&Xb.ResizeNorth,r,void 0,o,{"aria-label":"Thumb to resize the selected object on top side direction"},void 0,"e-diagram-resize-handle e-north"),s&Wb.ResizeSouth&&this.renderCircularHandle("resizeSouth",e,c+u/2,d+p,t,aC(s,"ResizeSouth"),i&Xb.ResizeSouth,r,void 0,o,{"aria-label":"Thumb to resize the selected object on bottom side direction"},void 0,"e-diagram-resize-handle e-south"),s&Wb.ResizeWest&&this.renderCircularHandle("resizeWest",e,c,d+p/2,t,aC(s,"ResizeWest"),i&Xb.ResizeWest,r,void 0,o,{"aria-label":"Thumb to resize the selected object on left side direction"},void 0,"e-diagram-resize-handle e-west"),s&Wb.ResizeEast&&this.renderCircularHandle("resizeEast",e,c+u,d+p/2,t,aC(s,"ResizeEast"),i&Xb.ResizeEast,r,void 0,o,{"aria-label":"Thumb to resize the selected object on right side direction"},void 0,"e-diagram-resize-handle e-east"))}renderEndPointHandle(e,t,i,n,s,r,o,a){const l=e.sourcePoint,h=e.targetPoint,c=e.wrapper;let d,p;if(this.renderCircularHandle("connectorSourceThumb",c,l.x,l.y,t,aC(n,"ConnectorSourceThumb"),i&Xb.ConnectorSource,s,r,void 0,{"aria-label":"Thumb to move the source point of the connector"},void 0,"e-diagram-endpoint-handle e-targetend"),this.renderCircularHandle("connectorTargetThumb",c,h.x,h.y,t,aC(n,"ConnectorTargetThumb"),i&Xb.ConnectorTarget,s,o,void 0,{"aria-label":"Thumb to move the target point of the connector"},void 0,"e-diagram-endpoint-handle e-targetend"),a)if(("Straight"===e.type||"Bezier"===e.type)&&e.segments.length>0)for(d=0;d<e.segments.length-1;d++)p=e.segments[d],this.renderCircularHandle("segementThumb_"+(d+1),c,p.point.x,p.point.y,t,!0,i&Xb.ConnectorSource,s,r,null,null,d);else for(d=0;d<e.segments.length;d++)this.renderOrthogonalThumbs("orthoThumb_"+(d+1),c,e.segments[d],t,aC(n,"ConnectorSourceThumb"),s);if("Bezier"===e.type)for(d=0;d<e.segments.length;d++){const r=e.segments[d];let o=rb.isEmptyPoint(r.point1)?r.bezierPoint1:r.point1;this.renderCircularHandle("bezierPoint_"+(d+1)+"_1",c,o.x,o.y,t,aC(n,"ConnectorSourceThumb"),i&Xb.ConnectorSource,s,void 0,void 0,{"aria-label":"Thumb to move the source point of the connector"},void 0,"e-diagram-bezier-handle e-source"),aC(n,"ConnectorSourceThumb")&&this.renderBezierLine("bezierLine_"+(d+1)+"_1",c,t,r.points[0],rb.isEmptyPoint(r.point1)?r.bezierPoint1:r.point1,s),o=rb.isEmptyPoint(r.point2)?r.bezierPoint2:r.point2,this.renderCircularHandle("bezierPoint_"+(d+1)+"_2",c,o.x,o.y,t,aC(n,"ConnectorTargetThumb"),i&Xb.ConnectorTarget,s,void 0,void 0,{"aria-label":"Thumb to move the target point of the connector"},void 0,"e-diagram-bezier-handle e-target"),aC(n,"ConnectorTargetThumb")&&this.renderBezierLine("bezierLine_"+(d+1)+"_2",c,t,r.points[1],rb.isEmptyPoint(r.point2)?r.bezierPoint2:r.point2,s)}}renderOrthogonalThumbs(e,t,i,n,s,r){let o,a,l,h=0;for(h=0;h<i.points.length-1;h++)l=rb.distancePoints(i.points[h],i.points[h+1]),o=i.points[h].y.toFixed(2)===i.points[h+1].y.toFixed(2)?"horizontal":"vertical",a=!!(l>=50&&i.allowDrag),this.renderOrthogonalThumb(e+"_"+(h+1),t,(i.points[h].x+i.points[h+1].x)/2,(i.points[h].y+i.points[h+1].y)/2,n,a,o,r)}renderOrthogonalThumb(e,t,i,n,s,r,o,a){let l,h,c;"horizontal"===o?(l="M0,7 L15,0 L30,7 L15,14 z",h=-15,c=-7):(l="M7,0 L0,15 L7,30 L14,15 z",h=-7,c=-15),this.svgRenderer.drawPath(s,{x:(i+a.tx)*a.scale+h,y:(n+a.ty)*a.scale+c,angle:0,fill:"#e2e2e2",stroke:"black",strokeWidth:1,dashArray:"",data:l,width:20,height:20,pivotX:0,pivotY:0,opacity:1,visible:r,id:e},this.diagramId)}renderPivotLine(e,t,i,n,s){const r=e;let o=!!(n&Wb.Rotate);s&&(o=!1);const a=this.getBaseAttributes(r,i);a.fill="None",a.stroke="black",a.strokeWidth=1,a.dashArray="2,3",a.visible=o;const l=i.scale;a.x*=l,a.y*=l,a.width*=l,a.height*=l,a.id="pivotLine",a.class="e-diagram-pivot-line";const h={x:r.actualSize.width*r.pivot.x*l,y:0};a.startPoint={x:r.actualSize.width*r.pivot.x*l,y:-20},a.endPoint=h,this.svgRenderer.drawLine(t,a)}renderBezierLine(e,t,i,n,s,r){const o=this.getBaseAttributes(t,r);o.id=e,o.stroke="black",o.strokeWidth=1,o.dashArray="3,3",o.fill="None",o.class="e-diagram-bezier-line",o.x=0,o.y=0;const a=r.scale,l={x:(s.x+r.tx)*a,y:(s.y+r.ty)*a};o.startPoint={x:(n.x+r.tx)*a,y:(n.y+r.ty)*a},o.endPoint=l,this.svgRenderer.drawLine(i,o)}renderCircularHandle(e,t,i,n,s,r,o,a,l,h,c,d,p){const u=t;let g=7,m={x:i,y:n};if(0!==u.rotateAngle||0!==u.parentTransform){const e=bb();wb(e,u.rotateAngle+u.parentTransform,u.offsetX,u.offsetY),m=vb(e,m)}const f=this.getBaseAttributes(u);f.stroke="black",f.strokeWidth=1,void 0!==d?(g=5,f.id="segmentEnd_"+d,f.fill="#e2e2e2"):(g=7,f.fill=l?"#8CC63F":"white"),f.centerX=(m.x+a.tx)*a.scale,f.centerY=(m.y+a.ty)*a.scale,f.radius=g,f.angle=0,f.id=e,f.visible=r,f.class=p,l&&(f.class+=" e-connected"),h&&(f.visible=!1),this.svgRenderer.drawCircle(s,f,o,c)}renderBorder(e,t,i,n,s,r){const o=this.getBaseAttributes(e,i);o.x*=i.scale,o.y*=i.scale,o.width*=i.scale,o.height*=i.scale,o.fill="transparent",o.stroke="#097F7F",o.strokeWidth=1.2,o.gradient=null,o.dashArray="6,3",o.class="e-diagram-border",r&&(o.class+=" e-diagram-lane"),o.id="borderRect",o.id=this.rendererActions&Kb.DrawSelectorBorder?"borderRect_symbol":"borderRect",n||(o.class+=" e-disabled"),s&&(o.class+=" e-thick-border"),o.cornerRadius=0;const a=this.getParentSvg(e,"selector");this.svgRenderer.drawRectangle(t,o,this.diagramId,void 0,!0,a)}renderUserHandler(e,t,i,n){const s=e.wrapper;let r;for(const o of e.userHandles){r=!0,(o.disableConnectors&&e.connectors.length>0||o.disableNodes&&e.nodes.length>0)&&(r=!1);const a=document.getElementById(o.name+"_template_hiddenUserHandle");a&&(o.template=a.childNodes[0].cloneNode(!0));const l=rC(e,o,i);if(l.x=(l.x+i.tx)*i.scale,l.y=(l.y+i.ty)*i.scale,o.visible&&(o.visible=!!(e.constraints&Wb.UserHandle)),r)if(o.pathData){const e=o.pathData?o.pathData:o.content,i=this.getBaseAttributes(s);i.id=o.name+"_userhandle",i.fill=o.backgroundColor,i.stroke=o.borderColor,i.strokeWidth=o.borderWidth,i.centerX=l.x,i.centerY=l.y,i.radius=.5*o.size,i.class="e-diagram-userhandle-circle",i.angle=0,i.visible=o.visible,i.opacity=1,this.svgRenderer.drawCircle(t,i,1,{"aria-label":o.name+"user handle"});const n=5;let r=[];r=ob(e),r=pb(r);let a=wP(e);const h=hb(r,(o.size-.45*o.size)/a.width,(o.size-.45*o.size)/a.height,!0,a.x,a.y,0,0);a=wP(h),this.svgRenderer.drawPath(t,{x:l.x-a.width/2,y:l.y-a.height/2,angle:0,id:"",class:"e-diagram-userhandle-path",fill:o.pathColor,stroke:o.backgroundColor,strokeWidth:.5,dashArray:"",data:h,width:o.size-n,height:o.size-n,pivotX:0,pivotY:0,opacity:1,visible:o.visible},this.diagramId,void 0,void 0,{"aria-label":o.name+"user handle"})}else if(o.content){const e=new uv(o.name,this.diagramId);e.content=o.content,e.offsetX=l.x,e.offsetY=l.y,e.id=o.name+"_shape",e.horizontalAlignment="Center",e.verticalAlignment="Center",e.visible=o.visible,e.setOffsetWithRespectToBounds(l.x,l.y,"Fraction"),e.relativeMode="Object",e.description=o.name||"User handle",e.measure(new nb(o.size,o.size)),e.arrange(e.desiredSize),this.svgRenderer.drawNativeContent(e,t,o.size,o.size,this.adornerSvgLayer)}else if(o.source){const e=new pv,n=this.getBaseAttributes(e,i);n.width=o.size,n.height=o.size,n.x=l.x-o.size/2,n.y=l.y-o.size/2,n.sourceWidth=o.size,n.sourceHeight=o.size,n.alignment=e.imageAlign,n.source=o.source,n.scale=e.imageScale,n.visible=o.visible,n.description=o.name||"User handle",n.id=o.name+"_",this.renderer.drawImage(t,n,this.adornerSvgLayer,!1)}else{const e=new vw(o.name,this.diagramId);e.offsetX=l.x,e.offsetY=l.y,e.id=o.name+"_shape",e.visible=o.visible,e.relativeMode="Object",e.template=o.template,e.measure(new nb(o.size,o.size)),e.arrange(e.desiredSize),this.svgRenderer.drawHTMLContent(e,n,void 0,!0,void 0)}}}renderRotateThumb(e,t,i,n,s){let r;new dv;const o=new nb;o.width=18,o.height=16;let a=!!(n&Wb.Rotate);s&&(a=!1);let l=e.offsetX-e.actualSize.width*e.pivot.x+e.pivot.x*e.actualSize.width,h=e.offsetY-e.actualSize.height*e.pivot.y;if(l=(l+i.tx)*i.scale,h=(h+i.ty)*i.scale,r={x:l-.5*o.width,y:h-30-.5*o.height},0!==e.rotateAngle||0!==e.parentTransform){const t=bb();wb(t,e.rotateAngle+e.parentTransform,(i.tx+e.offsetX)*i.scale,(i.ty+e.offsetY)*i.scale),r=vb(t,r)}const c={x:r.x,y:r.y,angle:e.rotateAngle+e.parentTransform,fill:"#231f20",stroke:"black",strokeWidth:.5,dashArray:"",data:"M 16.856144362449648 10.238890446662904 L 18.000144362449646 3.437890446662903L 15.811144362449646 4.254890446662903 C 14.837144362449646 2.5608904466629028 13.329144362449647  1.2598904466629026 11.485144362449645 0.5588904466629026 C 9.375144362449646 - 0.24510955333709716 7.071144362449646  - 0.18010955333709716 5.010144362449646 0.7438904466629028 C 2.942144362449646 1.6678904466629028 1.365144362449646 3.341890446662903 0.558144362449646 5.452890446662903 C - 0.244855637550354 7.567890446662903 - 0.17985563755035394 9.866890446662904 0.7431443624496461 11.930890446662904 C 1.6681443624496461 13.994890446662904 3.343144362449646 15.575890446662903 5.457144362449647 16.380890446662903 C 6.426144362449647 16.7518904466629 7.450144362449647 16.9348904466629 8.470144362449647 16.9348904466629 C 9.815144362449647 16.9348904466629 11.155144362449647 16.6178904466629 12.367144362449647 15.986890446662901 L 11.351144362449647 14.024890446662901 C 9.767144362449647 14.8468904466629 7.906144362449647 14.953890446662902 6.237144362449647 14.3178904466629 C 4.677144362449647 13.7218904466629 3.444144362449647 12.5558904466629 2.758144362449647 11.028890446662901 C 2.078144362449646 9.501890446662903 2.031144362449646 7.802890446662903 2.622144362449646 6.243890446662903 C 3.216144362449646 4.6798904466629025 4.387144362449646 3.442890446662903 5.914144362449646 2.760890446662903 C 7.437144362449646 2.078890446662903 9.137144362449646 2.0298904466629026 10.700144362449645 2.6258904466629027 C 11.946144362449646 3.100890446662903 12.971144362449646 3.9538904466629026 13.686144362449646 5.049890446662903 L 11.540144362449645 5.850890446662903 L 16.856144362449648 10.238890446662904 Z",width:20,height:20,pivotX:0,pivotY:0,opacity:1,visible:a,id:e.id,class:"e-diagram-rotate-handle"};c.id="rotateThumb",this.svgRenderer.drawPath(t,c,this.diagramId,!0,void 0,{"aria-label":"Thumb to rotate the selected object"})}renderPathElement(e,t,i,n,s,r){const o=this.getBaseAttributes(e,i,r);o.data=e.absolutePath,o.data=e.absolutePath;const a=e.description?e.description:e.id;this.isSvgMode||(o.x=e.flipOffset.x?e.flipOffset.x:o.x,o.y=e.flipOffset.y?e.flipOffset.y:o.y),e.isExport&&(o.data=SP(e,e.absoluteBounds,0,o)),this.renderer.drawPath(t,o,this.diagramId,void 0,n,a)}renderSvgGridlines(e,t,i,n,s,r){const o=document.createElementNS("http://www.w3.org/2000/svg","pattern"),a=document.createElementNS("http://www.w3.org/2000/svg","defs");a.setAttribute("id",this.diagramId+"_grid_pattern_defn"),(e.constraints&Bb.ShowHorizontalLines||e.constraints&Bb.ShowVerticalLines)&&o.setAttribute("id",this.diagramId+"_pattern");let l=0,h=0,c=0,d=0,p=1,u=!1;const g="Lines"===e.gridType,m=g?e.verticalGridlines.lineIntervals:e.verticalGridlines.dotIntervals,f=g?e.horizontalGridlines.lineIntervals:e.horizontalGridlines.dotIntervals;if(n.showRulers&&n.dynamicGrid&&s&&r)c=r.updateSegmentWidth(i.scale),d=s.updateSegmentWidth(i.scale),e.horizontalGridlines.scaledIntervals=[c/s.interval],e.verticalGridlines.scaledIntervals=[d/r.interval],u=!0;else{for(let e=0;e<m.length;e+=1)l+=m[e];for(let e=0;e<f.length;e+=1)h+=f[e];p=this.scaleSnapInterval(e,i.scale)}l=u?d:l*p,h=u?c:h*p,WP(o,{id:this.diagramId+"_pattern",x:0,y:0,width:l,height:h,patternUnits:"userSpaceOnUse"}),this.horizontalSvgGridlines(o,l,h,p,e,n,r,u,g,f),this.verticalSvgGridlines(o,l,h,p,e,n,s,u,g,m),a.appendChild(o),t.appendChild(a)}horizontalSvgGridlines(e,t,i,n,s,r,o,a,l,h){let c,d=0,p=[];if(s.constraints&Bb.ShowHorizontalLines){s.horizontalGridlines.lineDashArray&&(p=this.renderer.parseDashArray(s.horizontalGridlines.lineDashArray)),r.showRulers&&r.dynamicGrid&&o&&(h=this.updateLineIntervals(h,r,o,i,l)),h=zS(h,l);for(let i=0;i<h.length;i+=2){d=RS(h,l,i,d);const r=0;let o;c=document.createElementNS("http://www.w3.org/2000/svg",l?"path":"circle");let u=l?d+h[i]/2:d;u=a?u:u*n,l?(o=""===p.toString()?{"stroke-width":h[i],d:"M0,"+u+" L"+t+","+u+" Z",class:1.25===h[i]?"e-diagram-thick-grid":"e-diagram-thin-grid",stroke:s.horizontalGridlines.lineColor}:{"stroke-width":h[i],stroke:s.horizontalGridlines.lineColor,d:"M0,"+u+" L"+t+","+u+" Z",class:1.25===h[i]?"e-diagram-thick-grid":"e-diagram-thin-grid",dashArray:p.toString()},WP(c,o),e.appendChild(c),d+=h[i+1]+h[i]):(this.renderDotGrid(i,e,s,r,u,n,!0),d+=h[i])}}}renderDotGrid(e,t,i,n,s,r,o){let a,l,h,c,d=o?i.verticalGridlines.dotIntervals:i.horizontalGridlines.dotIntervals;d=zS(d,!1);for(let p=1;p<d.length;p+=2)a=p===d.length-1?d[0]:d[p-1],l=document.createElementNS("http://www.w3.org/2000/svg","circle"),h=n,h*=r,c={cx:o?h:s,cy:o?s:h,fill:i.horizontalGridlines.lineColor,r:a},WP(l,c),t.appendChild(l),n+=d[p]+d[p-1]}verticalSvgGridlines(e,t,i,n,s,r,o,a,l,h){let c,d=0,p=[];if(s.constraints&Bb.ShowVerticalLines){s.verticalGridlines.lineDashArray&&(p=this.renderer.parseDashArray(s.verticalGridlines.lineDashArray)),r.showRulers&&r.dynamicGrid&&o&&(h=this.updateLineIntervals(h,r,o,t,l));const u=0;h=zS(h,l);for(let t=0;t<h.length;t+=2){d=RS(h,l,t,d);let r,o=l?d+h[t]/2:d;o=a?o:o*n,c=document.createElementNS("http://www.w3.org/2000/svg",l?"path":"circle"),l?(r=""===p.toString()?{"stroke-width":h[t],d:"M"+o+",0 L"+o+","+i+" Z",class:1.25===h[t]?"e-diagram-thick-grid":"e-diagram-thin-grid",stroke:s.verticalGridlines.lineColor}:{"stroke-width":h[t],class:1.25===h[t]?"e-diagram-thick-grid":"e-diagram-thin-grid",stroke:s.verticalGridlines.lineColor,d:"M"+o+",0 L"+o+","+i+" Z",dashArray:p.toString()},WP(c,r),e.appendChild(c),d+=h[t+1]+h[t]):(this.renderDotGrid(t,e,s,u,o,n,!1),d+=h[t])}}}updateGrid(e,t,i,n,s,r){const o=t.getElementById(this.diagramId+"_grid_rect");let a=!1;if(o){let l=t.getElementById(this.diagramId+"_pattern");l&&l.parentNode.removeChild(l);let h=0,c=0,d=1;const p="Lines"===e.gridType,u=p?e.verticalGridlines.lineIntervals:e.verticalGridlines.dotIntervals,g=p?e.horizontalGridlines.lineIntervals:e.horizontalGridlines.dotIntervals;n.showRulers&&n.dynamicGrid&&r&&s?(h=r.updateSegmentWidth(i.scale),c=s.updateSegmentWidth(i.scale),a=!0,e.horizontalGridlines.scaledIntervals=[h/s.interval],e.verticalGridlines.scaledIntervals=[c/r.interval]):d=this.scaleSnapInterval(e,i.scale);let m=0;for(let e=0;e<g.length;e+=1)m+=g[e];let f=0;for(let e=0;e<u.length;e+=1)f+=u[e];let y={x:-i.tx*i.scale,y:-i.ty*i.scale};WP(o,y),f=a?c:f*d,m=a?h:m*d,y={id:this.diagramId+"_pattern",x:0,y:0,width:f,height:m,patternUnits:"userSpaceOnUse"},l=document.createElementNS("http://www.w3.org/2000/svg","pattern"),WP(l,y),this.horizontalSvgGridlines(l,f,m,d,e,n,r,a,p,g),this.verticalSvgGridlines(l,f,m,d,e,n,s,a,p,u);const b=t.getElementById(this.diagramId+"_grid_pattern_defn");b&&b.appendChild(l)}}updateLineIntervals(e,t,i,n,s){const r=[],o=n/i.interval,a=s?i.interval:i.interval+1;for(let l=0;l<2*a;l++)r[l]=l%2==0?s?0===l?1.25:.25:0:s?o-r[l-1]:o;return r}scaleSnapInterval(e,t){if(t>=2)for(;t>=2;)t/=2;else if(t<=.5)for(;t<=.5;)t*=2;let i;if(e.horizontalGridlines.scaledIntervals=e.horizontalGridlines.snapIntervals,e.verticalGridlines.scaledIntervals=e.verticalGridlines.snapIntervals,1!==t){let n=e.horizontalGridlines;for(n.scaledIntervals=[],i=0;i<n.snapIntervals.length;i++)n.scaledIntervals[i]=n.snapIntervals[i]*t;for(n=e.verticalGridlines,n.scaledIntervals=[],i=0;i<n.snapIntervals.length;i++)n.scaledIntervals[i]=n.snapIntervals[i]*t}return t}renderTextElement(e,t,i,n,s){const r=this.getBaseAttributes(e,i);r.cornerRadius=0,r.whiteSpace=oO(e.style.whiteSpace,e.style.textWrapping),r.content=e.content,r.breakWord=iO(e.style.textWrapping),r.textAlign=tO(e.style.textAlign),r.color=e.style.color,r.italic=e.style.italic,r.bold=e.style.bold,r.fontSize=e.style.fontSize,r.fontFamily=e.style.fontFamily,r.textOverflow=e.style.textOverflow,r.textWrapping=e.style.textWrapping,r.textDecoration=e.style.textDecoration,r.doWrap=e.doWrap,r.wrapBounds=e.wrapBounds,r.childNodes=e.childNodes,r.isHorizontalLane=e.isLaneOrientation,r.id=e.id?e.id:XP(),e.isLaneOrientation&&(r.parentOffsetX=this.groupElement.offsetX,r.parentOffsetY=this.groupElement.offsetY,r.parentWidth=this.groupElement.actualSize.width,r.parentHeight=this.groupElement.actualSize.height),r.dashArray="",r.strokeWidth=0,r.fill=e.style.fill;const o=e.description?e.description:e.content?e.content:e.id;("Wrap"===e.style.textWrapping||"WrapWithOverflow"===e.style.textWrapping)&&this.groupElement&&r.height>this.groupElement.actualSize.height&&("Clip"===e.style.textOverflow||"Ellipsis"===e.style.textOverflow)&&(r.y=r.y+(r.height-this.groupElement.actualSize.height)/2),this.renderer.drawRectangle(t,r,this.diagramId,void 0,void 0,n),this.renderer.drawText(t,r,n,o,this.diagramId,e.isExport&&Math.min(e.exportScaleValue.x||e.exportScaleValue.y),this.groupElement),this.isSvgMode&&(e.doWrap=!1)}renderNativeElement(e,t,i,n,s){let r,o;const a=this.getParentSvg(e,void 0,t)||n,l=this.getParentElement(e,t,a).g||t,h=this.getBaseAttributes(e,i);switch(h.fill="transparent",h.cornerRadius=e.cornerRadius,h.stroke="transparent",this.renderer.drawRectangle(t,h,this.diagramId,void 0,void 0,n),e.scale){case"None":r=e.contentSize.width,o=e.contentSize.height;break;case"Stretch":r=e.actualSize.width,o=e.actualSize.height;break;case"Meet":r=o=e.actualSize.width<=e.actualSize.height?e.actualSize.width:e.actualSize.height;break;case"Slice":r=o=e.actualSize.width>=e.actualSize.height?e.actualSize.width:e.actualSize.height}this.svgRenderer&&this.svgRenderer.drawNativeContent(e,l,o,r,a)}renderHTMLElement(e,t,i,n,s,r,o){const a=this.getBaseAttributes(e,n);a.fill="transparent",a.cornerRadius=e.cornerRadius,a.stroke="transparent",this.renderer.drawRectangle(t,a,this.diagramId,void 0,void 0,s),this.svgRenderer&&this.svgRenderer.drawHTMLContent(e,i.children[0],n,function(e){let t=e.parentElement;do{if(HP(t,"e-diagram"))return!0;t=t.parentElement}while(t);return!1}(i),o)}renderImageElement(e,t,i,n,s){const r=this.getBaseAttributes(e,i);let o,a,l,h;if(r.cornerRadius=0,this.renderer.drawRectangle(t,r,this.diagramId,void 0,void 0,n),"Stretch"===e.stretch)o=e.actualSize.width,a=e.actualSize.height;else{const t=e.contentSize.width,i=e.contentSize.height;let n,s=r.width/t,c=r.height/i;switch(e.stretch){case"Meet":n=Math.min(s,c),o=t*n,a=i*n,r.x+=Math.abs(r.width-o)/2,r.y+=Math.abs(r.height-a)/2;break;case"Slice":s=r.width/t,c=r.height/i,n=Math.max(s,c),o=t*n,a=i*n,l=r.width/o*t,h=r.height/a*i;break;case"None":o=t,a=i}}r.width=o,r.height=a,r.sourceWidth=l,r.sourceHeight=h,r.source=e.source,r.alignment=e.imageAlign,r.scale=e.imageScale,r.description=e.description?e.description:e.id,this.renderer.drawImage(t,r,n,s)}renderContainer(e,t,i,n,s,r,o,a,l){const h={svg:s,g:t};if(this.diagramId&&(s=this.getParentSvg(e)||s,this.isSvgMode)){const i=this.getParentElement(e,t,s,a).g||t;s=this.getParentSvg(this.hasNativeParent(e.children))||s;const n=this.getParentElement(this.hasNativeParent(e.children),i,s,a);h.svg=n.svg||s,h.g=n.g||i,r?(s&&(s.getElementById(h.g.id)||t.appendChild(h.g)),t=h.g):t=h.g}if(this.renderRect(e,t,n,s),this.groupElement=e,e.hasChildren()){let r,h,c;for(const d of e.children)s=this.getParentSvg(this.hasNativeParent(e.children)||d)||s,this.isSvgMode&&(h=this.getParentElement(this.hasNativeParent(e.children)||d,t,s),r=h.g||t,h.svg&&(s=h.svg)),this.isSvgMode||(d.flip=e.flip),this.renderElement(d,r||t,i,n,s,!0,o,a,l),d instanceof av&&r&&!(e.elementActions&Yb.ElementIsGroup)&&(c=d.flip&&"None"!==d.flip?d.flip:e.flip,this.renderFlipElement(d,r,c)),d.elementActions&Yb.ElementIsPort&&r&&(c=d.flip&&"None"!==d.flip?d.flip:e.flip,this.renderFlipElement(e,r,c)),!(d instanceof av)&&"None"!==e.flip&&e.elementActions&Yb.ElementIsGroup&&this.renderFlipElement(d,r||t,e.flip);e.elementActions&Yb.ElementIsGroup||this.renderFlipElement(e,t,e.flip)}}renderFlipElement(e,t,i){let n={},s=1,r=1,o=0,a=0,l=0,h=0;if("None"!==i?("Horizontal"!==i&&"Both"!==i||(o=e.bounds.center.x,l=-e.bounds.center.x,s=-1),"Vertical"!==i&&"Both"!==i||(a=e.bounds.center.y,h=-e.bounds.center.y,r=-1),n={transform:"translate("+o+","+a+") scale("+s+","+r+") translate("+l+","+h+")"}):n={transform:"translate(0,0)"},n)if(e&&e.children&&e.children.length&&e.children[0]instanceof vw){const i=t.id.split("_preview");(t=(document.getElementById(i[0]+"_html_div")||LP(this.diagramId).children[0]).querySelector("#"+e.id+"_content_html_element"))&&(t.style.transform="scale("+s+","+r+")rotate("+(e.rotateAngle+e.parentTransform)+"deg)")}else WP(t,n)}hasNativeParent(e,t){if(e&&e.length>0){const i=e[0];if(i instanceof uv)return i;i.children&&i.children.length&&this.hasNativeParent(i.children,t++||0)}}renderRect(e,t,i,n,s){const r=this.getBaseAttributes(e,i,s);r.cornerRadius=e.cornerRadius||0,this.renderer.drawRectangle(t,r,this.diagramId,void 0,void 0,n,e.description?e.description:e.id)}drawRect(e,t){t.cornerRadius=0,this.svgRenderer.drawRectangle(e,t,this.diagramId)}getBaseAttributes(e,t,i){const n={width:e.actualSize.width,height:e.actualSize.height,x:e.offsetX-e.actualSize.width*e.pivot.x+.5,y:e.offsetY-e.actualSize.height*e.pivot.y+.5,fill:e.style.fill,stroke:e.style.strokeColor,angle:e.rotateAngle+e.parentTransform,pivotX:e.pivot.x,pivotY:e.pivot.y,strokeWidth:e.style.strokeWidth,dashArray:e.style.strokeDashArray||"",opacity:e.style.opacity,shadow:e.shadow,gradient:e.style.gradient,visible:e.visible,id:e.id,description:e.description,canApplyStyle:e.canApplyStyle};return i&&(n.x=n.x-.5,n.y=n.y-.5),e.isExport&&(n.width*=e.exportScaleValue.x,n.height*=e.exportScaleValue.y,n.x*=e.exportScaleValue.x,n.y*=e.exportScaleValue.y,n.strokeWidth*=e.exportScaleValue.x),e.flip&&(n.flip=e.flip),t&&(n.x+=t.tx,n.y+=t.ty),n}static renderSvgBackGroundImage(e,t,i,n,s,r){if(e.source){let o=RP(t.id).getElementById(t.id+"_image");if(!o){const e=function(e){let t=null;return t=PP(e).getElementsByClassName("e-background-image-layer")[0],t}(t.id);o=document.createElementNS("http://www.w3.org/2000/svg","image"),o.setAttribute("id",t.id+"_image"),e.appendChild(o)}const a=new Image;a.src=e.source,o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a.src.toString());const l="None"!==e.scale?e.scale:"",h=e.align;let c=h.charAt(0).toLowerCase()+h.slice(1);l&&(c+=" "+l.charAt(0).toLowerCase()+l.slice(1)),WP(o,{id:t.id+"_image",x:i,y:n,width:s,height:r,preserveAspectRatio:c})}}transformLayers(e,t){const i=e.tx*e.scale,n=e.ty*e.scale;return(i!==this.transform.x||n!==this.transform.y||0===i||0===n)&&(t&&(window.domTable[this.diagramId+"_diagramLayer"]||(window.domTable[this.diagramId+"_diagramLayer"]=this.diagramSvgLayer.getElementById(this.diagramId+"_diagramLayer")),window.domTable[this.diagramId+"_diagramLayer"].setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+"),scale("+e.scale+")")),function(e){let t=null;return window.domTable[e+"_gridline"]?t=window.domTable[e+"_gridline"]:(t=MP(e).getElementById(e+"_gridline"),window.domTable[e+"_gridline"]=t),t}(this.diagramId).setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+")"),window.domTable[this.diagramId+"_diagramPorts"]||(window.domTable[this.diagramId+"_diagramPorts"]=this.iconSvgLayer.getElementById(this.diagramId+"_diagramPorts")),window.domTable[this.diagramId+"_diagramPorts"].setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+"),scale("+e.scale+")"),window.domTable[this.diagramId+"_diagramExpander"]||(window.domTable[this.diagramId+"_diagramExpander"]=this.iconSvgLayer.getElementById(this.diagramId+"_diagramExpander")),window.domTable[this.diagramId+"_diagramExpander"].setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+"),scale("+e.scale+")"),window.domTable[this.diagramId+"_nativeLayer"]||(window.domTable[this.diagramId+"_nativeLayer"]=this.nativeSvgLayer.getElementById(this.diagramId+"_nativeLayer")),window.domTable[this.diagramId+"_nativeLayer"].setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+"),scale("+e.scale+")"),LP(this.diagramId).children[0].style.transform="translate("+e.tx*e.scale+"px,"+e.ty*e.scale+"px)scale("+e.scale+")",this.transform={x:e.tx*e.scale,y:e.ty*e.scale},!0)}updateNode(e,t,i,n,s){this.renderElement(e,t,i,n,this.getParentSvg(e),void 0,void 0,s)}}var uO=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let gO=(()=>{class e extends bg{}return uO([ig("")],e.prototype,"source",void 0),uO([ig("transparent")],e.prototype,"color",void 0),uO([ig("None")],e.prototype,"scale",void 0),uO([ig("None")],e.prototype,"align",void 0),e})(),mO=(()=>{class e extends bg{}return uO([ig("Page")],e.prototype,"mode",void 0),uO([ig("PageSettings")],e.prototype,"region",void 0),uO([ng({top:25,bottom:25,left:25,right:25},Ib)],e.prototype,"margin",void 0),uO([ig(!1)],e.prototype,"canZoomIn",void 0),uO([ig(void 0)],e.prototype,"customBounds",void 0),uO([ig(!1)],e.prototype,"canFit",void 0),e})(),fO=(()=>{class e extends bg{}return uO([ig(null)],e.prototype,"width",void 0),uO([ig(null)],e.prototype,"height",void 0),uO([ng({},Ib)],e.prototype,"margin",void 0),uO([ig("Landscape")],e.prototype,"orientation",void 0),uO([ig("Infinity")],e.prototype,"boundaryConstraints",void 0),uO([ng({},gO)],e.prototype,"background",void 0),uO([ig(!1)],e.prototype,"multiplePage",void 0),uO([ig(!1)],e.prototype,"showPageBreaks",void 0),uO([ng({},mO)],e.prototype,"fitOptions",void 0),e})(),yO=(()=>{class e extends bg{}return uO([ig(0)],e.prototype,"horizontalOffset",void 0),uO([ig(0)],e.prototype,"verticalOffset",void 0),uO([ig(1)],e.prototype,"currentZoom",void 0),uO([ig(0)],e.prototype,"viewPortWidth",void 0),uO([ig(0)],e.prototype,"viewPortHeight",void 0),uO([ig(.2)],e.prototype,"minZoom",void 0),uO([ig(30)],e.prototype,"maxZoom",void 0),uO([ig("Diagram")],e.prototype,"scrollLimit",void 0),uO([ig()],e.prototype,"scrollableArea",void 0),uO([ig(!1)],e.prototype,"canAutoScroll",void 0),uO([ng({left:15,right:15,top:15,bottom:15},Ib)],e.prototype,"autoScrollBorder",void 0),uO([ng({left:0,right:0,top:0,bottom:0},Ib)],e.prototype,"padding",void 0),e})();class bO{constructor(){this.services={}}register(e,t){this.services[e]=t}getService(e){return this.services[e]}}var vO=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let wO=(()=>{class e extends bg{}return vO([ig("lightgray")],e.prototype,"lineColor",void 0),vO([ig("")],e.prototype,"lineDashArray",void 0),vO([ig([1.25,18.75,.25,19.75,.25,19.75,.25,19.75,.25,19.75])],e.prototype,"lineIntervals",void 0),vO([ig([1,19,.5,19.5,.5,19.5,.5,19.5,.5,19.5])],e.prototype,"dotIntervals",void 0),vO([ig([20])],e.prototype,"snapIntervals",void 0),e})(),xO=(()=>{class e extends bg{}return vO([ng({},wO)],e.prototype,"horizontalGridlines",void 0),vO([ng({},wO)],e.prototype,"verticalGridlines",void 0),vO([ig(Bb.All)],e.prototype,"constraints",void 0),vO([ig(5)],e.prototype,"snapAngle",void 0),vO([ig("Lines")],e.prototype,"gridType",void 0),vO([ig(5)],e.prototype,"snapObjectDistance",void 0),e})();var SO=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let CO=(()=>{class e extends bg{}return SO([ig(5)],e.prototype,"interval",void 0),SO([ig(100)],e.prototype,"segmentWidth",void 0),SO([ig("Horizontal")],e.prototype,"orientation",void 0),SO([ig("RightOrBottom")],e.prototype,"tickAlignment",void 0),SO([ig("red")],e.prototype,"markerColor",void 0),SO([ig(25)],e.prototype,"thickness",void 0),SO([ig(null)],e.prototype,"arrangeTick",void 0),e})(),PO=(()=>{class e extends bg{}return SO([ig(!1)],e.prototype,"showRulers",void 0),SO([ig(!0)],e.prototype,"dynamicGrid",void 0),SO([ng({orientation:"Horizontal"},CO)],e.prototype,"horizontalRuler",void 0),SO([ng({orientation:"Vertical"},CO)],e.prototype,"verticalRuler",void 0),e})();var OO=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let TO=(()=>{class e extends bg{}return OO([ig("")],e.prototype,"property",void 0),OO([ig("")],e.prototype,"field",void 0),e})();var EO=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let AO=(()=>{class e extends bg{}return EO([ig("")],e.prototype,"read",void 0),EO([ig("")],e.prototype,"create",void 0),EO([ig("")],e.prototype,"update",void 0),EO([ig("")],e.prototype,"destroy",void 0),EO([ig()],e.prototype,"customFields",void 0),e})(),IO=(()=>{class e extends bg{}return EO([ig("")],e.prototype,"id",void 0),EO([ig("")],e.prototype,"sourceID",void 0),EO([ig("")],e.prototype,"targetID",void 0),EO([ig(null)],e.prototype,"sourcePointX",void 0),EO([ig(null)],e.prototype,"sourcePointY",void 0),EO([ig(null)],e.prototype,"targetPointX",void 0),EO([ig(null)],e.prototype,"targetPointY",void 0),EO([ig(null)],e.prototype,"dataManager",void 0),EO([ng({},AO)],e.prototype,"crudAction",void 0),e})(),DO=(()=>{class e extends bg{}return EO([ig("")],e.prototype,"id",void 0),EO([ig(null)],e.prototype,"dataManager",void 0),EO([ig(null)],e.prototype,"dataSource",void 0),EO([ig("")],e.prototype,"root",void 0),EO([ig("")],e.prototype,"parentId",void 0),EO([ig()],e.prototype,"doBinding",void 0),EO([rg([],TO)],e.prototype,"dataMapSettings",void 0),EO([ng({},AO)],e.prototype,"crudAction",void 0),EO([ng({},IO)],e.prototype,"connectionDataSource",void 0),e})();var MO=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let RO=(()=>{class e extends bg{}return MO([ig("")],e.prototype,"fixedNode",void 0),MO([ig(30)],e.prototype,"horizontalSpacing",void 0),MO([ig("SamePoint")],e.prototype,"connectionPointOrigin",void 0),MO([ig("Nonlinear")],e.prototype,"arrangement",void 0),MO([ig(30)],e.prototype,"verticalSpacing",void 0),MO([ig(30)],e.prototype,"maxIteration",void 0),MO([ig(40)],e.prototype,"springFactor",void 0),MO([ig(50)],e.prototype,"springLength",void 0),MO([ng({left:50,top:50,right:0,bottom:0},Ib)],e.prototype,"margin",void 0),MO([ig("Auto")],e.prototype,"horizontalAlignment",void 0),MO([ig("Auto")],e.prototype,"verticalAlignment",void 0),MO([ig("TopToBottom")],e.prototype,"orientation",void 0),MO([ig("Auto")],e.prototype,"connectionDirection",void 0),MO([ig("Default")],e.prototype,"connectorSegments",void 0),MO([ig("None")],e.prototype,"type",void 0),MO([ig()],e.prototype,"getLayoutInfo",void 0),MO([ig()],e.prototype,"layoutInfo",void 0),MO([ig()],e.prototype,"getBranch",void 0),MO([ig()],e.prototype,"bounds",void 0),MO([ig(!0)],e.prototype,"enableAnimation",void 0),MO([ig(!1)],e.prototype,"enableRouting",void 0),MO([ig("")],e.prototype,"root",void 0),e})();function zO(e,t,i){return e.x>=t.x-i&&e.x<=t.x+i&&e.y>=t.y-i&&e.y<=t.y+i}function LO(e){return e.selectedItems.nodes.length>0||e.selectedItems.connectors.length>0}function kO(e){return 1===e.selectedItems.connectors.length&&!e.selectedItems.nodes.length}function jO(e,t,i=!0,n){if(t instanceof bP)return!0;if(t instanceof pP)for(;t;){if(-1!==e.selectedItems.nodes.indexOf(t)&&void 0===e.selectedItems.annotation)return!0;if(i)break;t=e.nameTable[t.parentId]}else if(t instanceof Vw){if(-1!==e.selectedItems.connectors.indexOf(t)&&void 0===e.selectedItems.annotation)return!0}else if((t instanceof wv||t instanceof xv)&&e.selectedItems.annotation&&e.selectedItems.wrapper.children[0].id===n.id)return!0;return!1}const HO={None:"default",Rotate:"crosshair",Select:"default",Drag:"move",ResizeWest:"w-resize",ResizeEast:"e-resize",ResizeSouth:"s-resize",ResizeNorth:"n-resize",Draw:"crosshair",PortDraw:"crosshair",ResizeNorthEast:"ne-resize",ResizeNorthWest:"nw-resize",ResizeSouthEast:"se-resize",ResizeSouthWest:"sw-resize",ConnectorSourceEnd:"move",ConnectorTargetEnd:"move",BezierSourceThumb:"move",BezierTargetThumb:"move",OrthoThumb:"move",SegmentEnd:"move",Pan:"grab",Hyperlink:"pointer",PortDrag:"pointer",LabelSelect:"pointer",LabelDrag:"move",LabelRotate:"crosshair",LabelResizeWest:"w-resize",LabelResizeEast:"e-resize",LabelResizeSouth:"s-resize",LabelResizeNorth:"n-resize",LabelResizeNorthEast:"ne-resize",LabelResizeNorthWest:"nw-resize",LabelResizeSouthEast:"se-resize",LabelResizeSouthWest:"sw-resize"};class _O{constructor(){this.valueCreated="created",this.valueUpdated="updated",this.valueDeleted="deleted",this.valueUnchanged="unchanged",this.newNodeObject=[],this.newConnectorObject=[],this.diagramObject={}}updateObjectCollection(e,t){for(let i=0;i<e.length;i++)e[i].objects||(e[i].objects=[]),e[i].objects=t.layers[i].objects}getOldObject(e,t,i){let n=t?i.oldNodeObjects:i.oldConnectorObjects;for(let s=0;s<n.length;s++)if(n[s].id===e)return n[s]}changeSegments(e,t){for(let i of Object.keys(e))if("segments"===i){let n=this.removeNullValues(t[i]);e[i]=n}return e}removeNullValues(e){let t=[],i={};for(var n=0;n<e.length;n++)i=this.removeNullObjectValues(e[n]),t.push(i);return t}removeNullObjectValues(e){let t={};for(let i of Object.keys(e))void 0!==e[i]&&(t[i]=e[i]instanceof Object?this.removeNullObjectValues(e[i]):e[i]);return t}getDifferenceValues(e,t,i,n){let s,r,o,a,l=e instanceof pP;if(e&&(a=this.getOldObject(e.id,!!l,n),a)){let c=QP(e);if(o=this.map(c,a),s=this.frameObject({},o),r=this.removeEmptyValues(s),r=this.changeSegments(r,c),r.children&&(r.children=QP(e).children),r.ports&&r.ports.length)for(var h=0;h<r.ports.length;h++)c.ports[h].outEdges&&(r.ports[h].outEdges=c.ports[h].outEdges),c.ports[h].inEdges&&(r.ports[h].inEdges=c.ports[h].inEdges);return this.getDiagramObjects(r,e.id,l,t,i,n)}}getLayerObject(e,t,i){}getDiagramObjects(e,t,i,n,s,r){let o=0;if(o=GP(r,t),e.sfIndex=o,i?this.newNodeObject.push(e):this.newConnectorObject.push(e),n&&(n.sourceWrapper instanceof av&&s||n.portId)){let e,s;s=i?n.portId?this.newNodeObject[0].ports:this.newNodeObject[0].annotations:this.newConnectorObject[0].annotations||[];for(let o=0;o<s.length;o++)if(Object.keys(s[o]).length>0){let a=r.nameTable[t];if(e=s[o],n.portId)this.newNodeObject[0].ports=[e];else{for(let t=0;t<a.annotations.length;t++)n.sourceWrapper.id===a.id+"_"+a.annotations[t].id&&(e.sfIndex=t);i?this.newNodeObject[0].annotations=[e]:this.newConnectorObject[0].annotations=[e]}}}this.diagramObject={nodes:this.newNodeObject,connectors:this.newConnectorObject}}removeArrayValues(e){let t=[];if(JSON.stringify(e)!==JSON.stringify({data:[]}))for(let i=0;i<e.length;i++)if(e[i]instanceof Object){let n=this.removeEmptyValues(e[i]);t.push(n)}else t.push(e[i]);return t}removeEmptyValues(e){let t={};for(let i of Object.keys(e))if("wrapper"!==i&&("data"!==i||"data"===i&&!(e[i]instanceof Array))){let n=e[i],s=JSON.stringify(n);if(n instanceof Array){let e=this.removeArrayValues(n);"[]"!==JSON.stringify(e)&&(t[i]=e)}else if(n instanceof Object){if(s!==JSON.stringify({data:[]})){let e=this.removeEmptyValues(n);"{}"!==JSON.stringify(e)&&(t[i]=e)}}else s!==JSON.stringify(["data"])&&s!==JSON.stringify("data")&&s!==JSON.stringify({data:[]})&&"version"!==i&&"ejsAction"!==i&&(t[i]=e[i])}return t}map(e,t,i){if(this.isFunction(e)||this.isFunction(t))throw"Invalid argument. Function given, object expected.";if(this.isValue(e)||this.isValue(t))return{type:this.compareValues(e,t),data:void 0===e?t:e};let n={};if(this.isArray(e))for(let r=0;r<e.length;r++){n[i]||(n[i]=[]);let s=this.map(e[r],t[r]);n[i].push(s)}else for(let r in e){if(this.isFunction(e[r]))continue;let i;void 0!==t[r]&&(i=t[r]);let s=this.map(e[r],i,this.isArray(i)?r:void 0);n[r]=this.isArray(i)?s[r]:s}if(this.isArray(t))for(var s=t.length-1;s>=0;s--){if(n[i]||(n[i]=[]),this.isFunction(t[s])||void 0!==n[i][s]){n[i][s].type&&n[i][s].type!==this.valueUpdated&&delete n[i];continue}let e=this.map(void 0,t[s]);n[i][s]=e}else for(let r in t){if(this.isFunction(t[r])||void 0!==n[r]){n[r].type&&n[r].type!==this.valueUpdated&&n[r].type!==this.valueDeleted&&delete n[r];continue}let e=this.map(void 0,t[r]);n[r]=e}return n}compareValues(e,t){return e===t||this.isDate(e)&&this.isDate(t)&&e.getTime()===t.getTime()?this.valueUnchanged:void 0===e?this.valueCreated:void 0===t?this.valueDeleted:this.valueUpdated}isFunction(e){return"[object Function]"===Object.prototype.toString.call(e)}isArray(e){return"[object Array]"===Object.prototype.toString.call(e)}isDate(e){return"[object Date]"===Object.prototype.toString.call(e)}isObject(e){return"[object Object]"===Object.prototype.toString.call(e)}isValue(e){return!this.isObject(e)&&!this.isArray(e)}frameObject(e,t){for(let i in t)if(this.isArray(t[i])){e[i]||(e[i]=[]);for(let n=0;n<t[i].length;n++){let s=this.frameObject({},t[i][n]);e[i].push(s)}}else if("type"!=i||"type"==i&&t[i]!==this.valueUpdated&&t[i]!==this.valueUnchanged&&t[i]!==this.valueDeleted&&t[i]!==this.valueCreated){if(this.isFunction(t[i]))continue;if(this.isValue(t[i]))return t.data;{let n=this.frameObject({},t[i]);(this.isValue(n)||Object.keys(n).length>0)&&(e[i]=n)}}return e}}var NO=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function a(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){e.done?s(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};class BO{constructor(e,t=!1){this.commandHandler=null,this.deepDiffer=new _O,this.inAction=!1,this.isProtectChange=!1,this.currentElement=null,this.blocked=!1,this.isTooltipVisible=!1,this.childTable={},this.undoElement={nodes:[],connectors:[]},this.checkProperty=!0,this.undoParentElement={nodes:[],connectors:[]},this.commandHandler=e,this.isProtectChange=t}startAction(e){this.currentElement=e,this.inAction=!0}mouseDown(e){this.currentElement=e.source,this.startPosition=this.currentPosition=this.prevPosition=e.position,this.isTooltipVisible=!0,this.startAction(e.source),this.checkProperty=!0,this.mouseDownElement=e.source}checkPropertyValue(){this.checkProperty&&this.commandHandler.startTransaction(this.isProtectChange)}mouseMove(e){return this.currentPosition=e.position,this.inAction&&(this.commandHandler.startTransaction(this.isProtectChange),this.checkProperty=!1),!this.blocked}mouseUp(e){this.checkPropertyValue(),this.currentPosition=e.position,this.isTooltipVisible=!1,this.commandHandler.endTransaction(this.isProtectChange),this.endAction(),this.mouseDownElement=null}endAction(){this.isTooltipVisible||this.commandHandler.closeTooltip(),this.commandHandler=null,this.currentElement=null,this.currentPosition=null,this.inAction=!1,this.blocked=!1}mouseWheel(e){this.currentPosition=e.position}mouseLeave(e){this.mouseUp(e)}updateSize(e,t,i,n,s,r){e=this.commandHandler.renderContainerHelper(e)||e;const o={snapped:!1,offset:0,left:!1,right:!1},a={snapped:!1,offset:0,top:!1,bottom:!1};let l=this.currentPosition.x-this.startPosition.x,h=this.currentPosition.y-this.startPosition.y;const c=!(e instanceof av)&&this.commandHandler.snappingModule&&this.commandHandler.snappingModule.canSnap(),d=c?this.commandHandler.snappingModule.getLayer():null,p=e instanceof av?r:e.rotateAngle;let u;u=bb(),wb(u,-p,0,0);let g=e.offsetX,m=e.offsetY;g-=e.width*e.pivot.x,m-=e.height*e.pivot.y;let f,y=0,b=0;const v=e instanceof av?e.actualSize.width:e.width,w=e instanceof av?e.actualSize.height:e.height;switch(n){case"ResizeWest":f=vb(u,{x:l,y:h}),l=f.x,h=f.y,b=1,l=c?this.commandHandler.snappingModule.snapLeft(o,a,d,l,h,e,i===t,s):l,h=0,y=(s.width-l)/v;break;case"ResizeEast":f=vb(u,{x:l,y:h}),l=f.x,h=f.y,l=c?this.commandHandler.snappingModule.snapRight(o,a,d,l,h,e,i===t,s):l,h=0,y=(s.width+l)/v,b=1;break;case"ResizeNorth":y=1,f=vb(u,{x:l,y:h}),l=f.x,h=f.y,h=c?this.commandHandler.snappingModule.snapTop(o,a,d,l,h,e,i===t,s):h,b=(s.height-h)/w;break;case"ResizeSouth":y=1,f=vb(u,{x:l,y:h}),l=f.x,h=f.y,h=c?this.commandHandler.snappingModule.snapBottom(o,a,d,l,h,e,i===t,s):h,b=(s.height+h)/w;break;case"ResizeNorthEast":f=vb(u,{x:l,y:h}),l=f.x,h=f.y,l=c?this.commandHandler.snappingModule.snapRight(o,a,d,l,h,e,i===t,s):l,h=c?this.commandHandler.snappingModule.snapTop(o,a,d,l,h,e,i===t,s):h,y=(s.width+l)/v,b=(s.height-h)/w;break;case"ResizeNorthWest":f=vb(u,{x:l,y:h}),l=f.x,h=f.y,h=c?this.commandHandler.snappingModule.snapTop(o,a,d,l,h,e,i===t,s):h,l=c?this.commandHandler.snappingModule.snapLeft(o,a,d,l,h,e,i===t,s):l,y=(s.width-l)/v,b=(s.height-h)/w;break;case"ResizeSouthEast":f=vb(u,{x:l,y:h}),l=f.x,h=f.y,h=c?this.commandHandler.snappingModule.snapBottom(o,a,d,l,h,e,i===t,s):h,l=c?this.commandHandler.snappingModule.snapRight(o,a,d,l,h,e,i===t,s):l,b=(s.height+h)/w,y=(s.width+l)/v;break;case"ResizeSouthWest":f=vb(u,{x:l,y:h}),l=f.x,h=f.y,h=c?this.commandHandler.snappingModule.snapBottom(o,a,d,l,h,e,i===t,s):h,l=c?this.commandHandler.snappingModule.snapLeft(o,a,d,l,h,e,i===t,s):l,y=(s.width-l)/v,b=(s.height+h)/w}return{width:y,height:b}}getPivot(e){switch(e){case"ResizeWest":return{x:1,y:.5};case"ResizeEast":return{x:0,y:.5};case"ResizeNorth":return{x:.5,y:1};case"ResizeSouth":return{x:.5,y:0};case"ResizeNorthEast":return{x:0,y:1};case"ResizeNorthWest":return{x:1,y:1};case"ResizeSouthEast":return{x:0,y:0};case"ResizeSouthWest":return{x:1,y:0}}return{x:.5,y:.5}}}class WO extends BO{constructor(e,t,i){super(e,!0),this.action=i}mouseDown(e){this.inAction=!0,super.mouseDown(e)}mouseMove(e){if(super.mouseMove(e),this.inAction&&!1===rb.equals(this.currentPosition,this.prevPosition)){const e=mb.toBounds([this.prevPosition,this.currentPosition]);this.mouseDownElement&&!ex(this.mouseDownElement)?this.commandHandler.clearObjectSelection(this.mouseDownElement):(this.commandHandler.clearSelectedItems(),this.commandHandler.drawSelectionRectangle(e.x,e.y,e.width,e.height))}return!this.blocked}mouseUp(e){if(this.checkPropertyValue(),!this.commandHandler.isUserHandle(this.currentPosition))if(!1===rb.equals(this.currentPosition,this.prevPosition)&&this.inAction){const e=mb.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.doRubberBandSelection(e)}else{const t=this.commandHandler.getSelectedObject();this.commandHandler.hasSelection()&&e.info&&e.info.ctrlKey?e&&e.source&&(this.commandHandler.isSelected(e.source)?1===e.clickCount&&(this.commandHandler.unSelect(e.source),this.commandHandler.updateBlazorSelector()):this.commandHandler.selectObjects([e.source],!0)):(this.commandHandler.clearSelection(null===e.source),"LabelSelect"===this.action?this.commandHandler.labelSelect(e.source,e.sourceWrapper):e.source&&this.commandHandler.selectObjects([e.source],!1,t))}this.inAction=!1,super.mouseUp(e)}mouseLeave(e){this.inAction&&this.mouseUp(e)}}class UO extends BO{mouseUp(e){this.checkPropertyValue(),this.inAction=!1;const t=e.source;let i;const n=e.sourceWrapper.id;for(let s=0;s<t.fixedUserHandles.length;s++)n.indexOf(t.fixedUserHandles[s].id)>-1&&(i=t.fixedUserHandles[s]);this.commandHandler.triggerEvent(nv.fixedUserHandleClick,{fixedUserHandle:i,element:e.source}),super.mouseUp(e)}}class FO extends BO{constructor(e,t){super(e,!0),this.isConnected=!1,this.endPoint=t}mouseDown(e){const t=Object.create(null,{mouseDown:{get:()=>super.mouseDown}});return NO(this,void 0,void 0,function*(){let i,n;if(this.inAction=!0,this.undoElement=void 0,this instanceof qO||(this.undoElement=QP(e.source)),t.mouseDown.call(this,e),e.source&&e.source.connectors&&(i={x:this.prevPosition.x,y:this.prevPosition.y},n=e.source.connectors[0],this.oldConnector=QP(n)),"BezierSourceThumb"===this.endPoint||"BezierTargetThumb"===this.endPoint)for(let e=0;e<n.segments.length;e++){const t=n.segments[e],i=rb.isEmptyPoint(t.point1)?t.bezierPoint1:t.point1,s=rb.isEmptyPoint(t.point2)?t.bezierPoint2:t.point2;(zO(this.currentPosition,i,n.hitPadding)||zO(this.currentPosition,s,n.hitPadding))&&(this.selectedSegment=t)}this.currentPosition=e.position})}mouseUp(e){const t=Object.create(null,{mouseUp:{get:()=>super.mouseUp}});return NO(this,void 0,void 0,function*(){if(this.isConnected&&e.source.connectors){const t=e.source.connectors[0],i="ConnectorSourceEnd"===this.endPoint?"sourceID":"targetID",n="ConnectorSourceEnd"===this.endPoint?"sourcePortID":"targetPortID",s={connector:t,oldValue:{nodeId:this.oldConnector[i],portId:this.oldConnector[n]},newValue:{nodeId:t[i],portId:t[n]},cancel:!1,state:"Changed",connectorEnd:this.endPoint};t[i]!==this.oldConnector[i]&&(this.commandHandler.triggerEvent(nv.connectionChange,s),this.isConnected=!1)}if(this.checkPropertyValue(),this.commandHandler.updateSelector(),this.commandHandler.removeSnap(),this.commandHandler.changeAnnotationDrag(e),this instanceof qO||("ConnectorSourceEnd"!==this.endPoint||!e.source.connectors.length||rb.equals(e.source.connectors[0].sourcePoint,this.undoElement.connectors[0].sourcePoint)&&e.source.connectors[0].sourceID===this.undoElement.connectors[0].sourceID)&&("ConnectorTargetEnd"!==this.endPoint||rb.equals(e.source.connectors[0].targetPoint,this.undoElement.connectors[0].targetPoint)&&e.source.connectors[0].targetID===this.undoElement.connectors[0].targetID)){if(!(this instanceof qO||"BezierTargetThumb"!==this.endPoint&&"BezierSourceThumb"!==this.endPoint)&&this.undoElement&&e.source){const t=QP(e.source);this.commandHandler.addHistoryEntry({type:"SegmentChanged",redoObject:t,undoObject:this.undoElement,category:"Internal"})}}else{let t,i,n,s;if(e.source&&e.source.connectors&&(t={x:this.prevPosition.x,y:this.prevPosition.y},i=e.source.connectors[0]),e.target){const t=this.commandHandler.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===this.endPoint,!0);t instanceof fv?n=t.id:s=t.id}if(this.commandHandler.triggerEvent("ConnectorSourceEnd"===this.endPoint?nv.sourcePointChange:nv.targetPointChange,{connector:i,state:"Completed",targetNode:s,oldValue:t,newValue:t,cancel:!1,targetPort:n}),this.commandHandler.removeTerminalSegment(i,!0),this.undoElement&&e.source){let t;t=QP(e.source);const i={type:"ConnectionChanged",redoObject:QP(t),undoObject:QP(this.undoElement),category:"Internal"};this.commandHandler.addHistoryEntry(i)}}this.commandHandler.updateBlazorSelector(),this.canCancel=void 0,this.tempArgs=void 0,t.mouseUp.call(this,e)})}mouseMove(e){let t;if(super.mouseMove(e),!(this instanceof qO)&&("ConnectorSourceEnd"===this.endPoint&&rb.equals(e.source.connectors[0].sourcePoint,this.undoElement.connectors[0].sourcePoint)||"ConnectorTargetEnd"===this.endPoint&&rb.equals(e.source.connectors[0].targetPoint,this.undoElement.connectors[0].targetPoint))){let t,i,n,s;if(e.source&&e.source.connectors&&(t={x:this.prevPosition.x,y:this.prevPosition.y},i=e.source.connectors[0]),e.target){s=e.target.id;const t=this.commandHandler.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===this.endPoint,!0);t instanceof fv||t instanceof QC?n=t.id:s=t.id}this.commandHandler.triggerEvent("ConnectorSourceEnd"===this.endPoint?nv.sourcePointChange:nv.targetPointChange,{connector:i,state:"Start",targetNode:s,oldValue:t,newValue:t,cancel:!1,targetPort:n})}if(this.currentPosition=e.position,this.currentPosition&&this.prevPosition){const i=this.currentPosition.x-this.prevPosition.x,n=this.currentPosition.y-this.prevPosition.y;let s,r,o,a,l,h,c;if(this.currentPosition=this.commandHandler.snapConnectorEnd(this.currentPosition),e.source&&e.source.connectors&&(s={x:this.currentPosition.x,y:this.currentPosition.y},r={x:this.prevPosition.x,y:this.prevPosition.y},l=e.source.connectors[0]),e.target){const t=this.commandHandler.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===this.endPoint,!0);t instanceof fv?h=t.id:c=t.id}let d={connector:l,state:"Progress",targetNode:c,oldValue:r,newValue:s,cancel:!1,targetPort:h};if(this instanceof qO||this.commandHandler.triggerEvent("ConnectorSourceEnd"===this.endPoint?nv.sourcePointChange:nv.targetPointChange,d),e.target&&(o=cC(e.target,!0),a=cC(e.target,!1)),!d.cancel&&this.inAction&&void 0!==this.endPoint&&0!==i||0!==n)if(this.blocked=!this.commandHandler.dragConnectorEnds(this.endPoint,e.source,this.currentPosition,this.selectedSegment,e.target,h),this.commandHandler.updateSelector(),e.target&&("ConnectorSourceEnd"===this.endPoint&&(cx(e.target)||dx(a))||"ConnectorTargetEnd"===this.endPoint&&(lx(e.target)||hx(o)))){this.commandHandler.canDisconnect(this.endPoint,e,h,c)&&(t=this.commandHandler.disConnect(e.source,this.endPoint,this.canCancel),this.isConnected=!0);const i=this.commandHandler.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===this.endPoint,!0);i instanceof pP?(lx(i)&&"ConnectorTargetEnd"===this.endPoint||cx(i)&&"ConnectorSourceEnd"===this.endPoint)&&(t=this.commandHandler.connect(this.endPoint,e,this.canCancel),this.isConnected=!0):this.checkConnect(i)&&(this.isConnected=!0,t=this.commandHandler.connect(this.endPoint,e,this.canCancel))}else-1===this.endPoint.indexOf("Bezier")&&(this.isConnected=!0,t=this.commandHandler.disConnect(e.source,this.endPoint,this.canCancel),this.commandHandler.updateSelector());if(this.commandHandler.canEnableDefaultTooltip()){const t=this.getTooltipContent(e.position);this.commandHandler.showTooltip(e.source,e.position,t,"ConnectTool",this.isTooltipVisible),this.isTooltipVisible=!1}t&&(this.tempArgs=t)}return this.prevPosition=this.currentPosition,!this.blocked}mouseLeave(e){this.mouseUp(e)}getTooltipContent(e){return"X:"+Math.round(e.x)+" Y:"+Math.round(e.y)}checkConnect(e){return!(!hx(e)||"ConnectorTargetEnd"!==this.endPoint)||!(!dx(e)||"ConnectorSourceEnd"!==this.endPoint)||!(e.constraints&sv.None||hx(e)||dx(e))&&(null==e.constraints||(e.constraints&sv.Default&~(sv.InConnect|sv.OutConnect))>0)}endAction(){super.endAction(),this.prevPosition=null,this.endPoint=null}}class VO extends BO{constructor(e,t){super(e,!0),this.currentTarget=null,this.canCancel=!1,this.objectType=t}mouseDown(e){if(e.source instanceof pP||e.source instanceof Vw){const t=this.commandHandler.getSelectedObject();this.commandHandler.selectObjects([e.source],e.info&&e.info.ctrlKey,t);const i={nodes:[],connectors:[]};e.source instanceof pP?i.nodes.push(QP(e.source)):i.connectors.push(QP(e.source)),this.undoElement=QP(i)}else this.undoElement=QP(e.source);this.undoParentElement=this.commandHandler.getSubProcess(e.source),"Port"===this.objectType&&(this.portId=e.sourceWrapper.id),this.commandHandler.insertBlazorConnector(e.source),super.mouseDown(e),this.initialOffset={x:0,y:0}}mouseUp(e,t){const i=Object.create(null,{mouseUp:{get:()=>super.mouseUp}});return NO(this,void 0,void 0,function*(){let n,s,r;this.checkPropertyValue();let o,a=!1;const l={nodes:[],connectors:[]};if("Port"!==this.objectType){if(e.source instanceof pP||e.source instanceof Vw){e.source instanceof pP?l.nodes.push(QP(e.source)):l.connectors.push(QP(e.source)),r=QP(l);const t=e.source.wrapper;r.offsetX=t.offsetX,r.offsetY=t.offsetY}else r=QP(e.source);if(o=this.commandHandler.renderContainerHelper(e.source)||e.source||this.commandHandler.renderContainerHelper(e.source),("helper"===o.id&&!r.nodes[0].isLane&&!r.nodes[0].isPhase||"helper"!==o.id)&&((o instanceof bP&&Math.round(o.width)===Math.round(this.undoElement.width)&&Math.round(o.height)===Math.round(this.undoElement.height)||!(o instanceof bP))&&(o.offsetX!==this.undoElement.offsetX||o.offsetY!==this.undoElement.offsetY||o.sourcePoint!==this.undoElement.sourcePoint||o.targetPoint!==this.undoElement.targetPoint)||this.isSelectionHasConnector(o))){e.source&&(s={offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY},n={offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY});let i={source:e.source,state:"Completed",oldValue:n,newValue:s,target:this.currentTarget,targetPosition:this.currentPosition,allowDrop:!0,cancel:!1};if(i={source:e.source,state:"Completed",oldValue:n,newValue:s,target:this.currentTarget,targetPosition:this.currentPosition,allowDrop:i.allowDrop,cancel:i.cancel},this.commandHandler.triggerEvent(nv.positionChange,i),!t){this.commandHandler.startGroupAction(),a=!0;const t={type:"PositionChanged",redoObject:QP(r),undoObject:QP(this.undoElement),category:"Internal"};if(r.nodes[0]&&r.nodes[0].processId){const t={type:"SizeChanged",category:"Internal",undoObject:this.undoParentElement,redoObject:this.commandHandler.getSubProcess(e.source)};this.commandHandler.addHistoryEntry(t)}this.commandHandler.addHistoryEntry(t)}}if(this.commandHandler.snapPoint(this.prevPosition,this.currentPosition,0,0),this.commandHandler.removeSnap(),this.commandHandler.removeHighlighter(),e.source&&this.currentTarget&&ux(this.currentTarget)&&this.commandHandler.isDroppable(e.source,this.currentTarget)){this.commandHandler.drop(this.currentElement,this.currentTarget,this.currentPosition);let t={element:e.source,target:this.currentTarget,position:this.currentPosition,cancel:!1};if(this.commandHandler.triggerEvent(nv.drop,t),!t.cancel&&e.source&&this.commandHandler.isParentAsContainer(this.currentTarget)){const t=e.source instanceof bP?e.source.nodes:[e.source];let i,n=!1;for(let e=0;e<t.length;e++){if(t[0].parentId!==t[e].parentId){i=!1;break}i=!0}for(let e=0;e<t.length;e++)!t[e].container&&i&&(n=!0,this.commandHandler.updateLaneChildrenZindex(t[e],this.currentTarget),this.commandHandler.dropChildToContainer(this.currentTarget,t[e]),this.commandHandler.renderContainerHelper(t[e]));a&&this.commandHandler.isContainer&&n&&this.commandHandler.endGroupAction()}}e.source&&this.currentTarget&&this.commandHandler.dropAnnotation(e.source,this.currentTarget),this.commandHandler.updateSelector(),a&&!this.commandHandler.isContainer&&this.commandHandler.endGroupAction()}else{l.nodes.push(QP(e.source)),e.portId=this.portId,r=QP(l);const t={type:"PortPositionChanged",objectId:this.portId,redoObject:QP(r),undoObject:QP(this.undoElement),category:"Internal"};this.commandHandler.addHistoryEntry(t)}this.commandHandler.updateBlazorSelector(),i.mouseUp.call(this,e)})}isSelectionHasConnector(e){return!(!(e.nodes&&e.connectors&&e.nodes.length>0&&e.connectors.length>0)||e.width===this.undoElement.width&&e.height===this.undoElement.height)}getBlazorPositionChangeEventArgs(e,t){return{source:e.source,state:e.state,oldValue:e.oldValue,newValue:e.newValue,target:yC(t)===Vw?{connector:t}:{node:t},targetPosition:this.currentPosition,allowDrop:!0,cancel:!1}}mouseMove(e){super.mouseMove(e);let t,i,n=!1;t=this.commandHandler.renderContainerHelper(e.source)||e.source,t instanceof pP||t instanceof Vw?t instanceof pP?t.offsetX===this.undoElement.nodes[0].offsetX&&t.offsetY===this.undoElement.nodes[0].offsetY&&(n=!0):rb.equals(t.sourcePoint,this.undoElement.connectors[0].sourcePoint)&&rb.equals(t.targetPoint,this.undoElement.connectors[0].targetPoint)&&(n=!0):t.wrapper.offsetX===this.undoElement.wrapper.offsetX&&t.wrapper.offsetY===this.undoElement.wrapper.offsetY&&(n=!0),t&&(i={offsetX:t.wrapper.offsetX,offsetY:t.wrapper.offsetY});let s={source:t,state:"Start",oldValue:i,newValue:i,target:e.target,targetPosition:e.position,allowDrop:!0,cancel:!1};if(s={source:t,state:"Start",oldValue:i,newValue:i,target:e.target,targetPosition:e.position,allowDrop:s.allowDrop,cancel:s.cancel},n&&this.commandHandler.triggerEvent(nv.positionChange,s),this.currentPosition=e.position,"Port"!==this.objectType){const i=this.initialOffset.x+(this.currentPosition.x-this.prevPosition.x),n=this.initialOffset.y+(this.currentPosition.y-this.prevPosition.y);let s,r;this.commandHandler.dragOverElement(e,this.currentPosition),this.commandHandler.disConnect(e.source),this.commandHandler.removeSnap();const o=this.commandHandler.snapPoint(this.prevPosition,this.currentPosition,i,n);this.initialOffset.x=i-o.x,this.initialOffset.y=n-o.y,t&&(s={offsetX:t.wrapper.offsetX,offsetY:t.wrapper.offsetY},r={offsetX:t.wrapper.offsetX+o.x,offsetY:t.wrapper.offsetY+o.y}),this.currentTarget&&e.target!==this.currentTarget&&this.commandHandler.removeChildFromBPmn(e.source,e.target,this.currentTarget),this.currentTarget=e.target;let a={source:t,state:"Progress",oldValue:s,newValue:r,target:e.target,targetPosition:e.position,allowDrop:!0,cancel:!1};if(this.commandHandler.triggerEvent(nv.positionChange,a),!a.cancel&&!this.canCancel){this.blocked=!this.commandHandler.dragSelectedObjects(o.x,o.y);const e=!this.commandHandler.mouseOver(this.currentElement,this.currentTarget,this.currentPosition);this.blocked=this.blocked||e}if(this.commandHandler.removeStackHighlighter(),this.commandHandler.renderStackHighlighter(e),this.currentTarget&&e.source!==this.currentTarget&&this.commandHandler.isDroppable(e.source,this.currentTarget)&&"helper"!==e.source.id){const t=e.source instanceof bP?e.source.nodes[0]:e.source;this.commandHandler.isParentAsContainer(t,!0)||"SwimLane"===t.shape.type||t.shape.isPhase||(this.currentTarget.isLane?this.commandHandler.renderStackHighlighter(e,this.currentTarget):this.commandHandler.drawHighlighter(this.currentTarget))}else this.commandHandler.removeHighlighter();if(this.commandHandler.canEnableDefaultTooltip()){const t=this.getTooltipContent(e.source);this.commandHandler.showTooltip(e.source,e.position,t,"MoveTool",this.isTooltipVisible),this.isTooltipVisible=!1}}else{const t=bb(),i=e.source;wb(t,-i.rotateAngle,i.offsetX,i.offsetY);const n=vb(t,{x:this.prevPosition.x,y:this.prevPosition.y}),s=vb(t,{x:e.position.x,y:e.position.y});this.commandHandler.portDrag(e.source,e.sourceWrapper,s.x-n.x,s.y-n.y)}return this.prevPosition=this.currentPosition,!this.blocked}getTooltipContent(e){return"X:"+Math.round(e.wrapper.bounds.x)+" Y:"+Math.round(e.wrapper.bounds.y)}mouseLeave(e){this.mouseUp(e)}endAction(){super.endAction(),this.currentTarget=null,this.prevPosition=null}}class YO extends BO{constructor(e){super(e,!0)}mouseDown(e){if(this.undoElement=QP(e.source),this.undoElement.nodes[0]&&this.undoElement.nodes[0].children){const e=this.commandHandler.getAllDescendants(this.undoElement.nodes[0],[]);for(let t=0;t<e.length;t++){const i=this.commandHandler.cloneChild(e[t].id);this.childTable[e[t].id]=QP(i)}}super.mouseDown(e)}mouseUp(e){const t=Object.create(null,{mouseUp:{get:()=>super.mouseUp}});return NO(this,void 0,void 0,function*(){let i;if(this.checkPropertyValue(),i=this.commandHandler.renderContainerHelper(e.source)||e.source,this.undoElement.rotateAngle!==i.wrapper.rotateAngle){const t={rotateAngle:i.wrapper.rotateAngle};let n;this.commandHandler.triggerEvent(nv.rotateChange,{source:e.source,state:"Completed",oldValue:t,newValue:t,cancel:!1}),n=QP(e.source);const s={type:"RotationChanged",redoObject:QP(n),undoObject:QP(this.undoElement),category:"Internal",childTable:this.childTable};this.commandHandler.addHistoryEntry(s),this.commandHandler.updateSelector()}this.commandHandler.updateBlazorSelector(),this.canCancel=void 0,this.tempArgs=void 0,t.mouseUp.call(this,e)})}mouseMove(e){let t;if(super.mouseMove(e),t=this.commandHandler.renderContainerHelper(e.source)||e.source,this.undoElement.rotateAngle===t.wrapper.rotateAngle){const i={rotateAngle:t.wrapper.rotateAngle};this.commandHandler.triggerEvent(nv.rotateChange,{source:e.source,state:"Start",oldValue:i,newValue:i,cancel:!1})}this.currentPosition=e.position;let i=rb.findAngle({x:t.wrapper.offsetX,y:t.wrapper.offsetY},this.currentPosition)+90;const n=this.commandHandler.snapAngle(i);i=0!==n?n:i,i=(i+360)%360;const s={source:e.source,state:"Progress",oldValue:{rotateAngle:t.wrapper.rotateAngle},newValue:{rotateAngle:i},cancel:!1};if(this.commandHandler.triggerEvent(nv.rotateChange,s),!s.cancel&&(this.blocked=!this.commandHandler.rotateSelectedItems(i-t.wrapper.rotateAngle)),this.commandHandler.canEnableDefaultTooltip()){const t=this.getTooltipContent(e.source);this.commandHandler.showTooltip(e.source,e.position,t,"RotateTool",this.isTooltipVisible),this.isTooltipVisible=!1}return!this.blocked}getTooltipContent(e){return Math.round(e.rotateAngle%360).toString()+"\xb0"}mouseLeave(e){this.mouseUp(e)}endAction(){super.endAction()}}class XO extends BO{constructor(e,t){super(e,!0),this.initialBounds=new mb,this.canCancel=!1,this.corner=t}mouseDown(e){if(this.undoElement=QP(e.source),this.undoParentElement=this.commandHandler.getSubProcess(e.source),super.mouseDown(e),this.undoElement.nodes[0]&&this.undoElement.nodes[0].children){const e=this.commandHandler.getAllDescendants(this.undoElement.nodes[0],[]);for(let t=0;t<e.length;t++){const i=this.commandHandler.cloneChild(e[t].id);this.childTable[e[t].id]=QP(i)}}this.commandHandler.checkSelection(e.source,this.corner),super.mouseDown(e),this.initialBounds.x=e.source.wrapper.offsetX,this.initialBounds.y=e.source.wrapper.offsetY,this.initialBounds.height=e.source.wrapper.actualSize.height,this.initialBounds.width=e.source.wrapper.actualSize.width}mouseUp(e,t){const i=Object.create(null,{mouseUp:{get:()=>super.mouseUp}});return NO(this,void 0,void 0,function*(){let n;if(this.checkPropertyValue(),this.commandHandler.removeSnap(),this.commandHandler.updateSelector(),n=this.commandHandler.renderContainerHelper(e.source)||e.source,this.undoElement.offsetX!==n.wrapper.offsetX||this.undoElement.offsetY!==n.wrapper.offsetY||this.undoElement.width!==n.wrapper.bounds.width||this.undoElement.height!==n.wrapper.bounds.height){{const t=this.updateSize(e.source,this.currentPosition,this.prevPosition,this.corner,this.initialBounds);this.blocked=this.scaleObjects(t.width,t.height,this.corner,this.currentPosition,this.prevPosition,n);const i={offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY,width:e.source.wrapper.actualSize.width,height:e.source.wrapper.actualSize.height};this.commandHandler.triggerEvent(nv.sizeChange,{source:e.source,state:"Completed",oldValue:i,newValue:i,cancel:!1})}const i=QP(e.source),s={type:"SizeChanged",redoObject:QP(i),undoObject:QP(this.undoElement),category:"Internal",childTable:this.childTable};if(!t){if(this.commandHandler.startGroupAction(),this.commandHandler.addHistoryEntry(s),i.nodes[0]&&i.nodes[0].processId){const t={type:"SizeChanged",redoObject:this.commandHandler.getSubProcess(e.source),undoObject:this.undoParentElement,category:"Internal"};this.commandHandler.addHistoryEntry(t)}this.commandHandler.endGroupAction()}}return this.commandHandler.updateBlazorSelector(),i.mouseUp.call(this,e),!this.blocked})}mouseMove(e){let t;super.mouseMove(e),t=this.commandHandler.renderContainerHelper(e.source)||e.source,this.undoElement.offsetX===t.wrapper.offsetX&&this.undoElement.offsetY===t.wrapper.offsetY&&this.commandHandler.triggerEvent(nv.sizeChange,{source:e.source,state:"Start",oldValue:{offsetX:e.source.wrapper.offsetX,offsetY:e.source.wrapper.offsetY,width:e.source.wrapper.actualSize.width,height:e.source.wrapper.actualSize.height},newValue:this.currentElement,cancel:!1}),this.currentPosition=e.position;let i={x:this.currentPosition.x-this.startPosition.x,y:this.currentPosition.y-this.startPosition.y};i=lO(-this.currentElement.wrapper.rotateAngle,void 0,void 0,i),i=this.getChanges(i),this.commandHandler.removeSnap();const n=this.updateSize(e.source,this.startPosition,this.currentPosition,this.corner,this.initialBounds);if(this.blocked=!this.scaleObjects(n.width,n.height,this.corner,this.startPosition,this.currentPosition,t),this.commandHandler.canEnableDefaultTooltip()){const t=this.getTooltipContent(e.source);this.commandHandler.showTooltip(e.source,e.position,t,"ResizeTool",this.isTooltipVisible),this.isTooltipVisible=!1}return this.prevPosition=this.currentPosition,!this.blocked}mouseLeave(e){this.mouseUp(e)}getTooltipContent(e){return"W:"+Math.round(e.wrapper.bounds.width)+" H:"+Math.round(e.wrapper.bounds.height)}getChanges(e){switch(this.corner){case"ResizeEast":return{x:e.x,y:0};case"ResizeSouthEast":return e;case"ResizeSouth":return{x:0,y:e.y};case"ResizeNorth":return{x:0,y:-e.y};case"ResizeNorthEast":return{x:e.x,y:-e.y};case"ResizeNorthWest":return{x:-e.x,y:-e.y};case"ResizeWest":return{x:-e.x,y:0};case"ResizeSouthWest":return{x:-e.x,y:e.y}}return e}scaleObjects(e,t,i,n,s,r){r instanceof bP&&1===r.nodes.length&&r.nodes[0].constraints&Vb.AspectRatio&&("ResizeWest"===i||"ResizeEast"===i||"ResizeNorth"===i||"ResizeSouth"===i?1===t&&1===e||(t=e=Math.max(1===t?0:t,1===e?0:e)):t=e=n!==s?Math.max(t,e):0);const o={offsetX:r.offsetX,offsetY:r.offsetY,width:r.width,height:r.height};this.blocked=this.commandHandler.scaleSelectedItems(e,t,this.getPivot(this.corner));const a={offsetX:r.offsetX,offsetY:r.offsetY,width:r.width,height:r.height};let l,h;return l={source:r,state:"Progress",oldValue:o,newValue:a,cancel:!1},h={source:r,state:"Progress",oldValue:o,newValue:a,cancel:l.cancel},this.commandHandler.triggerEvent(nv.sizeChange,h),(h.cancel||this.canCancel)&&this.commandHandler.scaleSelectedItems(1/e,1/t,this.getPivot(this.corner)),this.blocked}}class GO extends BO{constructor(e,t){super(e,!0),this.sourceObject=t}mouseDown(e){super.mouseDown(e),this.inAction=!0,this.commandHandler.setFocus()}mouseMove(e){let t;if(super.mouseMove(e),this.drawingObject||(this.drawingObject=this.commandHandler.drawObject({offsetX:this.currentPosition.x,width:3,height:3,offsetY:this.currentPosition.y})),this.inAction&&!1===rb.equals(this.currentPosition,this.prevPosition)){const e=mb.toBounds([this.prevPosition,this.currentPosition]);t=this.commandHandler.checkBoundaryConstraints(void 0,void 0,e),t&&this.commandHandler.updateNodeDimension(this.drawingObject,e)}return t}mouseUp(e){let t;this.checkPropertyValue();const i=mb.toBounds([this.prevPosition,this.currentPosition]);t=this.commandHandler.checkBoundaryConstraints(void 0,void 0,i),this.drawingObject&&this.drawingObject instanceof pP&&(this.commandHandler.addObjectToDiagram(this.drawingObject),this.drawingObject=null),this.commandHandler.updateBlazorSelector(),super.mouseUp(e),this.inAction=!1}endAction(){super.endAction()}mouseLeave(e){this.inAction&&this.mouseUp(e)}}class qO extends FO{constructor(e,t,i){super(e,t),this.sourceObject=i}mouseDown(e){const t=Object.create(null,{mouseDown:{get:()=>super.mouseDown}});return NO(this,void 0,void 0,function*(){t.mouseDown.call(this,e),this.inAction=!0,this.commandHandler.setFocus()})}mouseMove(e){if(this.commandHandler.enableServerDataBinding(!1),this.inAction){const t={sourcePoint:this.currentPosition,targetPoint:this.currentPosition};this.drawingObject||(this.drawingObject=this.commandHandler.drawObject(t)),e.source=this.drawingObject,(e.target&&e.target instanceof pP||e.actualObject&&e.sourceWrapper&&CC(e.actualObject,e.sourceWrapper))&&("ConnectorTargetEnd"!==this.endPoint||lx(e.target))&&this.commandHandler.connect(this.endPoint,e),this.endPoint="ConnectorTargetEnd"}return this.inAction||(this.commandHandler.updateSelector(),e.source&&e.sourceWrapper&&this.commandHandler.renderHighlighter(e,!0)),super.mouseMove(e),this.commandHandler.enableServerDataBinding(!0),!this.blocked}mouseUp(e){const t=Object.create(null,{mouseUp:{get:()=>super.mouseUp}});return NO(this,void 0,void 0,function*(){this.commandHandler.enableServerDataBinding(!1),this.checkPropertyValue(),this.drawingObject&&this.drawingObject instanceof Vw&&(this.commandHandler.addObjectToDiagram(this.drawingObject),this.drawingObject=null),this.commandHandler.updateBlazorSelector(),this.inAction=!1,this.commandHandler.enableServerDataBinding(!0),t.mouseUp.call(this,e)})}endAction(){super.endAction()}mouseLeave(e){this.inAction&&this.mouseUp(e)}}class ZO extends BO{constructor(e){super(e,!0)}mouseDown(e){super.mouseDown(e),this.commandHandler.clearSelection(),e.source||(this.drawingNode=this.commandHandler.drawObject({shape:{type:"Text"},offsetX:this.currentPosition.x,offsetY:this.currentPosition.y}))}mouseMove(e){if(super.mouseMove(e),this.drawingNode?(this.drawingNode.style.strokeColor="black",this.drawingNode.style.strokeDashArray="2 2",this.drawingNode.style.fill="transparent"):(this.drawingNode=this.commandHandler.drawObject({shape:{type:"Text"},offsetX:this.currentPosition.x,width:30,height:30,offsetY:this.currentPosition.y}),this.drawingNode.style.strokeDashArray="2 2",this.drawingNode.style.fill="transparent"),this.inAction&&!1===rb.equals(this.currentPosition,this.prevPosition)){const e=mb.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.updateNodeDimension(this.drawingNode,e)}return!this.blocked}mouseUp(e){this.checkPropertyValue(),this.drawingNode?(this.drawingNode.style.strokeColor="none",this.drawingNode.style.fill="none"):this.drawingNode=e.source,this.drawingNode&&(this.drawingNode instanceof pP||this.drawingNode instanceof Vw)&&this.commandHandler.addText(this.drawingNode,this.currentPosition),super.mouseUp(e),this.inAction=!1}endAction(){super.endAction()}}class $O extends BO{constructor(e,t){super(e),this.zooming=t}mouseDown(e){super.mouseDown(e),this.inAction=!0,this.commandHandler.setBlazorDiagramProps(!0)}mouseMove(e){if(super.mouseMove(e),this.inAction)if(this.zooming||!1!==rb.equals(this.currentPosition,this.prevPosition)){if(e.moveTouches&&e.moveTouches.length&&e.moveTouches.length>=2){const t=e.startTouches[0],i=e.startTouches[1],n=e.moveTouches[0],s=e.moveTouches[1],r=this.getDistance(n,s)/this.getDistance(t,i);this.commandHandler.zoom(r,0,0,e.position),this.updateTouch(t,n),this.updateTouch(i,s)}}else this.commandHandler.scroll(this.currentPosition.x-this.prevPosition.x,this.currentPosition.y-this.prevPosition.y,this.currentPosition);return this.commandHandler.dataBinding(),!this.blocked}mouseUp(e){this.commandHandler.setBlazorDiagramProps(!1),this.checkPropertyValue(),this.commandHandler.updatePanState(!1),super.mouseUp(e),this.inAction=!1}endAction(){super.endAction()}getDistance(e,t){const i=t.pageX-e.pageX,n=t.pageY-e.pageY;return Math.sqrt(i*i+n*n)}updateTouch(e,t){e.pageX=t.pageX,e.pageY=t.pageY}}class QO extends BO{constructor(e){super(e,!0)}mouseUp(e){this.checkPropertyValue(),this.commandHandler.initExpand(e),super.mouseUp(e)}}class JO extends BO{constructor(e){super(e,!0)}mouseUp(e){this.checkPropertyValue(),window.open(e.sourceWrapper.hyperlink.link,"_blank").focus(),super.mouseUp(e)}}class KO extends BO{constructor(e){super(e,!0)}mouseDown(e){if(super.mouseDown(e),this.inAction=!0,this.drawingObject){let e;const t=this.drawingObject.shape;e=t.points[t.points.length-1],e={x:e.x,y:e.y},this.drawingObject.shape.points.push(e)}else{this.startPoint={x:this.startPosition.x,y:this.startPosition.y};this.drawingObject=this.commandHandler.drawObject({offsetX:this.currentPosition.x,offsetY:this.currentPosition.y,width:5,height:5,style:{strokeColor:"black",strokeWidth:1},shape:{type:"Basic",shape:"Polygon",points:[{x:this.startPoint.x,y:this.startPoint.y},{x:this.currentPosition.x,y:this.currentPosition.y}]}})}}mouseMove(e){if(super.mouseMove(e),this.inAction){const e=this.drawingObject.shape;if(this.drawingObject&&this.currentPosition&&(e.points[e.points.length-1].x=this.currentPosition.x,e.points[e.points.length-1].y=this.currentPosition.y,this.drawingObject.wrapper.children[0].data=ab(this.drawingObject.shape.points),this.inAction&&!1===rb.equals(this.currentPosition,this.prevPosition))){const e=mb.toBounds(this.drawingObject.shape.points);this.commandHandler.updateNodeDimension(this.drawingObject,e)}}return!0}mouseUp(e,t){this.checkPropertyValue(),super.mouseMove(e),this.inAction&&(this.inAction=!1,this.drawingObject&&this.commandHandler.addObjectToDiagram(this.drawingObject)),this.endAction()}mouseWheel(e){super.mouseWheel(e),this.mouseMove(e)}endAction(){this.inAction=!1,this.drawingObject=null}}class eT extends BO{constructor(e){super(e,!0)}mouseMove(e){if(super.mouseMove(e),this.inAction){const e=this.drawingObject;e.targetPoint=this.currentPosition,this.commandHandler.updateConnectorPoints(e)}return!0}mouseDown(e){if(super.mouseDown(e),this.inAction=!0,this.drawingObject){const e=this.drawingObject;let t;t=new zw(e,"segments",{type:"Straight"},!0),t.point=this.currentPosition,e.segments[e.segments.length-1]=t}else this.drawingObject=this.commandHandler.drawObject({id:"Connector",type:"Straight",sourcePoint:this.currentPosition,targetPoint:this.currentPosition})}mouseWheel(e){super.mouseWheel(e),this.mouseMove(e)}mouseUp(e){if(this.checkPropertyValue(),super.mouseMove(e),this.inAction&&this.drawingObject){const e=this.drawingObject;e.segments[e.segments.length-1].point={x:0,y:0},this.commandHandler.addObjectToDiagram(this.drawingObject)}this.endAction()}endAction(){this.drawingObject=null,this.inAction=!1}}class tT extends BO{constructor(e){super(e,!0)}mouseDown(e){this.inAction=!0,this.undoElement=QP(e.source),this.annotationId=e.sourceWrapper.id,super.mouseDown(e)}mouseMove(e){super.mouseMove(e);let t=this.currentPosition.x-this.prevPosition.x,i=this.currentPosition.y-this.prevPosition.y;const n=e.source;if(n instanceof pP){const e=bb();wb(e,-n.rotateAngle,0,0);const s=vb(e,{x:t,y:i});t=s.x,i=s.y}return this.inAction&&(this.commandHandler.labelDrag(e.source,e.sourceWrapper,t,i),this.commandHandler.updateSelector()),this.prevPosition=this.currentPosition,!this.blocked}mouseUp(e){this.checkPropertyValue();const t=e.source;this.inAction=!1;const i={type:"AnnotationPropertyChanged",objectId:this.annotationId,undoObject:QP(this.undoElement),category:"Internal",redoObject:QP(t)};this.commandHandler.addHistoryEntry(i),super.mouseUp(e)}mouseLeave(e){this.mouseUp(e)}}class iT extends BO{constructor(e,t){super(e,!0),this.corner=t}mouseDown(e){this.inAction=!0;const t=e.source.nodes.length?e.source.nodes[0]:e.source.connectors[0];this.annotationId=e.source.wrapper.children[0].id,this.undoElement=QP(t);const i=e.source.wrapper.children[0];this.initialBounds={x:i.offsetX,y:i.offsetY,width:i.actualSize.width,height:i.actualSize.height},super.mouseDown(e)}mouseMove(e){return super.mouseMove(e),this.inAction&&this.resizeObject(e),!this.blocked}mouseUp(e){this.checkPropertyValue();const t=e.source.nodes.length?e.source.nodes[0]:e.source.connectors[0];this.inAction=!1;const i={type:"AnnotationPropertyChanged",objectId:this.annotationId,redoObject:QP(t),undoObject:QP(this.undoElement),category:"Internal"};this.commandHandler.addHistoryEntry(i),super.mouseUp(e)}mouseLeave(e){this.mouseUp(e)}resizeObject(e){let t;t=e.source.nodes.length?e.source.nodes[0]:e.source.connectors[0];const i=e.source.wrapper.children[0];let n,s;const r={x:i.offsetX,y:i.offsetY};let o=i.rotateAngle;o+=t instanceof pP?t.rotateAngle:0,o=(o+360)%360;const a=bb();wb(a,o,r.x,r.y);const l=this.corner.slice(5),h=this.updateSize(i,this.startPosition,this.currentPosition,l,this.initialBounds,o),c=i.offsetX-i.actualSize.width*i.pivot.x,d=i.offsetY-i.actualSize.height*i.pivot.y;let p=this.getPivot(l);p={x:c+i.actualSize.width*p.x,y:d+i.actualSize.height*p.y};const u=vb(a,p);h.x=u.x,h.y=u.y,n=h.width,s=h.height,n=n<0?1:n,s=s<0?1:s,this.commandHandler.labelResize(t,e.source.annotation,n,s,h,e.source),this.commandHandler.updateSelector()}}class nT extends BO{constructor(e){super(e,!0)}mouseDown(e){this.inAction=!0,this.annotationId=e.source.wrapper.children[0].id,this.undoElement=QP(e.source.nodes.length?e.source.nodes[0]:e.source.connectors[0]),super.mouseDown(e)}mouseMove(e){if(super.mouseMove(e),e.source&&this.inAction){let t;t=e.source.annotation,this.commandHandler.labelRotate(e.source.nodes[0]?e.source.nodes[0]:e.source.connectors[0],t,this.currentPosition,e.source),this.commandHandler.updateSelector()}return this.prevPosition=this.currentPosition,!this.blocked}mouseUp(e){this.checkPropertyValue(),this.inAction=!1;const t={type:"AnnotationPropertyChanged",objectId:this.annotationId,redoObject:QP(e.source.nodes.length?e.source.nodes[0]:e.source.connectors[0]),undoObject:QP(this.undoElement),category:"Internal"};this.commandHandler.addHistoryEntry(t),super.mouseUp(e)}mouseLeave(e){this.mouseUp(e)}}class sT extends BO{constructor(e,t){super(e,!0),this.endPoint=t}mouseDown(e){let t,i=!0;if(e.source&&e.source.connectors&&(t=e.source.connectors[0]),e.info&&(i=e.info.ctrlKey&&"Orthogonal"!==e.actualObject.type),t&&i){this.inAction=!0,this.undoElement=QP(e.source),super.mouseDown(e);for(let e=0;e<t.segments.length;e++){const i=t.segments[e];if("OrthoThumb"===this.endPoint)for(let e=0;e<i.points.length-1;e++){const t={x:0,y:0};t.x=(i.points[e].x+i.points[e+1].x)/2,t.y=(i.points[e].y+i.points[e+1].y)/2,zO(this.currentPosition,t,30)&&(this.selectedSegment=i,this.segmentIndex=e)}else zO(this.currentPosition,i.point,10)&&(this.selectedSegment=i)}}}mouseMove(e){if(super.mouseMove(e),this.currentPosition=e.position,this.currentPosition&&this.prevPosition){const t=this.currentPosition.y-this.prevPosition.y,i=this.currentPosition.x-this.prevPosition.x;let n;if(this.currentPosition=this.commandHandler.snapConnectorEnd(this.currentPosition),e.source&&e.source.connectors&&(n=e.source.connectors[0]),this.inAction&&void 0!==this.selectedSegment&&void 0!==this.endPoint&&(0!==i||0!==t)){if("OrthoThumb"===this.endPoint)this.blocked=!this.dragOrthogonalSegment(n,this.selectedSegment,this.currentPosition,this.segmentIndex);else{const e=this.currentPosition.x-this.selectedSegment.point.x,t=this.currentPosition.y-this.selectedSegment.point.y,i=n.segments.indexOf(this.selectedSegment);this.blocked=!this.commandHandler.dragControlPoint(n,e,t,!1,i)}this.commandHandler.updateSelector()}}return this.prevPosition=this.currentPosition,!this.blocked}mouseUp(e){let t,i;if(e.source&&e.source.connectors&&(t=e.source.connectors[0],i={segments:t.segments}),e&&e.source&&e.info&&e.info.ctrlKey&&e.info.shiftKey&&"Straight"===t.type)this.addOrRemoveSegment(t,this.currentPosition);else if("OrthoThumb"===this.endPoint&&this.selectedSegment){const e=t.segments.indexOf(this.selectedSegment),n=t.segments[e-1],s=t.segments[e+1];if(e===t.segments.length-2&&this.updateLastSegment(t,this.selectedSegment))t.segments.splice(t.segments.length-2,1);else if(n&&Math.abs(n.length)<5)1!==e&&this.removePrevSegment(t,e);else if(s){const i=rb.distancePoints(s.points[0],s.points[1]);Math.abs(s.length||0===s.length?s.length:i)<=5&&this.removeNextSegment(t,e)}this.commandHandler.updateEndPoint(t,i)}if(this.undoElement){const t=QP(e.source);this.commandHandler.addHistoryEntry({type:"SegmentChanged",redoObject:t,undoObject:this.undoElement,category:"Internal"})}super.mouseUp(e)}removePrevSegment(e,t){const i=e.segments[t-2],n=e.segments[t+1];if(!((n.length||0===n.length?n.length:rb.distancePoints(n.points[0],n.points[1]))<=5)){const n=e.segments.slice(t-1,t+1);let s={element:e,removeSegments:n,type:"Removal",cancel:!1};if(this.commandHandler.triggerEvent(nv.segmentCollectionChange,s),!s.cancel){const n=e.segments[t+1];e.segments.splice(t-1,2);const s=this.selectedSegment;"Left"===s.direction||"Right"===s.direction?(i.points[i.points.length-1].x=n.points[0].x,n.points[0].y=i.points[i.points.length-1].y):(i.points[i.points.length-1].y=n.points[0].y,n.points[0].x=i.points[i.points.length-1].x),(s.length||0===s.length)&&this.findSegmentDirection(i),this.findSegmentDirection(n)}}}findSegmentDirection(e){e.direction&&(e.length||0===e.length)&&(e.length=rb.distancePoints(e.points[0],e.points[e.points.length-1]),e.direction=rb.direction(e.points[0],e.points[e.points.length-1]))}removeNextSegment(e,t){const i=this.selectedSegment,n=e.segments[t-1],s=e.segments[t+2],r=e.segments[t+1];let o,a;if(r.length||0===r.length?(o=e.segments.slice(t,2),a={element:e,removeSegments:o,type:"Removal",cancel:!1},a={element:e,removeSegments:o,type:"Removal",cancel:!1},this.commandHandler.triggerEvent(nv.segmentCollectionChange,a),a.cancel||(e.segments.splice(t,2),"Top"===i.direction||"Bottom"===i.direction?(s.points[0].y=i.points[0].y,n.points[n.points.length-1].x=s.points[0].x):(s.points[0].x=i.points[0].x,n.points[n.points.length-1].y=s.points[0].y))):(o=e.segments.slice(t+1,1),a={element:e,removeSegments:o,type:"Removal",cancel:!1},this.commandHandler.triggerEvent(nv.segmentCollectionChange,a),a.cancel||(e.segments.splice(t+1,1),"Top"===i.direction||"Bottom"===i.direction?n.points[n.points.length-1].x=r.points[r.points.length-1].x:n.points[n.points.length-1].y=r.points[r.points.length-1].y,this.findSegmentDirection(n),i.length=i.direction=null)),n&&s&&!a.cancel&&(n.length=rb.distancePoints(n.points[0],s.points[0]),n.direction=rb.direction(n.points[0],s.points[0]),s.length||0===s.length)){s.length=rb.distancePoints(n.points[n.points.length-1],s.points[s.points.length-1]);const e=n.points,t=s.points;s.direction=rb.direction(e[e.length-1],t[t.length-1])}}addOrRemoveSegment(e,t){let i,n;const s={segments:e.segments};for(let r=0;r<e.segments.length;r++)zO(t,e.segments[r].point,e.hitPadding)&&(n=r,i=!0);if(i&&void 0!==n){if(e.segments&&e.segments[n]&&"Straight"===e.segments[n].type){const t=e.segments[n],i=e.segments[n+1];i&&(e.segments.splice(n,1),i.points[0]=t.points[0])}}else{this.commandHandler.enableServerDataBinding(!1);const n=this.findIndex(e,t);if(e.segments&&e.segments[n]&&"Straight"===e.segments[n].type){const s=e.segments[n],r=new zw(e,"segments",{type:"Straight",point:t},!0);r.points[0]=s.points[0],r.points[1]=t,s.points[0]=t,e.segments.splice(n,0,r),i=!0}this.commandHandler.enableServerDataBinding(!0)}i&&this.commandHandler.updateEndPoint(e,s)}findIndex(e,t){const i=[];for(let n=0;n<e.segments.length;n++){const s=e.segments[n],r=mb.toBounds([s.points[0],s.points[1]]);r.Inflate(e.hitPadding),r.containsPoint(t)&&i.push(s)}if(1===i.length)return e.segments.indexOf(i[0]);{let n,s,r,o,a,l;for(let e=0;e<i.length;e++)o=i[e],a=(t.y-o.points[0].y)/(o.points[1].y-t.y),l=(t.x-o.points[0].x)/(o.points[1].x-t.x),n=Math.abs(a-l),0===e&&(s=n,r=0),n<s&&(s=n,r=e);return e.segments.indexOf(i[r])}}dragOrthogonalSegment(e,t,i,n){const s={x:0,y:0},r={segments:e.segments};s.x=(t.points[n].x+t.points[n+1].x)/2,s.y=(t.points[n].y+t.points[n+1].y)/2;const o=i.y-s.y,a=i.x-s.x;let l=e.segments.indexOf(t),h=!1;return-1!==l&&(0===l&&1===e.segments.length&&2===t.points.length?(l=this.addSegments(e,t,a,o,l),h=!0):l!==e.segments.length-1||null!==t.direction&&null!==t.length?0===l&&(l=this.insertFirstSegment(e,t,a,o,l),h=!0):(l=this.addTerminalSegment(e,t,a,o,n),h=!0),l&&(h&&(this.selectedSegment=t=e.segments[l],this.segmentIndex=0),this.updateAdjacentSegments(e,l,a,o),this.commandHandler.updateEndPoint(e,r))),!0}addSegments(e,t,i,n,s){let r;const o=[],a=rb.distancePoints(t.points[0],t.points[1]),l=rb.direction(t.points[0],t.points[1]);o.push(new kw(e,"segments",{type:"Orthogonal",direction:l,length:a/4},!0)),o.push(new kw(e,"segments",{type:"Orthogonal",direction:t.points[0].y===t.points[1].y?n>0?"Bottom":"Top":i>0?"Right":"Left",length:t.points[0].x===t.points[1].x?n:i},!0)),o.push(new kw(e,"segments",{type:"Orthogonal",direction:l,length:a/2},!0));let h={element:e,addSegments:o,type:"Addition",cancel:!1};return this.commandHandler.triggerEvent(nv.segmentCollectionChange,h),h.cancel||(e.segments=o.concat(e.segments),r=s+2),r}insertFirstSegment(e,t,i,n,s){let r,o;const a=[];let l,h,c;if(e.sourcePortID&&t.length&&e.segments[0].points.length>2){let s;for(let r=0;r<t.points.length-1;r++){const o=rb.distancePoints(t.points[r],t.points[r+1]),l=rb.direction(t.points[r],t.points[r+1]);c=new kw(e,"segments",{type:"Orthogonal",direction:l,length:o},!0),0===c.length&&(c.direction=!s||"Top"!==s.direction&&"Bottom"!==s.direction?n>0?"Bottom":"Top":i>0?"Right":"Left"),s=c,a.push(c)}}else l={type:"Orthogonal",direction:t.direction,length:t.length/3},a.push(new kw(e,"segments",l,!0)),"Bottom"===t.direction||"Top"===t.direction?(o=Math.abs(i),r=i>0?"Right":"Left"):(o=Math.abs(n),r=n>0?"Bottom":"Top"),c=new kw(e,"segments",{type:"Orthogonal",direction:r,length:o},!0),a.push(c);let d={element:e,addSegments:a,type:"Addition",cancel:!1};if(this.commandHandler.triggerEvent(nv.segmentCollectionChange,d),!d.cancel){if(e.sourcePortID&&t.length&&e.segments[0].points.length>2)e.segments.splice(0,1),h=1;else{const i=e.segments[1];i&&i.length&&(i.length=r!==i.direction?i.length+o:i.length-o),h=2,t.length=2*t.length/3}e.segments=a.concat(e.segments)}return h}updateAdjacentSegments(e,t,i,n){const s=e.segments[t],r=s.points[s.points.length-1];let o=!0;"Orthogonal"===s.type&&(s.points[0]=s.points[0],s.points[s.points.length-1]=r,e.segments[t-1]&&(o=this.updatePreviousSegment(i,n,e,t)),e.segments.length-1>t&&o&&this.updateNextSegment(e,s,e.segments[t+1],i,n))}addTerminalSegment(e,t,i,n,s){let r,o,a,l,h=e.segments.indexOf(t);const c=[],d=e.segments.pop(),p=e.segments[e.segments.length-1];r=p&&"Orthogonal"===p.type?p:null;for(let f=0;f<t.points.length-2;f++)a=rb.distancePoints(t.points[f],t.points[f+1]),l=rb.direction(t.points[f],t.points[f+1]),o=new kw(e,"segments",{type:"Orthogonal",length:a,direction:l},!0),c.push(o),r=o;const u=s;if((2===t.points.length||u===t.points.length-2)&&(r&&(r.length+=5),void 0!==u)){a=2*rb.distancePoints(t.points[t.points.length-2],t.points[t.points.length-1])/3,l=rb.direction(t.points[t.points.length-2],t.points[t.points.length-1]);const i=new kw(e,"segments",{type:"Orthogonal",length:a,direction:l});c.push(i)}const g=new kw(e,"segments",{type:"Orthogonal"},!0);let m;return c.push(g),m={element:e,addSegments:c,type:"Addition",cancel:!1},this.commandHandler.triggerEvent(nv.segmentCollectionChange,m),m.cancel?e.segments.push(d):(e.segments=e.segments.concat(c),h+=s),this.commandHandler.updateEndPoint(e),h}updatePortSegment(e,t,i,n,s){if(1===i&&2===e.points.length&&e.length<0){const n=t.sourceWrapper.corners,s=t.segments[i],r=t.segments[i+1];let o;const a=[];let l;o=new kw(t,"segments",{type:"Orthogonal",length:13,direction:e.direction}),a.push(o),l="Left"===s.direction?s.points[0].x-(n.middleLeft.x-20):"Right"===s.direction?n.middleRight.x+20-s.points[0].x:"Bottom"===s.direction?n.bottomCenter.y+20-s.points[0].y:s.points[0].y-(n.topCenter.y-20),o=new kw(t,"segments",{type:"Orthogonal",length:l,direction:s.direction}),a.push(o),s.length=s.length-l,r&&r.length&&r.direction&&(r.direction===e.direction?r.length-=13:r.direction===aw(e.direction)&&(r.length+=13)),t.segments=a.concat(t.segments),this.selectedSegment=t.segments[3]}}updatePreviousSegment(e,t,i,n){const s=i.segments[n],r=i.segments[n-1];r.points[r.points.length-1]=s.points[0];const o=!i.sourceID||""!==i.sourcePortID;let a=!0;return"Orthogonal"===r.type&&("Bottom"===r.direction?r.length+=t:"Top"===r.direction?r.length-=t:"Right"===r.direction?r.length+=e:r.length-=e,""!==i.sourcePortID&&r.length<0?this.updatePortSegment(r,i,n,e,t):i.sourceID&&""===i.sourcePortID&&r.length<0&&1===n&&(a=!1,this.updateFirstSegment(i,s)),o&&this.changeSegmentDirection(r)),a}changeSegmentDirection(e){e.length<0&&(e.direction=aw(e.direction),e.length*=-1)}updateNextSegment(e,t,i,n,s){i.points[0]=t.points[t.points.length-1],i&&"Orthogonal"===i.type&&(i.length||0===i.length)&&("Left"===i.direction||"Right"===i.direction?0!==n&&(i.length="Right"===i.direction?i.length-n:i.length+n,(i.length||0===i.length)&&this.changeSegmentDirection(i)):0!==s&&(i.length="Bottom"===i.direction?i.length-s:i.length+s,(i.length||0===i.length)&&this.changeSegmentDirection(i)))}updateFirstSegment(e,t){const i=e.segments.indexOf(t);let n=!1;const s=e.segments[i],r=e.segments[i-1];let o;const a={segments:e.segments};if(r.length<0&&e.sourceID){const t=e.sourceWrapper.corners,l=[];let h,c=!1;this.changeSegmentDirection(s);const d=e.segments[i+1],p=e.segments[i+2];switch(d&&this.changeSegmentDirection(d),p&&this.changeSegmentDirection(p),r.direction){case"Top":case"Bottom":o=s.length>0&&"Left"===s.direction?t.middleLeft:t.middleRight,s.length>t.width/2?Math.abs(r.length)<t.height/2&&(r.length=rb.distancePoints(t.center,r.points[r.points.length-1]),s.points[0].x=o.x,s.length=rb.distancePoints(s.points[0],s.points[s.points.length-1]),s.length-=20,n=!0):(d&&d.direction&&d.length&&(d.points[0].y=o.y,d.points[0].x=d.points[d.points.length-1].x="Right"===s.direction?o.x+20:o.x-20),n=!0,c=!0);break;case"Left":case"Right":o=s.length>0&&"Top"===s.direction?t.topCenter:t.bottomCenter,s.length>t.height/2?Math.abs(r.length)<t.width/2&&(r.length=rb.distancePoints(t.center,r.points[r.points.length-1]),s.points[0].y=o.y,s.length=rb.distancePoints(s.points[0],s.points[s.points.length-1]),s.length-=20,n=!0):(d&&d.direction&&d.length&&(d.points[0].x=o.x,d.points[0].y=d.points[d.points.length-1].y="Bottom"===s.direction?o.y+20:o.y-20),n=!0,c=!0)}this.changeSegmentDirection(r),this.changeSegmentDirection(s),n&&(h={type:"Orthogonal",direction:s.direction,length:20},l.push(new kw(e,"segments",h,!0)),c&&(d&&d.direction&&d.length&&(d.length=rb.distancePoints(d.points[0],d.points[d.points.length-1])),p&&p.direction&&p.length&&(p.length=rb.distancePoints(d.points[d.points.length-1],p.points[p.points.length-1])),e.segments.splice(i-1,2)),e.segments=l.concat(e.segments)),this.selectedSegment=c?e.segments[i-1]:e.segments[i+1],this.commandHandler.updateEndPoint(e,a)}}updateLastSegment(e,t){if(e.targetID&&""===e.targetPortID){let i,n,s,r;const o=e.targetWrapper.corners,a=t.points[0],l=t.points[t.points.length-1];return"Right"===t.direction||"Left"===t.direction?(i={x:a.x,y:a.y},n={x:"Left"===t.direction?l.x-o.width/2:l.x+o.width/2,y:l.y},s={x:o.center.x,y:o.center.y-o.height},r={x:o.center.x,y:o.center.y+o.height}):(i={x:a.x,y:a.y},n={x:l.x,y:"Bottom"===t.direction?l.y+o.height/2:l.y-o.height/2},s={x:o.center.x-o.width,y:o.center.y},r={x:o.center.x+o.width,y:o.center.y}),BS({x1:i.x,y1:i.y,x2:n.x,y2:n.y},{x1:s.x,y1:s.y,x2:r.x,y2:r.y}).enabled}return!1}destroy(){}getModuleName(){return"ConnectorEditingTool"}}class rT{constructor(e,t){this.currentAction="None",this.previousAction="None",this.focus=!1,this.isBlocked=!1,this.isMouseDown=!1,this.inAction=!1,this.doingAutoScroll=!1,this.diagram=null,this.objectFinder=null,this.tool=null,this.eventArgs=null,this.keyArgs={},this.diagram=e,this.objectFinder=new oT,this.commandHandler=t}get action(){return this.currentAction}set action(e){e!==this.currentAction&&("PortDraw"===this.currentAction&&(this.diagram.tool&=~qb.DrawOnce,this.tool&&this.tool.mouseUp({position:this.currentPosition}),this.tool=null),"Rotate"===e||"LabelRotate"===e?this.diagram.diagramCanvas.classList.add("e-diagram-rotate"):"Rotate"!==this.currentAction&&"LabelRotate"!==this.currentAction||this.diagram.diagramCanvas.classList.remove("e-diagram-rotate"),this.currentAction=e,this.diagram.diagramActions="None"!==this.currentAction&&"Select"!==this.currentAction&&!(this.diagram.diagramActions&Jb.TextEdit)||this.commandHandler.isUserHandle(this.currentPosition)?this.diagram.diagramActions|Jb.ToolAction:this.diagram.diagramActions&~Jb.ToolAction,this.diagram.setCursor(this.diagram.getCursor(e,this.inAction)))}get blocked(){return this.isBlocked}set blocked(e){this.isBlocked=e,this.diagram.setCursor(this.blocked?"not-allowed":this.diagram.getCursor(this.action,this.inAction))}getMousePosition(e){let t,i,n;-1!==e.type.indexOf("touch")?(t=e,i=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY):(i=e.clientX,n=e.clientY);let s=new nb;s=$w(this.diagram);const r=this.diagram.element.getBoundingClientRect();return i=i+this.diagram.diagramCanvas.scrollLeft-r.left-s.width,n=n+this.diagram.diagramCanvas.scrollTop-r.top-s.height,i/=this.diagram.scroller.transform.scale,n/=this.diagram.scroller.transform.scale,i-=this.diagram.scroller.transform.tx,n-=this.diagram.scroller.transform.ty,{x:i,y:n}}windowResize(e){return this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=setTimeout(()=>{this.updateViewPortSize(this.diagram.element)},300),!1}updateViewPortSize(e){const t=document.getElementById(e.id);if(t){const e=t.getBoundingClientRect();this.diagram.scroller.setViewPortSize(e.width,e.height);let i=new nb;i=$w(this.diagram);const n=this.diagram.getSizeValue(this.diagram.width,i.width),s=this.diagram.getSizeValue(this.diagram.height,i.height);this.diagram.diagramCanvas.style.width=n,this.diagram.diagramCanvas.style.height=s,this.diagram.scroller.setSize(),this.diagram.transformLayers(),this.diagram.rulerSettings.showRulers&&qw(this.diagram)}}canHideResizers(){return(this.tool instanceof VO||this.tool instanceof YO)&&this.isMouseDown}updateCursor(){if(1===this.diagram.selectedItems.nodes.length||1===this.diagram.selectedItems.connectors.length){let e=[];e=e.concat(this.diagram.selectedItems.nodes,this.diagram.selectedItems.connectors),this.blocked=!(this.eventArgs&&this.eventArgs.source&&!ex(this.eventArgs.source))&&this.isMouseDown&&1===e.length&&this.tool instanceof WO&&!ex(e[0])}}isForeignObject(e,t){let i=e;if(i)for(;null!==i.parentNode;){if("string"==typeof i.className&&(!t&&-1!==i.className.indexOf("foreign-object")||t&&-1!==i.className.indexOf("e-diagram-text-edit")))return i;i=i.parentNode}return null}isMetaKey(e){return navigator.platform.match("Mac")?e.metaKey:e.ctrlKey}renderUmlHighLighter(e){this.diagram.commandHandler.removeStackHighlighter();const t=this.diagram.selectedItems.nodes[0];if(t&&t.container&&"Stack"===t.container.type&&"UmlClassifier"===t.shape.type&&!t.wrapper.bounds.containsPoint(this.currentPosition)){const i=this.diagram.findObjectsUnderMouse({x:this.currentPosition.x-20,y:this.currentPosition.y}),n=this.diagram.findObjectUnderMouse(i,this.action,this.inAction);n&&n.parentId&&n.parentId===t.id&&Qx(n.wrapper,"Vertical"===this.diagram.nameTable[n.parentId].container.orientation,e.position,this.diagram,!0)}}isDeleteKey(e,t){return navigator.platform.match("Mac")&&"Backspace"===e&&"delete"===t}isMouseOnScrollBar(e){const t=e.offsetX,i=e.offsetY,n=this.diagram.diagramCanvas,s=n.offsetHeight,r=n.offsetWidth;let o,a,l,h,c;return!!(s<n.scrollHeight&&(o={x:r-17,y:0},a={x:r,y:0},l={x:r-17,y:s},h={x:r,y:s},c=mb.toBounds([o,a,l,h]),c.containsPoint({x:t,y:i})))||!!(r<n.scrollWidth&&(o={x:0,y:s-17},a={x:r,y:s-17},l={x:0,y:s},h={x:r,y:s},c=mb.toBounds([o,a,l,h]),c.containsPoint({x:t,y:i})))}updateVirtualization(){const e=setInterval(t=>{this.diagram.removeVirtualObjects(e)},50);setTimeout(()=>{this.diagram.deleteVirtualObject=!0},50)}checkPreviousAction(){if(this.action!==this.previousAction&&this.diagram.selectedItems.userHandles.length)for(let e=0;e<this.diagram.selectedItems.userHandles.length;e++)this.previousAction&&this.diagram.selectedItems.userHandles[e]&&(this.checkUserHandleEvent(nv.onUserHandleMouseLeave),this.previousAction="None")}checkUserHandleEvent(e){if(this.diagram.selectedItems&&this.diagram.selectedItems.userHandles.length>0){const t=e===nv.onUserHandleMouseLeave?this.previousAction:this.action,i={element:void 0};for(let n=0;n<this.diagram.selectedItems.userHandles.length;n++)if(t===this.diagram.selectedItems.userHandles[n].name||e===nv.onUserHandleMouseUp&&"Select"===t){i.element=this.diagram.selectedItems.userHandles[n],e===nv.onUserHandleMouseEnter&&(this.previousAction=this.action),e===nv.onUserHandleMouseDown&&(this.userHandleObject=this.diagram.selectedItems.userHandles[n].name);const t=document.getElementById(this.diagram.selectedItems.userHandles[n].name+"_userhandle");e===nv.onUserHandleMouseUp?this.commandHandler.isUserHandle(this.currentPosition)&&t&&t.id===this.userHandleObject+"_userhandle"&&this.diagram.triggerEvent(e,i):this.diagram.triggerEvent(e,i)}}}mouseDown(e){if(!0===this.inAction&&this.tool instanceof GO)return;this.focus=!0;const t=e.touches;if(this.isMouseOnScrollBar(e))return this.isScrolling=!0,void e.preventDefault();if(this.checkUserHandleEvent(nv.onUserHandleMouseDown),!this.checkEditBoxAsTarget(e)&&xx(this.diagram)||yx(this.diagram)&&!wx(this.diagram))if("Select"!==this.action&&"Drag"!==this.action||this.diagram.updatePortVisibility(this.hoverElement,Nb.Hover,!0),!(this.tool instanceof KO||this.tool instanceof eT)||2!==e.button&&2!==e.buttons)if(!0===this.inAction&&!0===this.isMouseDown&&(this.tool instanceof KO||this.tool instanceof eT))this.isMouseDown=!0,this.eventArgs={},this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.eventArgs.position=this.currentPosition,this.tool.mouseDown(this.eventArgs);else{let i;this.isMouseDown=!0,this.currentPosition=this.prevPosition=this.getMousePosition(e),this.eventArgs={},this.diagram.textEditing&&!this.isMouseOnScrollBar(e)&&(this.diagram.endEdit(),this.diagram.textEditing=!1);const n=this.objectFinder.findObjectsUnderMouse(this.currentPosition,this.diagram,this.eventArgs,null,this.action),s=this.objectFinder.findObjectUnderMouse(this.diagram,n,this.action,this.inAction,this.eventArgs,this.currentPosition);let r=null;null!==s&&(r=this.diagram.findElementUnderMouse(s,this.currentPosition),r&&(i=this.commandHandler.findTarget(r,s))),this.action=this.diagram.findActionToBeDone(s,r,this.currentPosition,i);const o=this.isMetaKey(e);o&&e.shiftKey&&this.diagram.connectorEditingToolModule?this.action="SegmentEnd":!o&&!e.shiftKey||yx(this.diagram)||(this.action="Select"),this.tool=this.diagram.getTool(this.action),this.tool||(this.action="Select",this.tool=this.diagram.getTool(this.action)),this.getMouseEventArgs(this.currentPosition,this.eventArgs),(o||e.shiftKey)&&(this.eventArgs.info=o&&e.shiftKey?{ctrlKey:o,shiftKey:e.shiftKey}:{ctrlKey:!0}),this.eventArgs.position=this.currentPosition,this.tool.mouseDown(this.eventArgs),this.initialEventArgs={source:this.eventArgs.source,sourceWrapper:this.eventArgs.sourceWrapper},this.initialEventArgs.position=this.currentPosition,this.initialEventArgs.info=this.eventArgs.info,this.inAction=!1,"touchstart"===e.type&&(t&&t.length>=2&&(this.touchStartList=_P(this.touchStartList,0,t)),t||e.preventDefault())}else this.inAction=!1,this.tool.mouseUp(this.eventArgs);this.isForeignObject(e.target)||this.isForeignObject(e.target,!0)||t||e.preventDefault()}mouseMoveExtend(e,t){(this.tool instanceof KO||this.tool instanceof eT)&&this.tool.mouseMove(this.eventArgs),this.diagram.scrollSettings.canAutoScroll?this.checkAutoScroll(e):this.blocked||this.tool.mouseMove(this.eventArgs),this.eventArgs.target&&(this.hoverElement=this.eventArgs.target);const i=!(this.eventArgs.target instanceof pP&&t instanceof pP);this.tool instanceof FO&&this.diagram.updatePortVisibility(this.hoverElement instanceof pP?this.hoverElement:this.hoverNode,Nb.Connect|Nb.Hover,i),this.hoverElement instanceof pP&&this.hoverNode instanceof pP&&this.hoverNode&&this.hoverNode.id!==this.hoverElement.id&&this.diagram.updatePortVisibility(this.hoverNode,Nb.Connect|Nb.Hover,!0),this.hoverElement=i?null:t,this.hoverNode=i?null:t}checkAction(e){if("LabelSelect"===this.action&&this.eventArgs.sourceWrapper&&(this.eventArgs.sourceWrapper instanceof av||this.eventArgs.sourceWrapper instanceof vw)){const e=this.commandHandler.findTarget(this.eventArgs.sourceWrapper,this.eventArgs.source);!jO(this.diagram,e,!1,this.eventArgs.sourceWrapper)&&ex(e)&&(this.action="LabelDrag",this.tool=this.getTool(this.action),this.tool.mouseDown(this.initialEventArgs))}else ex(e)&&Kw(e)&&this.initialEventArgs&&this.initialEventArgs.source&&"Select"===this.action&&(!jO(this.diagram,this.eventArgs.source,!1)&&this.eventArgs.source instanceof bP&&this.getMouseEventArgs(this.currentPosition,this.eventArgs),e instanceof Vw&&(!(e instanceof Vw)||zO(this.currentPosition,e.sourcePoint,e.hitPadding)||zO(this.currentPosition,e.targetPoint,e.hitPadding))||(this.action="Drag"),this.tool=this.getTool(this.action),this.tool.mouseDown(this.initialEventArgs))}isSwimlaneElements(e){return!e||!(e.isLane||e.isPhase||e.isHeader)}mouseMove(e,t){var i,n;if(this.focus=!0,this.isScrolling)e.preventDefault();else if(xx(this.diagram)||yx(this.diagram)&&!wx(this.diagram)){this.currentPosition=this.getMousePosition(e);const s=this.diagram.findObjectsUnderMouse(this.currentPosition),r=this.diagram.findObjectUnderMouse(s,this.action,this.inAction);n=this.currentPosition,(i=this.diagram).rulerSettings.showRulers&&(i.hRuler.drawRulerMarker(i.hRuler.element,n,i.scroller.horizontalOffset),i.vRuler.drawRulerMarker(i.vRuler.element,n,i.scroller.verticalOffset));let o,a=!1;if("touchmove"===e.type&&(t=e.touches)&&t.length>1&&(this.touchMoveList=_P(this.touchMoveList,0,t),"PinchZoom"!==this.action&&(a=!0)),!1===rb.equals(this.currentPosition,this.prevPosition)||this.inAction){if(!1===this.isMouseDown||a){this.eventArgs={};let e=null;if(null!==r){if(e=this.diagram.findElementUnderMouse(r,this.currentPosition),r!==this.hoverElement){const e=this.getContent();this.hoverElement&&"Auto"===this.hoverElement.tooltip.openOn&&""!==e&&this.elementLeave(),this.diagram.updatePortVisibility(this.hoverElement,Nb.Hover,!0),r instanceof pP&&(this.hoverNode=r);let t=!0;!this.isSwimlaneElements(r)&&this.hoverElement&&this.isSwimlaneElements(this.hoverElement)&&(t=!1),this.hoverElement=t?r:this.hoverElement,t?this.elementEnter(this.currentPosition,!1):this.hoverElement=r}else this.hoverElement||this.hoverElement!==r||this.elementEnter(this.currentPosition,!0);e&&(o=this.commandHandler.findTarget(e,r))}this.action=this.diagram.findActionToBeDone(r,e,this.currentPosition,o),this.checkUserHandleEvent(nv.onUserHandleMouseEnter),this.checkPreviousAction(),this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.tool=this.getTool(this.action),this.mouseEvents(),this.tool instanceof qO||this.tool instanceof eT||this.tool instanceof KO?this.tool.mouseMove(this.eventArgs):t&&this.tool instanceof $O&&this.tool.mouseDown(this.eventArgs),this.updateCursor(),this.renderUmlHighLighter(this.eventArgs);let i=!1;(!this.hoverElement||this.tool instanceof $O||!(r instanceof pP)||!this.isSwimlaneElements(r)||0!==this.diagram.selectedItems.nodes.length&&jO(this.diagram,this.hoverElement))&&(i=!0),this.diagram.updatePortVisibility(this.hoverElement,Nb.Hover,i);const n=this.getContent();null===r&&this.hoverElement&&"Auto"===this.hoverElement.tooltip.openOn&&n&&(this.hoverElement=null,this.elementLeave()),a=!1}else{this.eventArgs.position=this.currentPosition,"Drag"===this.action&&!jO(this.diagram,this.eventArgs.source,!1)&&this.eventArgs.source instanceof bP&&this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.mouseEvents(),(e.ctrlKey||e.shiftKey)&&(this.eventArgs.info=e.ctrlKey&&e.shiftKey?{ctrlKey:e.ctrlKey,shiftKey:e.shiftKey}:{ctrlKey:!0}),this.checkAction(r);const t=this.getConnectorPadding(this.eventArgs);this.getMouseEventArgs(this.currentPosition,this.eventArgs,this.eventArgs.source,t),this.updateCursor(),this.inAction=!0,this.initialEventArgs=null,"Drag"!==this.action&&"Rotate"!==this.action||(this.diagram.diagramActions=this.diagram.diagramActions|Jb.Interactions),this.mouseMoveExtend(e,r)}this.prevPosition=this.currentPosition,this.isForeignObject(e.target,!0)||e.preventDefault()}}}getContent(){return this.hoverElement instanceof pP&&this.hoverElement.constraints&Vb.Tooltip||this.hoverElement instanceof Vw&&this.hoverElement.constraints&Ub.Tooltip?this.hoverElement.tooltip.content:this.diagram.tooltip.content}checkAutoScroll(e){const t=this.startAutoScroll(e);if(!t&&this.doingAutoScroll)this.doingAutoScroll=!1,clearInterval(this.timeOutValue);else if(t){if((this.tool instanceof GO||this.tool instanceof qO||this.tool instanceof VO||this.tool instanceof XO||this.tool instanceof WO)&&this.inAction){const i=this,n=100;this.diagram.scrollSettings.canAutoScroll&&t&&!this.doingAutoScroll&&(this.doingAutoScroll=!0,this.timeOutValue=setInterval(s=>{i.doAutoScroll(t,e,n)},n))}}else this.blocked=!this.tool.mouseMove(this.eventArgs)}mouseUp(e){this.checkUserHandleEvent(nv.onUserHandleMouseUp),"SVG"===this.diagram.mode&&gx(this.diagram)&&this.updateVirtualization(),this.diagram.previousSelectedObject=null,this.diagram.diagramRenderer.rendererActions=this.diagram.removeConstraints(this.diagram.diagramRenderer.rendererActions,Kb.DrawSelectorBorder);const t=e.touches;if(this.isScrolling)return this.isScrolling=!1,void e.preventDefault();if(!this.checkEditBoxAsTarget(e)&&xx(this.diagram)||yx(this.diagram)&&!wx(this.diagram)){if(this.tool&&(!(this.tool instanceof KO||this.tool instanceof eT)||(this.tool instanceof KO||this.tool instanceof eT)&&2===e.detail)){if(!this.isForeignObject(e.target)&&this.isMouseDown&&document.getElementById(this.diagram.element.id+"content").focus(),!this.inAction&&3!==e.which&&"Drag"===this.action){this.action="Select";let t=this.diagram.selectedItems.nodes.concat(this.diagram.selectedItems.connectors);const i=this.diagram.findObjectsUnderMouse(this.currentPosition),n=this.diagram.findObjectUnderMouse(i,this.action,this.inAction);let s=!0;!e.ctrlKey&&this.isMouseDown&&this.diagram.selectedItems.nodes.length+this.diagram.selectedItems.connectors.length>1&&1===e.which&&!(this.diagram.diagramActions&Jb.PreventClearSelection)&&(s=!1,this.commandHandler.clearSelection()),jO(this.diagram,n)&&s||this.commandHandler.selectObjects([n],void 0,t)}let t=!1;const i=this.updateContainerProperties();let n;if(this.addUmlNode(),this.inAction=!1,this.isMouseDown=!1,this.currentPosition=this.getMousePosition(e),this.diagram.selectedObject.helperObject&&(n=this.updateContainerBounds()),this.tool&&(this.tool.prevPosition||this.tool instanceof JO)){this.eventArgs.position=this.currentPosition;const n=this.getConnectorPadding(this.eventArgs);this.getMouseEventArgs(this.currentPosition,this.eventArgs,this.eventArgs.source,n);const s=this.isMetaKey(e);if((s||e.shiftKey)&&(this.eventArgs.info=s&&e.shiftKey?{ctrlKey:s,shiftKey:e.shiftKey}:{ctrlKey:!0}),this.diagram.diagramActions&Jb.Interactions&&(this.diagram.diagramActions=this.diagram.diagramActions&~Jb.Interactions),this.eventArgs.clickCount=e.detail,this.diagram.selectedObject.helperObject&&(this.tool instanceof VO||this.tool instanceof XO)){if(this.diagram.selectedObject.actualObject&&""!==this.diagram.selectedObject.actualObject.parentId){const e=this.diagram.getObject(this.diagram.selectedObject.actualObject.parentId);e&&e.isLane&&(this.commandHandler.isContainer=!0)}t=this.diagram.lineRoutingModule&&this.diagram.nameTable.helper&&this.eventArgs.target&&this.eventArgs.target.isLane&&(this.eventArgs.source instanceof bP&&this.eventArgs.source.nodes.length>0&&""===this.eventArgs.source.nodes[0].parentId||""===this.eventArgs.source.parentId),t&&(this.diagram.diagramActions=this.diagram.diagramActions|Jb.PreventLaneContainerUpdate),this.tool.mouseUp(this.eventArgs,i.isPreventHistory)}else this.tool.mouseUp(this.eventArgs),!this.diagram.checkMenu||-1===window.navigator.userAgent.indexOf("Linux")&&-1===window.navigator.userAgent.indexOf("X11")||(!e.pageY&&e instanceof TouchEvent&&e.changedTouches?(window.getSelection().removeAllRanges(),this.diagram.contextMenuModule.contextMenu.open(e.changedTouches[0].pageY,e.changedTouches[0].pageX,this.diagram.element),e.preventDefault()):this.diagram.contextMenuModule.contextMenu.open(e.pageY,e.pageX,this.diagram.element),this.diagram.checkMenu=!1);i.hasStack&&this.diagram.endGroupAction()}if(n&&this.diagram.endGroupAction(),this.updateContainerBounds(!0),2!==this.eventArgs.clickCount&&(this.commandHandler.updateSelectedNodeProperties(this.eventArgs.source),t)){this.diagram.diagramActions=this.diagram.diagramActions&~Jb.PreventLaneContainerUpdate;let e=this.eventArgs.source instanceof bP?this.eventArgs.source.nodes:[this.eventArgs.source];if(e)for(let t=0;t<e.length;t++)e[t].container||(this.commandHandler.dropChildToContainer(this.eventArgs.target,e[t]),this.commandHandler.renderContainerHelper(e[t]))}if(this.diagram.selectedObject&&this.diagram.selectedObject.helperObject&&(this.diagram.remove(this.diagram.selectedObject.helperObject),this.diagram.selectedObject={helperObject:void 0,actualObject:void 0},this.diagram.diagramActions&Jb.PublicMethod&&this.diagram.constraints&Gb.LineRouting&&(this.diagram.diagramActions=this.diagram.diagramActions&~Jb.PublicMethod)),this.blocked=!1,this.hoverElement){let e=Nb.Connect;jO(this.diagram,this.hoverElement)&&(e|=Nb.Hover),this.diagram.updatePortVisibility(this.hoverElement,e,!0),this.hoverElement=null}this.touchStartList=null,this.touchMoveList=null,this.tool instanceof ZO||(this.tool=null)}t||e.preventDefault(),this.diagram.currentDrawingObject=void 0;const i=this.diagram.selectedItems;let n=!1;if(this.commandHandler.isUserHandle(this.currentPosition)&&this.isForeignObject(e.target)&&(n=!0),!this.inAction&&i.wrapper&&i.userHandles.length>0&&!n&&this.diagram.renderSelector(!0),!this.inAction&&!this.diagram.currentSymbol&&this.eventArgs){let t={element:this.eventArgs.source||this.diagram,position:this.eventArgs.position,count:e.detail,actualObject:this.eventArgs.actualObject,button:0===e.button?"Left":1===e.button?"Middle":"Right"};this.diagram.tool!==qb.ZoomPan&&this.diagram.triggerEvent(nv.click,t)}this.eventArgs={}}this.diagram.diagramActions=this.diagram.diagramActions&~Jb.PreventLaneContainerUpdate,this.eventArgs={},this.diagram.commandHandler.removeStackHighlighter()}getConnectorPadding(e){let t;const i=e.source;if(i&&i instanceof bP&&i.connectors.length){const e=i.connectors[0];t=e.constraints&Ub.ConnectToNearByPort?e.connectionPadding:0}else i&&i instanceof Vw&&"PortDraw"===this.action&&this.tool instanceof qO&&i.constraints&Ub.ConnectToNearByPort&&(t=i.connectionPadding);return t||0}getBlazorClickEventArgs(e){return e={element:this.eventArgs.source?{selector:this.eventArgs.source}:{diagram:this.diagram},position:this.eventArgs.position,count:e.count,actualObject:this.eventArgs.actualObject?{selector:this.eventArgs.actualObject}:{diagram:this.diagram},button:e.button},this.eventArgs.source instanceof pP?(e.element.selector.nodes=[],e.element.selector.nodes.push(this.eventArgs.source)):this.eventArgs.source instanceof Vw&&(e.element.selector.connectors=[],e.element.selector.connectors.push(this.eventArgs.source)),e}addSwimLaneObject(e){let t,i,n,s,r,o,a=0;const l=e.shape,h=this.objectFinder.findObjectsUnderMouse(this.currentPosition,this.diagram,this.eventArgs,null,this.action);if(i||(i=this.diagram.findObjectUnderMouse(h,this.action,this.inAction)),this.diagram.clearSelectorLayer(),i&&!(i.isLane||i.isPhase||i.isHeader))for(let c=0;c<h.length;c++){const e=this.diagram.nameTable[h[c].id];(e.isLane||e.isPhase||e.isHeader)&&(i=e)}if(i&&(l.isPhase||l.isLane&&i.isLane)&&(t=this.diagram.nameTable[i.parentId]),t&&(n=t.shape,r=l.isLane?l.orientation===n.orientation:l.orientation!==n.orientation),r&&i){if(n&&n.header&&n.hasHeader&&"Horizontal"===n.orientation&&(a=1),n.phases.length>0&&(a+=1),l.isPhase){o="Horizontal"===n.orientation?this.currentPosition.x-t.wrapper.bounds.x:this.currentPosition.y-(t.wrapper.bounds.y+n.header.height);const e={id:XP(),offset:o,header:{annotation:{content:"Phase"}}};this.diagram.addPhases(t,[e])}else{const e={id:XP(),style:l.lanes[0].style,header:{annotation:{content:l.lanes[0].header.annotation.content,style:l.lanes[0].header.annotation.style},style:l.lanes[0].header.style}};"Horizontal"===l.orientation?e.height=l.lanes[0].height:e.width=l.lanes[0].width,"Horizontal"===n.orientation?(s=i.rowIndex?i.rowIndex:this.diagram.nameTable[i.parentId].rowIndex,i.wrapper.offsetY<this.currentPosition.y&&(s+=1)):(s=i.columnIndex?i.columnIndex:this.diagram.nameTable[i.parentId].columnIndex,this.currentPosition.x<i.wrapper.bounds.center.x&&(s-=1)),n.lanes.length>s-a?(e.header.width=n.lanes[s-a].header.width,e.header.height=n.lanes[s-a].header.height):(e.header.width=n.lanes[s-a-1].header.width,e.header.height=n.lanes[s-a-1].header.height),this.diagram.addLanes(t,[e],s-a)}this.commandHandler.select(t)}else if(l.isLane){const t={id:XP(),width:e.width,height:e.height,addInfo:e.addInfo,shape:{type:"SwimLane",header:{annotation:{content:"Header"},height:50,style:l.lanes[0].header.style},phases:[{id:XP(),header:{annotation:{content:"Phase"}}}],lanes:[{id:XP(),height:e.height,width:e.width,style:l.lanes[0].style,header:{annotation:{content:l.lanes[0].header.annotation.content,style:l.lanes[0].header.annotation.style},style:l.lanes[0].header.style}}],orientation:l.orientation}};"Vertical"===l.orientation&&(t.width+=20),t.offsetX=this.currentPosition.x+t.width/2,t.offsetY=this.currentPosition.y+t.height/2,this.diagram.add(t)}}mouseLeave(e){this.tool&&this.inAction&&this.tool.mouseLeave(this.eventArgs),this.diagram.selectedObject.helperObject&&(this.updateContainerProperties(),this.updateContainerBounds()&&this.diagram.endGroupAction()),this.eventArgs&&this.eventArgs.source&&(this.diagram.updatePortVisibility(this.eventArgs.source,Nb.Hover,!0),this.hoverElement=null),this.eventArgs&&!this.eventArgs.source&&this.hoverElement&&(this.hoverElement=null),this.tool instanceof FO&&this.eventArgs&&this.eventArgs.target&&this.eventArgs.target instanceof pP&&(this.diagram.updatePortVisibility(this.eventArgs.target,Nb.Hover|Nb.Connect,!0),this.hoverElement=null);const t=this.diagram.selectedItems;t&&t.wrapper&&(IC(this.diagram,t)||this.diagram.renderSelector(!0)),(this.diagram.diagramActions&Jb.Interactions||this.diagram.diagramActions&Jb.ToolAction)&&(this.diagram.diagramActions=this.diagram.diagramActions&~Jb.ToolAction),this.isMouseDown=!1,this.focus=!1,this.touchStartList=null,this.touchMoveList=null,this.elementLeave(),this.commandHandler.removeSnap(),this.inAction=!1,this.eventArgs={},this.diagram.selectedObject&&this.diagram.selectedObject.helperObject&&(this.diagram.remove(this.diagram.selectedObject.helperObject),this.diagram.selectedObject={helperObject:void 0,actualObject:void 0}),this.tool=null,function(){const e=document.getElementsByClassName("e-d-ruler-marker");let t,i;if(e&&e.length>0)for(i=e.length-1;i>=0;i--)t=e[i],t&&t.parentNode.removeChild(t)}(),"Rotate"===this.action&&this.diagram.diagramCanvas.classList.remove("e-diagram-rotate"),e.preventDefault()}mouseWheel(e){this.diagram.blazorActions|=_b.interaction;const t=e.wheelDelta>0||-40*e.detail>0,i=this.getMousePosition(e);if(this.diagram.tooltipObject.close(),this.isMetaKey(e))this.diagram.zoom(t?1.2:1/1.2,i),e.preventDefault();else{const n=this.diagram.scroller.horizontalOffset,s=this.diagram.scroller.verticalOffset,r=t?20:-20;this.tool&&(this.tool instanceof KO||this.tool instanceof eT)&&(this.eventArgs={},this.getMouseEventArgs(i,this.eventArgs),this.eventArgs.position=i,this.tool.mouseWheel(this.eventArgs)),this.diagram.scrollActions|=tv.Interaction,e.shiftKey?this.diagram.scroller.zoom(1,r,0,i):this.diagram.scroller.zoom(1,0,r,i),this.diagram.scrollActions&=~tv.Interaction,n===this.diagram.scroller.horizontalOffset&&s===this.diagram.scroller.verticalOffset||e.preventDefault()}if(this.diagram.textEditing){if(this.diagram.isTriggerEvent=!0,this.diagram.activeLabel.parentId){const e=this.diagram.getObject(this.diagram.activeLabel.parentId);this.diagram.startTextEdit(e,this.diagram.activeLabel.id)}this.diagram.isTriggerEvent=!1}this.diagram.blazorActions=this.diagram.blazorActions&~_b.interaction}keyDown(e){if(!(this.diagram.diagramActions&Jb.TextEdit)&&!this.checkEditBoxAsTarget(e)||"Escape"===e.key||27===e.keyCode){const t="inAction";let i;const n=e.keyCode?e.keyCode:e.which,s=e.key,r=this.isMetaKey(e);if(this.diagram.commandManager&&this.diagram.commands){const o=this.diagram.commands;for(const a of Object.keys(o))if(i=this.diagram.commands[a],i&&(i.gesture.keyModifiers||i.gesture.key)&&(n===i.gesture.key||s===Qb[i.gesture.key]||this.isDeleteKey(s,a))&&(!i.gesture.keyModifiers&&!e.altKey&&!e.shiftKey&&!r||i.gesture.keyModifiers&&(r||e.altKey||e.shiftKey)&&this.altKeyPressed(i.gesture.keyModifiers)&&e.altKey||this.shiftKeyPressed(i.gesture.keyModifiers)&&e.shiftKey||this.ctrlKeyPressed(i.gesture.keyModifiers)&&r)){const n=hO(i.canExecute);if(n&&n({keyDownEventArgs:KeyboardEvent,parameter:i.parameter})){if(e.preventDefault(),"Escape"===e.key)if(this.checkEditBoxAsTarget(e))document.getElementById(this.diagram.diagramCanvas.id).focus();else if(this.diagram.currentSymbol){const e="selectedSymbols",t="sourceElement",i="intDestroy";this.diagram.removeFromAQuad(this.diagram.currentSymbol),this.diagram.removeObjectsFromLayer(this.diagram.nameTable[this.diagram.currentSymbol.id]),this.diagram.removeElements(this.diagram.currentSymbol),GS(this.diagram.currentSymbol,this.diagram),delete this.diagram.nameTable[this.diagram.currentSymbol.id],this.diagram.droppable[t].draggable[i]();const n=this.diagram.droppable[e];n.parentNode.removeChild(n);const s=this.diagram.diagramActions;this.diagram.diagramActions=this.diagram.addConstraints(s,Jb.PreventClearSelection),this.tool.mouseUp(this.eventArgs),this.diagram.diagramRenderer.rendererActions=this.diagram.removeConstraints(this.diagram.diagramRenderer.rendererActions,Kb.DrawSelectorBorder),this.diagram.previousSelectedObject&&this.diagram.select(this.diagram.previousSelectedObject),this.action="Select",this.diagram.previousSelectedObject=null,this.diagram.currentSymbol=null,this.diagram.diagramActions=this.diagram.removeConstraints(s,Jb.PreventClearSelection),this.isMouseDown=!1}else this.inAction&&this.diagram.drawingObject&&this.tool&&this.tool[t]&&(this.tool.mouseUp(this.eventArgs),this.tool=null,this.isMouseDown=!1);i.execute&&this.diagram.tool!==qb.ZoomPan&&hO(i.execute)({keyDownEventArgs:KeyboardEvent,parameter:i.parameter});break}}}}this.keyArgs={element:this.diagram.selectedItems,key:e.key,keyCode:e.keyCode?e.keyCode:e.which},this.getKeyModifier(this.keyArgs,e),this.diagram.diagramActions&Jb.TextEdit&&this.getlabel(this.keyArgs,e),this.diagram.triggerEvent(nv.keyDown,this.keyArgs)}getlabel(e,t){const i=this.diagram.activeLabel;e.target=this.diagram.element.id+"_editBox";const n=this.diagram.nameTable[i.parentId];if(document.getElementById(this.diagram.element.id+"_editBox")){e.text=document.getElementById(this.diagram.element.id+"_editBox").value;for(let t=0;t<n.annotations.length;t++)if(n.annotations[t].id===i.id){e.label=n.annotations[t];break}}}getKeyModifier(e,t){e.keyModifiers=$b.None,t.ctrlKey&&(e.keyModifiers|=$b.Control),t.shiftKey&&(e.keyModifiers|=$b.Shift),t.altKey&&(e.keyModifiers|=$b.Alt),this.isMetaKey(t)&&(e.keyModifiers|=$b.Meta)}keyUp(e){this.keyArgs={element:this.diagram.selectedItems,key:e.key,keyCode:e.keyCode?e.keyCode:e.which},this.getKeyModifier(this.keyArgs,e),this.diagram.diagramActions&Jb.TextEdit&&this.getlabel(this.keyArgs,e),this.diagram.triggerEvent(nv.keyUp,this.keyArgs)}startAutoScroll(e){const t=this.getMousePosition(e);t.x*=this.diagram.scroller.currentZoom,t.y*=this.diagram.scroller.currentZoom;const i=$w(this.diagram);let n;const s=this.diagram.scrollSettings.autoScrollBorder;if("mozilla"===wu.info.name&&0===this.diagram.scroller.viewPortWidth){const e=document.getElementById(this.diagram.element.id).getBoundingClientRect();e.width!==this.diagram.scroller.viewPortWidth&&this.diagram.scroller.setViewPortSize(e.width,e.height)}return this.diagram.scrollSettings.canAutoScroll&&(t.x+this.diagram.scroller.horizontalOffset+s.right+i.width>=this.diagram.scroller.viewPortWidth-18?n="right":t.x+this.diagram.scroller.horizontalOffset<s.left?n="left":t.y+this.diagram.scroller.verticalOffset+s.bottom+i.height>this.diagram.scroller.viewPortHeight-18?n="bottom":t.y+this.diagram.scroller.verticalOffset<s.top&&(n="top")),n}doAutoScroll(e,t,i,n){const s=e;if((this.tool instanceof GO||this.tool instanceof qO||this.tool instanceof VO||this.tool instanceof XO||this.tool instanceof WO)&&this.inAction){const e=this.getMousePosition(t);let i=0,n=0;const r={x:e.x,y:e.y};switch(s){case"right":r.x=e.x+10,i=10;break;case"left":r.x=e.x-10,i=-10;break;case"bottom":r.y=e.y+10,n=10;break;case"top":r.y=e.y-10,n=-10}this.eventArgs.position={x:r.x,y:r.y},this.currentPosition=this.eventArgs.position;const o=this.objectFinder.findObjectsUnderMouse(this.currentPosition,this.diagram,this.eventArgs,null,this.action);this.eventArgs.target=this.diagram.findObjectUnderMouse(o,this.action,this.inAction),this.tool.mouseMove(this.eventArgs),this.diagram.scrollActions|=tv.Interaction,this.diagram.scroller.zoom(1,-i,-n,e),this.diagram.scrollActions&=~tv.Interaction}}mouseEvents(){const e=this.diagram.findObjectsUnderMouse(this.currentPosition);for(let i=0;i<e.length;i++)this.eventArgs.actualObject===e[i]&&e.splice(i,1);let t={targets:{}};if(t={targets:e,element:this.eventArgs.source===this.eventArgs.actualObject?void 0:this.eventArgs.source,actualObject:this.eventArgs.actualObject},this.lastObjectUnderMouse&&this.diagram.mouseLeave&&(!this.eventArgs.actualObject||this.lastObjectUnderMouse!==this.eventArgs.actualObject)){this.diagram.triggerEvent(nv.mouseLeave,{targets:void 0,element:this.lastObjectUnderMouse,actualObject:void 0}),this.lastObjectUnderMouse=null}(!this.lastObjectUnderMouse&&this.eventArgs.source||this.lastObjectUnderMouse!==this.eventArgs.actualObject)&&(this.lastObjectUnderMouse=this.eventArgs.actualObject,void 0!==this.eventArgs.actualObject&&this.diagram.triggerEvent(nv.mouseEnter,t)),this.eventArgs.actualObject&&this.diagram.triggerEvent(nv.mouseOver,t)}getBlazorCollectionObject(e,t){if(e)for(let i=0;i<e.length;i++)yC(e[i])===Vw?t.targets.connector.push(e[i]):t.targets.node.push(e[i])}elementEnter(e,t){if(!t){const e=this.hoverElement instanceof pP&&this.hoverElement.constraints&Vb.Tooltip||this.hoverElement instanceof Vw&&this.hoverElement.constraints&Ub.Tooltip,t=this.getContent();"Auto"===this.hoverElement.tooltip.openOn&&""!==t&&(i=this.diagram,uw((n=e?this.hoverElement:void 0)?n.tooltip:i.tooltip,i.tooltipObject)),this.diagram.tooltipObject.offsetX=0,this.diagram.tooltipObject.offsetY=0;const s=this.diagram.findObjectsUnderMouse(this.currentPosition),r=this.diagram.findObjectUnderMouse(s,this.action,this.inAction);let o=document.getElementById(r.id+(r.shape&&r.shape instanceof WC?"_content_native_element":"_groupElement"));"Auto"===this.hoverElement.tooltip.openOn&&""!==t&&(this.diagram.tooltipObject.close(),this.diagram.tooltipObject.openOn=this.hoverElement.tooltip.openOn,this.diagram.tooltipObject.dataBind()),function(e,t){let i=0;return e instanceof Vw?e.constraints&Ub.Tooltip?i=e.constraints&Ub.Tooltip:e.constraints&Ub.InheritTooltip&&(i=t.constraints&Gb.Tooltip):e.constraints&Vb.Tooltip?i=e.constraints&Vb.Tooltip:e.constraints&Vb.InheritTooltip&&(i=t.constraints&Gb.Tooltip),i}(this.hoverElement,this.diagram)&&"Auto"===this.hoverElement.tooltip.openOn&&this.diagram.tooltipObject.open(o)}var i,n}elementLeave(){this.diagram.tooltipObject&&"Custom"!==this.diagram.tooltipObject.openOn&&this.diagram.tooltipObject.close()}altKeyPressed(e){return!!(e&$b.Alt)}ctrlKeyPressed(e){return!!(e&$b.Control)}shiftKeyPressed(e){return!!(e&$b.Shift)}scrolled(e){this.diagram.updateScrollOffset()}doubleClick(e){if(xx(this.diagram)){let t;const i=this.diagram.findObjectsUnderMouse(this.currentPosition),n=this.diagram.findObjectUnderMouse(i,this.action,this.inAction);if(null!==n&&xx(this.diagram))if(t=this.diagram.findElementUnderMouse(n,this.currentPosition),this.tool&&(this.tool instanceof KO||this.tool instanceof eT))this.tool.mouseUp(this.eventArgs),this.isMouseDown=!1,this.eventArgs={},this.tool=null,e.preventDefault();else{const e=this.diagram.commandHandler.getObjectLayer(n.id);if(e&&!e.lock&&e.visible&&!(this.diagram.diagramActions&Jb.TextEdit)){let e="";"TextAnnotation"===n.shape.shape&&(e=n.wrapper.children[1].id.split("_")[1]),this.diagram.startTextEdit(n,e||(t instanceof av?t.id.split(n.id+"_")[1]:void 0))}}this.diagram.triggerEvent(nv.doubleClick,{source:n||this.diagram,position:this.currentPosition,count:e.detail})}}itemClick(e,t){const i=e;return Yx(this.diagram,i,!0)?i:null}inputChange(e){let t,i,n,s,r,o,a,l,h;const c=document.getElementById(this.diagram.element.id+"_editBox"),d=document.getElementById(this.diagram.element.id+"_editTextBoxDiv"),p=c.value,u=p.split("\n");s=this.diagram.selectedItems.nodes[0]?this.diagram.selectedItems.nodes[0]:this.diagram.selectedItems.connectors[0],(!s&&this.tool instanceof ZO||s&&"SwimLane"===s.shape.type)&&(s=this.diagram.nameTable[this.diagram.activeLabel.parentId]),s&&("Text"!==s.shape.type&&s.annotations.length>0||"Text"===s.shape.type)&&(n=this.diagram.getWrapper(s.wrapper,this.diagram.activeLabel.id),t=s.wrapper.bounds.width<n.bounds.width?s.wrapper.bounds.width:n.bounds.width,t=t>90?t:90,a=xP(n.style,p,void 0,void 0,t),i=Number(c.style.fontSize.split("px")[0]),u.length>1&&""===u[u.length-1]&&(a.height=a.height+i),l=this.diagram.scroller.transform,h=Sx(this.diagram)?l.scale:1,o=a.width,o=(90>o?90:o)*h,r=(12>a.height?12:a.height)*h,d.style.left=(n.bounds.center.x+l.tx)*l.scale-o/2-2.5+"px",d.style.top=(n.bounds.center.y+l.ty)*l.scale-r/2-3+"px",d.style.width=o+"px",d.style.height=r+"px",c.style.minHeight="12px",c.style.minWidth="90px",c.style.width=o+"px",c.style.height=r+"px")}isAddTextNode(e,t){return!(!(this.tool instanceof ZO||t)||(this.tool=null,e&&!bx(this.diagram)&&(this.diagram.drawingObject=void 0,this.diagram.currentDrawingObject=void 0),pC(this.diagram.nodes,e.id)||pC(this.diagram.connectors,e.id)||this.diagram.bpmnModule&&this.diagram.bpmnModule.textAnnotationConnectors.indexOf(e)>-1))}checkEditBoxAsTarget(e){return!(!e.target||e.target.id!==this.diagram.element.id+"_editBox")}getMouseEventArgs(e,t,i,n){let s,r,o;if(t.position=e,i?(r=this.diagram.findObjectsUnderMouse(this.currentPosition,i),s=this.diagram.findTargetObjectUnderMouse(r,this.action,this.inAction,t.position,i)):"Drag"===this.action||"ConnectorSourceEnd"===this.action||"SegmentEnd"===this.action||"OrthoThumb"===this.action||"BezierSourceThumb"===this.action||"BezierTargetThumb"===this.action||"ConnectorTargetEnd"===this.action||-1!==this.action.indexOf("Rotate")||-1!==this.action.indexOf("Resize")?(s=this.diagram.selectedItems,!this.diagram.currentSymbol&&"Drag"===this.action&&s&&this.diagram.selectedItems.nodes.length>0&&"SwimLane"===this.diagram.selectedItems.nodes[0].shape.type&&(r=this.diagram.findObjectsUnderMouse(this.currentPosition),s=this.diagram.findObjectUnderMouse(r,this.action,this.inAction))):(r=this.diagram.findObjectsUnderMouse(this.currentPosition),s=this.diagram.findObjectUnderMouse(r,this.action,this.inAction)),s&&s.isHeader&&(s=this.diagram.nameTable[s.parentId],this.eventArgs.actualObject=s),s){let e,t,a;if(o=this.diagram.findElementUnderMouse(s,this.currentPosition,n),(o&&s.ports&&s.ports.length&&!CC(s,o)||!o||!s)&&r&&r.length&&i instanceof bP)for(e=i.connectors[0],a=r.length-1;a>=0;a--)if(t=r[a],t instanceof pP&&e&&e.connectionPadding){if(s=t,o=this.diagram.findElementUnderMouse(s,this.currentPosition,n),e.constraints&Ub.ConnectToNearByPort&&s&&s.ports&&s.ports.length&&CC(s,o))break;if(t instanceof pP&&e&&e.connectionPadding&&t.wrapper.outerBounds.containsPoint(this.currentPosition)&&e.constraints&Ub.ConnectToNearByNode&&!(e.constraints&Ub.ConnectToNearByPort)){s=t,o=this.diagram.findElementUnderMouse(s,this.currentPosition,0);break}}}return i?(t.target=s,t.targetWrapper=o):(t.source=s,t.sourceWrapper=o),t.actualObject=this.eventArgs.actualObject,t.source instanceof bP&&void 0===t.actualObject&&(t.source.nodes.length>0||t.source.connectors.length>0)&&(t.actualObject=t.source.nodes.length>0?this.diagram.nameTable[t.source.nodes[0].id]:this.diagram.nameTable[t.source.connectors[0].id]),t.startTouches=this.touchStartList,t.moveTouches=this.touchMoveList,t}resetTool(){this.action="Select",this.hoverElement=null,this.hoverNode=null,this.tool=this.diagram.getTool(this.action),this.updateCursor()}getTool(e){switch(e){case"Select":return new WO(this.commandHandler,!0);case"Drag":return new VO(this.commandHandler);case"Rotate":return new YO(this.commandHandler);case"LayoutAnimation":return new QO(this.commandHandler);case"FixedUserHandle":return new UO(this.commandHandler,!0);case"Hyperlink":return new JO(this.commandHandler);case"ResizeSouthEast":case"ResizeSouthWest":case"ResizeNorthEast":case"ResizeNorthWest":case"ResizeSouth":case"ResizeNorth":case"ResizeWest":case"ResizeEast":return new XO(this.commandHandler,e);case"ConnectorSourceEnd":case"ConnectorTargetEnd":case"BezierSourceThumb":case"BezierTargetThumb":return new FO(this.commandHandler,e);case"SegmentEnd":case"OrthoThumb":return new sT(this.commandHandler,e);case"Draw":const t="shape",i=function(e){let t;return e&&(e.type?t="Connector":e.shape&&!e.type&&(t="Node")),t}(this.diagram.drawingObject);if("Node"===i&&"Text"===this.diagram.drawingObject.shape.type)return new ZO(this.commandHandler);if("Node"===i&&"Polygon"===this.diagram.drawingObject.shape[t]&&!this.diagram.drawingObject.shape.points)return new KO(this.commandHandler);if("Node"===i||"Node"===i&&"Polygon"===this.diagram.drawingObject.shape[t]&&this.diagram.drawingObject.shape.points)return new GO(this.commandHandler,this.diagram.drawingObject);if("Connector"===i&&"Polyline"===this.diagram.drawingObject.type)return new eT(this.commandHandler);if("Connector"===i)return new qO(this.commandHandler,"ConnectorSourceEnd",this.diagram.drawingObject);break;case"Pan":return new $O(this.commandHandler,!1);case"PinchZoom":return new $O(this.commandHandler,!0);case"PortDrag":return new VO(this.commandHandler,"Port");case"PortDraw":return new qO(this.commandHandler,"ConnectorSourceEnd",this.diagram.drawingObject);case"LabelSelect":return new WO(this.commandHandler,!0,"LabelSelect");case"LabelDrag":return new tT(this.commandHandler);case"LabelResizeSouthEast":case"LabelResizeSouthWest":case"LabelResizeNorthEast":case"LabelResizeNorthWest":case"LabelResizeSouth":case"LabelResizeNorth":case"LabelResizeWest":case"LabelResizeEast":return new iT(this.commandHandler,e);case"LabelRotate":return new nT(this.commandHandler)}return null}getCursor(e){const t=this.diagram.selectedItems.annotation?this.diagram.selectedItems.wrapper.children[0]:this.diagram.selectedItems;return function(e,t){if(t+=360,t%=360,-1===e.indexOf("Resize"))return HO[e];{const i=HO[e];if(t>=0&&t<25||t>=160&&t<=205||t>=340&&t<=360)return i;if(t>=25&&t<=70||t>=205&&t<=250)return"n-resize"===i||"s-resize"===i?"ne-resize":"nw-resize"===i||"se-resize"===i?"n-resize":"e-resize"===i||"w-resize"===i?"nw-resize":"e-resize";if(t>=70&&t<=115||t>=250&&t<=295)return"n-resize"===i||"s-resize"===i?"e-resize":"nw-resize"===i||"se-resize"===i?"ne-resize":"e-resize"===i||"w-resize"===i?"n-resize":"nw-resize";if(!(t>=115&&t<=155||t>=295&&t<=340))return"n-resize";if("n-resize"===i||"s-resize"===i)return"nw-resize";if("nw-resize"===i||"se-resize"===i)return"e-resize";if("e-resize"===i||"w-resize"===i)return"ne-resize"}return HO[e]}(e,this.diagram.selectedItems.annotation?t.rotateAngle+t.parentTransform:t.rotateAngle)}findElementUnderMouse(e,t,i){return this.objectFinder.findElementUnderSelectedItem(e,t,i)}findObjectsUnderMouse(e,t){return this.objectFinder.findObjectsUnderMouse(e,this.diagram,this.eventArgs,t)}findObjectUnderMouse(e,t,i){return this.objectFinder.findObjectUnderMouse(this.diagram,e,t,i,this.eventArgs,this.currentPosition)}findTargetUnderMouse(e,t,i,n,s){return this.objectFinder.findObjectUnderMouse(this.diagram,e,t,i,this.eventArgs,n,s)}findActionToBeDone(e,t,i,n){return function(e,t,i,n,s,r,o){if(r&&r.length>1&&s&&s.length>1)return"PinchZoom";if(n.currentSymbol)return"Drag";if("PortDraw"===n.eventHandler.action&&(n.tool&=~qb.DrawOnce),(vx(n)||bx(n))&&n.drawingObject)return"Draw";if(LO(n)){const e=n.selectedItems;if(e.wrapper&&aC(e.constraints,"UserHandle"))for(const t of e.userHandles)if(t.visible&&zO(i,rC(e,t,n.scroller.transform),t.size/(2*n.scroller.transform.scale)))return t.name}if(LO(n)){const e=n.selectedItems.annotation?n.selectedItems.wrapper.children[0]:n.selectedItems.wrapper,t=e.bounds,s=n.selectedItems,r=new mb(t.x,t.y,t.width,t.height);if(kO(n)&&!n.selectedItems.annotation){const e=n.selectedItems.connectors[0],t=10/n.scrollSettings.currentZoom,r=10/n.scrollSettings.currentZoom;if(aC(s.constraints,"ResizeAll")){if(aC(s.constraints,"ConnectorSourceThumb")&&nx(e)&&zO(i,e.sourcePoint,t))return"ConnectorSourceEnd";if(aC(s.constraints,"ConnectorTargetThumb")&&sx(e)&&zO(i,e.targetPoint,r))return"ConnectorTargetEnd";const o=function(e,t,i,n){const s=10/n.scrollSettings.currentZoom,r=10/n.scrollSettings.currentZoom;if("Bezier"===e.type)for(let o=0;o<e.segments.length;o++){const t=e.segments[o];if(zO(i,rb.isEmptyPoint(t.point1)?t.bezierPoint1:t.point1,r))return"BezierSourceThumb";if(zO(i,rb.isEmptyPoint(t.point2)?t.bezierPoint2:t.point2,s))return"BezierTargetThumb"}if(n.connectorEditingToolModule&&rx(e))if("Straight"===e.type||"Bezier"===e.type){for(let o=0;o<e.segments.length;o++)if(zO(i,e.segments[o].point,10))return"SegmentEnd"}else for(let o=0;o<e.segments.length;o++){const t={x:0,y:0},n=e.segments[o];if(n.allowDrag)for(let e=0;e<n.points.length-1;e++)if(rb.distancePoints(n.points[e],n.points[e+1])>=50&&(t.x=(n.points[e].x+n.points[e+1].x)/2,t.y=(n.points[e].y+n.points[e+1].y)/2,zO(i,t,30)))return"OrthoThumb"}return null}(e,0,i,n);if("OrthoThumb"===o)return o;if(aC(s.constraints,"ConnectorSourceThumb")&&nx(e)&&o)return o;if(aC(s.constraints,"ConnectorTargetThumb")&&sx(e)&&o)return o}}else{const t=10/n.scroller.currentZoom,o=bb();wb(o,e.rotateAngle+e.parentTransform,e.offsetX,e.offsetY);const a=e.offsetX-e.pivot.x*e.actualSize.width,l=e.offsetY-e.pivot.y*e.actualSize.height;let h={x:a+(.5===e.pivot.x?2*e.pivot.x:e.pivot.x)*e.actualSize.width/2,y:l-30/n.scroller.currentZoom};h=vb(o,h);const c=!!n.selectedItems.annotation,d=!(!c||!ox(n.selectedItems.annotation));if(aC(s.constraints,"Rotate")&&zO(i,h,t)&&n.selectedItems.thumbsConstraints&Xb.Rotate){if(c&&d)return"LabelRotate";if(!c)return"Rotate"}if(r.Inflate(t),r.containsPoint(i)){const t=function(e,t,i,n,s,r){let o;return 1===e.selectedItems.nodes.length&&0===e.selectedItems.connectors.length&&e.selectedItems.nodes[0].container&&(o=function(e,t,i,n,s){const r=10/e.scroller.currentZoom,o=40/e.scroller.currentZoom,a=e.selectedItems,l=t.actualSize.width,h=t.actualSize.height,c=new mb(n,s+20,t.style.strokeWidth,h-40),d=new mb(n+l,s+20,t.style.strokeWidth,h-40),p=new mb(n+20,s,l-40,t.style.strokeWidth),u=new mb(n+20,s+h,l-40,t.style.strokeWidth),g=Yx(e,e.selectedItems.nodes[0],!0)?e.nameTable[e.selectedItems.nodes[0].parentId]:e.selectedItems.nodes[0];if(l>=o&&h>=o){if(oC(a.constraints,"ResizeEast",a.thumbsConstraints,a)&&d.containsPoint(i,r))return"ResizeEast";if(oC(a.constraints,"ResizeSouth",a.thumbsConstraints,a)&&u.containsPoint(i,r))return"ResizeSouth";if("Grid"!==g.container.type){if(oC(a.constraints,"ResizeWest",a.thumbsConstraints,a)&&c.containsPoint(i,r))return"ResizeWest";if(oC(a.constraints,"ResizeNorth",a.thumbsConstraints,a)&&p.containsPoint(i,r))return"ResizeNorth"}}return null}(e,t,i,s,r)),o||e.selectedItems.nodes[0]&&(e.selectedItems.nodes[0].isPhase||e.selectedItems.nodes[0].isLane||"SwimLane"===e.selectedItems.nodes[0].shape.type)||(o=function(e,t,i,n,s,r){const o=40/e.scroller.currentZoom,a=10/e.scroller.currentZoom,l=e.selectedItems,h=!!l.annotation;if(t.actualSize.width>=o&&t.actualSize.height>=o){if(oC(l.constraints,"ResizeSouthEast",l.thumbsConstraints,l)&&zO(i,vb(n,{x:s+t.actualSize.width,y:r+t.actualSize.height}),a))return h?"LabelResizeSouthEast":"ResizeSouthEast";if(oC(l.constraints,"ResizeSouthWest",l.thumbsConstraints,l)&&zO(i,vb(n,{x:s,y:r+t.actualSize.height}),a))return h?"LabelResizeSouthWest":"ResizeSouthWest";if(oC(l.constraints,"ResizeNorthEast",l.thumbsConstraints,l)&&zO(i,vb(n,{x:s+t.actualSize.width,y:r}),a))return h?"LabelResizeNorthEast":"ResizeNorthEast";if(oC(l.constraints,"ResizeNorthWest",l.thumbsConstraints,l)&&zO(i,vb(n,{x:s,y:r}),a))return h?"LabelResizeNorthWest":"ResizeNorthWest"}return oC(l.constraints,"ResizeEast",l.thumbsConstraints,l)&&zO(i,vb(n,{x:s+t.actualSize.width,y:r+t.actualSize.height/2}),a)?h?"LabelResizeEast":"ResizeEast":oC(l.constraints,"ResizeWest",l.thumbsConstraints,l)&&zO(i,vb(n,{x:s,y:r+t.actualSize.height/2}),a)?h?"LabelResizeWest":"ResizeWest":oC(l.constraints,"ResizeSouth",l.thumbsConstraints,l)&&zO(i,vb(n,{x:s+t.actualSize.width/2,y:r+t.actualSize.height}),a)?h?"LabelResizeSouth":"ResizeSouth":oC(l.constraints,"ResizeNorth",l.thumbsConstraints,l)&&zO(i,vb(n,{x:s+t.actualSize.width/2,y:r}),a)?h?"LabelResizeNorth":"ResizeNorth":null}(e,t,i,n,s,r)),o||null}(n,e,i,o,a,l);if(t)return t}}}if(yx(n)&&!e)return"Pan";if(o instanceof fv&&!yx(n)){const e=function(e,t,i,n){if(Ox(t)&&(lC(t,Nb.Hover)||lC(t,Nb.Visible))){if(t.constraints&sv.Drag)return"PortDrag"}else if(Px(t)&&(lC(t,Nb.Hover)||lC(t,Nb.Visible))&&t.constraints&sv.Draw){e.drawingObject={};const i={type:"Orthogonal",sourcePortID:t.id};return e.drawingObject=i,e.tool|=qb.DrawOnce,e.currentDrawingObject=i,"PortDraw"}return"None"}(n,o);if("None"!==e)return e}if((o instanceof wv||o instanceof xv)&&!yx(n)&&Kw(o))return jO(n,o,void 0,t)&&ex(o)?"LabelDrag":"LabelSelect";if(null!==e){if(!(e instanceof pP||e instanceof Vw))return"Select";if(t&&t.id){const i=t.id.split(e.id)[1];if(i&&i.match("^_icon"))return"LayoutAnimation"}if(t&&t.id){let i;for(let n=0;n<e.fixedUserHandles.length;n++)if(i=e.fixedUserHandles[n].id,t.id&&t.id.indexOf(i)>-1)return"FixedUserHandle"}if(t instanceof av&&t.hyperlink.link)return"Hyperlink";if(!ex(e)||!jO(n,e,!1)||void 0!==n.selectedItems.annotation)return e&&yx(n)&&!wx(n)?"Pan":n.selectedItems.nodes.length&&n.selectedItems.nodes[0].isLane&&n.selectedItems.wrapper&&n.selectedItems.wrapper.bounds.containsPoint(i)?"Drag":"Select";if(e instanceof Vw&&!zO(i,e.sourcePoint,e.hitPadding)&&!zO(i,e.targetPoint,e.hitPadding)||!(e instanceof Vw))return"Drag"}return"Select"}(e,t,this.currentPosition,this.diagram,this.touchStartList,this.touchMoveList,n)}updateContainerBounds(e){let t=!1;if(this.diagram.selectedObject.helperObject&&this.diagram.selectedObject.actualObject instanceof pP){const i=this.tool instanceof XO,n=this.diagram.selectedObject.actualObject,s=this.diagram.nameTable[n.parentId];e?Fx(this.diagram,n,this.currentPosition,i):((!s||s&&"SwimLane"!==s.shape.type)&&this.diagram.updateDiagramObject(n),t=function(e,t,i,n){let s;const r=[];let o=!1;if(Yx(e,t,!0)){e.protectPropertyChange(!0),s=e.nameTable[t.parentId];const a=s.wrapper;if(s&&"Canvas"===s.container.type){if(n||a.bounds.x<=i.x&&a.bounds.right>=i.x&&a.bounds.y<=i.y&&a.bounds.bottom>=i.y){let i;const n=a.bounds.y,r=a.bounds.x,l=e.nameTable[s.parentId]||s;if("SwimLane"===l.shape.type)o=$x(s,l,t,e,!0);else{const t=e.nameTable[s.parentId]||s,o=t.shape;i=t.wrapper,a.actualSize.width<a.outerBounds.width&&!(a.bounds.x>a.outerBounds.x)&&(void 0!==s.rowIndex?(i.updateColumnWidth(s.columnIndex,a.outerBounds.width,!0),"Horizontal"===o.orientation&&o.phaseSize&&uS(t,e,a,s.columnIndex),gS(e,t),e.drag(t,r-a.bounds.x,n-a.bounds.y)):e.scale(s,1+(a.outerBounds.width-a.actualSize.width)/a.actualSize.width,1,a.outerBounds.x<a.bounds.x?{x:1,y:.5}:{x:0,y:.5})),a.actualSize.height<a.outerBounds.height&&!(a.bounds.y>a.outerBounds.y)&&(void 0!==s.rowIndex?(i.updateRowHeight(s.rowIndex,a.outerBounds.height,!0),e.drag(t,r-a.bounds.x,n-a.bounds.y)):e.scale(s,1,1+(a.outerBounds.height-a.actualSize.height)/a.actualSize.height,a.outerBounds.y<a.bounds.y?{x:.5,y:1}:{x:.5,y:0}))}}e.select([t]),hS(r,e)}e.protectPropertyChange(!1)}return o}(this.diagram,n,this.currentPosition,i),this.diagram.updateSelector(),(n.isLane||n.isPhase)&&(this.diagram.clearSelection(),this.commandHandler.selectObjects([n])))}return t}updateContainerProperties(){let e,t,i,n,s=!1,r=!1,o={hasStack:!1,isPreventHistory:!1};if(this.diagram.selectedObject.helperObject){const a=this.diagram.findObjectsUnderMouse(this.currentPosition);let l=this.diagram.findObjectUnderMouse(a,this.action,this.inAction);if(e=this.diagram.selectedObject.helperObject,n=this.diagram.selectedObject.actualObject,n instanceof pP){if("SwimLane"===n.shape.type&&(i=nS(this.diagram,n.wrapper.children[0])),"SwimLane"!==n.shape.type&&n.parentId&&"SwimLane"===this.diagram.getObject(n.parentId).shape.type&&l instanceof pP&&this.diagram.getObject(l.parentId)&&"SwimLane"!==this.diagram.getObject(l.parentId).shape.type&&(l=this.diagram.getObject(l.parentId)),"Drag"===this.currentAction&&n.container&&"Canvas"===n.container.type&&n.parentId&&"SwimLane"===this.diagram.getObject(n.parentId).shape.type&&l&&l!==n&&l.container&&"Canvas"===l.container.type&&l.isLane&&n.isLane&&l.parentId===n.parentId)(function(e,t,i,n){let s,r,o,a,l,h,c,d,p,u;const g=e.getObject(t.parentId),m=g.shape,f=g.wrapper.children[0],y=m.lanes,b=nS(e,f);if("Horizontal"===m.orientation&&t.rowIndex!==i.rowIndex||"Vertical"===m.orientation&&t.columnIndex!==i.columnIndex){if("Horizontal"===m.orientation)l=t.rowIndex,h=i.rowIndex,s=(m.header&&m.hasHeader?1:0)+(m.phases.length&&m.phaseSize?1:0),d=t.rowIndex-s,p=i.rowIndex-s,y[d].canMove&&(d<p?n&&i.wrapper.offsetY>n.y&&(h+=p>0?-1:1,p+=p>0?-1:1):n&&i.wrapper.offsetY<n.y&&(h+=1,p+=1),l!==h&&f.updateRowIndex(l,h));else if(l=t.columnIndex,h=i.columnIndex,s=m.phases.length&&m.phaseSize?1:0,d=t.columnIndex-s,p=i.columnIndex-s,u=m.header&&m.hasHeader?1:0,y[d].canMove&&(d<p?n&&i.wrapper.offsetX>n.x&&(h+=p>0?-1:1,p+=p>0?-1:1):n&&i.wrapper.offsetX<n.x&&(h+=1,p+=1),l!==h)){if(!(0!==m.phaseSize&&0!==m.phases.length||0!==h&&0!==l)&&m.header&&m.hasHeader){const e=0===h?l:h;f.rows[0].cells[e].children=f.rows[0].cells[0].children,f.rows[0].cells[e].columnSpan=f.rows[0].cells[0].columnSpan,f.rows[0].cells[0].children=[]}f.updateColumnIndex(0,l,h)}l!==h&&(c=y[d],c.canMove&&(r={target:QP(i),source:QP(t)},c=y[d],y.splice(d,1),y.splice(p,0,c),a={target:QP(r.source),source:QP(r.target)},o={type:"LanePositionChanged",redoObject:a,undoObject:r,category:"Internal"},e.diagramActions&Jb.UndoRedo||e.commandHandler.addHistoryEntry(o),rS(e,g,0),hS(b,e),function(e,t){let i,n;for(let s=0;s<e.length;s++){i=e[s];for(let e=0;e<i.children.length;e++)n=t.nameTable[i.children[e].id],n.offsetX=n.wrapper.offsetX,n.offsetY=n.wrapper.offsetY}}(y,e),g.wrapper.measure(new nb(g.width,g.height)),g.wrapper.arrange(g.wrapper.desiredSize),e.updateDiagramObject(g)))}e.updateDiagramElementQuad()})(this.diagram,n,l,this.currentPosition),o.isPreventHistory=!0;else{let a,h=this.diagram.nameTable[n.parentId];if(!h||h&&"SwimLane"!==h.shape.type)if(h&&h.isLane&&n.constraints&Vb.AllowMovingOutsideLane){const t=this.diagram.getObject(h.parentId),i=this.diagram.getObject(t.id+t.shape.lanes[0].id+"0"),s=i.wrapper.bounds.x,r=i.wrapper.bounds.y;new mb(s,r,t.wrapper.bounds.bottomRight.x-s,t.wrapper.bounds.bottomRight.y-r).containsPoint(this.currentPosition)&&(n.offsetX=e.offsetX,n.offsetY=e.offsetY,n.width=e.width,n.height=e.height,n.rotateAngle=e.rotateAngle)}else n.offsetX=e.offsetX,n.offsetY=e.offsetY,n&&n.shape&&"UmlClassifier"!==n.shape.type&&("Bpmn"!==n.shape.type||"Bpmn"===n.shape.type&&"TextAnnotation"!==n.shape.shape)&&(n.width=e.width,n.height=e.height),n.rotateAngle=e.rotateAngle;if(h&&h.container&&"Stack"===h.container.type&&(this.diagram.startGroupAction(),r=!0),!l&&h&&h.container&&"Stack"===h.container.type&&"Drag"===this.action){const e=h.wrapper.children.indexOf(n.wrapper);if(a={targetIndex:void 0,target:void 0,sourceIndex:e,source:QP(n)},e>-1){const i=h.children;i.splice(i.indexOf(n.id),1),this.diagram.nameTable[n.id].parentId="",t=!0,h.wrapper.children.splice(e,1)}}if(function(e,t,i,n){const s=e,r=i.nameTable[s.parentId],o=i.nameTable[s.parentId];if(t&&o&&o.container&&"Stack"===o.container.type&&t.container&&"Stack"===t.container.type&&o.id!==t.parentId){const e=o.wrapper.children.indexOf(s.wrapper);e>-1&&(i.nameTable[s.id].parentId=t.id,o.wrapper.children.splice(e,1))}if(t&&t.parentId&&s.parentId&&"Drag"===n&&o.container&&"Stack"===o.container.type){const n=r.wrapper.children.indexOf(t.wrapper),o=r.wrapper.children.indexOf(s.wrapper),a={targetIndex:n,target:t,sourceIndex:o,source:e};r.wrapper.children.splice(o,1),r.wrapper.children.splice(n,0,s.wrapper),i.commandHandler.addHistoryEntry({type:"StackChildPositionChanged",redoObject:{targetIndex:o,target:t,sourceIndex:n,source:e},undoObject:a,category:"Internal"})}}(n,l,this.diagram,this.action),h=Yx(this.diagram,n)?this.diagram.nameTable[n.parentId]:this.diagram.nameTable[n.parentId]||n,h&&h.container&&"Canvas"===h.container.type&&(h.wrapper.maxWidth=h.maxWidth=h.wrapper.actualSize.width,h.wrapper.maxHeight=h.maxHeight=h.wrapper.actualSize.height,s=!0),Yx(this.diagram,n,!0)&&h&&"Canvas"===h.container.type?Xx(this.diagram,n):o=this.updateContainerPropertiesExtend(h,n,i,e,o),this.diagram.lineRoutingModule&&this.diagram.constraints&Gb.LineRouting&&!Yx(this.diagram,n,!0)&&(n.children&&(this.diagram.realActions|=ev.EnableGroupAction),this.diagram.nodePropertyChange(n,{},{width:n.width,height:n.height,offsetX:n.offsetX,offsetY:n.offsetY}),n.children&&(this.diagram.realActions&=~ev.EnableGroupAction)),n.shape.lanes&&this.updateLaneChildNode(n),s&&(h.maxWidth=h.wrapper.maxWidth=void 0,h.maxHeight=h.wrapper.maxHeight=void 0),t){this.diagram.nodePropertyChange(h,{},{offsetX:h.offsetX,offsetY:h.offsetY,width:h.width,height:h.height,rotateAngle:h.rotateAngle});const e={redoObject:{sourceIndex:void 0,source:a.source},type:"StackChildPositionChanged",undoObject:a,category:"Internal"};this.diagram.diagramActions&Jb.UndoRedo||this.diagram.addHistoryEntry(e)}n&&n.container&&("Stack"===n.container.type||"Canvas"===n.container.type&&""===n.parentId)&&(n&&n.shape&&"UmlClassifier"===n.shape.type&&(n.wrapper.measureChildren=!0),this.diagram.nodePropertyChange(n,{},{offsetX:n.offsetX,offsetY:n.offsetY,width:n.width,height:n.height,rotateAngle:n.rotateAngle}),n&&n.shape&&"UmlClassifier"===n.shape.type&&(n.wrapper.measureChildren=!1))}hS(i,this.diagram),o.hasStack=r}}return n&&(n.isPhase||n.isLane||n.shape&&"SwimLane"===n.shape.type)&&this.diagram.updateDiagramElementQuad(),o}updateLaneChildNode(e){for(let t=0;t<e.shape.lanes.length;t++)if(e.shape.lanes[t].children&&e.shape.lanes[t].children.length>0)for(let i=0;i<e.shape.lanes[t].children.length;i++){const n=this.diagram.nameTable[e.shape.lanes[t].children[i].id];n.offsetX=n.wrapper.offsetX,n.offsetY=n.wrapper.offsetY}}updateContainerPropertiesExtend(e,t,i,n,s){if("ResizeEast"===this.currentAction||"ResizeSouth"===this.currentAction||"SwimLane"===t.shape.type){const r=QP(t);let o=!1;if(e&&e.container&&"Grid"===e.container.type){const r="SwimLane"===e.shape.type,a=r?e.wrapper.children[0]:e.wrapper,l=r?e.shape.padding:void 0,h=e.wrapper.bounds.x,c=e.wrapper.bounds.y;if(void 0!==t.columnIndex&&"Horizontal"===e.container.orientation&&(r&&t.isPhase||!r&&1===t.rowIndex)||"Vertical"===e.container.orientation&&(!r&&t.rowIndex>0&&t.columnIndex>0||r&&t.isLane)){if("Horizontal"===e.container.orientation&&t.isPhase&&t.wrapper.width>t.maxWidth&&(t.maxWidth=t.wrapper.width,t.wrapper.maxWidth=t.wrapper.width),cS(this.diagram,t,e,n),a.updateColumnWidth(t.columnIndex,n.width,!0,l),t.isPhase){const i=this.diagram.nameTable[e.shape.phases[t.columnIndex].header.id];i.maxWidth<n.width&&(i.maxWidth=n.width,i.wrapper.maxWidth=n.width)}"SwimLane"===e.shape.type&&(e.width=e.width?a.width:e.width,gS(this.diagram,e),e.wrapper.width=e.width,i=nS(this.diagram,a))}else void 0!==t.rowIndex&&(o=!0,cS(this.diagram,t,e,n),a.updateRowHeight(t.rowIndex,n.height,!0,l),"SwimLane"===e.shape.type&&(e.height=e.height?a.height:e.height,e.wrapper.height=e.height,i=nS(this.diagram,a)));"SwimLane"===e.shape.type&&(s.isPreventHistory=!0),this.diagram.nodePropertyChange(e,{},{offsetX:e.offsetX,offsetY:e.offsetY,rotateAngle:e.rotateAngle}),this.diagram.drag(e,h-e.wrapper.bounds.x,c-e.wrapper.bounds.y)}else t&&t.shape&&"UmlClassifier"===t.shape.type&&(t.wrapper.measureChildren=!0),this.diagram.nodePropertyChange(t,{},{offsetX:t.offsetX,offsetY:t.offsetY,width:t.width,height:t.height,rotateAngle:t.rotateAngle}),t.wrapper.measureChildren=!1;if(t.wrapper.measure(new nb(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize),"ResizeEast"===this.currentAction||"ResizeSouth"===this.currentAction){const e=QP(t);this.diagram.addHistoryEntry({category:"Internal",type:o?"RowHeightChanged":"ColumnWidthChanged",undoObject:r,redoObject:e})}}return hS(i,this.diagram),s}addUmlNode(){const e=this.diagram.selectedItems.nodes[0];let t=this.diagram.findObjectsUnderMouse({x:this.currentPosition.x+20,y:this.currentPosition.y}),i=this.diagram.findObjectUnderMouse(t,this.action,this.inAction);if(i||(t=this.diagram.findObjectsUnderMouse({x:this.currentPosition.x-20,y:this.currentPosition.y}),i=this.diagram.findObjectUnderMouse(t,this.action,this.inAction)),e&&e.container&&"Stack"===e.container.type&&i&&i.parentId&&i.parentId===e.id){const t=i,n=TP(this.diagram.element.id);if(n.getElementById(n.id+"_stack_highlighter")){const n=e.wrapper.children.indexOf(i.wrapper)+1;this.diagram.enableServerDataBinding(!1);const s=new pP(this.diagram,"nodes",{style:{fill:e.style.fill,strokeColor:"black"===e.style.strokeColor?"#ffffff00":e.style.strokeColor},annotations:i.annotations,verticalAlignment:"Stretch",horizontalAlignment:"Stretch",constraints:(Vb.Default|Vb.HideThumbs)&~(Vb.Rotate|Vb.Drag|Vb.Resize),minHeight:25},!0);s.annotations[0].content=" + Name : Type",t.id.split("_"),s.id=XP()+s.id,s.parentId=e.id,s.zIndex=-1,s.umlIndex=n,this.diagram.startGroupAction(),e.wrapper.children.indexOf(s.wrapper),this.diagram.enableServerDataBinding(!0),this.diagram.add(s),this.diagram.updateConnectorEdges(e),this.diagram.clearSelection(),this.diagram.select([this.diagram.nameTable[s.id]]),this.diagram.endGroupAction(),this.diagram.startTextEdit()}}}}class oT{findObjectsUnderMouse(e,t,i,n,s){let r,o,a,l,h=[];n&&n instanceof bP&&n.nodes.length+n.connectors.length===1&&(n=n.nodes[0]||n.connectors[0]).children&&0===n.children.length&&(i.actualObject=n);const c=n&&n instanceof Vw&&(n.constraints&Ub.ConnectToNearByNode||n.constraints&Ub.ConnectToNearByPort)&&n.connectionPadding||0,d=t.spatialSearch.findObjects(new mb(e.x-50-c,e.y-50-c,100+c,100+c)),p={};let u;for(const g of d){let i=e;o=g.wrapper.outerBounds;let s=!g.rotateAngle&&o.containsPoint(i,c);if((g!==n||t.currentDrawingObject instanceof Vw)&&g instanceof Vw?g!==t.currentDrawingObject:g.wrapper.visible){const h=t.commandHandler.getObjectLayer(g.id);if(h&&!h.lock&&h.visible){if(u=p[h.zIndex]=p[h.zIndex]||[],g.rotateAngle)for(a of(r=g.wrapper,o=ZP(r),r.children))l=bb(),wb(l,-(a.rotateAngle+a.parentTransform),a.offsetX,a.offsetY),i=vb(l,e),ZP(a).containsPoint(i,c)&&(s=!0);if((!n||!1===jO(t,g))&&tx(g)&&(g instanceof Vw?NS(g,e):s)){const t=g instanceof Vw&&g.hitPadding||0;this.findElementUnderMouse(g,e,c||t)&&"helper"!==g.id&&gC(g,"zIndex",u)}}}}for(const g of t.layers){h=h.concat(p[g.zIndex]||[]);for(const e of h){const i="eventHandler";if("Bpmn"===e.shape.type&&e.processId&&(!(t[i].tool instanceof VO)||t[i].tool instanceof VO&&ux(e))){const i=h.indexOf(t.nameTable[e.processId]);i>-1&&h.splice(i,1)}if("UmlClassifier"===e.shape.type&&e.container&&"Stack"===e.container.type){const i=h.indexOf(t.nameTable[t.nameTable[e.id].wrapper.children[0].id]);i>-1&&h.splice(i,1)}}}for(let g=0;g<h.length;g++){let i=t.nameTable[h[g].parentId];if(i){const t=this.findElementUnderMouse(i,e);for(let e=0;e<i.ports.length;e++)if(t.id.match("_"+i.ports[e].id+"$")){const t=i.ports[e];if(Ox(t)||Px(t))return h}}for(;i;){const e=h.indexOf(i);if(-1===e)break;h.splice(e,1),i=t.nameTable[i.parentId]}}if(this.checkSwimlane(h,t),i&&!i.source)for(let g=0;g<h.length;g++){const e=t.nameTable[h[g].parentId];if(e&&"SwimLane"===e.shape.type)for(let t=0;t<h.length;t++)h[t]instanceof Vw&&h.splice(g,1)}return h}checkSwimlane(e,t){let i;for(let n=0;n<e.length;n++){let s,r,o=e[n];o instanceof pP&&(s=e[n].parentId,r=o),""===s&&(i="SwimLane"!==r.shape.type);let a=t.nameTable[s];if(a&&a.isLane&&t.nameTable[a.parentId].zIndex>o.zIndex&&(e[n]=a),n>0&&i&&r&&(r.isLane||r.isPhase||r.isHeader)&&e[n].zIndex<e[n-1].zIndex){let t=e[n];e[n]=e[n-1],e[n-1]=t}}if(e.length>=2){let i="";for(let n=e.length-1;n>=0;n--)if(e[n].parentId){let s=AC(e[n],t,i),r=AC(e[n-1],t,i),o=t.nameTable[s],a=t.nameTable[r];a&&s!==r&&o.zIndex<a.zIndex&&e.splice(n,1)}}}isTarget(e,t,i){const n=t.selectedItems.connectors[0];let s;if(s="ConnectorSourceEnd"===i?t.nameTable[n.targetID]:s=t.nameTable[n.sourceID],!s||(s.processId||e.processId)&&s.processId===e.processId||(s.processId!==e.processId&&(e=null),e&&e.parentId&&"UmlClassifier"===t.nameTable[e.parentId].shape.type&&(e=t.nameTable[e.parentId])),"ConnectorSourceEnd"===i&&n.targetID){const i=t.nameTable[n.targetID];if(i&&i.shape&&"TextAnnotation"===i.shape.shape){const s=n.id.split("_");("Bpmn"===i.shape.type&&"Bpmn"!==e.shape.type||s[0]===e.id||"TextAnnotation"===e.shape.shape)&&(e=null),e.parentId&&"UmlClassifier"===t.nameTable[e.parentId].shape.type&&(e=t.nameTable[e.parentId])}}return e}findObjectUnderMouse(e,t,i,n,s,r,o){let a,l,h=null;if(0!==t.length)if(o&&o instanceof bP&&o.nodes.length+o.connectors.length===1&&(o=o.nodes[0]||o.connectors[0]),"ConnectorSourceEnd"===i&&o||"PortDraw"===i||(vx(e)||bx(e))&&yC(e.drawingObject)===Vw){const n=e.selectedItems.connectors[0];for(let o=t.length-1;o>=0;o--){l=cC(t[o],!1),a=cC(t[o],!0);const c=e.eventHandler.tool,d=this.findTargetElement(t[o].wrapper,r,void 0);if("Draw"===i&&d&&t[o]instanceof pP&&!CC(t[o],d)&&(c&&"ConnectorSourceEnd"===c.endPoint&&!cx(t[o])||c&&"ConnectorTargetEnd"===c.endPoint&&!lx(t[o])))return h;if(t[o]instanceof pP&&(cx(t[o])||dx(l)||lx(t[o])||hx(a)||"PortDraw"===i&&c instanceof FO&&"ConnectorTargetEnd"===c.endPoint&&(lx(t[o])||hx(a))))return h=t[o],n&&(h=this.isTarget(h,e,i)),s.actualObject=h,h}}else if("ConnectorTargetEnd"===i&&o){for(let c=t.length-1;c>=0;c--)if(a=cC(t[c],!0),t[c]instanceof pP&&(lx(t[c])||hx(a)))return h=t[c],h=this.isTarget(h,e,i),s.actualObject=h,h}else{if(o&&("Drag"===i||e.eventHandler.tool instanceof VO)){let i=0;for(let e=0;e<t.length;e++){const n=t[e];o!==n&&(n instanceof Vw||!r||n.wrapper.bounds.containsPoint(r))&&ux(n)&&(h?(h=i>=n.zIndex?h:n,i=Math.max(i,n.zIndex)):(h=n,i=h.zIndex))}return h&&"Bpmn"===h.shape.type&&(h=e.selectedItems.nodes.length>0&&"Bpmn"===e.selectedItems.nodes[0].shape.type?h:null),h&&(s.actualObject=h),h}if("Select"!==i&&"Pan"!==i||!e.eventHandler.tool)if("Pan"===i||"LayoutAnimation"===i){for(let e=t.length-1;e>=0;e--)if(t[e]instanceof pP||t[e]instanceof Vw){const n=this.findTargetElement(t[e].wrapper,r,void 0);if("Pan"===i||n&&(n.id.match("_icon_content_shape$")||n.id.match("_icon_content_rect$")))return t[e]}}else h=t[t.length-1],s&&h&&(s.actualObject=h);else{for(let e=t.length-1;e>=0;e--)if(t[e]instanceof Vw){const i=t[e-1];if(t[e-1]instanceof pP&&i.ports){const e=this.findTargetElement(i.wrapper,r,void 0);if(e&&(e.id.match("_icon_content_shape$")||e.id.match("_icon_content_rect$")))return i;for(let t=0;t<i.ports.length;t++)if(e&&e.id.match("_"+i.ports[t].id+"$")&&Px(i.ports[t]))return i}}if(h=t[t.length-1],s.actualObject=h,!e.eventHandler.itemClick(h,!0)&&h.parentId){let t=h;const i=jO(e,t);for(;t&&(!jO(e,t)||i);)h=t,t=e.nameTable[t.parentId]}}}return h}findElementUnderSelectedItem(e,t,i){return e instanceof bP?1!==e.nodes.length||e.connectors&&e.connectors.length?e.nodes&&!e.nodes.length||1!==e.connectors.length?null:this.findElementUnderMouse(e.connectors[0],t):this.findElementUnderMouse(e.nodes[0],t):this.findElementUnderMouse(e,t,i)}findElementUnderMouse(e,t,i){return this.findTargetElement(e.wrapper,t,i)}findTargetElement(e,t,i){for(let n=e.children.length-1;n>=0;n--){const s=e.children[n];if(s&&s.outerBounds.containsPoint(t,i||0)){if(s instanceof ov){const e=this.findTargetElement(s,t);if(e)return e}if(s.bounds.containsPoint(t,i||0))return s}}return e.bounds.containsPoint(t,i)&&"none"!==e.style.fill?e:null}}var aT=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let lT=(()=>{class e extends bg{constructor(e,t,i,n){super(e,t,i,n),this.objectZIndex=-1,this.zIndexTable={},this.objects=[]}}return aT([ig("")],e.prototype,"id",void 0),aT([ig(!0)],e.prototype,"visible",void 0),aT([ig(!1)],e.prototype,"lock",void 0),aT([ig()],e.prototype,"objects",void 0),aT([ig()],e.prototype,"addInfo",void 0),aT([ig(-1)],e.prototype,"zIndex",void 0),e})();var hT=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function a(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){e.done?s(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};class cT{constructor(e){this.clipboardData={},this.diagramObject={},this.newSelectedObjects={},this.oldSelectedObjects={},this.connectorsTable=[],this.processTable={},this.deepDiffer=new _O,this.isContainer=!1,this.childTable={},this.parentTable={},this.blazor="Blazor",this.blazorInterop="sfBlazor",this.cloneGroupChildCollection=[],this.diagram=e}get snappingModule(){return this.diagram.snappingModule}get layoutAnimateModule(){return this.diagram.layoutAnimateModule}startTransaction(e){this.state={element:this.diagram.selectedItems,backup:null},e&&this.diagram.protectPropertyChange(!0),AP(this.diagram.element.id).style.pointerEvents="none"}endTransaction(e){this.state=null,e&&this.diagram.protectPropertyChange(!1),AP(this.diagram.element.id).style.pointerEvents="all"}setFocus(){document.getElementById(this.diagram.element.id).focus()}showTooltip(e,t,i,n,s){let r,o,a=!1;if(e instanceof bP?1==e.nodes.length&&0==e.connectors.length?(r=e.nodes[0].id,e.nodes[0].shape&&e.nodes[0].shape instanceof WC&&(a=!0)):0==e.nodes.length&&1==e.connectors.length?r=e.connectors[0].id:o=document.getElementById(this.diagram.element.id+"_SelectorElement"):e instanceof pP?(r=e.id,e.shape&&e.shape instanceof WC&&(a=!0)):r=e.id,jp(o)&&!jp(r)&&(o=document.getElementById(r+(a?"_content_native_element":"_groupElement"))),s&&(this.diagram.tooltipObject.position="BottomCenter",this.diagram.tooltipObject.animation={open:{delay:0,duration:0}},this.diagram.tooltipObject.openDelay=0,this.diagram.tooltipObject.closeDelay=0),this.diagram.selectedItems.setTooltipTemplate){let t;const n=hO(this.diagram.selectedItems.setTooltipTemplate);n&&(t=n(e,this.diagram)),i=t instanceof HTMLElement?t.cloneNode(!0):t||i}e.tooltip&&(this.diagram.tooltipObject.openOn=e.tooltip.openOn),this.diagram.tooltipObject.content=i,this.diagram.tooltipObject.offsetX=0,this.diagram.tooltipObject.offsetY=0,this.diagram.tooltipObject.refresh(o),s&&setTimeout(()=>{this.diagram.tooltipObject.open(o)},1)}closeTooltip(){this.diagram.tooltipObject.close()}canEnableDefaultTooltip(){return!!(this.diagram.selectedItems.constraints&Wb.ToolTip)}updateSelector(){this.diagram.updateSelector()}updateConnectorValue(e){if(e.cancel){this.enableCloneObject(!0),this.ismouseEvents(!0),this.insertBlazorObject(e.connector);const t={},i={},n=this.diagram.nameTable[e.connector.id],s="ConnectorSourceEnd"===e.connectorEnd?"sourceID":"targetID",r="ConnectorSourceEnd"===e.connectorEnd?"sourcePortID":"targetPortID",o="ConnectorTargetEnd"===e.connectorEnd,a=o?e.newValue.connectorTargetValue:e.newValue.connectorSourceValue,l=o?e.oldValue.connectorTargetValue:e.oldValue.connectorSourceValue;i[s]=a.nodeId,i[r]=a.portId,t[s]=l.nodeId,t[r]=l.portId,e.cancel&&"ConnectorTargetEnd"!==e.connectorEnd&&(n.sourceID=l.nodeId,e.connector.sourcePortID&&(n.sourcePortID=l.portId),this.diagram.connectorPropertyChange(n,i,t)),e.cancel&&"ConnectorTargetEnd"===e.connectorEnd&&(e.connector.targetPortID&&(n.targetPortID=l.portId),n.targetID=l.nodeId,this.diagram.connectorPropertyChange(n,i,t))}}triggerEvent(e,t){return hT(this,void 0,void 0,function*(){if(e===nv.drop||e===nv.positionChange||e===nv.connectionChange){if(this.diagram.currentSymbol)return;if(e===nv.drop&&(t.source=this.diagram),this.diagram.currentDrawingObject&&e!==nv.positionChange)return}return yield this.diagram.triggerEvent(e,t)})}dragOverElement(e,t){this.diagram.currentSymbol&&this.triggerEvent(nv.dragOver,{element:e.source,target:e.target,mousePosition:t,diagram:this.diagram})}disConnect(e,t,i){let n,s,r,o={},a={};if(e instanceof bP?(s=e,r=s.connectors[0]):e instanceof Vw&&this.diagram.currentDrawingObject&&(r=this.diagram.currentDrawingObject),e&&r&&(kO(this.diagram)||this.diagram.currentDrawingObject))if(!t||"ConnectorSourceEnd"!==t&&"ConnectorTargetEnd"!==t){if("OrthoThumb"!==t&&"SegmentEnd"!==t&&(r.sourceID||r.targetID)){o={sourceID:r.sourceID,sourcePortID:r.sourcePortID,targetID:r.targetID,targetPortID:r.targetPortID},r.sourceID="",r.sourcePortID="",r.targetID="",r.targetPortID="",a={sourceID:r.sourceID,sourcePortID:r.sourcePortID,targetID:r.targetID,targetPortID:r.targetPortID};let e={connector:r,oldValue:o,newValue:a,cancel:!1,state:"Changing",connectorEnd:t};this.triggerEvent(nv.connectionChange,e),e.cancel?(r.sourceID=o.sourceID,r.sourcePortID=o.sourcePortID,r.targetID=o.targetID,r.targetPortID=o.targetPortID):(this.diagram.connectorPropertyChange(r,o,a),this.diagram.updateDiagramObject(r),e={connector:r,oldValue:o,newValue:a,cancel:!1,state:"Changed",connectorEnd:t},this.triggerEvent(nv.connectionChange,e))}}else{const e="ConnectorSourceEnd"===t?"sourceID":"targetID",s="ConnectorSourceEnd"===t?"sourcePortID":"targetPortID";r[e]&&(o[e]=r[e],r[e]="",a[e]=r[e],(r.sourcePortID||r.targetPortID)&&(o[s]=r[s],r[s]="",a[s]=r[s]),n=this.connectionEventChange(r,o,a,t,i))}return n}connectionEventChange(e,t,i,n,s){const r="ConnectorSourceEnd"===n?"sourceID":"targetID",o="ConnectorSourceEnd"===n?"sourcePortID":"targetPortID";let a;if(this.enableCloneObject){a=this.diagram.nameTable[i[r]];const e=QP(a);this.diagram.insertValue(e,!0)}let l={cancel:!1,state:"Changing",connectorEnd:n,connector:e,oldValue:{nodeId:t[r],portId:t[o]},newValue:{nodeId:i[r],portId:i[o]}};if(this.triggerEvent(nv.connectionChange,l),l.cancel?(e[r]=t[r],e[o]=t[o],i=t):(this.diagram.connectorPropertyChange(e,t,i),this.diagram.updateDiagramObject(e),l={connector:e,oldValue:{nodeId:t[r],portId:t[o]},newValue:{nodeId:i[r],portId:i[o]},cancel:!1,state:"Changing",connectorEnd:n}),this.enableCloneObject&&void 0===a){a=this.diagram.nameTable[t[r]];const e=QP(a);this.diagram.insertValue(e,!0)}}insertBlazorObject(e,t){let i,n;if(e instanceof bP){this.oldSelectedObjects=xC(this.diagram);for(let t=0;t<e.nodes.length;t++)i=this.diagram.getObject(e.nodes[t].id),this.diagram.insertValue(QP(i),!0);for(let t=0;t<e.connectors.length;t++)n=this.diagram.getObject(e.connectors[t].id),this.diagram.insertValue(QP(n),!1)}else e=this.diagram.getObject(e.id),this.diagram.insertValue(QP(e),e instanceof pP)}updatePropertiesToBlazor(e,t){this.enableCloneObject(!1),this.ismouseEvents(!1),this.getBlazorOldValues(e,t),this.updateBlazorSelector()}insertSelectedObjects(){this.oldSelectedObjects=xC(this.diagram)}findTarget(e,t,i,n){if(t instanceof pP){if(e&&e.id===t.id+"_content")return t;if(i&&"Bpmn"===t.shape.type&&"Activity"===t.shape.shape&&"Transaction"===t.shape.activity.subProcess.type){const i=t.shape.activity.subProcess.transaction;if(i.success.visible&&0===e.id.indexOf(t.id+"_success"))return i.success;if(i.cancel.visible&&0===e.id.indexOf(t.id+"_cancel"))return i.cancel;if(i.failure.visible&&0===e.id.indexOf(t.id+"_failure"))return i.failure}if(e instanceof dv)for(let i=0;i<t.ports.length;i++){const n=t.ports[i];if(e.id===t.id+"_"+n.id)return n}}if(!n){let i;for(let n=0;n<t.annotations.length;n++)if(i=t.annotations[n],e.id===t.id+"_"+i.id)return i}return t}canDisconnect(e,t,i,n){let s,r;return t.source instanceof bP?(s=t.source,r=s.connectors[0]):t.source instanceof Vw&&this.diagram.currentDrawingObject&&(r=this.diagram.currentDrawingObject),this.findTarget(t.targetWrapper,t.target,"ConnectorSourceEnd"===e,!0),r["ConnectorSourceEnd"===e?"sourceID":"targetID"]!==n||r["ConnectorSourceEnd"===e?"sourcePortID":"targetPortID"]!==i}changeAnnotationDrag(e){let t,i;if(e.source&&e.source.connectors&&e.source.connectors.length&&this.diagram.bpmnModule&&this.diagram.bpmnModule.textAnnotationConnectors.indexOf(e.source.connectors[0])>-1){e.source instanceof bP&&(t=e.source,i=t.connectors[0]);const n=i.id.split("_"),s=n[n.length-3]||n[0];if(e.target&&e.target.id!==s&&"TextAnnotation"!==e.target.shape.shape){this.diagram.startGroupAction();const t=this.getAnnotation(this.diagram.nameTable[n[0]],n[1]),s={id:n[1]+XP(),angle:rb.findAngle(i.intermediatePoints[0],i.intermediatePoints[1]),text:t.text,length:rb.distancePoints(i.intermediatePoints[0],i.intermediatePoints[1]),shape:{shape:"TextAnnotation",type:"Bpmn"},nodeId:t.nodeId},r=new tP(e.target.shape,"annotations",s,!0);this.diagram.bpmnModule.checkAndRemoveAnnotations(this.diagram.nameTable[i.targetID],this.diagram),this.diagram.refreshCanvasLayers(),r.id=n[1],this.diagram.addTextAnnotation(r,e.target),this.diagram.endGroupAction()}else i&&(i.sourceID=s,this.diagram.connectorPropertyChange(i,{},{sourceID:s}),this.diagram.updateDiagramObject(i))}}connect(e,t,i){const n={},s={};let r,o,a,l,h;t.source instanceof bP?(a=t.source,l=a.connectors[0]):t.source instanceof Vw&&this.diagram.currentDrawingObject&&(l=this.diagram.currentDrawingObject);const c=this.findTarget(t.targetWrapper||t.sourceWrapper,t.target||t.actualObject,"ConnectorSourceEnd"===e,!0),d="ConnectorSourceEnd"===e?"sourceID":"targetID",p="ConnectorSourceEnd"===e?"sourcePortID":"targetPortID";if(c instanceof pP)s[d]=l[d],l[d]=c.id,n[d]=l[d],s[p]=l[p],h=this.connectionEventChange(l,s,n,e,i);else{r=l[d],o=l[p],l[p]=c.id,l[d]=t.target&&t.target.id||t.actualObject.id,n[d]=l[d],n[p]=l[p];let i={connector:l,oldValue:{nodeId:r,portId:o},newValue:{nodeId:n[d],portId:n[p]},cancel:!1,state:"Changing",connectorEnd:e};this.triggerEvent(nv.connectionChange,i),i.cancel?(l[d]=r,l[p]=o,n[d]=r,n[p]=o):(this.diagram.connectorPropertyChange(l,s,n),this.diagram.updateDiagramObject(l),i={connector:l,oldValue:{nodeId:r,portId:o},newValue:{nodeId:n[d],portId:n[p]},cancel:!1,state:"Changing",connectorEnd:e})}return this.renderHighlighter(t,void 0,"ConnectorSourceEnd"===e),h}cut(){this.clipboardData.pasteIndex=0,this.diagram.undoRedoModule&&this.diagram.historyManager.startGroupAction(),this.clipboardData.clipObject=this.copyObjects(),this.diagram.undoRedoModule&&this.diagram.historyManager.endGroupAction(),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer()}UpdateBlazorDiagramModelLayers(e,t){if(window&&window.Blazor){const i={methodName:"UpdateBlazorDiagramModelLayers",diagramobj:JSON.stringify(e),isRemove:t};this.diagram.isLoading||window.sfBlazor.updateBlazorProperties(i,this.diagram)}}addLayer(e,t,i=!0){e.id=e.id||XP(),e.zIndex=this.diagram.layers.length;let n=this.diagram.allowServerDataBinding;if(this.diagram.enableServerDataBinding(!1),e=new lT(this.diagram,"layers",e,!0),this.diagram.enableServerDataBinding(n),e.objectZIndex=-1,e.zIndexTable={},this.diagram.layers.push(e),i&&this.UpdateBlazorDiagramModelLayers(e,!1),this.diagram.layerZIndexTable[e.zIndex]=e.id,this.diagram.activeLayer=e,t)for(let s=0;s<t.length;s++)this.diagram.add(t[s])}getObjectLayer(e){const t=this.diagram.layers;for(let i=0;i<t.length;i++)if(t[i].objects.indexOf(e)>-1)return t[i];return this.diagram.activeLayer}getLayer(e){const t=this.diagram.layers;for(let i=0;i<t.length;i++)if(t[i].id===e)return t[i]}removeLayer(e,t=!0){const i=this.getLayer(e);if(i){const n=this.diagram.layers.indexOf(i),s=i.objects;for(let t=s.length-1;t>=0;t--)this.diagram.unSelect(this.diagram.nameTable[s[t]]),this.diagram.remove(this.diagram.nameTable[s[t]]),"default_layer"!==i.id&&this.diagram.activeLayer.id===e&&(this.diagram.activeLayer=this.diagram.layers[this.diagram.layers.length-1]);t&&this.UpdateBlazorDiagramModelLayers(this.diagram.layers[n],!0),delete this.diagram.layerZIndexTable[i.zIndex],this.diagram.layers.splice(n,1),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer()}}moveObjects(e,t){const i=this.getLayer(t)||this.diagram.activeLayer;let n;this.diagram.setActiveLayer(i.id);for(const s of e)this.getObjectLayer(s).objects.indexOf(s)>-1&&(n=this.diagram.nameTable[s],this.diagram.unSelect(n),this.diagram.remove(this.diagram.nameTable[s]),this.diagram.add(n))}cloneLayer(e){const t=this.getLayer(e);if(t){const i=[],n={id:e+"_"+XP(),objects:[],visible:!0,lock:!1};this.addLayer(n,null,!0),n.zIndex=this.diagram.layers.length-1;for(const e of t.objects)i.push(this.diagram.nameTable[e]);this.paste(i)}}copy(){return this.clipboardData.pasteIndex=1,this.clipboardData.clipObject=this.copyObjects(),this.clipboardData.clipObject}copyObjects(){let e=[];const t=[];if(this.clipboardData.childTable={},this.diagram.selectedItems.connectors.length>0){e=this.diagram.selectedItems.connectors;for(let i=0;i<e.length;i++){let n;n=this.diagram.bpmnModule&&this.diagram.bpmnModule.textAnnotationConnectors.indexOf(e[i])>-1?QP(this.diagram.nameTable[e[i].targetID]):QP(e[i]),t.push(n)}}if(this.diagram.selectedItems.nodes.length>0){e=e.concat(this.diagram.selectedItems.nodes);for(let i=0;i<this.diagram.selectedItems.nodes.length;i++)if(!e[i].isPhase){const e=QP(this.diagram.selectedItems.nodes[i]);e.wrapper&&e.offsetX!==e.wrapper.offsetX&&(e.offsetX=e.wrapper.offsetX),e.wrapper&&e.offsetY!==e.wrapper.offsetY&&(e.offsetY=e.wrapper.offsetY),this.copyProcesses(e),t.push(QP(e));const n=bb();if(wb(n,-e.rotateAngle,e.offsetX,e.offsetY),e.children){const t=this.clipboardData.childTable;let i;const s=this.getAllDescendants(e,[],!0);for(let r=0;r<s.length;r++){i=this.diagram.nameTable[s[r].id];const o=t[i.id]=QP(i),a=vb(n,{x:o.wrapper.offsetX,y:o.wrapper.offsetY});i instanceof pP&&(o.offsetX=a.x,o.offsetY=a.y,o.rotateAngle-=e.rotateAngle)}this.clipboardData.childTable=t}if("SwimLane"===e.shape.type){const e=this.diagram.getObject(this.diagram.selectedItems.nodes[i].id),t=this.clipboardData.childTable,n=nS(this.diagram,e.wrapper.children[0]);for(let i=0;i<n.length;i++){const e=this.diagram.getObject(n[i]);t[e.id]=QP(e)}}if(e&&e.isLane){const t=this.clipboardData.childTable,i=this.diagram.getObject(e.parentId),n=AS(e,this.diagram);t[e.id]=QP(n),t[e.id].width=i.wrapper.actualSize.width}}}if(0===this.clipboardData.pasteIndex){this.startGroupAction();for(const t of e)this.diagram.nameTable[t.id]&&(this.diagram.bpmnModule&&this.diagram.bpmnModule.textAnnotationConnectors.indexOf(t)>-1?this.diagram.remove(this.diagram.nameTable[t.targetID]):this.diagram.remove(t));this.endGroupAction()}return this.sortByZIndex(t,"zIndex"),t}copyProcesses(e){if("Bpmn"===e.shape.type&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length>0){const t=e.shape.activity.subProcess.processes;for(const e of t)this.processTable[e]=QP(this.diagram.nameTable[e]),this.processTable[e].shape.activity.subProcess.processes&&this.processTable[e].shape.activity.subProcess.processes.length>0&&this.copyProcesses(this.processTable[e]);this.clipboardData.processTable=this.processTable}}group(){this.oldSelectedObjects=xC(this.diagram);const e=this.diagram.isProtectedOnChange;this.diagram.protectPropertyChange(!0),this.diagram.diagramActions=this.diagram.diagramActions|Jb.Group;let t=[],i={};i.id="group"+XP(),i=new pP(this.diagram,"nodes",i,!0),i.children=[],t=this.diagram.selectedItems.nodes,t=t.concat(this.diagram.selectedItems.connectors);for(let s=0;s<t.length;s++)t[s].parentId||i.children.push(t[s].id);const n=this.diagram.add(i);n&&this.select(n),this.addHistoryEntry({type:"Group",undoObject:i,redoObject:i,category:"Internal"}),this.diagram.diagramActions=this.diagram.diagramActions&~Jb.Group,this.diagram.protectPropertyChange(e),this.updateBlazorSelector()}unGroup(e){const t=this.diagram.isProtectedOnChange;this.diagram.protectPropertyChange(!0),this.diagram.diagramActions=this.diagram.diagramActions|Jb.Group;let i=[];e?i.push(e):i=this.diagram.selectedItems.nodes,this.diagram.startGroupAction();for(let n=0;n<i.length;n++){const e=i[n],t=QP(e),s=[];for(let i=0;i<e.children.length;i++)s.push(e.children[i]);if(e.children){e.ports&&e.ports.length>0&&this.diagram.removePorts(e,e.ports),e.annotations&&e.annotations.length>0&&this.diagram.removeLabels(e,e.annotations);const i=this.diagram.nameTable[e.parentId];for(let t=e.children.length-1;t>=0;t--)this.diagram.nameTable[e.children[t]].parentId="",this.diagram.deleteChild(this.diagram.nameTable[e.children[t]],e),e.parentId&&e.children[t]&&this.diagram.addChild(i,e.children[t]);this.resetDependentConnectors(e.inEdges,!0),this.resetDependentConnectors(e.outEdges,!1);const n={type:"UnGroup",undoObject:t,redoObject:t,category:"Internal"};this.diagram.diagramActions&Jb.UndoRedo||this.addHistoryEntry(n),e.parentId&&this.diagram.deleteChild(e,i)}this.diagram.removeNode(e,s),this.clearSelection()}this.diagram.endGroupAction(),this.diagram.diagramActions=this.diagram.diagramActions&~Jb.Group,this.diagram.protectPropertyChange(t)}resetDependentConnectors(e,t){for(let i=0;i<e.length;i++){const n=this.diagram.nameTable[e[i]],s=QP(n);let r;t?(n.targetID="",n.targetPortID="",r={targetID:n.targetID,targetPortID:n.targetPortID}):(n.sourceID="",n.sourcePortID="",r={sourceID:n.sourceID,sourcePortID:n.sourcePortID}),this.diagram.connectorPropertyChange(n,{},r);const o={type:"ConnectionChanged",undoObject:{connectors:[s],nodes:[]},redoObject:{connectors:[QP(n)],nodes:[]},category:"Internal"};this.diagram.diagramActions&Jb.UndoRedo||this.addHistoryEntry(o)}}paste(e){if(e||this.clipboardData.clipObject){this.diagram.protectPropertyChange(!0);const t=e?this.getNewObject(e):this.clipboardData.clipObject;if(t){const e=1!==t.length;let i=!1;const n={},s={};0!==this.clipboardData.pasteIndex&&this.clearSelection(),this.diagram.undoRedoModule&&(i=!0,this.diagram.historyManager.startGroupAction());for(const o of t)n[o.id]=o;let r=[];e&&(this.diagram.isServerUpdate=!0);for(let o=0;o<t.length;o++){const i=t[o];if(yC(i)===Vw){const t=QP(i);let o=t.sourceID;t.sourceID="",n[o]&&s[o]&&(t.sourceID=s[o]),o=t.targetID,t.targetID="",n[o]&&s[o]&&(t.targetID=s[o]);const a=this.cloneConnector(t,e);r.push(a),s[i.id]=a.id}else{const t=this.cloneNode(i,e);if(r.push(t),t){s[i.id]=t.id;let e=i.inEdges;if(e)for(const t of e)if(n[t]&&s[t]){const e=this.diagram.nameTable[s[t]];e.targetID=s[i.id],this.diagram.connectorPropertyChange(e,{targetID:"",targetPortID:""},{targetID:e.targetID,targetPortID:e.targetPortID})}if(e=i.outEdges,e)for(const t of e)if(n[t]&&s[t]){const e=this.diagram.nameTable[s[t]];e.sourceID=s[i.id],this.diagram.connectorPropertyChange(e,{sourceID:"",sourcePortID:""},{sourceID:e.sourceID,sourcePortID:e.sourcePortID})}}}}e&&(this.diagram.isServerUpdate=!1,this.diagram.UpdateBlazorDiagramModelCollection(t[0],r),this.getBlazorOldValues(),this.diagram.select(r,!0)),!0===i&&(this.diagram.historyManager.endGroupAction(),i=!1),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer(),this.clipboardData.pasteIndex++,this.diagram.protectPropertyChange(!1)}}}getNewObject(e){let t;const i=[];this.clipboardData.pasteIndex=1;for(let n=0;n<e.length;n++)t=QP(e[n]),i.push(t);return i}cloneConnector(e,t){const i=QP(e);this.translateObject(i),i.zIndex=-1;const n=this.diagram.add(i);return this.diagram.isServerUpdate||this.selectObjects([n],t),n}cloneNode(e,t,i,n){let s;const r={},o=QP(e);let a;const l=this.diagram.nameTable[e.parentId];if(e.shape&&"Bpmn"===e.shape.type&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length&&(a=o.shape.activity.subProcess.processes,o.zIndex=-1,o.shape.activity.subProcess.processes=void 0),e.shape&&"SwimLane"===e.shape.type)wS(e,this.diagram,this.clipboardData);else if(l&&"SwimLane"===l.shape.type)wS(QP(l),this.diagram,this.clipboardData,e,!0);else if(!e.children||!e.children.length||i&&i.length)if(e.shape&&"TextAnnotation"===e.shape.shape&&-1!==e.id.indexOf("_textannotation_")&&this.diagram.nameTable[e.id]){const t=e.id.split("_textannotation_"),i=this.diagram.nameTable[e.id];for(let e=0;e<i.inEdges.length;e++){const n=this.diagram.nameTable[i.inEdges[e]];if(n){const e=this.diagram.nameTable[n.sourceID],i=this.getAnnotation(e,t[1]),s={id:t[1]+XP(),angle:i.angle,text:i.text,length:i.length,shape:{shape:"TextAnnotation",type:"Bpmn"},nodeId:i.nodeId};this.diagram.addTextAnnotation(s,e)}}}else this.translateObject(o,n),o.zIndex=-1,i&&(o.children=i),s=this.diagram.add(o);else s=this.cloneGroup(e,t);for(const h of Object.keys(r))this.diagram.add(r[h]);return a&&a.length&&(s.shape.activity.subProcess.processes=a,this.cloneSubProcesses(s)),s&&!this.diagram.isServerUpdate&&this.selectObjects([s],t),s}getAnnotation(e,t){const i=e.shape.annotations;if(i&&i.length)for(let n=0;n<=i.length;n++)if(i[n].id===t)return i[n]}cloneSubProcesses(e){const t=[],i={};if("Bpmn"===e.shape.type&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length){const n=e.shape.activity.subProcess.processes;for(let s=0;s<n.length;s++){const r=this.diagram.nameTable[n[s]]||this.clipboardData.processTable[n[s]];for(const e of r.outEdges)t.indexOf(e)<0&&t.push(e);for(const e of r.inEdges)t.indexOf(e)<0&&t.push(e);const o=QP(this.clipboardData.processTable[n[s]]);o.processId=e.id;const a=this.cloneNode(o,!1);i[n[s]]=a.id,n[s]=a.id,this.diagram.addProcess(a,e.id);for(const e of t){const n=QP(this.diagram.nameTable[e]||this.diagram.connectorTable[e]);i[n.sourceID]&&i[n.targetID]&&(n.zIndex=-1,n.id+=XP(),n.sourceID=i[n.sourceID],n.targetID=i[n.targetID],t.splice(t.indexOf(e),1),this.diagram.add(n))}}}}cloneGroup(e,t){const i=[];let n=[];const s=[];let r;const o=[];n=n.concat(e.children);const a=XP(),l=[];if(this.diagram.blazorActions|=_b.GroupClipboardInProcess,this.clipboardData.childTable||e.children.length>0)for(let c=0;c<n.length;c++){let e;e=this.clipboardData.childTable?this.clipboardData.childTable[n[c]]:this.diagram.nameTable[n[c]],e.parentId="",e&&(yC(e)===Vw?s.push(e):(r=this.cloneNode(e,t,void 0,a),o.push(e.id),i.push(r.id),l.push(r)))}for(let c=0;c<s.length;c++){if(s[c].sourceID||s[c].targetID)for(let e=0;e<o.length;e++)s[c].sourceID===o[e]&&(s[c].sourceID+=a),s[c].targetID===o[e]&&(s[c].targetID+=a);r=this.cloneConnector(s[c],t),i.push(r.id),l.push(r)}const h=this.cloneNode(e,t,i);return l.push(h),h&&h.container&&h.shape&&"UmlClassifier"===h.shape.type&&(this.diagram.updateDiagramObject(h),h.wrapper.measure(new nb)),this.diagram.blazorActions&=~_b.GroupClipboardInProcess,this.diagram.isServerUpdate?this.cloneGroupChildCollection=l:this.diagram.UpdateBlazorDiagramModelCollection(void 0,l,void 0,!0),h}translateObject(e,t){e.id+=t||XP();const i=10*this.clipboardData.pasteIndex;if(yC(e)===Vw){if(e.sourcePoint={x:e.sourcePoint.x+i,y:e.sourcePoint.y+i},e.targetPoint={x:e.targetPoint.x+i,y:e.targetPoint.y+i},"Bezier"===e.type){const t=e.segments;for(let e=0;e<t.length;e++)rb.isEmptyPoint(t[e].point1)||(t[e].point1={x:t[e].point1.x+i,y:t[e].point1.y+i}),rb.isEmptyPoint(t[e].point2)||(t[e].point2={x:t[e].point2.x+i,y:t[e].point2.y+i})}if(("Straight"===e.type||"Bezier"===e.type)&&e.segments&&e.segments.length>0){const t=e.segments;for(let e=0;e<t.length-1;e++)t[e].point.x+=i,t[e].point.y+=i}}else e.offsetX+=i,e.offsetY+=i}drawObject(e){let t;e&&e.shape&&"Text"===e.shape.type&&(e.width=this.diagram.drawingObject.width?this.diagram.drawingObject.width:50,e.height=this.diagram.drawingObject.height?this.diagram.drawingObject.height:20);const i=QP(this.diagram.drawingObject);for(const n of Object.keys(e))i[n]=e[n];return yC(this.diagram.drawingObject)===pP?(t=new pP(this.diagram,"nodes",i,!0),t.id=(this.diagram.drawingObject.id||"node")+XP()):(t=new Vw(this.diagram,"connectors",i,!0),t.id=(this.diagram.drawingObject.id||"connector")+XP()),this.diagram.initObject(t),this.diagram.updateDiagramObject(t),this.diagram.currentDrawingObject=t,t}addObjectToDiagram(e){this.diagram.removeFromAQuad(e),this.diagram.removeObjectsFromLayer(this.diagram.nameTable[e.id]),delete this.diagram.nameTable[e.id];const t=this.diagram.add(e);"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer(),this.selectObjects([t]),e&&!bx(this.diagram)&&(this.diagram.tool&=~qb.DrawOnce,this.diagram.currentDrawingObject=void 0)}enableServerDataBinding(e){this.diagram.enableServerDataBinding(e)}addText(e,t){const i=this.diagram.findElementUnderMouse(e,t);this.diagram.startTextEdit(e,i instanceof av?i.id.split("_")[1]:void 0)}updateArgsObject(e,t,i){if(e){let t;for(let n=0;n<e.length;n++)t=yC(e[n])===Vw,t?i.connectorCollection.push(e[n].id):i.nodeCollection.push(e[n].id)}}updateSelectionChangeEventArgs(e,t,i){return e}isUserHandle(e){const t=this.diagram.selectedItems;if(t.wrapper&&aC(t.constraints,"UserHandle"))for(const i of t.userHandles)if(i.visible&&zO(e,rC(t,i,this.diagram.scroller.transform),i.size/(2*this.diagram.scroller.transform.scale)))return!0;return!1}selectObjects(e,t,i){return hT(this,void 0,void 0,function*(){let n={oldValue:i||this.getSelectedObject(),newValue:e,cause:this.diagram.diagramActions,state:"Changing",type:"Addition",cancel:!1};this.diagram.enableServerDataBinding(!1);let s=!0;this.diagram.triggerEvent(nv.selectionChange,n);const r=fx(this.diagram),o=mx(this.diagram);if(o||r){if(!r&&(e.length>1||t&&1===e.length)){if(1!==e.length)return;this.clearSelection()}if(!(o||1!==e.length||t&&LO(this.diagram)))return void this.clearSelection()}if(!n.cancel){for(let i=0;i<e.length;i++){const n=e[i];if(n)if(s=!0,LO(this.diagram)){if((i>0||t)&&n.children&&!n.parentId)for(let e=0;e<this.diagram.selectedItems.nodes.length;e++){let t=this.diagram.nameTable[this.diagram.selectedItems.nodes[e].parentId];t&&(t=this.findParent(t),t&&n.id===t.id&&this.selectGroup(n))}this.selectProcesses(n),s=this.selectBpmnSubProcesses(n),s&&this.select(n,i>0||t,!0)}else this.select(n,i>0||t,!0)}n={oldValue:i||[],newValue:this.getSelectedObject(),cause:this.diagram.diagramActions,state:"Changed",type:"Addition",cancel:!1},this.diagram.renderSelector(t||e&&e.length>1),this.updateBlazorSelectorModel(i),this.diagram.triggerEvent(nv.selectionChange,n),this.diagram.enableServerDataBinding(!0),this.updateBlazorSelector()}})}updateBlazorSelector(){}findParent(e){return e.parentId&&this.findParent(e=this.diagram.nameTable[e.parentId]),e}selectProcesses(e){if(this.hasProcesses(e)){const t=e.shape.activity.subProcess.processes;for(let e=0;e<t.length;e++){const i=this.diagram.nameTable[t[e]];this.hasProcesses(i)&&this.selectObjects([i],!0),this.unSelect(i)}}}selectGroup(e){for(let t=0;t<e.children.length;t++){const i=this.diagram.nameTable[e.children[t]];i.children&&this.selectGroup(i),this.unSelect(this.diagram.nameTable[e.children[t]])}}selectBpmnSubProcesses(e){let t,i=!0;if(e.processId)i=!jO(this.diagram,this.diagram.nameTable[e.processId])&&this.selectBpmnSubProcesses(this.diagram.nameTable[e.processId]);else if(e instanceof Vw){if(e.sourceID&&this.diagram.nameTable[e.sourceID]&&this.diagram.nameTable[e.sourceID].processId&&(t=this.diagram.nameTable[e.sourceID].processId),e.targetID&&this.diagram.nameTable[e.targetID]&&this.diagram.nameTable[e.targetID].processId&&(t=this.diagram.nameTable[e.targetID].processId),t){if(jO(this.diagram,this.diagram.nameTable[t]))return!1;i=this.selectBpmnSubProcesses(this.diagram.nameTable[t])}}else e.parentId&&this.diagram.nameTable[e.parentId]&&"UmlClassifier"===this.diagram.nameTable[e.parentId].shape.type&&jO(this.diagram,this.diagram.nameTable[e.parentId])&&(i=!1);return i}hasProcesses(e){return!!(e&&"Bpmn"===e.shape.type&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length>0)}select(e,t,i){const n=this.getObjectLayer(e.id);if(Kw(e)&&!(e instanceof bP)&&!jO(this.diagram,e)&&n&&!n.lock&&n.visible&&e.wrapper.visible){(t=!!LO(this.diagram)&&t)||this.clearSelection(),this.diagram.enableServerDataBinding(!1);const n=this.diagram.selectedItems;if(e instanceof pP?n.nodes.push(e.isHeader?this.diagram.nameTable[e.parentId]:e):n.connectors.push(e),t)n.wrapper.rotateAngle=n.rotateAngle=0,n.wrapper.children.push(e.wrapper);else if(n.init(this.diagram),1===n.nodes.length&&0===n.connectors.length){const e=xS(this.diagram,n);e&&(n.wrapper.children[0]=e),n.rotateAngle=n.nodes[0].rotateAngle,n.wrapper.rotateAngle=n.nodes[0].rotateAngle,n.wrapper.pivot=n.nodes[0].pivot}i||this.diagram.renderSelector(t),this.diagram.enableServerDataBinding(!0)}}getObjectCollectionId(e,t){const i=[];let n=0;const s=e?this.diagram.selectedItems.nodes:this.diagram.selectedItems.connectors;for(;!t&&n<s.length;)i[n]=s[n].id,n++;return i}updateBlazorSelectorModel(e,t){if(window&&window.sfBlazor){let i=0,n=[],s=[];const r=[];for(;e&&i<e.length;)r[i]=e[i].id,i++;i=0,n=this.getObjectCollectionId(!0,t),s=this.getObjectCollectionId(!1,t);const o={nodes:n,connectors:s};window.sfBlazor.updateDiagramCollection&&window.sfBlazor.updateDiagramCollection.call(this.diagram,"selectedItems",o,r,!1,!0)}}labelSelect(e,t){this.oldSelectedObjects=xC(this.diagram);const i=this.diagram.selectedItems,n=this.diagram.allowServerDataBinding;this.diagram.allowServerDataBinding=!1,i.nodes=i.connectors=[],this.diagram.allowServerDataBinding=n,e instanceof pP?i.nodes[0]=e:i.connectors[0]=e,i.annotation=this.findTarget(t,e),i.init(this.diagram),this.diagram.renderSelector(!1),this.updateBlazorSelector()}unSelect(e){const t=[];t.push(e);let i={oldValue:t,newValue:[],cause:this.diagram.diagramActions,state:"Changing",type:"Removal",cancel:!1};if(this.diagram.currentSymbol||this.diagram.triggerEvent(nv.selectionChange,i),jO(this.diagram,e)){const n=this.diagram.selectedItems;let s;e instanceof pP?(s=n.nodes.indexOf(e,0),n.nodes.splice(s,1)):(s=n.connectors.indexOf(e,0),n.connectors.splice(s,1)),i={oldValue:t,newValue:[],cause:this.diagram.diagramActions,state:"Changed",type:"Removal",cancel:!1},this.updateBlazorSelectorModel(t),i={oldValue:t,newValue:[],cause:this.diagram.diagramActions,state:"Changed",type:"Removal",cancel:i.cancel},i.cancel||(s=n.wrapper.children.indexOf(e.wrapper,0),n.wrapper.children.splice(s,1),this.diagram.updateSelector(),this.diagram.currentSymbol)||this.diagram.triggerEvent(nv.selectionChange,i)}}getChildElements(e){const t=[];for(let i=0;i<e.length;i++){const n=e[i];n.children&&n.children.length>0?t.concat(this.getChildElements(n.children)):(t.push(n.id),n instanceof av&&t.push(n.id+"_text"))}return t}moveSvgNode(e,t){const i=PP(t+"_groupElement",this.diagram.element.id),n=PP(e+"_groupElement",this.diagram.element.id);i.parentNode.insertBefore(n,i)}sendLayerBackward(e){const t=this.getLayer(e);if(t&&0!==t.zIndex){const e=t.zIndex;if("SVG"===this.diagram.mode){const i=t.objects,n=this.getLayer(this.diagram.layerZIndexTable[e-1]).objects[0];if(n)for(const e of i)this.moveSvgNode(e,n)}const i=this.getLayer(this.diagram.layerZIndexTable[e-1]);i.zIndex=i.zIndex+1,t.zIndex=t.zIndex-1;const n=this.diagram.layerZIndexTable[e];this.diagram.layerZIndexTable[e]=this.diagram.layerZIndexTable[e-1],this.diagram.layerZIndexTable[e-1]=n,"Canvas"===this.diagram.mode&&this.diagram.refreshDiagramLayer()}}bringLayerForward(e){const t=this.getLayer(e);if(t&&t.zIndex<this.diagram.layers.length-1){const e=t.zIndex,i=this.getLayer(this.diagram.layerZIndexTable[e+1]);if("SVG"===this.diagram.mode){const e=t.objects[0],n=i.objects;for(const t of n)t&&this.moveSvgNode(t,e)}i.zIndex=i.zIndex-1,t.zIndex=t.zIndex+1;const n=this.diagram.layerZIndexTable[e];this.diagram.layerZIndexTable[e]=this.diagram.layerZIndexTable[e+1],this.diagram.layerZIndexTable[e+1]=n,"Canvas"===this.diagram.mode&&this.diagram.refreshDiagramLayer()}}sendToBack(e){if(this.diagram.protectPropertyChange(!0),LO(this.diagram)||e){let t=e&&e.id;t=t||(this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id);const i=this.diagram.nameTable[t].zIndex,n=this.diagram.layers.indexOf(this.getObjectLayer(t)),s=this.diagram.layers[n].zIndexTable,r=JSON.parse(JSON.stringify(s)),o=QP(this.diagram.selectedItems);let a=0;if(1!==this.diagram.nodes.length&&(void 0===this.diagram.nameTable[t].children||this.checkObjectBehind(t,s,i))){let e=this.diagram.nameTable[t];for(let t=i;t>0;t--)s[t]&&(s[t-1]?(s[t]=s[t-1],this.diagram.nameTable[s[t]].zIndex=t):(s[t-1]=s[t],this.diagram.nameTable[s[t-1]].zIndex=t,delete s[t]));for(let t=i;t>0;t--)s[t]&&(this.diagram.nameTable[s[t]].zIndex=t);if("SwimLane"!==e.shape.type?(s[0]=this.diagram.nameTable[t].id,this.diagram.nameTable[t].zIndex=0):a=this.swapZIndexObjects(i,s,t,r),"SVG"===this.diagram.mode){let e=this.diagram.nameTable[t],n="SwimLane"!==e.shape.type?1:a;n!==a&&(n=e.children&&e.children.length>0?i:1);let r=s[n];for(;!r&&n<i;)r=s[++n];r=this.resetTargetNode(t,r,n,s),r=this.diagram.nameTable[r].parentId?this.checkParentExist(r):r,this.moveSvgNode(t,r),this.updateNativeNodeIndex(t)}else this.diagram.refreshCanvasLayers();const n={type:"SendToBack",category:"Internal",undoObject:o,redoObject:QP(this.diagram.selectedItems)};this.diagram.diagramActions&Jb.UndoRedo||this.addHistoryEntry(n)}}this.diagram.protectPropertyChange(!1)}swapZIndexObjects(e,t,i,n){let s=0,r=0,o=-1,a=1;for(let h=0;h<=e;h++)t[h]&&this.diagram.nameTable[t[h]].parentId===i&&(-1===o&&(o=h),r++);for(let h=0;h<=e;h++)if(t[h]&&a<=r){for(;!t[o];)o++;t[h]=t[o],this.diagram.nameTable[t[h]].zIndex=h,o++,a++}let l=0;for(let h=0;h<r;h++){for(;!t[l];)l++;s=this.diagram.nameTable[t[l]].zIndex,l++}for(s+=1;!t[s];)++s;l=0,t[s]=this.diagram.nameTable[i].id,this.diagram.nameTable[i].zIndex=s,s+=1;for(let h=s;h<=e;h++)if(t[h]){for(;!n[l];)l++;t[h]=n[l],this.diagram.nameTable[t[h]].zIndex=h,l++}return s}resetTargetNode(e,t,i,n){return"SwimLane"===this.diagram.nameTable[e].shape.type&&null!=this.diagram.nameTable[t].parentId&&""!=this.diagram.nameTable[t].parentId&&this.diagram.nameTable[this.diagram.nameTable[t].parentId].isLane&&n[i+=1]?this.resetTargetNode(e,t=n[i],i,n):t}getZIndexObjects(){const e=[];let t,i;for(t=0;t<this.diagram.nodes.length;t++)e.push(this.diagram.nodes[t]);for(i=0;i<this.diagram.connectors.length;i++)e.push(this.diagram.connectors[i]);this.updateBlazorZIndex(e)}updateBlazorZIndex(e){let t={};const i=[],n=[];let s;if(e&&e.length>0)for(s=0;s<e.length;s++){const t=e[s];t instanceof pP?i.push(this.getBlazorObject(t)):t instanceof Vw&&n.push(this.getBlazorObject(t))}t={nodes:i,connectors:n},window&&window.Blazor&&window.sfBlazor.updateBlazorProperties({methodName:"UpdateBlazorProperties",diagramobj:t},this.diagram)}getBlazorObject(e){return{sfIndex:GP(this.diagram,e.id),zIndex:e.zIndex}}checkParentExist(e){let t=e;for(;this.diagram.nameTable[t].parentId;)t=this.diagram.nameTable[t].parentId;return t}checkObjectBehind(e,t,i){for(let n=0;n<i;n++)if(e!==this.diagram.nameTable[t[n]].parentId)return!0;return!1}bringToFront(e){if(this.diagram.protectPropertyChange(!0),LO(this.diagram)||e){let t=e&&e.id;t=t||(this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id);const i=this.diagram.layers.indexOf(this.getObjectLayer(t)),n=this.diagram.layers[i].zIndexTable,s=QP(this.diagram.selectedItems);let r=JSON.parse(JSON.stringify(n)),o=Number(Object.keys(n).sort((e,t)=>Number(e)-Number(t)).reverse()[0]);const a=this.diagram.nameTable[t].zIndex,l=[];let h=0;for(let e=0;e<=o;e++)l.push(n[e]);let c=this.diagram.nameTable[t];if("SwimLane"===c.shape.type)for(let e=o;e>=a;e--)if(n[e]&&this.diagram.nameTable[n[e]].parentId!==t){h=e,o=h;break}for(let e=a;e<o;e++)n[e]&&(n[e+1]?(n[e]=n[e+1],this.diagram.nameTable[n[e]].zIndex=e):(n[e+1]=n[e],this.diagram.nameTable[n[e+1]].zIndex=e,delete n[e]));for(let e=a;e<o;e++)n[e]&&(this.diagram.nameTable[n[e]].zIndex=e);if("SwimLane"!==c.shape.type)n[o]=this.diagram.nameTable[t].id,this.diagram.nameTable[t].zIndex=o;else{let e=0,i=-1,s=0,l=0,h=JSON.parse(JSON.stringify(n));for(let r=0;r<=a;r++)if(n[r]&&this.diagram.nameTable[n[r]].parentId===t&&-1===i){i=r,s=r;break}for(let n=0;n<=o;n++)r[n]&&r[n]!==t&&this.diagram.nameTable[r[n]].parentId!==t&&this.diagram.nameTable[r[n]].zIndex>=this.diagram.nameTable[t].zIndex&&e++;let c=i;for(let t=0;t<=e;t++){for(;!n[c];)c++;l=this.diagram.nameTable[n[c]].zIndex,c++}for(let t=l;t<=o;t++){for(;!h[i];)i++;for(;!n[t];)t++;n[t]=h[i],this.diagram.nameTable[n[t]].zIndex=t,i++}n[o]=this.diagram.nameTable[t].id,this.diagram.nameTable[t].zIndex=o,c=a+1;let d=s;for(let o=0;o<e;o++){for(;!r[c];)c++;for(;this.diagram.nameTable[r[c]].parentId===t;)c++;for(;!n[d];)d++;n[d]=r[c],this.diagram.nameTable[n[d]].zIndex=d,c++,d++}}if("SVG"===this.diagram.mode){const e=this.diagram.diagramLayer;let i=PP(t+"_groupElement",this.diagram.element.id);const s=this.diagram.selectedItems.nodes;if(s.length>0&&("Native"===s[0].shape.type||"HTML"===s[0].shape.type)){i.parentNode.removeChild(i);for(let e=0;e<this.diagram.views.length;e++){i=PP(t+("HTML"===s[0].shape.type?"_html_element":"_content_groupElement"),this.diagram.views[e]);const n=i.parentNode.lastChild;n.parentNode.insertBefore(i,n.nextSibling)}const n=LP(this.diagram.element.id);this.diagram.diagramRenderer.renderElement(this.diagram.nameTable[t].wrapper,e,n)}else Object.keys(n).forEach(e=>{let i=n[e];if(i!==t&&this.diagram.nameTable[i].parentId!==t&&void 0!==i&&l.indexOf(t)<l.indexOf(i)){let e=this.diagram.nameTable[t],n=this.diagram.nameTable[i];(""===e.parentId&&""===n.parentId&&void 0===n.parentId&&e.parentId!==n.id||this.checkGroupNode(t,i,this.diagram.nameTable))&&(this.moveSvgNode(i,t),this.updateNativeNodeIndex(t))}})}else this.diagram.refreshCanvasLayers();const d={type:"BringToFront",category:"Internal",undoObject:s,redoObject:QP(this.diagram.selectedItems)};this.diagram.diagramActions&Jb.UndoRedo||this.addHistoryEntry(d)}this.diagram.protectPropertyChange(!1)}checkGroupNode(e,t,i){return i[t].parentId===i[e].parentId}sortByZIndex(e,t){const i=t||"zIndex";return e.sort((e,t)=>e[i]-t[i])}orderCommands(e,t,i){let n=t.nodes;if(n=n.concat(t.connectors),e)"SendBackward"===i?this.sendBackward(n[0]):"SendForward"===i?this.sendForward(n[0]):"BringToFront"===i?this.bringToFront(n[0]):"SendToBack"===i&&this.sendToBack(n[0]);else{const e=n[0].zIndex,t=this.diagram.nameTable[n[0].id].zIndex,s=n[0],r=this.getObjectLayer(s.id),o=r.zIndex,a=r.zIndexTable;if("SendBackward"===i||"SendForward"===i)for(let i=0;i<n.length;i++){const e=n[i],t=this.diagram.layers.indexOf(this.getObjectLayer(e.id));this.diagram.nameTable[n[i].id].zIndex=e.zIndex,this.diagram.layers[t].zIndexTable[e.zIndex]=e.id}else if("BringToFront"===i)if("SwimLane"===n[0].shape.type)this.sendToBack(n[0]);else{const i=1;for(let n=t;n>e;n--)a[n]&&(a[n-i]?(a[n]=a[n-i],this.diagram.nameTable[a[n]].zIndex=n):(a[n-i]=a[n],this.diagram.nameTable[a[n-i]].zIndex=n,delete a[n]))}else if("SendToBack"===i)if("SwimLane"===n[0].shape.type)this.bringToFront(n[0]);else for(let i=t;i<e;i++)a[i]&&(a[i+1]?(a[i]=a[i+1],this.diagram.nameTable[a[i]].zIndex=i):(a[i+1]=a[i],this.diagram.nameTable[a[i+1]].zIndex=i,delete a[i]));if("BringToFront"!==i&&"SendToBack"!==i||(this.diagram.nameTable[n[0].id].zIndex=s.zIndex,this.diagram.layers[o].zIndexTable[s.zIndex]=s.id),"SVG"===this.diagram.mode){if("SendBackward"===i)this.moveObject(n[1].id,n[0].id);else if("SendForward"===i)this.moveObject(n[0].id,n[1].id);else if("BringToFront"===i)"SwimLane"!==n[0].shape.type&&this.moveObject(n[0].id,a[n[0].zIndex+1]);else if("SendToBack"===i&&"SwimLane"!==n[0].shape.type){const e=this.getObjectLayer(n[0].id);for(let t=0;t<=n[0].zIndex;t++)e.objects[t]!==n[0].id&&(this.moveSvgNode(e.objects[t],n[0].id),this.updateNativeNodeIndex(n[0].id))}}else this.diagram.refreshCanvasLayers()}}moveObject(e,t){t&&(this.moveSvgNode(e,t),this.updateNativeNodeIndex(e,t))}sendForward(e){if(this.diagram.protectPropertyChange(!0),LO(this.diagram)||e){let t=e&&e.id;t=t||(this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id);const i=this.diagram.layers.indexOf(this.getObjectLayer(t)),n=this.diagram.layers[i].zIndexTable,s=this.diagram.nameTable[t],r=[];let o=this.diagram.spatialSearch.findObjects(s.wrapper.bounds);o.length>2&&(o=this.sortByZIndex(o));for(const e of o)if(s.id!==e.id&&i===this.getObjectLayer(e.id).zIndex&&Number(this.diagram.nameTable[t].zIndex)<Number(e.zIndex)&&s.wrapper.bounds.intersects(e.wrapper.bounds)){r.push(e);break}if(r.length>0){let e=this.diagram.nameTable[n[Number(r[0].zIndex)]];if(e.parentId){let i=AC(e,this.diagram,""),n=this.diagram.nameTable[i];n.id!==t&&(r[0]=n)}const i=r[0].zIndex,o=s.zIndex,a=n[i],l=QP(this.diagram.selectedItems);this.diagram.nameTable[a]instanceof pP?l.nodes.push(QP(this.diagram.nameTable[a])):l.connectors.push(QP(this.diagram.nameTable[a])),this.diagram.layers[0].zIndexTable[i]=s.id,this.diagram.nameTable[n[i]].zIndex=i,this.diagram.layers[0].zIndexTable[o]=r[0].id,this.diagram.nameTable[n[o]].zIndex=o,"SVG"===this.diagram.mode?(this.moveSvgNode(n[Number(r[0].zIndex)],t),this.updateNativeNodeIndex(n[Number(r[0].zIndex)],t)):this.diagram.refreshCanvasLayers();const h=QP(this.diagram.selectedItems);this.diagram.nameTable[a]instanceof pP?h.nodes.push(QP(this.diagram.nameTable[a])):h.connectors.push(QP(this.diagram.nameTable[a]));const c={type:"SendForward",category:"Internal",undoObject:l,redoObject:h};this.diagram.diagramActions&Jb.UndoRedo||this.addHistoryEntry(c)}}this.diagram.protectPropertyChange(!1)}sendBackward(e){if(this.diagram.protectPropertyChange(!0),LO(this.diagram)||e){let t=e&&e.id;t=t||(this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id);const i=this.diagram.layers.indexOf(this.getObjectLayer(t)),n=this.diagram.layers[i].zIndexTable,s=this.diagram.nameTable[t],r=[];let o=this.diagram.spatialSearch.findObjects(s.wrapper.bounds);o.length>2&&(o=this.sortByZIndex(o));for(const e of o)s.id!==e.id&&i===this.getObjectLayer(e.id).zIndex&&Number(this.diagram.nameTable[t].zIndex)>Number(e.zIndex)&&s.wrapper.bounds.intersects(e.wrapper.bounds)&&r.push(e);for(let e=r.length-1;e>=0;e--)this.diagram.nameTable[r[e].id].parentId===t&&r.splice(e,1);if(r.length>0){let e=this.diagram.nameTable[r[r.length-1].id];if(e.parentId){let i=AC(e,this.diagram,""),n=this.diagram.nameTable[i];t!==n.id&&(r[r.length-1]=n)}const i=r[r.length-1].zIndex,o=s.zIndex,a=n[i],l=QP(this.diagram.selectedItems);if(this.diagram.nameTable[a]instanceof pP?l.nodes.push(QP(this.diagram.nameTable[a])):l.connectors.push(QP(this.diagram.nameTable[a])),n[i]=s.id,this.diagram.nameTable[n[i]].zIndex=i,n[o]=r[r.length-1].id,this.diagram.nameTable[n[o]].zIndex=o,"SVG"===this.diagram.mode){this.moveSvgNode(t,n[r[r.length-1].zIndex]);let e=this.diagram.nameTable[n[r[r.length-1].zIndex]];e.children&&e.children.length>0?this.updateNativeNodeIndex(t):this.updateNativeNodeIndex(t,n[r[r.length-1].zIndex])}else this.diagram.refreshCanvasLayers();const h=QP(this.diagram.selectedItems);this.diagram.nameTable[a]instanceof pP?h.nodes.push(QP(this.diagram.nameTable[a])):h.connectors.push(QP(this.diagram.nameTable[a]));const c={type:"SendBackward",category:"Internal",undoObject:l,redoObject:h};this.diagram.diagramActions&Jb.UndoRedo||this.addHistoryEntry(c)}}this.diagram.protectPropertyChange(!1)}updateNativeNodeIndex(e,t){const i=this.diagram.selectedItems.nodes[0]||this.diagram.getObject(t);for(let n=0;n<this.diagram.views.length;n++)if(i&&("HTML"===i.shape.type||"Native"===i.shape.type)){const s="HTML"===i.shape.type?"_html_element":"_content_groupElement",r=PP(e+s,this.diagram.views[n]),o=t?PP(t+s,this.diagram.views[n]):r.parentElement.firstChild;r.parentNode.id===o.parentNode.id&&o.parentNode.insertBefore(r,o)}}initSelectorWrapper(){const e=this.diagram.selectedItems;e.init(this.diagram),1===e.nodes.length&&0===e.connectors.length&&(e.rotateAngle=e.nodes[0].rotateAngle,e.wrapper.rotateAngle=e.nodes[0].rotateAngle,e.wrapper.pivot=e.nodes[0].pivot)}doRubberBandSelection(e){this.clearSelectionRectangle();let t=[],i=[];t=this.diagram.getNodesConnectors(t),i="CompleteIntersect"===this.diagram.selectedItems.rubberBandSelectionMode?function(e,t){const i=[];for(let n=0;n<t.length;n++){const s=t[n];e.containsRect(s.wrapper.bounds)&&i.push(s)}return i}(e,t):this.diagram.spatialSearch.findObjects(e),i.length&&this.selectObjects(i,!0)}clearSelectionRectangle(){const e=TP(this.diagram.element.id).getElementById(this.diagram.element.id+"_diagramAdorner_selected_region");e&&Ru(e)}dragConnectorEnds(e,t,i,n,s,r){let o,a,l,h,c=!1;return t instanceof bP?(o=t,a=o.connectors[0]):t instanceof Vw&&this.diagram.currentDrawingObject&&(this.clearSelection(),a=this.diagram.currentDrawingObject),"BezierSourceThumb"!==e&&"BezierTargetThumb"!==e||(c=!0),"ConnectorSourceEnd"===e||"BezierSourceThumb"===e?(l=i.x-(c?n.bezierPoint1.x:a.sourcePoint.x),h=i.y-(c?n.bezierPoint1.y:a.sourcePoint.y),this.dragSourceEnd(a,l,h,null,i,e,void 0,s,r,void 0,n)):(l=i.x-(c?n.bezierPoint2.x:a.targetPoint.x),h=i.y-(c?n.bezierPoint2.y:a.targetPoint.y),this.dragTargetEnd(a,l,h,null,i,e,void 0,n))}getSelectedObject(){const e=this.diagram.selectedItems;return e.nodes.concat(e.connectors)}updateBlazorProperties(e){if(e){if(window&&window.Blazor&&"{}"!==JSON.stringify(this.deepDiffer.diagramObject)){const e={methodName:"UpdateBlazorProperties",diagramobj:this.deepDiffer.diagramObject};this.diagram.isLoading||window.sfBlazor.updateBlazorProperties(e,this.diagram)}}else window&&window.Blazor&&window.sfBlazor.updateBlazorProperties({methodName:"UpdateBlazorProperties",diagramobj:this.diagramObject},this.diagram);this.deepDiffer.newNodeObject=[],this.deepDiffer.newConnectorObject=[],this.diagramObject=[],this.diagram.oldNodeObjects=[],this.diagram.oldConnectorObjects=[]}enableCloneObject(e){this.diagram.lineRoutingModule&&this.diagram.constraints&Gb.LineRouting||(this.diagram.canEnableBlazorObject=e)}ismouseEvents(e){this.diagram.blazorActions=e?this.diagram.addConstraints(this.diagram.blazorActions,_b.interaction):this.diagram.removeConstraints(this.diagram.blazorActions,_b.interaction)}updateLayerObject(e,t){}getDiagramOldValues(e,t){const i={};for(let a=0;a<t.length;a++)i[t[a]]=QP(this.diagram[t[a]]);const n=QP(i),s=this.deepDiffer.map(n,e),r=this.deepDiffer.frameObject({},s);let o=this.deepDiffer.removeEmptyValues(r);o=this.deepDiffer.changeSegments(o,n),this.diagramObject=o,this.diagram.blazorActions&_b.ClearObject||this.updateBlazorProperties()}getBlazorOldValues(e,t){}getObjectChanges(e,t,i){for(let n=0;n<e.length;n++){const s=this.deepDiffer.map(t[n],e[n]),r=this.deepDiffer.frameObject({},s);let o=this.deepDiffer.removeEmptyValues(r);o.children&&(o.children=QP(t[n]).children),o=this.deepDiffer.changeSegments(o,t[n]),o.sfIndex=GP(this.diagram,t[n].id),i.push(o)}}clearObjectSelection(e){const t=this.diagram.selectedItems;let i=[];i=i.concat(t.nodes,t.connectors),-1===i.indexOf(e)&&(this.clearSelection(i.length>0),this.selectObjects([e],!0))}clearSelection(e,t){return hT(this,void 0,void 0,function*(){const t=this.diagram.allowServerDataBinding;if(this.diagram.enableServerDataBinding(!1),LO(this.diagram)){const i=this.diagram.selectedItems,n=this.getSelectedObject();this.diagram.currentSymbol&&(this.diagram.previousSelectedObject=n);let s={oldValue:n,newValue:[],cause:this.diagram.diagramActions,state:"Changing",type:"Removal",cancel:!1};this.updateBlazorSelectorModel(n,!0),e&&this.diagram.triggerEvent(nv.selectionChange,s),!s.cancel&&(i.offsetX=0,i.offsetY=0,i.width=0,i.height=0,i.rotateAngle=0,i.nodes=[],i.connectors=[],i.wrapper=null,i.annotation=void 0,this.diagram.clearSelectorLayer(),e)&&(s={oldValue:n,newValue:[],cause:this.diagram.diagramActions,state:"Changed",type:"Removal",cancel:!1},this.diagram.triggerEvent(nv.selectionChange,s)),this.updateBlazorSelector(),this.diagram.enableServerDataBinding(t)}})}clearSelectedItems(){this.clearSelection((this.diagram.selectedItems.nodes?this.diagram.selectedItems.nodes.length:0)+(this.diagram.selectedItems.connectors?this.diagram.selectedItems.connectors.length:0)>0)}removeStackHighlighter(){const e=TP(this.diagram.element.id),t=e.getElementById(e.id+"_stack_highlighter");t&&t.parentNode.removeChild(t)}renderStackHighlighter(e,t){const i=this.diagram.selectedItems.nodes[0];let n,s,r;if(!t){const i=this.diagram.findObjectsUnderMouse(e.position);if((t=this.diagram.findObjectUnderMouse(i,"Drag",!0))&&!(t.isLane||t.isPhase||t.isHeader))for(let e=0;e<i.length;e++){const n=this.diagram.nameTable[i[e].id];(!n.isLane||n.isPhase||n.isHeader)&&(this.diagram.parentObject=t=n)}}if(i&&t&&t.isLane&&i.shape&&!i.shape.isPhase&&(s=this.diagram.nameTable[t.parentId],this.diagram.currentSymbol&&"SwimLane"===s.shape.type&&(n=!0),i&&!i.parentId&&"SwimLane"!==i.shape.type||i&&i.parentId&&this.diagram.nameTable[i.parentId]&&this.diagram.nameTable[i.parentId].isLane&&i.parentId!==t.parentId&&i.parentId!==t.id)){r=this.diagram.selectedItems;const e=xS(this.diagram,r,t.id,!0);e&&(r.wrapper.children[0]=e),this.diagram.renderSelector(!1,!0),r.wrapper.children[0]=r.nodes[0].wrapper}if(i&&t&&t.parentId&&i.shape&&i.shape.isPhase&&"SwimLane"===this.diagram.nameTable[t.parentId].shape.type&&(this.diagram.selectedItems.wrapper.children[0]=this.diagram.nameTable[t.parentId].wrapper,this.diagram.renderSelector(!1,!0)),n&&this.diagram.currentSymbol.shape.isLane||i&&t&&i.parentId&&t.parentId&&!i.isPhase&&i.parentId===t.parentId&&i.id!==t.id&&s&&s.container&&("Stack"===s.container.type||"Grid"===s.container.type)){let o;const a="Vertical"===s.container.orientation,l="Stack"===s.container?a:!a;"Grid"===s.container.type&&t.isLane&&(!this.diagram.currentSymbol&&"Horizontal"===s.shape.orientation&&t.rowIndex!==i.rowIndex||"Vertical"===s.shape.orientation&&t.columnIndex!==i.columnIndex||this.diagram.currentSymbol&&this.diagram.currentSymbol.shape.orientation===s.container.orientation)&&(r=this.diagram.selectedItems,(i.isLane&&IS(i,this.diagram)||!i.isLane)&&(o=xS(this.diagram,r,t.id,n)));const h="Stack"===s.container.type?t.wrapper:o;h&&Qx(h,l,e.position,this.diagram,!1,!0)}}insertBlazorConnector(e){if(e instanceof bP)for(let t=0;t<e.connectors.length;t++)this.diagram.insertBlazorConnector(e.connectors[t]);else this.diagram.insertBlazorConnector(e)}drag(e,t,i){let n;const s=[];if(ex(e)&&this.checkBoundaryConstraints(t,i,e.wrapper.bounds)&&Cx(this.diagram))if(e instanceof pP){const r={offsetX:e.offsetX,offsetY:e.offsetY};if(e.offsetX+=t,e.offsetY+=i,e.children&&!e.container){Yx(this.diagram,e,!0)||(this.diagram.diagramActions=this.diagram.diagramActions|Jb.isGroupDragging);const r=this.getAllDescendants(e,s);for(let e=0;e<r.length;e++)n=this.diagram.nameTable[r[e].id],this.drag(n,t,i);this.updateInnerParentProperties(e),this.diagram.diagramActions=this.diagram.diagramActions&~Jb.isGroupDragging}Yx(this.diagram,e,!0)?Xx(this.diagram,e):(e&&e.shape&&"UmlClassifier"===e.shape.type&&(e.wrapper.measureChildren=!0),this.diagram.nodePropertyChange(e,r,{offsetX:e.offsetX,offsetY:e.offsetY},void 0,void 0,!1),e.wrapper.measureChildren=!1),"SwimLane"!==e.shape.type||this.diagram.currentSymbol||hS(nS(this.diagram,e.wrapper.children[0]),this.diagram)}else{const n=e,s={sourcePoint:n.sourcePoint,targetPoint:n.targetPoint},r="Bezier"===n.type;let o=!1;n.sourceWrapper?o=!0:this.dragSourceEnd(n,t,i,!0,null,"",r),n.targetWrapper?o=!0:this.dragTargetEnd(n,t,i,!0,null,"",r);let a=!1;e instanceof Vw&&(a=!0),(!o||a)&&(this.dragControlPoint(n,t,i,!0),this.diagram.connectorPropertyChange(n,s,{sourcePoint:n.sourcePoint,targetPoint:n.targetPoint}))}}connectorSegmentChange(e,t,i){let n,s,r=!0;if(!1===t.equals(t,e.wrapper.bounds)&&e.outEdges.length>0)for(let o=0;o<e.outEdges.length;o++){const a=this.diagram.nameTable[e.outEdges[o]];if(r=""!==a.targetID?!this.isSelected(this.diagram.nameTable[a.targetID]):!this.isSelected(this.diagram.nameTable[a.id]),"Orthogonal"===a.type&&a.segments&&a.segments.length>1)if(i){const t=a.segments[0],i=a.segments[1];let n=Gv(Hv(e.wrapper,e.wrapper.corners,e.wrapper.bounds),t.direction);n=Zv(a,0,n,{x:a.sourceWrapper.offsetX,y:a.sourceWrapper.offsetY},!1);const s=tw({corners:void 0,point:n,margin:void 0,direction:t.direction},{corners:void 0,point:i.points[1],margin:void 0,direction:void 0});t.length=rb.distancePoints(s[0],s[1]),i.direction&&i.length&&(i.length=rb.distancePoints(s[1],s[2]))}else if(r){switch(a.segments[0].direction){case"Bottom":n=e.wrapper.bounds.bottomCenter.x-t.bottomCenter.x,s=e.wrapper.bounds.bottomCenter.y-t.bottomCenter.y;break;case"Top":n=e.wrapper.bounds.topCenter.x-t.topCenter.x,s=e.wrapper.bounds.topCenter.y-t.topCenter.y;break;case"Left":n=e.wrapper.bounds.middleLeft.x-t.middleLeft.x,s=e.wrapper.bounds.middleLeft.y-t.middleLeft.y;break;case"Right":n=e.wrapper.bounds.middleRight.x-t.middleRight.x,s=e.wrapper.bounds.middleRight.y-t.middleRight.y}this.dragSourceEnd(a,n,s,!0,null,"ConnectorSourceEnd",void 0,void 0,void 0,!(e.parentId&&this.diagram.diagramActions&Jb.isGroupDragging))}}}updateEndPoint(e,t){const i={sourcePoint:e.sourcePoint,targetPoint:e.targetPoint};e.sourceID&&(i.sourceID=e.sourceID),e.targetID&&(i.targetID=e.targetID),e.sourcePortID&&(i.sourcePortID=e.sourcePortID),e.targetPortID&&(i.targetPortID=e.targetPortID),e.segments&&(i.segments=e.segments),this.diagram.connectorPropertyChange(e,t||{},i),this.diagram.updateSelector()}dragSourceEnd(e,t,i,n,s,r,o,a,l,h,c){const d=this.diagram.nameTable[e.id];let p={};const u=this.checkBoundaryConstraints(t,i,d.wrapper.bounds);if(nx(d)&&u&&"BezierSourceThumb"!==r&&Cx(this.diagram)&&(p={sourcePoint:d.sourcePoint},d.sourcePoint.x+=t,d.sourcePoint.y+=i,"ConnectorSourceEnd"===r&&"Orthogonal"===d.type&&this.changeSegmentLength(d,a,l,h),"Bpmn"===d.shape.type&&"Default"===d.shape.sequence&&this.updatePathElementOffset(d)),"Bezier"===d.type)if(p={sourcePoint:d.sourcePoint},c)this.translateBezierPoints(e,""===r?"ConnectorSourceEnd":r,t,i,c,s,!o);else for(let g=0;g<e.segments.length;g++)this.translateBezierPoints(e,""===r?"ConnectorSourceEnd":r,t,i,e.segments[g],s,!o);return n||this.updateEndPoint(d,p),this.diagram.realActions&ev.AnimationClick||this.diagram.refreshCanvasLayers(),u}updatePathElementOffset(e){e.wrapper.children.splice(3,1);let t=new dv;t=SC(e.intermediatePoints,e),e.wrapper.children.splice(3,0,t)}changeSegmentLength(e,t,i,n){if(e.segments&&null!==e.segments[0].direction&&(!t&&""===e.sourceID||n)){const t=e.segments[0],i=e.segments[1],n=this.diagram.nameTable[e.sourceID];let s;if(t.points[0]=e.sourcePoint,"Top"===t.direction||"Bottom"===t.direction?(t.points[t.points.length-1].x=e.sourcePoint.x,i.points[0].y=t.points[t.points.length-1].y):(t.points[t.points.length-1].y=e.sourcePoint.y,i.points[0].x=t.points[t.points.length-1].x),t.direction&&(t.length||0===t.length)&&(t.length=rb.distancePoints(t.points[0],t.points[t.points.length-1])),i.direction&&(i.length||0===i.length)&&(i.length=rb.distancePoints(t.points[t.points.length-1],i.points[i.points.length-1]),i.direction=rb.direction(t.points[t.points.length-1],i.points[i.points.length-1])),""!==e.sourcePortID&&t.length<10)if(e.segments.length>2){const i=e.segments[2],s=rb.direction(i.points[0],i.points[1]);t.direction===aw(s)?("Right"===t.direction?i.points[0].x=t.points[t.points.length-1].x=n.wrapper.corners.middleRight.x+20:"Left"===t.direction?i.points[0].x=t.points[t.points.length-1].x=n.wrapper.corners.middleLeft.x-20:i.points[0].y=t.points[t.points.length-1].y="Top"===t.direction?n.wrapper.corners.topCenter.y-20:n.wrapper.corners.bottomCenter.y+20,i.direction&&i.length&&(i.length=rb.distancePoints(i.points[0],i.points[i.points.length-1])),t.length=rb.distancePoints(t.points[0],t.points[t.points.length-1])):t.direction===s&&i.direction&&i.length?("Top"===t.direction||"Bottom"===t.direction?(i.points[0]=t.points[0],i.points[i.points.length-1].x=i.points[0].x):(i.points[0]=t.points[0],i.points[i.points.length-1].y=i.points[0].y),i.length=rb.distancePoints(i.points[0],i.points[i.points.length-1]),e.segments.splice(0,2)):t.length=20}else t.length=20;else if(t.length<1)if(""!==e.sourceID){if("Right"===i.direction?(s=n.wrapper.corners.middleRight,i.points[i.points.length-1].y=s.y):"Left"===i.direction?(s=n.wrapper.corners.middleLeft,i.points[i.points.length-1].y=s.y):"Top"===i.direction?(s=n.wrapper.corners.topCenter,i.points[i.points.length-1].x=s.x):(s=n.wrapper.corners.bottomCenter,i.points[i.points.length-1].x=s.x),i.length=rb.distancePoints(s,i.points[i.points.length-1]),e.segments.length>2){const t=e.segments[2];t.direction&&t.length&&(t.length=rb.distancePoints(i.points[i.points.length-1],t.points[t.points.length-1]))}e.segments.splice(0,1)}else e.segments.splice(0,1)}else t&&!i&&e.sourceID!==t.id&&e.segments&&null!==e.segments[0].direction&&t&&t instanceof pP&&this.changeSourceEndToNode(e,t),t&&i&&e.sourcePortID!==i&&e.segments&&null!==e.segments[0].direction&&t&&t instanceof pP&&this.changeSourceEndToPort(e,t,i)}changeSourceEndToPort(e,t,i){const n=this.diagram.getWrapper(t.wrapper,i),s={x:n.offsetX,y:n.offsetY},r=ow(s,ZP(t.wrapper),t.wrapper.bounds),o=e.segments[0],a=e.segments[1];if(o.direction!==r){const t=[];let i={};if(o.direction===aw(r)){let n;i={},"Top"===r||"Bottom"===r?(n="Top"===r?{type:"Orthogonal",isTerminal:!0,direction:r,length:Math.abs(o.points[0].y-s.y)}:{type:"Orthogonal",isTerminal:!0,direction:r,length:Math.abs(s.y-o.points[0].y)},i=o.points[0].x>s.x?{type:"Orthogonal",isTerminal:!0,direction:"Right",length:o.points[0].x-s.x}:{type:"Orthogonal",isTerminal:!0,direction:"Left",length:s.x-o.points[0].x}):(n="Right"===r?{type:"Orthogonal",isTerminal:!0,direction:r,length:Math.abs(o.points[0].x-s.x)}:{type:"Orthogonal",isTerminal:!0,direction:r,length:Math.abs(s.x-o.points[0].x)},i=o.points[0].y>s.y?{type:"Orthogonal",direction:"Top",isTerminal:!0,length:o.points[0].y-s.y}:{type:"Orthogonal",direction:"Bottom",isTerminal:!0,length:s.y-o.points[0].y}),t.push(new kw(e,"segments",n,!0)),t.push(new kw(e,"segments",i,!0))}else i={type:"Orthogonal",direction:r,length:20,isTerminal:!0},t.push(new kw(e,"segments",i,!0));o.direction!==aw(r)&&("Top"===r||"Bottom"===r?(o.points[0].x=s.x,o.points[0].y=o.points[o.points.length-1].y="Top"===r?s.y-20:s.y+20):(o.points[0].y=s.y,o.points[0].x=o.points[o.points.length-1].x="Right"===r?s.x+20:s.x-20),o.length=rb.distancePoints(o.points[0],o.points[o.points.length-1]),a.length=rb.distancePoints(o.points[o.points.length-1],a.points[a.points.length-1])),e.segments=t.concat(e.segments)}else o.points[0]=s,"Top"===r||"Bottom"===r?o.points[o.points.length-1].x=s.x:o.points[o.points.length-1].y=s.y,o.length=rb.distancePoints(o.points[0],o.points[o.points.length-1]),a.length=rb.distancePoints(o.points[o.points.length-1],a.points[a.points.length-1])}removeTerminalSegment(e,t){for(let i=0;i<e.segments.length-2;i++){const n=e.segments[0];n.isTerminal&&(t?n.isTerminal=!1:(e.segments.splice(i,1),i--))}}changeSourceEndToNode(e,t){this.removeTerminalSegment(e);const i=t.wrapper.children[0].corners;let n,s;const r=e.segments[0],o=e.segments[1],a=[];if("Right"===r.direction||"Left"===r.direction)if(n="Left"===r.direction?i.middleLeft:i.middleRight,r.length>i.width||"Left"===r.direction&&n.x>=r.points[0].x||"Right"===r.direction&&n.x<=r.points[0].x)r.points[0].y=r.points[r.points.length-1].y=n.y,r.points[0].x=n.x,r.length=rb.distancePoints(r.points[0],r.points[r.points.length-1]),o.length=rb.distancePoints(r.points[r.points.length-1],o.points[o.points.length-1]);else{let t;t=o.direction?o.direction:rb.direction(o.points[0],o.points[o.points.length-1]),s="Bottom"===t?i.bottomCenter:i.topCenter,o.length&&o.direction&&(o.length="Top"===t?r.points[r.points.length-1].y-(s.y+20):s.y+20-r.points[r.points.length-1].y),r.length=r.points[r.points.length-1].x-s.x,r.direction=r.length>0?"Right":"Left",a.push(new kw(e,"segments",{type:"Orthogonal",direction:t,length:20},!0)),e.segments=a.concat(e.segments)}else if(n="Bottom"===r.direction?i.bottomCenter:i.topCenter,r.length>i.height||"Top"===r.direction&&n.y>=r.points[0].y||"Bottom"===r.direction&&n.y<=r.points[0].y)r.points[0].x=r.points[r.points.length-1].x=n.x,r.points[0].y=n.y,r.length=rb.distancePoints(r.points[0],r.points[r.points.length-1]),o.length=rb.distancePoints(r.points[r.points.length-1],o.points[o.points.length-1]);else{let t;s="Left"===o.direction?i.middleLeft:i.middleRight,t=o.direction?o.direction:rb.direction(o.points[0],o.points[o.points.length-1]),o.length&&o.direction&&(o.length="Left"===t?r.points[r.points.length-1].x-(s.x+20):s.x+20-r.points[r.points.length-1].x),r.length=r.points[r.points.length-1].y-s.y,r.direction=r.length>0?"Bottom":"Top",a.push(new kw(e,"segments",{type:"Orthogonal",direction:t,length:20},!0)),e.segments=a.concat(e.segments)}}translateBezierPoints(e,t,i,n,s,r,o){const a=e.segments.indexOf(s),l=e.segments[a];l&&("BezierSourceThumb"===t&&(l.vector1.angle||l.vector1.distance)?l.vector1={distance:e.distance(e.sourcePoint,r),angle:rb.findAngle(e.sourcePoint,r)}:"BezierTargetThumb"===t&&(l.vector2.angle||l.vector2.distance)?l.vector2={distance:e.distance(e.targetPoint,r),angle:rb.findAngle(e.targetPoint,r)}:("ConnectorSourceEnd"===t&&!e.sourceID||"ConnectorTargetEnd"===t&&!e.targetID)&&o&&Hw(l.vector1)&&Hw(l.vector2)?(rb.isEmptyPoint(l.point1)&&(l.bezierPoint1=_w(e.sourcePoint,e.targetPoint)),rb.isEmptyPoint(l.point2)&&(l.bezierPoint2=_w(e.targetPoint,e.sourcePoint))):"BezierSourceThumb"===t||"ConnectorSourceEnd"===t&&!o&&Hw(l.vector1)?(l.bezierPoint1.x+=i,l.bezierPoint1.y+=n,rb.isEmptyPoint(l.point1)&&!o||(l.point1={x:l.bezierPoint1.x,y:l.bezierPoint1.y})):("BezierTargetThumb"===t||"ConnectorTargetEnd"===t&&!o&&Hw(l.vector2))&&(l.bezierPoint2.x+=i,l.bezierPoint2.y+=n,rb.isEmptyPoint(l.point2)&&!o||(l.point2={x:l.bezierPoint2.x,y:l.bezierPoint2.y})))}dragTargetEnd(e,t,i,n,s,r,o,a){const l=this.diagram.nameTable[e.id];let h;const c=this.checkBoundaryConstraints(t,i,l.wrapper.bounds);if(sx(l)&&"BezierTargetThumb"!==r&&c&&Cx(this.diagram)){if(h={targetPoint:l.targetPoint},l.targetPoint.x+=t,l.targetPoint.y+=i,"ConnectorTargetEnd"===r&&"Orthogonal"===l.type&&l.segments&&l.segments.length>0){const e=l.segments[l.segments.length-2];e&&2===l.segments[l.segments.length-1].points.length&&("Left"===e.direction||"Right"===e.direction?e.points[e.points.length-1].x=l.targetPoint.x:e.points[e.points.length-1].y=l.targetPoint.y,e.length=rb.distancePoints(e.points[0],e.points[e.points.length-1]),e.direction=rb.direction(e.points[0],e.points[e.points.length-1]))}"Bpmn"===l.shape.type&&"Default"===l.shape.sequence&&this.updatePathElementOffset(l)}if("Bezier"===l.type)if(h={targetPoint:l.targetPoint},a)this.translateBezierPoints(e,""===r?"ConnectorTargetEnd":r,t,i,a,s,!o);else for(let d=0;d<e.segments.length;d++)this.translateBezierPoints(e,""===r?"ConnectorTargetEnd":r,t,i,e.segments[d],s,!o);return n||this.updateEndPoint(l,h),this.diagram.realActions&ev.AnimationClick||this.diagram.refreshCanvasLayers(),c}dragControlPoint(e,t,i,n,s){const r=this.diagram.nameTable[e.id];if(("Straight"===r.type||"Bezier"===r.type)&&r.segments.length>0){if(void 0!==s&&r.segments[s])r.segments[s].point.x+=t,r.segments[s].point.y+=i;else for(let e=0;e<r.segments.length-1;e++)r.segments[e].point.x+=t,r.segments[e].point.y+=i;n||this.updateEndPoint(r)}return!0}rotatePropertyChnage(e){const t=this.diagram.selectedItems;let i=[];i=i.concat(t.nodes),i=i.concat(t.connectors),this.rotateObjects(t,i,e-t.rotateAngle,{x:t.offsetX,y:t.offsetY}),t.wrapper.rotateAngle=t.rotateAngle=e,this.diagram.updateSelector()}rotateObjects(e,t,i,n,s){n=n||{};const r=bb();let o;wb(r,i,n.x,n.y);for(const a of t){if(a instanceof pP){if(ox(a)&&Cx(this.diagram)){if(!1!==s||e!==a){o={rotateAngle:a.rotateAngle},a.rotateAngle+=i,a.rotateAngle=(a.rotateAngle+360)%360;const e=vb(r,{x:a.offsetX,y:a.offsetY});a.offsetX=e.x,a.offsetY=e.y,this.diagram.nodePropertyChange(a,{},{offsetX:a.offsetX,offsetY:a.offsetY,rotateAngle:a.rotateAngle})}if(a.processId){const e=this.diagram.bpmnModule.getChildrenBound(this.diagram.nameTable[a.processId],a.id,this.diagram);this.diagram.bpmnModule.updateSubProcessess(e,a,this.diagram)}a.children&&a.children.length&&!a.container&&this.getChildren(a,t)}}else this.rotatePoints(a,i,n||{x:a.wrapper.offsetX,y:a.wrapper.offsetY});this.diagram.updateDiagramObject(a)}this.diagram.refreshCanvasLayers(),this.diagram.updateSelector()}snapConnectorEnd(e){return this.diagram.snapSettings.constraints&Bb.SnapToLines&&this.snappingModule&&this.diagram.snappingModule.snapConnectorEnd(e),e}snapAngle(e){return this.diagram.snapSettings.constraints&Bb.SnapToLines&&this.snappingModule?this.snappingModule.snapAngle(this.diagram,e):0}rotatePoints(e,t,i){if(!e.sourceWrapper||!e.targetWrapper){const n=bb();if(wb(n,t,i.x,i.y),e.sourcePoint=vb(n,e.sourcePoint),e.targetPoint=vb(n,e.targetPoint),"Bpmn"===e.shape.type&&"Default"===e.shape.sequence&&this.updatePathElementOffset(e),this.diagram.connectorPropertyChange(e,{},{sourcePoint:e.sourcePoint,targetPoint:e.targetPoint}),e.segments&&e.segments.length>0){this.diagram.protectPropertyChange(!0);let t=e;t.segments=[],this.diagram.connectorPropertyChange(t,{},{segments:t.segments}),this.diagram.protectPropertyChange(!1)}}}updateInnerParentProperties(e){const t=this.diagram.isProtectedOnChange;this.diagram.protectPropertyChange(!0);const i=this.getAllDescendants(e,[],!1,!0);for(let n=0;n<i.length;n++){const e=this.diagram.nameTable[i[n].id];e.offsetX=e.wrapper.offsetX,e.offsetY=e.wrapper.offsetY,e.width=e.wrapper.width,e.height=e.wrapper.height}this.diagram.protectPropertyChange(t)}scale(e,t,i,n,s,r){const o=this.diagram.nameTable[e.id],a=o,l=[],h=o.wrapper;s||(s=e);const c=s.wrapper,d=function(e,t,i,n,s,r,o,a){let l={x:0,y:0};const h=bb();switch(wb(h,s,r,o),a.x){case 0:switch(a.y){case 0:l=vb(h,{x:e,y:t});break;case.5:l=vb(h,{x:e,y:t+n/2});break;case 1:l=vb(h,{x:e,y:t+n})}break;case.5:switch(a.y){case 0:l=vb(h,{x:e+i/2,y:t});break;case.5:l=vb(h,{x:e+i/2,y:t+n/2});break;case 1:l=vb(h,{x:e+i/2,y:t+n})}break;case 1:switch(a.y){case 0:l=vb(h,{x:e+i,y:t});break;case.5:l=vb(h,{x:e+i,y:t+n/2});break;case 1:l=vb(h,{x:e+i,y:t+n})}}return{x:l.x,y:l.y}}(c.offsetX-c.actualSize.width*c.pivot.x,c.offsetY-c.actualSize.height*c.pivot.y,c.actualSize.width,c.actualSize.height,c.rotateAngle,c.offsetX,c.offsetY,n);if(void 0!==h.actualSize.width&&void 0!==h.actualSize.height&&Cx(this.diagram)){if(a.children&&!a.container){const n=this.getAllDescendants(a,l);for(const e of n)this.scaleObject(t,i,d,e,h,s);e.wrapper.measure(new nb),e.wrapper.arrange(e.wrapper.desiredSize),this.diagram.updateGroupOffset(o),this.updateInnerParentProperties(a)}else this.scaleObject(t,i,d,o,h,s);const c=$P(e.wrapper);if(!this.checkBoundaryConstraints(void 0,void 0,c)&&r)return this.scale(e,1/t,1/i,n,void 0,!0),!1;this.diagram.updateDiagramObject(e)}return!0}getAllDescendants(e,t,i,n){const s=e,r=[];for(let o=0;o<s.children.length;o++)(e=this.diagram.nameTable[s.children[o]])&&(e.children?(i&&t.push(e),n&&r.push(e),t=this.getAllDescendants(e,t)):t.push(e));return n?r:t}getChildren(e,t){const i=e;if(e.children)for(let n=0;n<i.children.length;n++)t.push(e=this.diagram.nameTable[i.children[n]]);return t}cloneChild(e){return this.diagram.nameTable[e]}scaleObject(e,t,i,n,s,r,o){t=t<0?1:t;let a={};if(1!==(e=e<0?1:e)||1!==t){let s,l;if(n instanceof pP){const i=n;let r,o;a={width:n.wrapper.actualSize.width,height:n.wrapper.actualSize.height,offsetX:n.wrapper.offsetX,offsetY:n.wrapper.offsetY,margin:{top:i.margin.top,left:i.margin.left}},"Bpmn"===i.shape.type&&i.shape.activity.subProcess.processes&&i.shape.activity.subProcess.processes.length>0&&(o=this.diagram.bpmnModule.getChildrenBound(i,i.id,this.diagram),r=i.wrapper.bounds.containsRect(o)),s=i.wrapper.actualSize.width*e,l=i.wrapper.actualSize.height*t,void 0!==i.maxWidth&&0!==i.maxWidth&&(s=Math.min(i.maxWidth,s)),void 0!==i.minWidth&&0!==i.minWidth&&(s=Math.max(i.minWidth,s)),void 0!==i.maxHeight&&0!==i.maxHeight&&(l=Math.min(i.maxHeight,l)),void 0!==i.minHeight&&0!==i.minHeight&&(l=Math.max(i.minHeight,l)),r&&(s=Math.max(s,o.right-i.wrapper.bounds.x),l=Math.max(l,o.bottom-i.wrapper.bounds.y)),e=s/i.actualSize.width,t=l/i.actualSize.height}const h=bb();r||(r=n);const c=r.wrapper;if(wb(h,-c.rotateAngle,i.x,i.y),xb(h,e,t,i.x,i.y),wb(h,c.rotateAngle,i.x,i.y),n instanceof pP){const e=n,t=vb(h,{x:e.wrapper.offsetX,y:e.wrapper.offsetY}),i=e.wrapper.offsetX-e.wrapper.actualSize.width*e.pivot.x,r=e.wrapper.offsetY-e.wrapper.actualSize.height*e.pivot.y;if(s>0)if(e.processId){const i=this.diagram.nameTable[e.processId];(!i.maxWidth||e.margin.left+s<i.maxWidth)&&(e.width=s,e.offsetX=t.x)}else e.width=s,e.offsetX=t.x;if(l>0)if(e.processId){const i=this.diagram.nameTable[e.processId];(!i.maxHeight||e.margin.top+l<i.maxHeight)&&(e.height=l,e.offsetY=t.y)}else e.height=l,e.offsetY=t.y;const c=e.wrapper.offsetX-e.wrapper.actualSize.width*e.pivot.x,d=e.wrapper.offsetY-e.wrapper.actualSize.height*e.pivot.y;this.diagram.nameTable[e.processId]&&(e.margin.top+(d-r)<=0||e.margin.left+(c-i)<=0)?this.diagram.nodePropertyChange(n,{},{margin:{top:e.margin.top,left:e.margin.left}}):Yx(this.diagram,n,!0)?Xx(this.diagram,n):o||this.diagram.nodePropertyChange(n,a,{width:e.width,height:e.height,offsetX:e.offsetX,offsetY:e.offsetY,margin:{top:e.margin.top+(d-r),left:e.margin.left+(c-i)}})}else{const s=n,r={sourcePoint:s.sourcePoint,targetPoint:s.targetPoint};s.sourceWrapper&&s.targetWrapper||this.scaleConnector(s,h,r,e,t,i)}const d=this.diagram.nameTable[n.processId];if(d){const e=this.diagram.bpmnModule.getChildrenBound(d,n.id,this.diagram);this.diagram.bpmnModule.updateSubProcessess(e,n,this.diagram)}}}scaleConnector(e,t,i,n,s,r){e.sourcePoint=vb(t,e.sourcePoint),e.targetPoint=vb(t,e.targetPoint),"Bpmn"===e.shape.type&&"Default"===e.shape.sequence&&this.updatePathElementOffset(e),this.diagram.connectorPropertyChange(e,i,{sourcePoint:e.sourcePoint,targetPoint:e.targetPoint});const o=this.diagram.selectedItems;if(IC(this.diagram,o)){let t=QP(this.diagram.selectedItems);const i=new pP(this.diagram,"nodes",{offsetX:t.offsetX,offsetY:t.offsetY,height:t.height,width:t.width,rotateAngle:t.rotateAngle},!0);i.wrapper=t.wrapper,i.wrapper.rotateAngle=o.rotateAngle,this.scaleObject(n,s,r,i,i.wrapper,i,!0),o.wrapper.actualSize.width=i.width,o.wrapper.actualSize.height=i.height,o.wrapper.offsetX=i.offsetX,o.wrapper.offsetY=i.offsetY,this.diagram.selectedItems.connectors[0].id!==e.id&&this.measureSelector(o)}}measureSelector(e){let t,i,n=[];n=QP(this.diagram.selectedItems).connectors;const s={x:this.diagram.selectedItems.offsetX,y:this.diagram.selectedItems.offsetY};for(let c=0;c<n.length;c++){const r=bb();wb(r,-e.rotateAngle,s.x,s.y),n[c].sourcePoint=vb(r,n[c].sourcePoint),n[c].targetPoint=vb(r,n[c].targetPoint),i=this.calculateBounds({x:n[c].sourcePoint.x,y:n[c].sourcePoint.y},{x:n[c].targetPoint.x,y:n[c].targetPoint.y}),void 0===t?t=i:t.uniteRect(i)}let r={};void 0!==t&&(r={x:t.x+t.width*e.wrapper.pivot.x,y:t.y+t.height*e.wrapper.pivot.y});const o=new pP(this.diagram,"nodes",{offsetX:r.x,offsetY:r.y,height:t.height,width:t.width,rotateAngle:0},!0),a=bb();wb(a,e.rotateAngle,s.x,s.y),o.rotateAngle+=e.rotateAngle,o.rotateAngle=(o.rotateAngle+360)%360;const l=vb(a,{x:o.offsetX,y:o.offsetY});o.offsetX=l.x,o.offsetY=l.y,e.wrapper.actualSize.width=t.width,e.wrapper.actualSize.height=t.height,e.wrapper.offsetX=o.offsetX,e.wrapper.offsetY=o.offsetY;const h=EP(this.diagram.element.id);this.diagram.diagramRenderer.renderResizeHandle(e.wrapper,h,e.thumbsConstraints,this.diagram.scroller.currentZoom,e.constraints,this.diagram.scroller.transform,!1,ex(e))}calculateBounds(e,t){let i=Math.min(e.x,t.x),n=Math.max(e.x,t.x),s=Math.min(e.y,t.y),r=Math.max(e.y,t.y);return new mb(i,s,n-i,r-s)}portDrag(e,t,i,n){let s,r;const o=this.findTarget(t,e),a=$P(e.wrapper);o&&Ox(o)&&(s=this.getPortChanges(e,o),o.offset.x+=i/a.width,o.offset.y+=n/a.height,r=this.getPortChanges(e,o),this.diagram.nodePropertyChange(e,s,r),this.diagram.updateDiagramObject(e))}labelDrag(e,t,i,n){const s=this.findTarget(t,e),r=ZP(e.wrapper),o=this.getAnnotationChanges(e,s);s instanceof wv?(s.offset.x+=i/r.width,s.offset.y+=n/r.height):(this.updatePathAnnotationOffset(e,s,i,n),s instanceof xv&&(s.alignment="Center"));const a=this.getAnnotationChanges(e,s);e instanceof pP?this.diagram.nodePropertyChange(e,o,a):this.diagram.connectorPropertyChange(e,o,a),this.diagram.updateDiagramObject(e),jO(this.diagram,s,!1,t)||this.labelSelect(e,t)}updatePathAnnotationOffset(e,t,i,n,s,r){const o=this.diagram.getWrapper(e.wrapper,t.id);let a;const l=e.intermediatePoints;let h,c,d=0,p=0;const u=s||{x:o.offsetX+i,y:o.offsetY+n},g=this.getInterceptWithSegment(u,l);let m=l[l.length-1];if(p=rb.getLengthFromListOfPoints(l),g.length>0){if(t.dragLimit.top||t.dragLimit.bottom||t.dragLimit.left||t.dragLimit.right){const i={minDistance:null};m=this.getRelativeOffset(u,l,i);const n={minDistance:null};c=this.getRelativeOffset(u,g,n),m=null!=i&&n.minDistance<i.minDistance?c:XS(e.intermediatePoints,t).point}else c=g[g.length-1],m=c;if(m){let e,t;for(e=0;e<l.length;e++){if(null!=h){if(t=mb.toBounds([h,l[e]]),t.containsPoint(m)){d+=rb.findLength(h,m);break}d+=rb.findLength(h,l[e])}h=l[e]}a={x:d/p,y:0}}this.updateLabelMargin(e,t,a,u,r,i,n)}else this.updateLabelMargin(e,t,null,u,r,i,n)}getRelativeOffset(e,t,i){let n,s,r,o;for(o=0;o<t.length;o++)r=t[o],s=Math.round(Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2))),null!==i.minDistance&&Math.min(Math.abs(i.minDistance),Math.abs(s))!==Math.abs(s)||(n=r,i.minDistance=s);return n}dragLimitValue(e,t,i,n){let s=!1,r=!1;return i.x>=t.x-e.dragLimit.left-n.width/2&&i.x<=t.x+e.dragLimit.right+n.width/2&&(s=!0),i.y>=t.y-e.dragLimit.top-n.height/2&&i.y<=t.y+e.dragLimit.bottom+n.height/2&&(r=!0),{x:s,y:r}}updateLabelMargin(e,t,i,n,s,r,o){if(i=i||{x:t.offset,y:0},t&&i&&i.x>0&&i.x<1){const a=rb.getLengthFromListOfPoints(e.intermediatePoints),l=this.getPointAtLength(a*i.x,e.intermediatePoints,0),h=this.diagram.scrollSettings.currentZoom,c=t.dragLimit;if(c.top||c.bottom||c.left||c.right){this.diagram.getWrapper(e.wrapper,t.id);const i=new mb(0,0,0,0),s=this.diagram.getWrapper(e.wrapper,t.id);i.x=s.offsetX/h+r,i.y=s.offsetY/h+o,i.width=s.bounds.width/h,i.height=s.bounds.height/h;const a=new mb(l.x-(c.left||0)-i.width/2,l.y-(c.top||0)-i.height/2,(c.left||0)+(c.right||0)+i.width,(c.top||0)+(c.bottom||0)+i.height);if(a.containsPoint(n))n=n;else{let e;e=this.boundsInterSects([l,n],a,!1);for(const t of e)n=t}const d=this.dragLimitValue(t,l,n,i);t.margin={left:d.x?n.x-l.x:t.margin.left,top:d.y?n.y-l.y:t.margin.top,right:0,bottom:0}}else t.margin={left:n.x-l.x,top:n.y-l.y,right:0,bottom:0};t.offset=i.x,s&&(t.width=s.width,t.height=s.height)}}boundsInterSects(e,t,i){let n;return t&&(n=this.intersect(e,[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height},{x:t.x,y:t.y}],i)),n}intersect(e,t,i){const n=[];for(let s=0;s<e.length-1;s++)for(let i=0;i<t.length-1;i++){const r=WS(e[s],e[s+1],t[i],t[i+1]);0!==r.x&&0!==r.y&&n.push(r)}return n}getPointAtLength(e,t,i){let n,s,r=0,o={x:0,y:0};for(let a=0;a<t.length;a++)if(s=t[a],n){{const t=rb.findLength(n,s);let i,a,l,h;if(r+t>=e){i=e-r,a=rb.findAngle(n,s),l=i*Math.cos(a*Math.PI/180),h=i*Math.sin(a*Math.PI/180),o={x:n.x+l,y:n.y+h};break}r+=t}n=s}else n=s;return o}getInterceptWithSegment(e,t){const i=[];let n,s,r=[],o=[];const a=rb.findLength({x:0,y:0},{x:this.diagram.scroller.viewPortWidth,y:this.diagram.scroller.viewPortHeight});for(let l=1;l<t.length;l++){o=[t[l-1],t[l]],r=[],s=Math.round(rb.findAngle(o[0],o[1])%360),n=Math.round(rb.findAngle(o[1],o[0])%360);const h=s>0&&s<=90||s>180&&s<=270?90:-90;r.push(rb.transform(e,s+h,a)),r.push(rb.transform(e,n+h,a));const c=BS({x1:o[0].x,y1:o[0].y,x2:o[1].x,y2:o[1].y},{x1:r[0].x,y1:r[0].y,x2:r[1].x,y2:r[1].y});c.enabled&&i.push(c.intersectPt)}return i}getAnnotationChanges(e,t){const i={};return i[dC(e,t.id,!0)]={width:t.width,height:t.height,offset:e instanceof pP?{x:t.offset.x,y:t.offset.y}:t.offset,rotateAngle:t.rotateAngle,margin:{left:t.margin.left,right:t.margin.right,top:t.margin.top,bottom:t.margin.bottom},horizontalAlignment:t.horizontalAlignment,verticalAlignment:t.verticalAlignment,alignment:e instanceof Vw?t.alignment:void 0},{annotations:i}}getPortChanges(e,t){const i={};return i[dC(e,t.id,!1)]={offset:t.offset},{ports:i}}labelRotate(e,t,i,n){let s,r;s=this.getAnnotationChanges(e,t),bb();const o=this.diagram.getWrapper(e.wrapper,t.id);let a=Xv({x:o.offsetX,y:o.offsetY},i)+90;const l=this.snapAngle(a);a=0!==l?l:a,t instanceof xv&&t.segmentAngle&&(a-=YS(e.intermediatePoints,t).angle),a=(a+360)%360,t.rotateAngle+=a-(t.rotateAngle+o.parentTransform),t.margin.bottom+="Top"===o.verticalAlignment?-t.height/2:"Bottom"===o.verticalAlignment?t.height/2:0,t.margin.right+="Left"===o.horizontalAlignment?-t.width/2:"Right"===o.horizontalAlignment?t.width/2:0,t instanceof xv?t.alignment="Center":t.horizontalAlignment=t.verticalAlignment="Center",n.wrapper.rotateAngle=n.rotateAngle=t.rotateAngle,r=this.getAnnotationChanges(e,t),e instanceof pP?this.diagram.nodePropertyChange(e,s,r):this.diagram.connectorPropertyChange(e,s,r),this.diagram.updateDiagramObject(e)}labelResize(e,t,i,n,s,r){let o,a,l;o=this.getAnnotationChanges(e,t);const h=r.wrapper.children[0];if(i&&1!==i||n&&1!==n){const r=bb(),o=bb();wb(r,-e.rotateAngle,e.offsetX,e.offsetY),l=(h.rotateAngle+(e instanceof pP?e.rotateAngle:0)+360)%360,wb(o,-l,s.x,s.y),xb(o,i,n,s.x,s.y),wb(o,l,s.x,s.y);let a=vb(o,{x:h.offsetX,y:h.offsetY});const c=h.actualSize.height*n,d=h.actualSize.width*i,p=this.findTarget(h,e);if(p instanceof xv)this.updatePathAnnotationOffset(e,t,0,0,a,new nb(d,c));else{const t=ZP(e.wrapper);a=vb(r,a),a.x=a.x-h.margin.left+h.margin.right,a.y=a.y-h.margin.top+h.margin.bottom,a.y+="Top"===p.verticalAlignment?-c/2:"Bottom"===p.verticalAlignment?c/2:0,a.x+="Left"===p.horizontalAlignment?-d/2:"Right"===p.horizontalAlignment?d/2:0;const i=t.width/(a.x-t.x),n=t.height/(a.y-t.y);d>1&&(p.width=d,p.offset.x=1/i),c>1&&(p.height=c,p.offset.y=1/n)}}t instanceof xv&&(t.alignment="Center"),a=this.getAnnotationChanges(e,t),e instanceof pP?this.diagram.nodePropertyChange(e,o,a):this.diagram.connectorPropertyChange(e,o,a),this.diagram.updateDiagramObject(e)}getSubProcess(e){const t={nodes:[],connectors:[]};let i;return e instanceof pP?i=e.processId:e&&e.nodes&&e.nodes.length&&e.nodes[0].processId&&(i=e.nodes[0].processId),i?(t.nodes.push(QP(this.diagram.nameTable[i])),t):t}checkBoundaryConstraints(e,t,i){const n=this.diagram.pageSettings,s=this.diagram.pageSettings.boundaryConstraints,r=this.diagram.scroller;if("Page"===s||"Diagram"===s){const o=i?void 0:this.diagram.selectedItems.wrapper.bounds,a="Page"===s?n.height:r.viewPortHeight,l=i,h=(i?l.left:o.left)+(e||0),c=(i?l.top:o.top)+(t||0),d=(i?l.bottom:o.bottom)+(t||0);return(i?l.right:o.right)+(e||0)<=("Page"===s?n.width:r.viewPortWidth)&&h>=0&&d<=a&&c>=0}return!0}dragSelectedObjects(e,t){let i=this.diagram.selectedItems;if(this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.offsetX=i.offsetX,this.state.backup.offsetY=i.offsetY),i=Vx(this.diagram,i)||i,this.checkBoundaryConstraints(e,t)){this.diagram.diagramActions=this.diagram.diagramActions|Jb.PreventZIndexOnDragging|Jb.DragUsingMouse;const n=this.diagram.selectedObject.actualObject;return(n&&n instanceof pP&&n.isLane&&IS(n,this.diagram)||!n||!n.isLane)&&this.diagram.drag(i,e,t),this.diagram.diagramActions=this.diagram.diagramActions&~(Jb.PreventZIndexOnDragging|Jb.DragUsingMouse),this.diagram.refreshCanvasLayers(),!0}return!1}scaleSelectedItems(e,t,i){let n=this.diagram.selectedItems;return this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.offsetX=n.offsetX,this.state.backup.offsetY=n.offsetY,this.state.backup.width=n.width,this.state.backup.height=n.height,this.state.backup.pivot=i),n=Vx(this.diagram,n)||n,this.diagram.scale(n,e,t,i)}rotateSelectedItems(e){let t=this.diagram.selectedItems;return this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.angle=t.rotateAngle),t=Vx(this.diagram,t)||t,this.diagram.rotate(t,e)}hasSelection(){return LO(this.diagram)}isSelected(e){return jO(this.diagram,e)}initExpand(e){const t=this.diagram.isProtectedOnChange;this.diagram.protectPropertyChange(!0);const i=e.target||e.source,n={isExpanded:i.isExpanded};i.isExpanded=!i.isExpanded,this.diagram.preventNodesUpdate=!0,this.diagram.diagramActions|=Jb.PreventIconsUpdate,this.diagram.nodePropertyChange(i,n,{isExpanded:i.isExpanded}),this.diagram.diagramActions=this.diagram.diagramActions&~Jb.PreventIconsUpdate,this.diagram.preventNodesUpdate=!1;for(const s of this.diagram.views){const e=this.diagram.views[s];e instanceof wT||this.diagram.refreshCanvasDiagramLayer(e)}this.diagram.protectPropertyChange(t)}expandNode(e,t,i){const n=this.diagram.preventNodesUpdate,s=e.isExpanded;this.diagram.preventNodesUpdate=!0,this.diagram.preventConnectorsUpdate=!0,this.expandCollapse(e,s,this.diagram),e.isExpanded=s;const r=this.diagram.layout.fixedNode;this.diagram.layout.fixedNode=e.id,this.diagram.diagramActions!=Jb.Render&&this.diagram.layoutAnimateModule&&this.diagram.layout.enableAnimation&&this.diagram.organizationalChartModule&&(this.diagram.organizationalChartModule.isAnimation=!0),this.diagram.blazorActions|=_b.expandNode;let o={};if(i||(o=this.diagram.doLayout()),this.diagram.blazorActions&=~_b.expandNode,this.diagram.preventNodesUpdate=n,this.diagram.preventConnectorsUpdate=!1,this.diagram.layoutAnimateModule&&this.diagram.organizationalChartModule&&!i)this.diagram.allowServerDataBinding=!1,this.layoutAnimateModule.expand(this.diagram.layout.enableAnimation,o,e,this.diagram),this.diagram.allowServerDataBinding=!0;else{const t={element:QP(e),state:!!e.isExpanded};this.triggerEvent(nv.expandStateChange,t),this.diagram.lineRoutingModule&&this.diagram.constraints&Gb.LineRouting&&this.diagram.resetSegments()}return this.diagram.layout.fixedNode=""===r?"":this.diagram.layout.fixedNode,o}getparentexpand(e,t,i,n){let s;for(let r=0;r<e.inEdges.length;r++){const o=t.nameTable[e.inEdges[r]],a=t.nameTable[o.sourceID];if(a.isExpanded&&!i&&a.id!==n.sourceID&&o.visible)return!1;s=!0}return s}expandCollapse(e,t,i){for(let n=0;n<e.outEdges.length;n++){const s=i.nameTable[e.outEdges[n]],r=i.nameTable[s.targetID],o=this.getparentexpand(r,i,t,s);s.visible=t;const a={visible:r.visible,style:{opacity:r.wrapper.style.opacity}},l={visible:r.visible,style:{opacity:r.wrapper.style.opacity}};o&&(r.isExpanded&&this.expandCollapse(r,t,i),r.visible=t,r.style.opacity=this.diagram.layoutAnimateModule&&this.diagram.layout.enableAnimation&&t?.1:r.style.opacity,i.nodePropertyChange(r,a,l)),i.connectorPropertyChange(s,a,l)}}updateNodeDimension(e,t){e instanceof pP&&(e.offsetX=t.x+t.width/2,e.offsetY=t.y+t.height/2,e.width=t.width,e.height=t.height,e.wrapper.children[0].canMeasurePath=!0,this.diagram.nodePropertyChange(e,{},{width:t.width,height:t.height,offsetX:e.offsetX,offsetY:e.offsetY}),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer())}updateConnectorPoints(e,t){e instanceof Vw&&(this.diagram.connectorPropertyChange(e,{},{targetPoint:e.targetPoint}),this.diagram.updateDiagramObject(e))}updateSelectedNodeProperties(e){if(this.diagram.lineRoutingModule&&this.diagram.constraints&Gb.LineRouting){this.diagram.protectPropertyChange(!0);let t=[];const i=[],n=this.diagram.selectedObject.actualObject,s=this.diagram.selectedObject.helperObject;if(s&&n){const e=s.offsetX-n.offsetX,i=s.offsetY-n.offsetY,r=s.width-n.width,o=s.height-n.height,a=s.rotateAngle-n.rotateAngle;if(this.diagram.selectedItems.nodes.length+this.diagram.selectedItems.connectors.length>0&&(this.diagram.selectedItems.wrapper.rotateAngle=this.diagram.selectedItems.rotateAngle=s.rotateAngle),n instanceof pP&&"SwimLane"!==n.shape.type&&!n.isLane&&!n.isPhase&&!n.isHeader)n.offsetX===n.wrapper.offsetX&&n.offsetY===n.wrapper.offsetY&&n.width===n.wrapper.width&&n.height===n.wrapper.height&&n.rotateAngle===n.wrapper.rotateAngle||(n.offsetX+=e,n.offsetY+=i,n.width+=r,n.height+=o,n.rotateAngle+=a,this.diagram.nodePropertyChange(n,{},{offsetX:n.offsetX,offsetY:n.offsetY,width:n.width,height:n.height,rotateAngle:n.rotateAngle})),t=this.diagram.spatialSearch.findObjects(n.wrapper.outerBounds);else if(n instanceof bP)for(let s=0;s<n.nodes.length;s++){const l=n.nodes[s];l instanceof pP&&"SwimLane"!==l.shape.type&&!l.isLane&&!l.isPhase&&!l.isHeader&&(l.offsetX+=e,l.offsetY+=i,l.width+=r,l.height+=o,l.rotateAngle+=a,this.diagram.nodePropertyChange(l,{},{offsetX:l.offsetX,offsetY:l.offsetY,width:l.width,height:l.height,rotateAngle:l.rotateAngle}),t=t.concat(this.diagram.spatialSearch.findObjects(n.wrapper.outerBounds)))}}else e instanceof Vw?t.push(e):e instanceof bP&&e.connectors.length&&(t=t.concat(e.connectors));for(let e=0;e<t.length;e++)t[e]instanceof Vw&&-1===i.indexOf(t[e].id)&&i.push(t[e].id);this.diagram.lineRoutingModule.renderVirtualRegion(this.diagram,!0);for(let e=0;e<i.length;e++){const t=this.diagram.nameTable[i[e]];t instanceof Vw&&"Orthogonal"===t.type&&this.diagram.lineRoutingModule.refreshConnectorSegments(this.diagram,t,!0)}this.updateSelector(),this.diagram.protectPropertyChange(!1)}}drawSelectionRectangle(e,t,i,n){this.diagram.drawSelectionRectangle(e,t,i,n)}startGroupAction(){this.diagram.startGroupAction()}endGroupAction(){this.diagram.endGroupAction()}removeChildFromBPmn(e,t,i){const n=this.diagram.nameTable[e.id]||e.nodes[0];if(i&&n&&n.processId&&n.processId===i.wrapper.id){const e=QP(n);e.processId=n.processId,this.diagram.startGroupAction();let t=[];t=t.concat(n.outEdges,n.inEdges);for(let n=t.length-1;n>=0;n--){const e=this.diagram.nameTable[t[n]];e&&this.diagram.remove(e)}const i=this.diagram.nameTable[n.processId].shape.activity.subProcess.processes||[];i.splice(i.indexOf(n.id),1),this.diagram.bpmnModule.removeChildFromBPMN(this.diagram.nameTable[n.processId].wrapper,n.id),this.diagram.nameTable[n.id].processId="",n.offsetX=n.wrapper.offsetX,n.offsetY=n.wrapper.offsetY;const s=QP(n);this.addHistoryEntry({type:"PositionChanged",redoObject:{nodes:[s]},undoObject:{nodes:[e]},category:"Internal"}),this.diagram.endGroupAction()}}isDroppable(e,t){const i=this.diagram.nameTable[e.id]||e.nodes[0];return!(!i||"TextAnnotation"!==i.shape.shape&&i&&"Bpmn"===i.shape.type&&(i.processId===t.id||i.id===t.processId||"Bpmn"===t.shape.type&&t.shape.activity.subProcess.collapsed))}renderHighlighter(e,t,i){if(new mb,e.target instanceof pP||t&&e.source instanceof pP){const n=this.findTarget(t?e.sourceWrapper:e.targetWrapper,t?e.source:e.target,i,!0);let s;if(n instanceof QC){const t=n.id,i=e.target,r=i.wrapper.children[0].children[0].children[2];for(const e of r.children)if(e.id===i.id+"_"+t){s=e.children[0];break}}else s=n instanceof pP?n.wrapper:t?e.sourceWrapper:e.targetWrapper;this.diagram.renderHighlighter(s)}}mouseOver(e,t,i){return!0}snapPoint(e,t,i,n){let s;s={x:i,y:n};let r=s;return this.snappingModule&&(r=this.diagram.snappingModule.snapPoint(this.diagram,this.diagram.selectedItems,t.x<e.x,t.y<e.y,s,e,t)),r}removeSnap(){this.diagram.snapSettings.constraints&Bb.SnapToObject&&this.snappingModule&&this.snappingModule.removeGuidelines(this.diagram)}dropAnnotation(e,t){const i=e instanceof pP?e:e.nodes[0];this.diagram.bpmnModule&&"Bpmn"===t.shape.type&&"TextAnnotation"===i.shape.shape&&(i.hasTarget=t.id,i.shape.annotation.nodeId=t.id,this.diagram.currentSymbol||(this.diagram.addTextAnnotation(i.shape.annotation,t),i.shape.annotation.nodeId="",this.diagram.remove(i)),this.diagram.refreshDiagramLayer())}drop(e,t,i){if(this.diagram.bpmnModule){const i=e instanceof pP?e:e.nodes[0];i&&"Bpmn"===i.shape.type&&"Bpmn"===t.shape.type&&(this.diagram.bpmnModule.dropBPMNchild(t,e instanceof pP?e:e.nodes[0],this.diagram),this.diagram.refreshDiagramLayer())}}addHistoryEntry(e){this.diagram.addHistoryEntry(e)}align(e,t,i){if(e.length>0){let n=0;e[0]=this.diagram.nameTable[e[0].id]||e[0];const s="Object"===i?$P(e[0].wrapper):this.diagram.selectedItems.wrapper.bounds;let r={nodes:[],connectors:[]},o={nodes:[],connectors:[]};for(n="Object"===i?n+1:n;n<e.length;n++){let i=0,a=0;e[n]=this.diagram.nameTable[e[n].id]||e[n];const l=$P(e[n].wrapper);"Left"===t?i=s.left+l.width/2-l.center.x:"Right"===t?i=s.right-l.width/2-l.center.x:"Top"===t?a=s.top+l.height/2-l.center.y:"Bottom"===t?a=s.bottom-l.height/2-l.center.y:"Center"===t?i=s.center.x-l.center.x:"Middle"===t&&(a=s.center.y-l.center.y),r=this.storeObject(r,e[n]),this.drag(e[n],i,a),this.diagram.updateSelector(),o=this.storeObject(o,e[n])}r=QP(r),o=QP(o);const a={type:"Align",category:"Internal",undoObject:QP(r),redoObject:QP(o)};this.addHistoryEntry(a)}}distribute(e,t){if(e.length>0){let i=0,n=0,s=0,r=0,o=0,a=0,l=0,h=0,c={nodes:[],connectors:[]},d={nodes:[],connectors:[]};for(i=0;i<e.length;i++)e[i]=this.diagram.nameTable[e[i].id]||e[i];for(e=function(e,t){let i,n=0,s=0;for(n=0;n<e.length;n++){const r=$P(e[n].wrapper);for(s=0;s<e.length;s++){const o=$P(e[s].wrapper);"Top"===t||"Bottom"===t||"BottomToTop"===t||"Middle"===t?r.center.y>o.center.y&&(i=e[n],e[n]=e[s],e[s]=i):r.center.x>o.center.x&&(i=e[n],e[n]=e[s],e[s]=i)}}return e}(e,t),i=1;i<e.length;i++)n=n+e[i].wrapper.bounds.topRight.x-e[i-1].wrapper.bounds.topRight.x,s=s+e[i].wrapper.bounds.topLeft.x-e[i-1].wrapper.bounds.topLeft.x,r=r+e[i].wrapper.bounds.topRight.y-e[i-1].wrapper.bounds.topRight.y,o=o+e[i].wrapper.bounds.bottomRight.y-e[i-1].wrapper.bounds.bottomRight.y,a=a+e[i].wrapper.bounds.center.x-e[i-1].wrapper.bounds.center.x,l=l+e[i].wrapper.bounds.center.y-e[i-1].wrapper.bounds.center.y,h=h+e[i].wrapper.bounds.topRight.y-e[i-1].wrapper.bounds.bottomRight.y;for(i=1;i<e.length-1;i++){let p=0,u=0;const g=$P(e[i-1].wrapper),m=$P(e[i].wrapper);"RightToLeft"===t||"Center"===t?p=g.center.x-m.center.x+a/(e.length-1):"Right"===t?p=g.topRight.x-m.topRight.x+n/(e.length-1):"Left"===t?p=g.topLeft.x-m.topLeft.x+s/(e.length-1):"Middle"===t?u=g.center.y-m.center.y+l/(e.length-1):"Top"===t?u=g.topRight.y-m.topRight.y+r/(e.length-1):"Bottom"===t?u=g.bottomRight.y-m.bottomRight.y+o/(e.length-1):"BottomToTop"===t&&(u=g.bottomRight.y-m.topRight.y+h/(e.length-1)),c=this.storeObject(c,e[i]),this.drag(e[i],p,u),this.diagram.updateSelector(),d=this.storeObject(d,e[i])}c=QP(c),d=QP(d);const p={type:"Distribute",category:"Internal",undoObject:QP(c),redoObject:QP(d)};this.addHistoryEntry(p)}}sameSize(e,t){if(e.length>0){let i=0;const n={x:.5,y:.5};e[0]=this.diagram.nameTable[e[0].id]||e[0];const s=$P(e[0].wrapper);let r={nodes:[],connectors:[]},o={nodes:[],connectors:[]};for(i=1;i<e.length;i++){e[i]=this.diagram.nameTable[e[i].id]||e[0];const a=$P(e[i].wrapper);let l=1,h=1;"Width"===t?l=s.width/a.width:"Height"===t?h=s.height/a.height:"Size"===t&&(l=s.width/a.width,h=s.height/a.height),r=this.storeObject(r,e[i]),this.scale(e[i],l,h,n),o=this.storeObject(o,e[i])}this.diagram.updateSelector(),r=QP(r),o=QP(o);const a={type:"Sizing",category:"Internal",undoObject:QP(r),redoObject:QP(o)};this.addHistoryEntry(a)}}storeObject(e,t){return t instanceof pP?e.nodes.push(QP(t)):e.connectors.push(QP(t)),e}updatePanState(e){if(e)this.diagram.realActions=this.diagram.realActions|ev.PanInProgress;else{this.diagram.dataBind();const e=this.diagram.scrollSettings;this.diagram.realActions=this.diagram.realActions&~ev.PanInProgress;const t={VerticalOffset:e.verticalOffset,HorizontalOffset:e.horizontalOffset,ViewportHeight:e.viewPortHeight,ViewportWidth:e.viewPortWidth,CurrentZoom:e.currentZoom};this.triggerEvent(nv.scrollChange,{oldValue:t,newValue:t,source:this.diagram,panState:"Completed"})}}dataBinding(){this.diagram.dataBind()}setBlazorDiagramProps(e){this.diagram.setBlazorDiagramProps(e)}scroll(e,t,i){this.diagram.pan((e=this.diagram.constraints&Gb.PanX?e:0)*this.diagram.scroller.currentZoom,(t=this.diagram.constraints&Gb.PanY?t:0)*this.diagram.scroller.currentZoom,i)}drawHighlighter(e){this.diagram.renderHighlighter(e.wrapper)}removeHighlighter(){this.diagram.clearHighlighter()}renderContainerHelper(e){return Vx(this.diagram,e)}isParentAsContainer(e,t){return Yx(this.diagram,e,t)}dropChildToContainer(e,t){this.diagram.diagramActions&Jb.PreventLaneContainerUpdate||qx(this.diagram,e,t)}updateLaneChildrenZindex(e,t){let i=this.findLeastIndexObject(e,t),n=this.diagram.nameTable[t.parentId];if(n.zIndex>i.zIndex){let e=this.diagram.layers.indexOf(this.diagram.getActiveLayer());const r=this.diagram.layers[e].zIndexTable,o=JSON.parse(JSON.stringify(r));let a=i.zIndex,l=n.zIndex;for(var s=l;s>=a;s--)a!==s?r[s-1]?(r[s]=r[s-1],this.diagram.nameTable[r[s]].zIndex=s):(r[s-1]=r[s],this.diagram.nameTable[r[s-1]].zIndex=s,delete r[s]):this.swapZIndexObjects(l,r,n.id,o);"SVG"===this.diagram.mode?(this.moveSvgNode(t.parentId,i.id),this.updateNativeNodeIndex(t.parentId,i.id)):this.diagram.refreshCanvasLayers()}}findLeastIndexConnector(e,t,i){for(let n=0;n<e.length;n++){let t=this.diagram.nameTable[e[n]];i.zIndex>t.zIndex&&(i=t)}return i}findLeastIndexObject(e,t){let i=e;return e instanceof pP&&(i=this.findLeastIndexConnector(e.inEdges,t,i),i=this.findLeastIndexConnector(e.outEdges,t,i)),i}checkSelection(e,t){let i;if(1===e.nodes.length&&0===e.connectors.length)if(Yx(this.diagram,e.nodes[0],!0)){i="SwimLane"===e.nodes[0].shape?e.nodes[0]:this.diagram.nameTable[e.nodes[0].parentId];const n=e.nodes[0];if("SwimLane"===i.shape.type){const e="Horizontal"===i.shape.orientation;(n.isPhase&&(e&&"ResizeSouth"===t||!e&&"ResizeEast"===t)||n.isLane&&(e&&"ResizeEast"===t||!e&&"ResizeSouth"===t))&&vS(this.diagram,i,t)}else if("Grid"===i.container.type)if("Horizontal"===i.container.orientation&&1===n.rowIndex||"Vertical"===i.container.orientation&&n.rowIndex>0&&n.columnIndex>0){if("ResizeSouth"===t)for(let e=0;e<this.diagram.nodes.length;e++){const t=this.diagram.nodes[e];if(t.rowIndex===i.rows.length-1&&0===t.columnIndex){this.select(t);break}}}else if("ResizeEast"===t)for(let e=0;e<this.diagram.nodes.length;e++){const t=this.diagram.nodes[e];if(1===t.rowIndex&&t.columnIndex===i.columns.length-1){this.select(t);break}}}else vS(this.diagram,e.nodes[0],t)}zoom(e,t,i,n){this.diagram.scroller.zoom(e,t*this.diagram.scroller.currentZoom,i*this.diagram.scroller.currentZoom,n)}}class dT{constructor(e){this.transform={tx:0,ty:0,scale:1},this.oldCollectionObjects=[],this.removeCollection=[],this.vPortWidth=0,this.vPortHeight=0,this.currentZoomFActor=1,this.hOffset=0,this.vOffset=0,this.scrolled=!1,this.hScrollSize=0,this.vScrollSize=0,this.diagram=e,this.objects=[],this.transform=e.scroller?e.scroller.transform:{tx:0,ty:0,scale:1},this.vPortWidth=e.scrollSettings.viewPortWidth,this.vPortHeight=e.scrollSettings.viewPortHeight,this.currentZoomFActor=e.scrollSettings.currentZoom,this.hOffset=e.scrollSettings.horizontalOffset,this.vOffset=e.scrollSettings.verticalOffset}get viewPortHeight(){return this.vPortHeight}set viewPortHeight(e){this.vPortHeight=e,this.diagram.scrollSettings.viewPortHeight=e}get currentZoom(){return this.currentZoomFActor}set currentZoom(e){this.currentZoomFActor=e,this.diagram.scrollSettings.currentZoom=e}get viewPortWidth(){return this.vPortWidth}set viewPortWidth(e){this.vPortWidth=e,this.diagram.scrollSettings.viewPortWidth=e}get horizontalOffset(){return this.hOffset}set horizontalOffset(e){this.hOffset=e,Math.abs(this.hOffset-this.diagram.scrollSettings.horizontalOffset)>1&&(this.diagram.realActions=this.diagram.realActions|ev.hScrollbarMoved,this.scrolled=!0),this.diagram.scrollSettings.horizontalOffset=e}get verticalOffset(){return this.vOffset}set verticalOffset(e){this.vOffset=e,Math.abs(this.vOffset-this.diagram.scrollSettings.verticalOffset)>1&&(this.diagram.realActions=this.diagram.realActions|ev.vScrollbarMoved,this.scrolled=!0),this.diagram.scrollSettings.verticalOffset=e}updateScrollOffsets(e,t){let i=0,n=0;const s=this.getPageBounds(void 0,void 0,!0);s.x*=this.currentZoom,s.y*=this.currentZoom,s.width*=this.currentZoom,s.height*=this.currentZoom,i=Math.max(0,e-s.left),n=Math.max(0,t-s.top),void 0!==e&&void 0!==t?(this.horizontalOffset=i,this.verticalOffset=n,this.diagram.setOffset(i,n)):this.diagram.setOffset(-this.horizontalOffset-s.x,-this.verticalOffset-s.y),this.transform={tx:Math.max(this.horizontalOffset,-s.left)/this.currentZoom,ty:Math.max(this.verticalOffset,-s.top)/this.currentZoom,scale:this.currentZoom}}setScrollOffset(e,t){this.scrolled=!1;const i=this.getPageBounds(void 0,void 0,!0);i.x*=this.currentZoom,i.y*=this.currentZoom,i.width*=this.currentZoom,i.height*=this.currentZoom;const n=-i.left,s=-i.top;let r=!1;const o=this.viewPortWidth*this.currentZoom,a=this.viewPortHeight*this.currentZoom,l=n-e;if(l!==this.horizontalOffset){n<this.horizontalOffset&&(this.horizontalOffset>l?this.horizontalOffset-=e:this.horizontalOffset=l,r=!0);const t=Math.max(i.right+this.vScrollSize,o);if(!r&&t<-l+this.viewPortWidth){const e=-l+o-this.vScrollSize,t=-this.horizontalOffset+o-this.vScrollSize;this.horizontalOffset=e<t||e-i.right>e-t?l:-(i.right+this.vScrollSize-o),r=!0}r||(this.horizontalOffset=n-e)}r=!1;const h=s-t;if(h!==this.verticalOffset){s<this.verticalOffset&&(this.verticalOffset>h?this.verticalOffset-=t:this.verticalOffset=h,r=!0);const e=Math.max(i.bottom+this.hScrollSize,a);if(!r&&e<-h+a){const e=-h+a-this.hScrollSize,t=-this.verticalOffset+a-this.hScrollSize;this.verticalOffset=e<t||e-i.bottom>e-t?h:-(i.bottom+this.hScrollSize-a),r=!0}r||(this.verticalOffset=s-t)}this.transform={tx:Math.max(this.horizontalOffset,-i.left)/this.currentZoom,ty:Math.max(this.verticalOffset,-i.top)/this.currentZoom,scale:this.currentZoom},this.setSize()}getObjects(e,t){const i=[];for(let n=0;n<e.length;n++){let s=!1;for(let i=0;i<t.length;i++)if(e[n]===t[i]){s=!0;break}s||i.push(e[n])}return i}virtualizeElements(){const e=this.diagram.spatialSearch.findObjects(new mb(-this.horizontalOffset/this.currentZoom,-this.verticalOffset/this.currentZoom,this.viewPortWidth/this.currentZoom,this.viewPortHeight/this.currentZoom)),t=[];for(let s=0;s<e.length;s++)t.push(e[s].id);const i=this.getObjects(t,this.oldCollectionObjects);0===this.oldCollectionObjects.length&&(this.oldCollectionObjects=t);const n=this.getObjects(this.oldCollectionObjects,t);this.diagram.updateVirtualObjects(i,!1,n),this.oldCollectionObjects=t}setSize(e){const t=this.getPageBounds(void 0,void 0,!0);t.x*=this.currentZoom,t.y*=this.currentZoom,t.width*=this.currentZoom,t.height*=this.currentZoom;const i=Math.min(t.x,-this.horizontalOffset),n=Math.min(t.y,-this.verticalOffset);let s=this.scrollerWidth,r=this.scrollerWidth;-this.verticalOffset<=t.y&&-this.verticalOffset+this.viewPortHeight>=t.bottom&&(r=0),-this.horizontalOffset<=t.x&&-this.horizontalOffset+this.viewPortWidth>=t.right&&(s=0),this.hScrollSize=s,this.vScrollSize=r;const o=this.diagramWidth,a=this.diagramHeight;this.diagramWidth=Math.max(t.right,-this.horizontalOffset+this.viewPortWidth-r)-i,this.diagramHeight=Math.max(t.bottom,-this.verticalOffset+this.viewPortHeight-s)-n,o===this.diagramWidth&&a===this.diagramHeight||"Diagram"===this.diagram.scrollSettings.scrollLimit||this.diagram.setSize(this.diagramWidth,this.diagramHeight),"Diagram"===this.diagram.scrollSettings.scrollLimit&&(o===this.diagramWidth&&a===this.diagramHeight&&1===this.currentZoom||this.diagram.diagramActions&&e&&(!this.diagram.diagramActions||!e||0===this.verticalOffset&&this.verticalOffset!==e.y||0===this.horizontalOffset&&this.horizontalOffset!==e.x)?e&&o===this.diagramWidth&&a===this.diagramHeight&&(this.diagram.diagramCanvas.scrollHeight>this.viewPortHeight&&e.y<0&&this.horizontalOffset===e.x&&0===this.verticalOffset||this.diagram.diagramCanvas.scrollWidth>this.viewPortWidth&&e.x<0&&this.verticalOffset===e.y&&0===this.horizontalOffset)&&(this.verticalOffset=e.y,this.horizontalOffset=e.x,this.transform={tx:Math.max(e.x,-t.left)/this.currentZoom,ty:Math.max(e.y,-t.top)/this.currentZoom,scale:this.currentZoom}):(this.diagram.scrollActions&tv.Interaction&&e&&(this.transform={tx:Math.max(e.x,-t.left/this.currentZoom)/this.currentZoom,ty:Math.max(e.y,-t.top/this.currentZoom)/this.currentZoom,scale:this.currentZoom},this.horizontalOffset=e.x,this.verticalOffset=e.y),this.diagram.setSize(this.diagramWidth,this.diagramHeight),this.diagram.scrollActions&tv.PropertyChange||!e||(this.horizontalOffset=e.x,this.verticalOffset=e.y,this.transform={tx:Math.max(e.x,-t.left)/this.currentZoom,ty:Math.max(e.y,-t.top)/this.currentZoom,scale:this.currentZoom}))),this.diagram.transformLayers(),this.diagram.element.style.overflow="hidden"}setViewPortSize(e,t){this.viewPortWidth=e,this.viewPortHeight=t}getPageBounds(e,t,i){let n,s=new mb;if("Content"!==t&&null!==this.diagram.pageSettings.width&&null!==this.diagram.pageSettings.height){let e=this.diagram.pageSettings.width,t=this.diagram.pageSettings.height,i=0,r=0;if(this.diagram.pageSettings.multiplePage){if(s=this.diagram.spatialSearch.getPageBounds(0,0),s.right>e&&(e*=Math.ceil(s.right/e)),s.bottom>t&&(t*=Math.ceil(s.bottom/t)),s.left<0&&Math.abs(s.left)>i){const e=Math.ceil(Math.abs(s.left)/this.diagram.pageSettings.width);i=this.diagram.pageSettings.width*e}if(s.top<0&&Math.abs(s.top)>r){const e=Math.ceil(Math.abs(s.top)/this.diagram.pageSettings.height);r=this.diagram.pageSettings.height*e}}n=new mb(-i,-r,e+i,t+r)}else{const t=e?void 0:0;n=this.diagram.spatialSearch.getPageBounds(t,t)}if(i){const e=this.diagram.scrollSettings.padding;n.x-=e.left,n.y-=e.top,n.width+=e.left+e.right,n.height+=e.top+e.bottom}return n}getPageBreak(e){let t=0,i=0,n=-1;const s=[];let r=0,o=0,a=0,l=0;const h=this.diagram.pageSettings.margin.left,c=this.diagram.pageSettings.margin.right,d=this.diagram.pageSettings.margin.top,p=this.diagram.pageSettings.margin.bottom;let u=1,g=1,m={x1:r,y1:a,x2:o,y2:l};for(;e.width>t;)t+=this.diagram.pageSettings.width?this.diagram.pageSettings.width:e.width,t===this.diagram.pageSettings.width&&(m={x1:e.left+h,y1:e.top+d,x2:e.left+h,y2:e.bottom-p},s[++n]=m),t<e.width&&(r=e.topLeft.x+this.diagram.pageSettings.width*u,a=e.topLeft.y+d,o=e.bottomLeft.x+this.diagram.pageSettings.width*u,l=e.bottomLeft.y-p,m={x1:r,y1:a,x2:o,y2:l},s[++n]=m,u++),e.width===t&&(m={x1:e.right-c,y1:e.top+d,x2:e.right-c,y2:e.bottom-p},s[++n]=m);for(;e.height>i;)i+=this.diagram.pageSettings.height?this.diagram.pageSettings.height:e.height,i===this.diagram.pageSettings.height&&(m={x1:e.left+h,y1:e.top+d,x2:e.right-c,y2:e.top+d},s[++n]=m),i<e.height&&(r=e.topLeft.x+h,a=e.topLeft.y+this.diagram.pageSettings.height*g,o=e.topRight.x-c,l=e.topRight.y+this.diagram.pageSettings.height*g,m={x1:r,y1:a,x2:o,y2:l},s[++n]=m,g++),e.height===i&&(m={x1:e.left+h,y1:e.bottom-p,x2:e.right-c,y2:e.bottom-p},s[++n]=m);return s}zoom(e,t,i,n){if(this.diagram.constraints&Gb.Zoom&&1!==e||this.diagram.constraints&Gb.Pan&&1===e){const s=bb();if(xb(s,this.currentZoom,this.currentZoom),Sb(s,this.horizontalOffset,this.verticalOffset),n=vb(s,n=n||{x:(this.viewPortWidth/2-this.horizontalOffset)/this.currentZoom,y:(this.viewPortHeight/2-this.verticalOffset)/this.currentZoom}),this.currentZoom*e>=this.diagram.scrollSettings.minZoom&&this.currentZoom*e<=this.diagram.scrollSettings.maxZoom){this.currentZoom*=e;const r=this.getPageBounds(void 0,void 0,!0);r.x*=this.currentZoom,r.y*=this.currentZoom;const o=bb();xb(o,e,e,n.x,n.y),Sb(o,t||0,i||0),Cb(s,o);let a=vb(s,{x:0,y:0});1===e&&(a=this.applyScrollLimit(a.x,a.y)),!(this.diagram.scrollActions&tv.PropertyChange)&&this.diagram.scrollActions&tv.Interaction&&"Diagram"===this.diagram.scrollSettings.scrollLimit||(this.transform={tx:Math.max(a.x,-r.left)/this.currentZoom,ty:Math.max(a.y,-r.top)/this.currentZoom,scale:this.currentZoom},this.horizontalOffset=a.x,this.verticalOffset=a.y),this.setSize(a),"SVG"!==this.diagram.mode&&gx(this.diagram)&&this.diagram.scroller.virtualizeElements(),"SVG"===this.diagram.mode||gx(this.diagram)||this.diagram.refreshDiagramLayer(),this.diagram.setOffset(-this.horizontalOffset-r.x,-this.verticalOffset-r.y),qw(this.diagram)}}}fitToPage(e){let t=(e=e||{}).mode,i=e.region;const n=e.margin||{},s=e.canZoomIn,r=e.customBounds;n.bottom=n.bottom||25,n.top=n.top||25,n.left=n.left||25,n.right=n.right||25;let o,a=r,l=-this.horizontalOffset,h=-this.verticalOffset;if(i=i||"PageSettings","PageSettings"===i&&this.diagram.pageSettings.width&&this.diagram.pageSettings.height||this.diagram.nodes.length>0||this.diagram.connectors.length>0){t=t||"Page","CustomBounds"!==i&&(a=this.getPageBounds(!0,i,!0));const e={x:0,y:0};let r,c,d;switch(e.x=(this.viewPortWidth-(n.left+n.right))/a.width,e.y=(this.viewPortHeight-(n.top+n.bottom))/a.height,!s&&a.width-this.horizontalOffset<this.viewPortWidth&&a.height-this.verticalOffset<this.viewPortHeight&&(e.x=Math.min(this.currentZoom,e.x),e.y=Math.min(this.currentZoom,e.y)),t){case"Width":r=e.x,o=r/this.currentZoom,c=(this.viewPortWidth-a.width*r)/2-a.x*r,l+=c+(n.left-n.right)/2*r,h-=-this.verticalOffset*o,h="CustomBounds"!==i?h:h-this.verticalOffset*o;break;case"Height":r=e.y,o=r/this.currentZoom,c=(this.viewPortWidth-a.width*r)/2-a.x*r,d=(this.viewPortHeight-a.height*r)/2-a.y*r,l+=c+(n.left-n.right)/2*r,h+=d+(n.top-n.bottom)/2*r;break;case"Page":r=Math.min(e.x,e.y),o=r/this.currentZoom,c=(this.viewPortWidth-a.width*r)/2-a.x*r,d=(this.viewPortHeight-a.height*r)/2-a.y*r,l+=c+(n.left-n.right)/2*r,h+=d+(n.top-n.bottom)/2*r}this.zoom(o,l,h,{x:0,y:0})}else o=1/this.currentZoom,this.zoom(o,l,h,{x:0,y:0})}bringIntoView(e){if(e&&e.width&&e.height){let t=e;t.x>0&&t.x>=t.width&&(t.width=t.x+t.x/3),t.x>0&&t.y>=t.height&&(t.height=t.y+t.y/3);const i={x:0,y:0};let n,s,r,o;i.x=(this.viewPortWidth-50)/t.width,i.y=(this.viewPortHeight-50)/t.height;let a=-this.horizontalOffset,l=-this.verticalOffset;n=Math.min(i.x,i.y),o=n/this.currentZoom,s=(this.viewPortWidth-t.width*n)/2-t.x*n,r=(this.viewPortHeight-t.height*n)/2-t.y*n,a+=s,l+=r,this.zoom(o,a,l,{x:0,y:0})}}bringToCenter(e){const t=this.currentZoom,i=new mb(e.x*t,e.y*t,e.width*t,e.height*t);this.zoom(1,-this.horizontalOffset-(i.x+i.width/2-this.viewPortWidth/2),-this.verticalOffset-(i.y+i.height/2-this.viewPortHeight/2),null)}applyScrollLimit(e,t){if("Infinity"!==this.diagram.scrollSettings.scrollLimit){let i;if("Limited"===this.diagram.scrollSettings.scrollLimit){const e=this.diagram.scrollSettings.scrollableArea;i=new mb(e.x,e.y,e.width,e.height)}i=i||this.getPageBounds(!0),i.x*=this.currentZoom,i.y*=this.currentZoom,i.width*=this.currentZoom,i.height*=this.currentZoom,e*=-1,t*=-1;const n=Math.max(i.right,this.viewPortWidth);e<=i.x&&(e+this.viewPortWidth>=i.right||e>=i.right-this.viewPortWidth)||e>=i.x&&e+this.viewPortWidth<=n||(e=e>=i.x?Math.max(i.x,Math.min(e,e-(e+this.viewPortWidth-this.vScrollSize-n))):Math.min(i.right-this.viewPortWidth,i.x));const s=Math.max(i.bottom,this.viewPortHeight);t<=i.y&&t+this.viewPortHeight>=i.bottom||t>=i.y&&t+this.viewPortHeight<=s||(t=t>=i.y?Math.max(i.y,Math.min(t,t-(t+this.viewPortHeight-this.hScrollSize-s))):Math.min(i.y,i.bottom-this.viewPortHeight)),e*=-1,t*=-1}return{x:e,y:t}}}class pT{constructor(e,t,i,n,s){this.objects=[],this.left=e,this.top=t,this.width=i,this.height=n,this.spatialSearch=s}findQuads(e,t){null!=this.first&&this.first.isIntersect(e)&&this.first.findQuads(e,t),null!=this.second&&this.second.isIntersect(e)&&this.second.findQuads(e,t),null!=this.third&&this.third.isIntersect(e)&&this.third.findQuads(e,t),null!=this.fourth&&this.fourth.isIntersect(e)&&this.fourth.findQuads(e,t),this.objects.length>0&&t.push(this)}isIntersect(e){return!(this.left+this.width<e.left||this.top+this.height<e.top||this.left>e.right||this.top>e.bottom)}selectQuad(){let e,t=null,i=this;for(;null!=i;)e=i.getQuad(t),i=e.source,t=e.target||t;return t}getQuad(e){const t=this.width/2,i=this.height/2;if(t>=1e3&&i>=1e3){const e=this.left+t,n=this.top+i;if(this.spatialSearch.childRight<=e){if(this.spatialSearch.childBottom<=n){if(!this.first){const e=new pT(this.left,this.top,t,i,this.spatialSearch);e.parent=this,this.first=e}return{source:this.first}}if(this.spatialSearch.childTop>=n){if(!this.third){const e=new pT(this.left,n,t,i,this.spatialSearch);e.parent=this,this.third=e}return{source:this.third}}}else if(this.spatialSearch.childLeft>=e){if(this.spatialSearch.childBottom<=n){if(!this.second){const n=new pT(e,this.top,t,i,this.spatialSearch);n.parent=this,this.second=n}return{source:this.second}}if(this.spatialSearch.childTop>=n){if(!this.fourth){const s=new pT(e,n,t,i,this.spatialSearch);s.parent=this,this.fourth=s}return{source:this.fourth}}}}return this.objects.push(this.spatialSearch.childNode),{target:this}}isContained(){return this.spatialSearch.childLeft>=this.left&&this.spatialSearch.childRight<=this.left+this.width&&this.spatialSearch.childTop>=this.top&&this.spatialSearch.childBottom<=this.top+this.height}addIntoAQuad(e){let t={};this.spatialSearch.setCurrentNode(e);let i=null;for(;!t.isAdded;)t=this.spatialSearch.parentQuad.add(i),i=t.quad;return i}add(e){if(e=null,this.isContained())return{isAdded:!0,quad:e=this.selectQuad()};{let t;const i=!(0!==this.objects.length||this.first||this.second||this.third||this.fourth),n=2*this.width,s=2*this.height;return this.spatialSearch.childLeft<this.left?this.spatialSearch.childTop<this.top?(t=new pT(this.left-this.width,this.top-this.height,n,s,this.spatialSearch),i||(t.fourth=this)):(t=new pT(this.left-this.width,this.top,n,s,this.spatialSearch),i||(t.second=this)):this.spatialSearch.childTop<this.top?(t=new pT(this.left,this.top-this.height,n,s,this.spatialSearch),i||(t.third=this)):(t=new pT(this.left,this.top,n,s,this.spatialSearch),i||(t.first=this)),this.parent=t,this.spatialSearch.parentQuad=t,{isAdded:!1,quad:e}}}}class uT{constructor(e){this.quadSize=500,this.objectTable=e,this.parentQuad=new pT(0,0,2*this.quadSize,2*this.quadSize,this),this.pageLeft=Number.MAX_VALUE,this.pageRight=-Number.MAX_VALUE,this.pageTop=Number.MAX_VALUE,this.pageBottom=-Number.MAX_VALUE,this.quadTable={}}removeFromAQuad(e){if(this.quadTable[e.id]){const t=this.quadTable[e.id],i=this.objectIndex(t.objects,e);-1!==i&&(t.objects.splice(i,1),this.update(t),delete this.quadTable[e.id])}}update(e){if(e.parent&&0===e.objects.length&&e.first&&e.second&&e.third&&e.fourth){const t=e.parent;t.first===e?t.first=null:t.second===e?t.second=null:t.third===e?t.third=null:t.fourth===e&&(t.fourth=null),this.update(e.parent)}else e!==this.parentQuad||e.first||e.second||e.third||e.fourth||(e.left=0,e.width=1e3,e.top=0,e.height=1e3)}addIntoAQuad(e){const t=this.parentQuad.addIntoAQuad(e);this.quadTable[e.id]=t}objectIndex(e,t){for(let i=0;i<e.length;i++)if(e[i].id===t.id)return i;return-1}updateQuad(e){this.setCurrentNode(e);const t=e.outerBounds;if(isNaN(t.x)||isNaN(t.y)||isNaN(t.width)||isNaN(t.height))return!1;if(this.quadTable[e.id]?this.quadTable[e.id].isContained()||(this.removeFromAQuad(e),this.addIntoAQuad(e)):this.addIntoAQuad(e),!this.isWithinPageBounds(t)||this.leftElement===e||this.topElement===e||this.rightElement===e||this.bottomElement===e){let t=!1;return this.pageLeft===this.childLeft&&e===this.leftElement||(this.pageLeft>=this.childLeft?(this.pageLeft=this.childLeft,this.leftElement=e,t=!0):e===this.leftElement&&(this.pageLeft=Number.MAX_VALUE,this.findLeft(this.parentQuad),t=!0)),this.pageTop===this.childTop&&e===this.topElement||(this.pageTop>=this.childTop?(this.pageTop=this.childTop,this.topElement=e,t=!0):e===this.topElement&&(this.pageTop=Number.MAX_VALUE,this.findTop(this.parentQuad),t=!0)),this.pageBottom===this.childBottom&&e===this.bottomElement||(this.pageBottom<=this.childBottom?(t=!0,this.pageBottom=this.childBottom,this.bottomElement=e):e===this.bottomElement&&(this.pageBottom=-Number.MAX_VALUE,this.findBottom(this.parentQuad),t=!0)),this.pageRight===this.childRight&&e===this.rightElement||(this.pageRight<=this.childRight?(this.pageRight=this.childRight,this.rightElement=e,t=!0):e===this.rightElement&&(this.pageRight=-Number.MAX_VALUE,this.findRight(this.parentQuad),t=!0)),t}return this.setCurrentNode(null),!1}isWithinPageBounds(e){return e.left>=this.pageLeft&&e.right<=this.pageRight&&e.top>=this.pageTop&&e.bottom<=this.pageBottom}findQuads(e){const t=[];return this.parentQuad.findQuads(e,t),t}findObjects(e){const t=this.findQuads(e),i=[];for(const n of t)for(const t of n.objects)t.outerBounds.intersects(e)&&i.push(this.objectTable[t.id]);return i}updateBounds(e){let t=!1;return e===this.topElement&&(this.pageTop=Number.MAX_VALUE,this.topElement=null,this.findTop(this.parentQuad),t=!0),e===this.leftElement&&(this.pageLeft=Number.MAX_VALUE,this.leftElement=null,this.findLeft(this.parentQuad),t=!0),e===this.rightElement&&(this.pageRight=-Number.MAX_VALUE,this.rightElement=null,this.findRight(this.parentQuad),t=!0),e===this.bottomElement&&(this.pageBottom=-Number.MAX_VALUE,this.bottomElement=null,this.findBottom(this.parentQuad),t=!0),t}findBottom(e){e.third||e.fourth?(e.third&&this.findBottom(e.third),e.fourth&&this.findBottom(e.fourth)):(e.second&&this.findBottom(e.second),e.first&&this.findBottom(e.first));for(const t of e.objects)this.pageBottom<=t.outerBounds.bottom&&(this.pageBottom=t.outerBounds.bottom,this.bottomElement=t)}findRight(e){e.second||e.fourth?(e.second&&this.findRight(e.second),e.fourth&&this.findRight(e.fourth)):(e.first&&this.findRight(e.first),e.third&&this.findRight(e.third));for(const t of e.objects)this.pageRight<=t.outerBounds.right&&(this.pageRight=t.outerBounds.right,this.rightElement=t)}findLeft(e){e.first||e.third?(e.first&&this.findLeft(e.first),e.third&&this.findLeft(e.third)):(e.second&&this.findLeft(e.second),e.fourth&&this.findLeft(e.fourth));for(const t of e.objects)this.pageLeft>=t.outerBounds.left&&(this.pageLeft=t.outerBounds.left,this.leftElement=t)}findTop(e){e.first||e.second?(e.first&&this.findTop(e.first),e.second&&this.findTop(e.second)):(e.third&&this.findTop(e.third),e.fourth&&this.findTop(e.fourth));for(const t of e.objects)this.pageTop>=t.outerBounds.top&&(this.pageTop=t.outerBounds.top,this.topElement=t)}setCurrentNode(e){if(this.childNode=e,e){const t=e.outerBounds;this.childLeft=Number(t.left),this.childTop=Number(t.top),this.childRight=Number(t.right),this.childBottom=Number(t.bottom)}else this.childLeft=Number.MAX_VALUE,this.childTop=Number.MAX_VALUE,this.childRight=-Number.MAX_VALUE,this.childBottom=-Number.MAX_VALUE}getPageBounds(e,t){if(this.pageLeft===Number.MAX_VALUE)return new mb(0,0,0,0);const i=void 0!==e?Math.min(this.pageLeft,0):this.pageLeft,n=void 0!==t?Math.min(this.pageTop,0):this.pageTop;return new mb(Math.round(i),Math.round(n),Math.round(this.pageRight-i),Math.round(this.pageBottom-n))}getQuad(e){return this.quadTable[e.id]}}let gT=(()=>{class e extends bg{}return function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);r>3&&o&&Object.defineProperty(t,i,o)}([ig(!1)],e.prototype,"preventDefaults",void 0),e})();var mT=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};let fT=(()=>{class e extends bg{}return mT([ig("")],e.prototype,"action",void 0),mT([ig("")],e.prototype,"cursor",void 0),e})(),yT=(()=>{class e extends bg{}return function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);r>3&&o&&Object.defineProperty(t,i,o)}([ig(!0)],e.prototype,"inversedAlignment",void 0),e})();var bT=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},vT=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function o(e){try{l(n.next(e))}catch(t){r(t)}}function a(e){try{l(n.throw(e))}catch(t){r(t)}}function l(e){e.done?s(e.value):new i(function(t){t(e.value)}).then(o,a)}l((n=n.apply(e,t||[])).next())})};let wT=(()=>{class e extends Cg{constructor(e,t){let i,n;super(e,t),this.version=17.1,this.checkMenu=!1,this.isServerUpdate=!1,this.oldNodeObjects=[],this.oldDiagramObject={},this.oldConnectorObjects=[],this.canEnableBlazorObject=!1,this.connectorTable={},this.groupTable={},this.scrollActions=tv.None,this.blazorActions=_b.Default,this.activeLabel={id:"",parentId:"",isGroup:!1,text:void 0},this.textEditing=!1,this.isTriggerEvent=!1,this.preventNodesUpdate=!1,this.preventConnectorsUpdate=!1,this.callBlazorModel=!0,this.selectionConnectorsList=[],this.deleteVirtualObject=!1,this.canLayout=!0,this.swimlaneChildTable={},this.swimlaneZIndexTable={},this.changedConnectorCollection=[],this.changedNodesCollection=[],this.previousNodeCollection=[],this.previousConnectorCollection=[],this.crudDeleteNodes=[],this.blazorAddorRemoveCollection=[],this.blazorRemoveIndexCollection=[],this.diagramid=88123,this.selectedObject={helperObject:void 0,actualObject:void 0},this.renderTimer=null,this.ignoreCollectionWatch=!0;for(let s=0;e&&e.nodes&&s<e.nodes.length;s++)i=e.nodes[s],n=this.nodes[s],i.children&&i.children.length>0&&(i.style&&i.style.fill||(n.style.fill="transparent"),i.style&&i.style.strokeColor||(n.style.strokeColor="transparent")),i.shape&&"UmlActivity"===i.shape.type&&LS(i,n),i.shape&&"SwimLane"===i.shape.type&&MS(i,n),this.nodeDefaults&&_S(n,i,this.nodeDefaults),this.updateAnnotationText(n.annotations);if(e&&e.connectors)for(let s=0;e&&e.connectors&&s<e.connectors.length;s++)i=e.connectors[s],n=this.connectors[s],this.connectorDefaults&&_S(n,i,this.connectorDefaults),this.updateAnnotationText(n.annotations);for(let s=0;e&&e.connectors&&s<e.connectors.length;s++){const t=e.connectors[s],i=this.connectors[s];t.shape&&"None"!==t.shape.type&&kS(t,i)}}updateAnnotationText(e){}callFromServer(e){if("getParentID"===e.methodName)return this.nameTable[e.id].parentId;if("getEdges"===e.methodName){const t=e.id;return e.outEdge?this.nameTable[t].outEdges:this.nameTable[t].inEdges}if("updateDiagramObjects"===e.methodName){const t="IsAdding",i=e.obj;this.isServerUpdate=!0,e[t]?this.add.apply(this,i):this.remove.apply(this,i),this.isServerUpdate=!1}else"invokeLoadDiagramMethod"===e.methodName&&this.loadDiagram(e.data)}clearCollection(e){const t=[];let i;for(const n of Object.keys(this.nameTable))i=this.nameTable[n],i&&(e&&i instanceof Vw||!e&&i instanceof pP)&&t.push(i);this.clearObjects(t)}onPropertyChanged(t,i){let n=!0,s=!1,r=!1;if(this.diagramActions&Jb.Render){for(const a of Object.keys(t))switch(a){case"width":case"height":this.element.style.width=this.getSizeValue(this.width),this.element.style.height=this.getSizeValue(this.height),this.eventHandler.updateViewPortSize(this.element);for(const t of this.views){const i=this.views[t];i instanceof e||i.updateView(i)}break;case"nodes":if(t.nodes.length>0&&0===i.nodes.length)this.clearCollection(),r=!0;else{for(const e of Object.keys(t.nodes)){const r=Number(e),o=this.nodes[r],a=t.nodes[r];t.nodes[r].style&&t.nodes[r].style.gradient&&(this.updateGradient(t.nodes[r],i.nodes[r],this.nodes[r]),this.nodes[r].oldGradientValue=QP(t.nodes[r].style.gradient)),s=s||void 0!==a.excludeFromLayout,this.nodePropertyChange(o,i.nodes[r],a,void 0,!0,!0);this.triggerEvent(nv.propertyChange,{element:o,cause:this.diagramActions,oldValue:i.nodes[r],newValue:t.nodes[r]}),n&&(n=!1)}"Canvas"===this.mode&&this.refreshDiagramLayer()}break;case"connectors":if(t.connectors.length>0&&0===i.connectors.length)this.clearCollection(!0),r=!0;else{for(const e of Object.keys(t.connectors)){const s=Number(e),r=this.connectors[s],o=t.connectors[s];o&&(o.sourceDecorator||o.targetDecorator)&&(this.diagramActions|=Jb.DecoratorPropertyChange),this.connectorPropertyChange(r,i.connectors[s],o,!0,!0),o&&(o.sourceDecorator||o.targetDecorator)&&(this.diagramActions=this.diagramActions&~Jb.DecoratorPropertyChange);this.triggerEvent(nv.propertyChange,{element:r,cause:this.diagramActions,oldValue:i.connectors[s],newValue:t.connectors[s]}),r&&r.parentId&&"UmlClassifier"===this.nameTable[r.parentId].shape.type&&this.updateConnectorEdges(this.nameTable[r.parentId]||r),n&&(n=!1)}this.updateBridging(),"Canvas"===this.mode&&this.refreshDiagramLayer()}break;case"bridgeDirection":this.updateBridging(),"Canvas"===this.mode&&this.refreshDiagramLayer();break;case"backgroundColor":this.intOffPageBackground();break;case"pageSettings":this.validatePageSize(),this.updatePage();break;case"selectedItems":if(t.selectedItems.userHandles&&this.selectedItems.wrapper&&this.selectedItems.userHandles&&this.selectedItems.userHandles.length>0){this.renderSelector(!0);break}if(t.selectedItems.constraints){this.renderSelector(!0);break}break;case"snapSettings":this.updateSnapSettings(t);break;case"commandManager":this.initCommands();break;case"layout":s=!0;break;case"dataSourceSettings":this.clear(),this.initObjects(),"None"===this.layout.type?r=!0:s=!0;break;case"tooltip":cw(this);break;case"rulerSettings":this.updateRulerSettings(t);break;case"layers":this.updateLayer(t);break;case"scrollSettings":this.scrollActions|=tv.PropertyChange,this.updateScrollSettings(t),this.scrollActions&=~tv.PropertyChange;break;case"locale":t.locale!==i.locale&&(this.realActions|=ev.PreventDataInit,super.refresh(),this.realActions&=~ev.PreventDataInit);break;case"contextMenuSettings":if(void 0!==t.contextMenuSettings.showCustomMenuOnly&&(this.contextMenuSettings.showCustomMenuOnly=t.contextMenuSettings.showCustomMenuOnly),void 0!==t.contextMenuSettings.show&&(this.contextMenuSettings.show=t.contextMenuSettings.show),t.contextMenuSettings.items){const e=t.contextMenuSettings.items;for(const t of Object.keys(e)){const i=Number(t);this.contextMenuSettings.items[i]=e[i]}this.contextMenuModule&&this.contextMenuModule.refreshItems()}break;case"serializationSettings":void 0!==t.serializationSettings.preventDefaults&&(this.serializationSettings.preventDefaults=t.serializationSettings.preventDefaults)}if(s&&!r){if(i.layout&&"DifferentPoint"===i.layout.connectionPointOrigin&&"SamePoint"===t.layout.connectionPointOrigin||i.layout&&t.layout&&!t.layout.enableRouting&&i.layout.enableRouting){for(let e=0;e<this.nodes.length;e++){const t=this.nodes[e];if(t.ports&&t.ports.length>0){const e=[];for(let i=t.ports.length-1;i>=0;i--)"LineDistribution"===t.ports[i].id.split("_")[1]&&e.push(t.ports[i]);this.removePorts(t,e)}}for(let e=0;e<this.connectors.length;e++){const t=this.connectors[e],i=t.sourcePortID,n=t.targetPortID;t.sourcePortID="",t.targetPortID="",t.sourcePortWrapper=void 0,t.targetPortWrapper=void 0,t.segments=[],this.connectorPropertyChange(t,{sourcePortID:i,targetPortID:n},{sourcePortID:"",targetPortID:""})}}this.doLayout(),this.renderReactTemplates()}if(n&&this.propertyChange){this.triggerEvent(nv.propertyChange,{element:this,cause:this.diagramActions,oldValue:i,newValue:t})}if(!r&&this.canLogChange()&&this.modelChanged(t,i)){const e={type:"PropertyChanged",undoObject:i,redoObject:t,category:"Internal"};this.historyManager&&this.addHistoryEntry(e)}this.resetDiagramActions(),r&&(this.initObjects(!0),this.refreshDiagramLayer(),s&&this.doLayout());const o=1===Object.keys(t).length&&void 0!==t.scrollSettings;if(!r)for(const n of this.views){const s=this.views[n];s instanceof e||(t.scrollSettings&&t.scrollSettings.currentZoom!==i.scrollSettings.currentZoom&&s.updateHtmlLayer(s),o||this.refreshCanvasDiagramLayer(s))}}}updateSnapSettings(e){(void 0!==e.snapSettings.constraints||e.snapSettings.horizontalGridlines||e.snapSettings.verticalGridlines||e.snapSettings.gridType)&&this.diagramRenderer.updateGrid(this.snapSettings,MP(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler)}updateGradient(e,t,i){if(i.oldGradientValue){let n=i,s=i,r=t.style.gradient,o=t.style.gradient;for(const a of Object.keys(e.style.gradient))switch(a){case"type":n.type&&(r.type=n.type);break;case"x1":n.x1&&(r.x1=n.x1);break;case"x2":n.x2&&(r.x2=n.x2);break;case"y1":n.y1&&(r.y1=n.y1);break;case"y2":n.y2&&(r.y2=n.y2);break;case"cx":s.cx&&(o.cx=s.cx);break;case"cy":s.cy&&(o.cy=s.cy);break;case"fx":s.fx&&(o.fx=s.fx);break;case"fy":s.fy&&(o.fy=s.fy);break;case"r":s.r&&(o.r=s.r);break;case"stops":if(i.oldGradientValue.stops){let e=Object.values(QP(i.oldGradientValue.stops));e.pop(),t.style.gradient.stops=e}}}}updateRulerSettings(e){void 0!==e.rulerSettings.dynamicGrid&&this.diagramRenderer.updateGrid(this.snapSettings,MP(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),void 0!==e.rulerSettings.showRulers?(this.intOffPageBackground(),this.scroller.setSize(),this.renderRulers()):void 0===e.rulerSettings.horizontalRuler&&void 0===e.rulerSettings.verticalRuler||(void 0!==e.rulerSettings.horizontalRuler.thickness||void 0!==e.rulerSettings.verticalRuler.thickness?(Zw(this),this.intOffPageBackground(),this.scroller.setSize(),this.renderRulers()):qw(this)),this.diagramRenderer.updateGrid(this.snapSettings,MP(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler)}getPersistData(){return this.addOnPersist(["loaded"])}preRender(){this.initializePrivateVariables(),this.isProtectedOnChange=!0,this.serviceLocator=new bO,this.initializeServices(),this.setCulture(),window.measureElement&&(window.measureElement=null),this.initDiagram(),this.initViews(),this.unWireEvents(),this.wireEvents(),this.element.classList.add("e-diagram")}initializePrivateVariables(){if(""===this.element.id){const e=document.getElementsByClassName("e-diagram").length;this.element.id="diagram_"+this.diagramid+"_"+e}this.defaultLocale={Copy:"Copy",Cut:"Cut",Paste:"Paste",Undo:"Undo",Redo:"Redo",SelectAll:"Select All",Grouping:"Grouping",Group:"Group",UnGroup:"Un Group",Order:"Order",BringToFront:"Bring To Front",MoveForward:"Move Forward",SendToBack:"Send To Back",SendBackward:"Send Backward"},this.layerZIndex=-1,this.layerZIndexTable={},this.nameTable={},this.pathTable={},this.groupTable={},this.commands={},this.isLoading||(this.views=[]),this.commandHandler=new cT(this),this.eventHandler=new rT(this,this.commandHandler),this.spatialSearch=new uT(this.nameTable),this.scroller=new dT(this)}initializeServices(){this.serviceLocator.register("localization",this.localeObj=new Rg(this.getModuleName(),this.defaultLocale,this.locale))}setCulture(){this.localeObj=new Rg(this.getModuleName(),this.defaultLocale,this.locale)}render(){this.refreshing&&this.dataSourceSettings.dataSource&&!this.isLoading&&(this.nodes=[],this.connectors=[]),this.ignoreCollectionWatch=!0,window.domTable={};const e=[];this.dataSourceSettings.crudAction.read&&this.renderInitialCrud(),this.initHistory(),this.diagramRenderer=new pO(this.element.id,new dO,"SVG"===this.mode),this.initLayers(),this.initializeDiagramLayers(),this.diagramRenderer.setLayers(),this.initObjects(!0);const t=this.nodes;for(let n=0;n<t.length;n++)t[n].isExpanded||e.push(t[n]);if(e.length)for(let n=e.length-1;n>=0;n--)this.commandHandler.expandNode(e[n],this,0!==n);this.canLayout&&this.doLayout(),this.lineRoutingModule&&this.lineRoutingModule.lineRouting(this),this.validatePageSize(),this.renderPageBreaks(),this.diagramRenderer.renderSvgGridlines(this.snapSettings,MP(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),this.commandHandler.initSelectorWrapper(),this.notify("initial-load",{}),this.trigger("load"),this.scroller.setSize(),this.scroller.updateScrollOffsets(),this.refreshDiagramLayer(),(this.scrollSettings.verticalOffset>0||this.scrollSettings.horizontalOffset>0)&&this.updateScrollOffset(),wu.isDevice&&(this.tool=qb.ZoomPan|qb.SingleSelect),this.notify("initial-end",{}),this.isProtectedOnChange=!1,this.tooltipObject=cw(this),this.diagramActions=Jb.Render,this.initCommands();const i=document.getElementsByClassName(this.element.id+"_hiddenUserHandleTemplate");!function(e,t,i,n){let s,r,o,a,l,h=document.getElementById(n).ej2_instances[0];if(e&&t)for(r of(s=qP(e),i.userHandles))if(s){for(o=s(QP(r),h,"userHandleTemplate_"+r.name,void 0,void 0,!1),a=0;a<o.length;a++)l=kP("div",{style:"height: 100%; width: 100%; pointer-events: all",id:r.name+"_template_hiddenUserHandle"}),l.appendChild(o[a]);t[0].appendChild(l)}}(this.userHandleTemplate,i,this.selectedItems,this.element.id),this.isLoading=!1,this.renderComplete(),this.updateFitToPage(),this.refreshing&&this.renderReactTemplates()}updateFitToPage(){this.pageSettings&&this.pageSettings.fitOptions&&this.pageSettings.fitOptions.canFit&&this.fitToPage(this.pageSettings.fitOptions)}updateTemplate(){let e,t,i;for(let n=0;n<this.nodes.length&&(e=this.nodes[n],"HTML"!==e.shape.type&&"Native"!==e.shape.type);n++);for(let n=0;n<this.nodes.length&&(e=this.nodes[n],t=e.annotations[0],!t||"Template"!==t.annotationType);n++);for(let n=0;n<this.connectors.length&&(i=this.connectors[n].annotations[0],!i||"Template"!==i.annotationType);n++);for(let n=0;n<this.selectedItems.userHandles.length&&!this.selectedItems.userHandles[n].template;n++);}resetTemplate(){let e,t,i;for(let n=0;n<this.nodes.length;n++)if(e=this.nodes[n],"HTML"===e.shape.type&&""===e.shape.content){lm("diagramsf_node_template");break}for(let n=0;n<this.nodes.length;n++)if(e=this.nodes[n],t=e.annotations[0],t&&"Template"===t.annotationType&&t.content instanceof HTMLElement){lm("diagramsf_annotation_template");break}for(let n=0;n<this.connectors.length;n++)if(i=this.connectors[n].annotations[0],i&&"Template"===i.annotationType&&i.content instanceof HTMLElement){lm("diagramsf_annotation_template");break}for(let n=0;n<this.selectedItems.userHandles.length&&!this.selectedItems.userHandles[n].template;n++);}renderInitialCrud(){const e=this;if(e.dataSourceSettings.crudAction.read){const t=new cu(e.dataSourceSettings.crudAction.read,"GET",!1);t.onSuccess=t=>{e.dataSourceSettings.dataManager?e.dataSourceSettings.dataManager=JSON.parse(t):e.dataSourceSettings.dataSource=JSON.parse(t),e.dataBind()},t.send().then()}if(e.dataSourceSettings.connectionDataSource.crudAction.read){const t=new cu(e.dataSourceSettings.connectionDataSource.crudAction.read,"GET",!1);t.onSuccess=t=>{e.dataSourceSettings.connectionDataSource.dataManager=JSON.parse(t),e.dataBind()},t.send().then()}}getModuleName(){return"diagram"}getClassName(){return"Diagram"}requiredModules(){const e=[];return e.push({member:"Bpmn",args:[]}),e.push({member:"Bridging",args:[]}),e.push({member:"ConnectorEditingTool",args:[]}),this.constraints&Gb.UndoRedo&&e.push({member:"UndoRedo",args:[]}),("OrganizationalChart"===this.layout.type||"HierarchicalTree"===this.layout.type||this.layout.enableAnimation)&&e.push({member:"LayoutAnimate",args:[]}),this.snapSettings.constraints&&e.push({member:"Snapping",args:[this]}),e.push({member:"PrintandExport",args:[this]}),this.contextMenuSettings.show&&e.push({member:"contextMenu",args:[this,this.serviceLocator]}),"OrganizationalChart"!==this.layout.type&&"HierarchicalTree"!==this.layout.type||e.push({member:"OrganizationalChart",args:[this]}),"ComplexHierarchicalTree"===this.layout.type&&e.push({member:"ComplexHierarchicalTree",args:[]}),"MindMap"===this.layout.type&&e.push({member:"MindMapChart",args:[]}),"RadialTree"===this.layout.type&&e.push({member:"RadialTree",args:[]}),"SymmetricalLayout"===this.layout.type&&e.push({member:"SymmetricalLayout",args:[]}),(this.dataSourceSettings.dataManager||this.dataSourceSettings.dataSource||this.dataSourceSettings.crudAction.read||this.dataSourceSettings.connectionDataSource.crudAction.read)&&e.push({member:"DataBinding",args:[]}),this.constraints&Gb.LineRouting&&e.push({member:"LineRouting",args:[]}),(this.layout&&"DifferentPoint"===this.layout.connectionPointOrigin||"Linear"===this.layout.arrangement||this.layout.enableRouting)&&e.push({member:"LineDistribution",args:[]}),e}removeUserHandlesTemplate(){if(this.selectedItems.userHandles.length)for(let e=0;e<this.selectedItems.userHandles.length;e++)for(const t of this.views)NP(this.selectedItems.userHandles[e].name+"_template_hiddenUserHandle",t)}destroy(){if(clearInterval(this.renderTimer),this.renderTimer=null,this.hRuler&&this.vRuler&&(this.hRuler.destroy(),this.vRuler.destroy()),this.tooltipObject.destroy(),this.droppable.destroy(),this.unWireEvents(),this.notify("destroy",{}),super.destroy(),this.removeUserHandlesTemplate(),this.clearTemplate(),document.getElementById(this.element.id)){this.element.classList.remove("e-diagram");const e=document.getElementsByClassName("e-diagram-tooltip");for(;e.length>0;)e[0].parentNode.removeChild(e[0]);const t=document.getElementById(this.element.id+"content");t&&this.element.removeChild(t);const i="measureElement";if(window[i]){window[i].usageCount-=1;const e="measureElementCount";window[e]--,0===window[e]&&(window[i].parentNode.removeChild(window[i]),window[i]=null)}}window.domTable={};for(let e=0;e<this.layers.length;e++)this.layers[e].zIndexTable={};this.diagramActions=void 0}wireEvents(){const e=wu.touchEndEvent,t=wu.touchMoveEvent,i=wu.isPointer?"pointerleave":"mouseleave",n="mozilla"===wu.info.name?wu.isPointer?"mousewheel":"DOMMouseScroll":"mousewheel";xu.add(this.diagramCanvas,wu.touchStartEvent,this.eventHandler.mouseDown,this.eventHandler),xu.add(this.diagramCanvas,t,this.eventHandler.mouseMove,this.eventHandler),xu.add(this.diagramCanvas,e,this.eventHandler.mouseUp,this.eventHandler),xu.add(this.diagramCanvas,i,this.eventHandler.mouseLeave,this.eventHandler),xu.add(this.diagramCanvas,"keydown",this.eventHandler.keyDown,this.eventHandler),xu.add(this.diagramCanvas,"keyup",this.eventHandler.keyUp,this.eventHandler),xu.add(this.diagramCanvas,"dblclick",this.eventHandler.doubleClick,this.eventHandler),xu.add(this.diagramCanvas,"scroll",this.eventHandler.scrolled,this.eventHandler),xu.add(this.diagramCanvas,n,this.eventHandler.mouseWheel,this.eventHandler),xu.add(window,"resize",this.eventHandler.windowResize,this.eventHandler),this.initDroppables()}unWireEvents(){const e=wu.touchMoveEvent,t=wu.isPointer?"pointerleave":"mouseleave",i="mozilla"===wu.info.name?wu.isPointer?"mousewheel":"DOMMouseScroll":"mousewheel",n=wu.touchEndEvent;xu.remove(this.diagramCanvas,wu.touchStartEvent,this.eventHandler.mouseDown),xu.remove(this.diagramCanvas,e,this.eventHandler.mouseMove),xu.remove(this.diagramCanvas,n,this.eventHandler.mouseUp),xu.remove(this.diagramCanvas,t,this.eventHandler.mouseLeave),xu.remove(this.diagramCanvas,"keydown",this.eventHandler.keyDown),xu.remove(this.diagramCanvas,"keyup",this.eventHandler.keyUp),xu.remove(this.diagramCanvas,"dblclick",this.eventHandler.doubleClick),xu.remove(this.diagramCanvas,"scroll",this.eventHandler.scrolled),xu.remove(this.diagramCanvas,i,this.eventHandler.mouseWheel),xu.remove(window,"resize",this.eventHandler.windowResize)}select(e,t){null!=e&&this.commandHandler.selectObjects(e,t)}selectAll(){let e=[];e=this.getObjectsOfLayer(this.activeLayer.objects),this.select(e)}unSelect(e){e&&jO(this,e)&&(this.commandHandler.unSelect(e),this.commandHandler.updateBlazorSelector())}clearSelection(){this.commandHandler.clearSelection(!0)}updateViewPort(){const e=this.getZoomingAttribute();this.updateBlazorDiagramProperties(e),this.eventHandler.updateViewPortSize(this.element),this.updateBlazorDiagramProperties(e,!0)}cutCommand(){this.cut()}cut(){this.commandHandler.cut()}addProcess(e,t){this.bpmnModule&&this.bpmnModule.addProcess(e,t,this)}removeProcess(e){this.bpmnModule&&this.bpmnModule.removeProcess(e,this)}pasteCommand(){this.paste()}paste(e){this.commandHandler.paste(e)}fitToPage(e){const t=this.getZoomingAttribute();this.updateBlazorDiagramProperties(t),this.scroller.fitToPage(e),this.updateBlazorDiagramProperties(t,!0)}bringIntoView(e){const t=this.getZoomingAttribute();this.updateBlazorDiagramProperties(t),this.scroller.bringIntoView(e),this.updateBlazorDiagramProperties(t,!0)}bringToCenter(e){const t=this.getZoomingAttribute();this.updateBlazorDiagramProperties(t),this.scroller.bringToCenter(e),this.updateBlazorDiagramProperties(t,!0)}copyCommand(){this.copy()}copy(){return this.commandHandler.copy()}group(){let e=[];e=this.selectedItems.nodes,e=e.concat(this.selectedItems.connectors),e.length>1&&(this.callBlazorModel=!1,this.insertBlazorDiagramObjects(this.selectedItems),this.commandHandler.group(),this.callBlazorModel=!0,this.commandHandler.getBlazorOldValues())}unGroup(){this.callBlazorModel=!1,this.insertBlazorDiagramObjects(this.selectedItems),this.commandHandler.unGroup(),this.callBlazorModel=!0,this.commandHandler.getBlazorOldValues()}sendToBack(){this.commandHandler.sendToBack()}setActiveLayer(e){const t=this.commandHandler.getLayer(e);this.activeLayer=t}addLayer(e,t){this.commandHandler.addLayer(e,t)}addDiagramLayer(e,t){this.commandHandler.addLayer(e,t,!1)}removeLayer(e){this.commandHandler.removeLayer(e,!1)}removeDiagramLayer(e){this.commandHandler.removeLayer(e,!1)}moveObjects(e,t){const i=QP(this.layers);this.enableServerDataBinding(!1),this.commandHandler.moveObjects(e,t);const n=this.commandHandler.deepDiffer.map(i,QP(this.layers)),s=this.commandHandler.deepDiffer.frameObject({},n);this.oldDiagramObject={layers:s},this.commandHandler.updateBlazorProperties()}layerObjectUpdate(){}sendLayerBackward(e){this.layerObjectUpdate(),this.commandHandler.sendLayerBackward(e),this.commandHandler.updateLayerObject(this.oldDiagramObject,!0)}bringLayerForward(e){this.layerObjectUpdate(),this.commandHandler.bringLayerForward(e),this.commandHandler.updateLayerObject(this.oldDiagramObject)}cloneLayer(e){this.commandHandler.cloneLayer(e)}bringToFront(){this.commandHandler.bringToFront()}moveForward(){this.commandHandler.sendForward()}sendBackward(){this.commandHandler.sendBackward()}getObject(e){return this.nameTable[e]}getNodeObject(e){return QP(this.nameTable[e])}getConnectorObject(e){return QP(this.nameTable[e])}getActiveLayer(){return this.activeLayer}nudgeCommand(e,t,i){"object"!=typeof e&&(this.selectedItems.nodes.length||this.selectedItems.connectors.length)>0&&this.nudge(e)}nudge(e,t,i){let n,s=0,r=0;"Left"===e||"Right"===e?(n="Left"===e,s=(n?-1:1)*(t||1)):(n="Up"===e,r=(n?-1:1)*(i||1));const o=this.selectedItems,a=this.selectedItems.wrapper.children[0];if(a instanceof av)this.commandHandler.labelDrag(o.nodes[0],a,s,r);else{const e=QP(this.selectedItems);this.protectPropertyChange(!0),this.drag(o,s,r),this.protectPropertyChange(!1);const t={type:"PositionChanged",redoObject:QP(this.selectedItems),undoObject:e,category:"Internal"};this.addHistoryEntry(t)}this.refreshCanvasLayers()}insertBlazorDiagramObjects(e){}drag(e,t,i){if(this.insertBlazorDiagramObjects(e),!(this.bpmnModule&&e instanceof pP&&this.bpmnModule.updateAnnotationDrag(e,this,t,i))){if(e instanceof bP){if(this.preventConnectorsUpdate=!0,e.nodes&&e.nodes.length){for(const n of e.nodes)if(this.callBlazorModel=!1,this.drag(n,t,i),n.parentId){const e=this.nameTable[n.parentId];e.isLane&&$x(e,this.nameTable[e.parentId],n,this)}this.callBlazorModel=!0}if(e.connectors&&e.connectors.length){this.callBlazorModel=!1;for(const n of e.connectors)this.drag(n,t,i),-1===this.selectionConnectorsList.indexOf(n)&&this.selectionConnectorsList.push(n);this.callBlazorModel=!0}this.updateSelector(),this.diagramActions&Jb.DragUsingMouse&&this.updatePage()}else e instanceof pP&&this.bpmnModule&&this.bpmnModule.updateAnnotationDrag(e,this,t,i),this.commandHandler.drag(e,t,i);if(e instanceof bP){this.preventConnectorsUpdate=!1;for(const e of this.selectionConnectorsList)this.updateConnectorProperties(this.nameTable[e.id]),"Bpmn"===e.shape.type&&"Default"===e.shape.sequence&&this.commandHandler.updatePathElementOffset(e);this.selectionConnectorsList=[]}this.diagramActions&Jb.ToolAction||this.diagramActions&Jb.DragUsingMouse||this.updateSelector(),!this.callBlazorModel||this.blazorActions&_b.interaction||this.blazorActions&_b.GroupClipboardInProcess||this.commandHandler.getBlazorOldValues()}}disableStackContainerPadding(e,t){if(e instanceof RC&&(e.considerPadding=t),e.children)for(const i of e.children)this.disableStackContainerPadding(i,!1)}scale(e,t,i,n){this.disableStackContainerPadding(e.wrapper,!1),this.insertBlazorDiagramObjects(e);let s=!0;if(e.id&&(e=this.nameTable[e.id]||e),e instanceof bP){if(e.nodes&&e.nodes.length){this.callBlazorModel=!1;for(const r of e.nodes)s=this.commandHandler.scale(r,t,i,n,e),this.commandHandler.checkBoundaryConstraints(void 0,void 0,e.wrapper.bounds)||this.commandHandler.scale(r,1/t,1/i,n,e);this.callBlazorModel=!0}if(e.connectors&&e.connectors.length){this.callBlazorModel=!1;for(const s of e.connectors)this.commandHandler.scale(s,t,i,n,e),this.commandHandler.checkBoundaryConstraints(void 0,void 0,e.wrapper.bounds)||this.commandHandler.scale(s,1/t,1/i,n,e);this.callBlazorModel=!0}IC(this,this.selectedItems)||this.updateSelector(),this.refreshCanvasLayers()}else this.commandHandler.scale(e,t,i,n,e.children?e:void 0);return!this.callBlazorModel||this.blazorActions&_b.interaction||this.blazorActions&_b.GroupClipboardInProcess||this.commandHandler.getBlazorOldValues(),this.disableStackContainerPadding(e.wrapper,!0),s}rotate(e,t,i){let n;if(this.insertBlazorDiagramObjects(e),e.id&&(e=this.nameTable[e.id]||e),e)if(i=i||{x:e.wrapper.offsetX,y:e.wrapper.offsetY},e instanceof bP){this.callBlazorModel=!1,e.rotateAngle+=t,e.wrapper.rotateAngle+=t;const s=$P(e.wrapper);if(n=this.commandHandler.checkBoundaryConstraints(void 0,void 0,s),!n)return e.rotateAngle-=t,e.wrapper.rotateAngle-=t,n;let r=[];r=r.concat(e.nodes),r=r.concat(e.connectors),this.commandHandler.rotateObjects(e,r,t,i),this.callBlazorModel=!0}else this.commandHandler.rotateObjects(e,[e],t,i);return!this.callBlazorModel||this.blazorActions&_b.interaction||this.commandHandler.getBlazorOldValues(),n}dragSourceEnd(e,t,i){this.insertBlazorDiagramObjects(e),this.commandHandler.dragSourceEnd(e,t,i),this.callBlazorModel&&this.commandHandler.getBlazorOldValues()}dragTargetEnd(e,t,i){this.insertBlazorDiagramObjects(e),this.commandHandler.dragTargetEnd(e,t,i),this.callBlazorModel&&this.commandHandler.getBlazorOldValues()}findObjectsUnderMouse(e,t){return this.eventHandler.findObjectsUnderMouse(e,t)}findObjectUnderMouse(e,t,i){return this.eventHandler.findObjectUnderMouse(e,t,i)}findTargetObjectUnderMouse(e,t,i,n,s){return this.eventHandler.findTargetUnderMouse(e,t,i,n,s)}findElementUnderMouse(e,t,i){return this.eventHandler.findElementUnderMouse(e,t,i)}findActionToBeDone(e,t,i,n){return this.eventHandler.findActionToBeDone(e,t,i,n)}getTool(e){let t;const i=hO(this.getCustomTool);return i&&(t=i(e),t)?t:this.eventHandler.getTool(e)}getCursor(e,t){let i;const n=hO(this.getCustomCursor);if(n&&(i=n(e,t),i))return i;if(this.customCursor.length)for(let s=0;s<this.customCursor.length;s++)if(this.customCursor[s].action===e)return this.customCursor[s].cursor;return this.eventHandler.getCursor(e)}initHistory(){this.undoRedoModule&&this.undoRedoModule.initHistory(this)}addHistoryEntry(e){if(this.undoRedoModule&&this.constraints&Gb.UndoRedo&&(!this.currentSymbol||this.checkCurrentSymbol(this.currentSymbol,e))){if(e.undoObject&&"helper"===e.undoObject.id)return;this.undoRedoModule.addHistoryEntry(e,this),"StartGroup"!==e.type&&"EndGroup"!==e.type&&this.historyChangeTrigger(e,"CustomAction")}}checkCurrentSymbol(e,t){if(t.undoObject&&t.redoObject){const i=t.undoObject,n=t.undoObject;return!(!n.id||!i.id||n.id===e.id||i.id===e.id)||!1}return!1}addCustomHistoryEntry(e){}historyChangeTrigger(e,t){const i={};let n=[];if("Internal"===e.category){switch(e&&e.redoObject&&e.redoObject.nodes instanceof Array&&e.redoObject.connectors instanceof Array?n=e.redoObject.nodes.concat(e.redoObject.connectors):e.redoObject&&n.push(e.redoObject),i.type=e.type,e.type){case"PositionChanged":i.oldValue={offsetX:e.undoObject.offsetX,offsetY:e.undoObject.offsetY},i.newValue={offsetX:e.redoObject.offsetX,offsetY:e.redoObject.offsetY};break;case"RotationChanged":i.oldValue={rotateAngle:e.undoObject.rotateAngle},i.newValue={rotateAngle:e.redoObject.rotateAngle};break;case"SizeChanged":i.oldValue={offsetX:e.undoObject.offsetX,offsetY:e.undoObject.offsetY,width:e.undoObject.width,height:e.undoObject.height},i.newValue={offsetX:e.redoObject.offsetX,offsetY:e.redoObject.offsetY,width:e.redoObject.width,height:e.redoObject.height};break;case"CollectionChanged":i[e.changeType]=n;break;case"ConnectionChanged":i.oldValue={offsetX:e.undoObject.offsetX,offsetY:e.undoObject.offsetY},i.newValue={offsetX:e.redoObject.offsetX,offsetY:e.redoObject.offsetY}}let s;s={cause:e.category,source:n,change:i,action:t},n.length&&this.triggerEvent(nv.historyChange,s)}}startGroupAction(){this.diagramActions&Jb.UndoRedo||this.addHistoryEntry({type:"StartGroup",category:"Internal"})}endGroupAction(){this.diagramActions&Jb.UndoRedo||this.addHistoryEntry({type:"EndGroup",category:"Internal"})}undo(){this.canEnableBlazorObject=!0,this.callBlazorModel=!1,this.undoRedoModule&&this.constraints&Gb.UndoRedo&&this.undoRedoModule.undo(this),this.commandHandler.getBlazorOldValues(),this.callBlazorModel=!0,this.canEnableBlazorObject=!1}redo(){this.canEnableBlazorObject=!0,this.callBlazorModel=!1,this.undoRedoModule&&this.constraints&Gb.UndoRedo&&this.undoRedoModule.redo(this),this.commandHandler.getBlazorOldValues(),this.callBlazorModel=!0,this.canEnableBlazorObject=!1}getBlazorDiagramObjects(e){if(e)for(let t=0;t<e.length;t++)this.insertBlazorDiagramObjects(e[t]);else this.insertBlazorDiagramObjects(this.selectedItems);this.callBlazorModel=!1,this.canEnableBlazorObject=!0}align(e,t,i){this.getBlazorDiagramObjects(t),t||(t=(t=[]).concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|Jb.PublicMethod,this.commandHandler.align(t,e,i||"Object"),this.commandHandler.getBlazorOldValues(),this.callBlazorModel=!0,this.canEnableBlazorObject=!1}distribute(e,t){this.getBlazorDiagramObjects(t),t||(t=(t=[]).concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|Jb.PublicMethod,this.commandHandler.distribute(t,e),this.commandHandler.getBlazorOldValues(),this.canEnableBlazorObject=!1,this.callBlazorModel=!0}sameSize(e,t){this.getBlazorDiagramObjects(t),t||(t=(t=[]).concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|Jb.PublicMethod,this.commandHandler.sameSize(t,e),this.commandHandler.getBlazorOldValues(),this.canEnableBlazorObject=!1,this.callBlazorModel=!0}updateBlazorDiagramProperties(e,t){t&&this.commandHandler.getDiagramOldValues(this.oldDiagramObject,e)}getZoomingAttribute(){const e=[];return e.push("scrollSettings"),e.push("snapSettings"),e}zoom(e,t){const i=this.getZoomingAttribute();this.updateBlazorDiagramProperties(i),this.scroller.zoom(e,0,0,t),this.blazorActions&_b.interaction||this.updateBlazorDiagramProperties(i,!0)}zoomTo(e){const t=this.getZoomingAttribute();this.updateBlazorDiagramProperties(t);let i=e.zoomFactor?e.zoomFactor:.2;i="ZoomOut"===e.type?1/(1+i):1+i,this.scroller.zoom(i,0,0,e.focusPoint),this.updateBlazorDiagramProperties(t,!0)}pan(e,t,i){const n=this.getZoomingAttribute();this.updateBlazorDiagramProperties(n),this.setCursor("grabbing"),this.scroller.zoom(1,e,t,i),this.updateBlazorDiagramProperties(n,!0)}reset(){const e=this.getZoomingAttribute();this.updateBlazorDiagramProperties(e),this.scroller.zoom(1/this.scroller.currentZoom,-this.scroller.horizontalOffset,-this.scroller.verticalOffset,{x:0,y:0}),this.updateBlazorDiagramProperties(e,!0)}resetSegments(){if(this.constraints&Gb.LineRouting&&this.lineRoutingModule)this.lineRoutingModule.lineRouting(this);else{let e;this.protectPropertyChange(!0);for(let t=0;t<this.connectors.length;t++)e=this.connectors[t],e.segments=[],this.connectorPropertyChange(e,{},{segments:e.segments});this.protectPropertyChange(!1)}}setBlazorDiagramProps(e){const t=this.getZoomingAttribute();e?this.updateBlazorDiagramProperties(t):this.updateBlazorDiagramProperties(t,!0)}triggerEvent(e,t){return vT(this,void 0,void 0,function*(){return t&&this.updateEventValue(t),yield this.trigger(nv[e],t)})}updateEventValue(e){const t=e.element;e.element&&t instanceof bP&&t.nodes.length+t.connectors.length===1&&(e.element=1===t.nodes.length?t.nodes[0]:t.connectors[0])}addNodeToLane(e,t,i){if(this.nameTable[t]){const n=this.nameTable[t];if(this.protectPropertyChange(!0),this.undoRedoModule&&this.historyManager.startGroupAction(),this.nameTable[e.id]||(e.offsetX=n.wrapper.bounds.width+n.wrapper.bounds.x,e.offsetY=n.wrapper.bounds.height+n.wrapper.bounds.y,e=this.add(e)),e.parentId="",n.shape.phases.length)for(let s=0;s<n.shape.phases.length;s++){const r=t+i+s;if(this.nameTable[r]&&this.nameTable[r].isLane){const s=this.nameTable[r].wrapper.bounds,o={x:s.x+(s.x-n.wrapper.bounds.x+e.margin.left+e.wrapper.bounds.width/2),y:s.y+n.wrapper.bounds.y-e.margin.top};if("Horizontal"===n.shape.orientation?o.y=s.y:(o.x=s.x,o.y=s.y+(n.wrapper.bounds.y-this.nameTable[this.nameTable[r].parentId+n.shape.lanes[0].id+"_0_header"].wrapper.bounds.height+e.margin.top+e.wrapper.bounds.height/2)),s.containsPoint(o)||r===t+i+(n.shape.phases.length-1)){qx(this,this.nameTable[r],e,void 0,!0),$x(this.nameTable[r],n,e,this);break}}}else{const s=t+i+"0";this.nameTable[s]&&(qx(this,this.nameTable[s],e,void 0,!0),$x(this.nameTable[s],n,e,this))}this.undoRedoModule&&this.historyManager.endGroupAction(),this.protectPropertyChange(!1)}this.updateDiagramElementQuad()}showTooltip(e){e&&e.id&&!e.wrapper&&(e=this.nameTable[e.id]);const t=$P(e.wrapper);let i={x:0,y:0};const n=e.tooltip.content?e.tooltip.content:"X:"+Math.round(t.x)+" Y:"+Math.round(t.y);e&&"Custom"===e.tooltip.openOn&&(i=e instanceof pP?{x:e.offsetX+e.width/2,y:e.offsetY+e.height/2}:{x:e.targetPoint.x,y:e.targetPoint.x},this.commandHandler.showTooltip(e,i,n,"SelectTool",!0))}hideTooltip(e){e&&"Custom"===e.tooltip.openOn&&this.tooltipObject.close()}addNode(e,t){return this.add(e,t)}addChildToGroup(e,t){const i=this.allowServerDataBinding;this.enableServerDataBinding(!1);const n=this.isProtectedOnChange;this.protectPropertyChange(!0),e=this.getObject(e.id);const s=!(this.diagramActions&Jb.UndoRedo||this.diagramActions&Jb.Group||this.diagramActions&Jb.PreventHistory);s&&this.startGroupAction();const r=this.addChild(e,t);if(s){const t={};t[r]=QP(this.getObject(r));const i={type:"AddChildToGroupNode",changeType:"Insert",undoObject:QP(e),redoObject:QP(e),category:"Internal",objectId:r,childTable:t};this.addHistoryEntry(i),this.endGroupAction()}this.protectPropertyChange(n),this.enableServerDataBinding(i),this.updateSelector()}getHistoryStack(e){let t=[];const i=e?this.historyManager.undoStack:this.historyManager.redoStack;if(void 0!==this.historyManager.stackLimit){for(let n=i.length-1;n>=0;n--)if(t.push(i[n]),t.length>this.historyManager.stackLimit)return t}else t=i;return t}getEdges(e){return e.outEdge?this.nameTable[e.id].outEdges:this.nameTable[e.id].inEdges}getParentId(e){return this.nameTable[e].parentId}addConnector(e){return this.add(e)}UpdateBlazorDiagramModelCollection(e,t,i,n){if(!(this.blazorActions&_b.ClearObject)){const s="sfBlazor",r="Blazor";if(window&&window[r]){let r;const o=[],a=[],l=[];let h=[];if(n&&!t)for(let e=0;e<this.blazorAddorRemoveCollection.length;e++)l.push(yC(this.blazorAddorRemoveCollection[e])===Vw?"Connector":"Node"),r=this.blazorAddorRemoveCollection[e],a.push(r),h=this.blazorRemoveIndexCollection;else if(!this.isServerUpdate||i){this.isServerUpdate=!0;let n=e;const s=[];let r,c=[];if(!t){c=i||this.commandHandler.getChildren(e,s);for(let e=0;e<c.length;e++)n=c[e],a.push(n),r=yC(c[e])===Vw?this.connectors.indexOf(c[e]):this.nodes.indexOf(c[e]),h.push(r),l.push(yC(c[e])===Vw?"Connector":"Node");i||(a.push(e),h.push(this.nodes.indexOf(e)),l.push(yC(e)===Vw?"Connector":"Node"))}if(t&&t.length>0)for(let e=0;e<t.length;e++)n=t[e],t[e]instanceof pP?a.push(n):o.push(n),l.push(yC(t[e])===Vw?"Connector":"Node");this.isServerUpdate=!1}const c={methodName:"UpdateBlazorDiagramObjects",diagramobj:{nodeObj:JSON.stringify(a),ObjectType:l,removalIndex:t?void 0:h,isMultipleObjects:!0,annotationIndex:void 0,connectorObj:JSON.stringify(o)}};window[s].updateBlazorProperties(c,this),n&&!t&&(this.blazorAddorRemoveCollection=[],this.blazorRemoveIndexCollection=[])}}}UpdateBlazorDiagramModel(e,t,i,n){if(!(this.blazorActions&_b.GroupClipboardInProcess)){const s="sfBlazor",r="Blazor";if(window&&window[r]&&!this.isServerUpdate&&!(this.diagramActions&Jb.Clear)){const r={methodName:"UpdateBlazorDiagramObjects",diagramobj:{nodeObj:JSON.stringify(e),ObjectType:t,removalIndex:i,isMultipleObjects:!1,annotationIndex:n,connectorObj:void 0}};window[s].updateBlazorProperties(r,this)}}}UpdateBlazorLabelOrPortObjects(e,t,i,n){if(window&&window.Blazor&&e.length>0&&!this.isServerUpdate&&!(this.diagramActions&Jb.Clear)){const s=[],r=[],o=[];for(let i=0;i<e.length;i++)s.push(e[i]),r.push(t),o.push(n);const a={methodName:"UpdateBlazorDiagramObjects",diagramobj:{nodeObj:JSON.stringify(s),ObjectType:r,removalIndex:i,isMultipleObjects:!0,annotationIndex:o,connectorObj:null,portIndex:"Port"===t?o:[]}};window.sfBlazor.updateBlazorProperties(a,this)}}addBlazorDiagramObjects(){const e=[],t=[];if(this.dataBindingModule&&!(this.realActions&ev.PreventDataInit)){for(let t=0;t<this.nodes.length;t++)e.push(QP(this.nodes[t],void 0,void 0,!0));for(let e=0;e<this.connectors.length;e++)t.push(QP(this.connectors[e],void 0,void 0,!0))}if(window&&window.Blazor){let i={methodName:"AddBlazorObjects",diagramobj:{nodeObj:JSON.stringify(e),isConnector:!1}};window.sfBlazor.updateBlazorProperties(i,this),i={methodName:"AddBlazorObjects",diagramobj:{nodeObj:JSON.stringify(t),isConnector:!0}},window.sfBlazor.updateBlazorProperties(i,this)}}removeNodeEdges(e,t,i){const n=this.nameTable[e],s=i?n.outEdges:n.inEdges;if(s.length>0)for(let r=0;r<s.length;r++)s[r]===t&&s.splice(r,1)}insertBlazorConnector(e){}add(t,i){let n;const s=this.isProtectedOnChange;if(this.protectPropertyChange(!0),t){let e;if(e={element:t=QP(t),cause:this.diagramActions,state:"Changing",type:"Addition",cancel:!1},this.parentObject&&(e.parentId=this.parentObject.id),"helper"===t.id||this.diagramActions&Jb.PreventCollectionChangeOnDragOver||this.triggerEvent(nv.collectionChange,e),e.cancel&&this.drawingObject){this.removeElements(e.element),this.tooltipObject.close();let t,i=this.getObject(e.element.sourceID);if(yC(e.element)===Vw){if(e.element.sourceID&&(this.removeNodeEdges(e.element.sourceID,e.element.id,!0),i.ports.length>0)){for(let n=0;n<i.ports.length;n++){const s=i.ports[n];s.id===e.element.sourcePortID&&(t=!(s.outEdges.length>0))}this.removePortEdges(i,e.element.sourcePortID,e.element.id,t)}e.element.targetID&&this.removeNodeEdges(e.element.targetID,e.element.id,!1)}}this.diagramActions=this.diagramActions|Jb.PublicMethod,t.id=t.id||XP();const s=this.activeLayer;if(!e.cancel&&!s.lock){if(s.objects.indexOf(t.id)<0&&!s.lock&&(s.visible||(s.visible=!0,this.dataBind()),s.objects.push(t.id)),yC(t)===Vw)n=new Vw(this,"connectors",t,!0),n.status="New",_S(n,t,this.connectorDefaults),this.connectors.push(n),this.initObject(n),!1===t.visible&&this.updateElementVisibility(n.wrapper,n,t.visible),this.updateEdges(n),this.insertBlazorConnector(n);else{if(n=new pP(this,"nodes",t,!0),_S(n,t,this.nodeDefaults),n.parentId=t.parentId?t.parentId:n.parentId,n.umlIndex=t.umlIndex,n.status="New",this.nodes.push(n),this.initObject(n,s,void 0,i),this.updateTemplate(),this.bpmnModule){if(n.shape.annotations&&0!==n.shape.annotations.length)for(const e of this.bpmnModule.getTextAnnotationConn(n))this.initConnectors(e,s,!1);n.shape.activity&&n.shape.activity.subProcess.processes&&n.shape.activity.subProcess.processes.length&&this.bpmnModule.updateDocks(n,this)}if(this.lineRoutingModule&&this.constraints&Gb.LineRouting){const e=this.spatialSearch.findObjects(n.wrapper.outerBounds);for(let t=0;t<e.length;t++){const i=e[t];i instanceof Vw&&this.connectorPropertyChange(i,{},{sourceID:i.sourceID,targetID:i.targetID,sourcePortID:i.sourcePortID,targetPortID:i.targetPortID,sourcePoint:i.sourcePoint,targetPoint:i.targetPoint})}}if(n.umlIndex>-1&&t.parentId&&this.nameTable[t.parentId]&&"UmlClassifier"===this.nameTable[t.parentId].shape.type){const e=this.nameTable[t.parentId];e.children.splice(n.umlIndex,0,n.id),e.wrapper.children.splice(n.umlIndex,0,n.wrapper),e.wrapper.measure(new nb),e.wrapper.arrange(e.wrapper.desiredSize),this.updateDiagramObject(e)}}if(e={element:n,cause:this.diagramActions,state:"Changed",type:"Addition",cancel:!1},this.parentObject&&(e.parentId=this.parentObject.id),"helper"===t.id||this.diagramActions&Jb.PreventCollectionChangeOnDragOver||this.triggerEvent(nv.collectionChange,e),!(this.diagramActions&Jb.UndoRedo||this.diagramActions&Jb.Group||this.diagramActions&Jb.PreventHistory)){const e={type:"CollectionChanged",changeType:"Insert",undoObject:QP(t),redoObject:QP(t),category:"Internal"};this.addHistoryEntry(e)}this.parentObject=void 0,"SVG"===this.mode&&(this.updateSvgNodes(n),this.updateTextElementValue(n),this.updateDiagramObject(n),n.shape.activity&&n.shape.activity.subProcess.processes&&n.shape.activity.subProcess.processes.length&&this.updateProcesses(n),this.updateBridging())}}this.protectPropertyChange(s),this.resetDiagramActions(Jb.PublicMethod),n&&this.layers.length>1&&this.moveNode(n);for(const r of this.views){const t=this.views[r];t instanceof e||this.refreshCanvasDiagramLayer(t)}return this.renderReactTemplates(),n}updateSvgNodes(e){if(e.children)for(const t of e.children)if(this.nameTable[t]&&this.nameTable[t].parentId){const e=PP(t+"_groupElement",this.element.id);e&&e.parentNode.removeChild(e)}}updateProcesses(e){if(this.bpmnModule&&e&&e.shape&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length){const t=e.shape.activity.subProcess.processes;this.moveSvgNode(e.id);for(const e of t){this.moveSvgNode(e);let t=[];t=t.concat(this.nameTable[e].outEdges,this.nameTable[e].inEdges);for(let e=t.length-1;e>=0;e--)this.moveSvgNode(t[e])}for(const e of t)this.nameTable[e].shape.activity.subProcess.processes&&this.nameTable[e].shape.activity.subProcess.processes.length&&this.updateProcesses(this.nameTable[e])}else this.moveSvgNode(e.id)}moveSvgNode(e){const t=PP(e+"_groupElement",this.element.id),i=t.parentElement;t.parentNode.removeChild(t),i.appendChild(t)}addTextAnnotation(e,t){if(this.bpmnModule){const i=this.bpmnModule.addAnnotation(t,e,this);if(this.initConnectors(i,this.commandHandler.getObjectLayer(t.id),!1),this.updateDiagramObject(t),!(this.diagramActions&Jb.UndoRedo||this.diagramActions&Jb.Group)){const t={type:"CollectionChanged",changeType:"Insert",undoObject:QP(e),redoObject:QP(e),category:"Internal"};this.addHistoryEntry(t)}}}spliceConnectorEdges(e,t){let i=[];const n=t?this.nameTable[e.sourceID]:this.nameTable[e.targetID];if(n){i=t?n.outEdges:n.inEdges;for(let t=i.length-1;t>=0;t--)i[t]===e.id&&i.splice(t,1);for(let i=0;n.ports&&i<n.ports.length;i++)this.removePortEdges(n,n.ports[i].id,e.id,!t)}}removeDependentConnector(e){let t,i=[];i=i.concat(e.outEdges,e.inEdges);for(let n=i.length-1;n>=0;n--)t=this.nameTable[i[n]],t&&(this.connectorTable[t.id]=QP(t),this.remove(t))}removeObjectsFromLayer(e){if(e.children)for(let n=0;n<e.children.length;n++){const t=this.nameTable[e.children[n]];t&&this.removeObjectsFromLayer(t)}const t=this.layers.indexOf(this.commandHandler.getObjectLayer(e.id)),i=this.layers[t].objects.indexOf(e.id);i>-1&&(jO(this,e)&&this.unSelect(e),this.layers[t].objects.splice(i,1),delete this.layers[t].zIndexTable[this.nameTable[e.id].zIndex])}removeElements(e){if("SVG"===this.mode||"Canvas"===this.mode&&"Native"===e.shape.type){const t=PP(e.id+"_groupElement",this.element.id),i=e;if(i.ports&&i.ports.length>0)for(let e=0;e<i.ports.length;e++){const t=PP(i.id+"_"+i.ports[e].id+"_groupElement",this.element.id);t&&t.parentNode.removeChild(t)}t&&t.parentNode.removeChild(t)}if(this.refreshCanvasLayers(),e.wrapper){const t=e.wrapper.children;let i;if(t)for(let n=0;n<t.length;n++){if(t[n]instanceof uv||t[n].id&&t[n].id.indexOf("icon_content")>0){t[n].id.indexOf("icon_content")>0&&"SVG"===this.mode&&(i=PP(t[n].id+"_shape_groupElement",this.element.id),i&&i.parentNode.removeChild(i),i=PP(t[n].id+"_rect_groupElement",this.element.id),i&&i.parentNode.removeChild(i));for(const i of this.views){NP(t[n].id+"_groupElement",i);const s=this.scroller.removeCollection.indexOf(e.id);this.scroller.removeCollection.splice(s,1)}}else if(t[n]instanceof vw)for(const i of this.views)NP(e.id+"_html_element",i),NP(t[n].id+"_html_element",i),this.clearTemplate(["nodeTemplate_"+e.id]),t[n].annotationId&&this.clearTemplate(["annotationTemplate_"+e.id+t[n].annotationId]);iC(t[n].id)}}}removeCommand(){this.remove()}remove(e){let t,i=[];i=i.concat(this.selectedItems.nodes,this.selectedItems.connectors);let n=!1;if(e){if(this.insertBlazorConnector(e=this.nameTable[e.id]),e&&(ix(e)||this.diagramActions&Jb.Clear)&&(t={element:e,cause:this.diagramActions,state:"Changing",type:"Removal",cancel:!1},this.diagramActions&Jb.Clear||"helper"===e.id||this.triggerEvent(nv.collectionChange,t),!t.cancel)){if(ix(e)&&e&&e.shape&&"SwimLane"===e.shape.type&&function(e,t){const i=t.wrapper.children[0].rows;let n,s,r,o,a,l;for(s=0;s<i.length;s++)for(r=0;r<i[s].cells.length;r++){if(a=CS(i[s].cells[r]),a&&a.children)for(o=a.children.length-1;o>=0;o--)a.children[o].children&&(l=e.nameTable[a.children[o].id],l&&(l.isLane?PS(e,l):(e.removeDependentConnector(l),e.diagramActions|=Jb.PreventHistory,l.constraints&Vb.Delete?e.remove(l):Fx(e,l,{},!1),e.diagramActions&=~Jb.PreventHistory)));a&&(n=e.nameTable[a.id],n&&PS(e,n))}}(this,e),this.bpmnModule&&this.bpmnModule.checkAndRemoveAnnotations(e,this))return void this.refreshCanvasLayers();if(!(this.diagramActions&Jb.UndoRedo||this.diagramActions&Jb.PreventHistory)&&(e instanceof pP||e instanceof Vw)){const t={type:"CollectionChanged",changeType:"Remove",undoObject:QP(e),redoObject:QP(e),category:"Internal"};this.diagramActions&Jb.Clear||e.children&&!e.isLane&&!e.isPhase&&e.children.length>0&&this.undoRedoModule&&"None"===this.layout.type&&(this.historyManager.startGroupAction(),n=!0),e instanceof pP&&this.removeDependentConnector(e),e.isLane||e.isPhase||this.diagramActions&Jb.Clear||this.isStackChild(e)||this.addHistoryEntry(t)}let s;!e.children||e.isLane||e.isPhase||this.deleteGroup(e),e.parentId&&(this.deleteChild(e),this.nameTable[e.parentId]&&"UmlClassifier"===this.nameTable[e.parentId].shape.type&&(this.updateDiagramObject(this.nameTable[e.parentId]),this.updateConnectorEdges(this.nameTable[e.parentId]))),this.diagramActions=this.diagramActions|Jb.PublicMethod;const r=this.nameTable[e.id];if(r instanceof pP){if("Bpmn"===r.shape.type&&this.bpmnModule&&this.bpmnModule.removeBpmnProcesses(r,this),r.isLane||r.isPhase||"SwimLane"===r.shape.type){const e=r.isLane||r.isPhase?this.nameTable[r.parentId]:this.nameTable[r.id];r.isLane?OS(this,r,e):r.isPhase&&ES(this,r,e)}s=this.nodes.indexOf(r),-1!==s&&(this.crudDeleteNodes.push(this.nameTable[r.id]),this.nodes.splice(s,1),this.updateNodeEdges(r))}else s=this.connectors.indexOf(r),-1!==s&&(this.crudDeleteNodes.push(this.nameTable[r.id]),this.connectors.splice(s,1)),this.updateEdges(r),this.spliceConnectorEdges(e,!0),this.spliceConnectorEdges(e,!1);if(this.isServerUpdate||this.blazorActions&_b.GroupClipboardInProcess||this.commandHandler.getBlazorOldValues(),n&&this.historyManager.endGroupAction(),jO(this,r)&&this.unSelect(r),!r.isPhase){if(this.removeObjectsFromLayer(e),this.currentDrawingObject&&(this.currentDrawingObject.wrapper=void 0),delete this.nameTable[e.id],i.length>0&&i[0].id===r.id&&r.parentId){const e=this.nameTable[r.parentId];e&&e.isLane&&"SwimLane"===this.nameTable[e.parentId].shape.type&&SS(this,this.nameTable[e.parentId],e,r)}this.removeElements(r),this.updateBridging(),"SVG"!==this.mode&&this.refreshDiagramLayer(),this.diagramActions&Jb.Clear||(this.removeFromAQuad(r),t={element:e,cause:this.diagramActions,state:"Changed",type:"Removal",cancel:!1},"helper"!==e.id&&this.triggerEvent(nv.collectionChange,t),this.resetTool())}}}else if(i.length>0){this.undoRedoModule&&(this.historyManager.startGroupAction(),this.blazorActions|=_b.GroupingInProgress,n=!0);for(let e=0;e<i.length;e++)if(this.nameTable[i[e].id]){if(i[e]instanceof Vw&&this.bpmnModule&&this.bpmnModule.textAnnotationConnectors.indexOf(i[e])>-1)return void this.remove(this.nameTable[i[e].targetID]);this.remove(i[e])}n&&(this.blazorActions&=~_b.GroupingInProgress,this.isServerUpdate=!0,this.commandHandler.getBlazorOldValues(),this.UpdateBlazorDiagramModelCollection(void 0,void 0,void 0,!0),this.historyManager.endGroupAction(),this.isServerUpdate=!1),this.clearSelection()}this.tooltipObject.close()}isStackChild(e){let t;const i=this.nameTable[e.parentId];if(e&&e.parentId&&i.container&&"Stack"===i.container.type&&"UmlClassifier"!==this.nameTable[e.parentId].shape.type){t=!0;const n={type:"StackChildPositionChanged",redoObject:{sourceIndex:void 0,source:e,target:void 0,targetIndex:void 0},undoObject:{sourceIndex:i.wrapper.children.indexOf(e.wrapper),source:e,target:void 0,targetIndex:void 0},category:"Internal"};this.diagramActions&Jb.UndoRedo||this.addHistoryEntry(n)}return t}deleteChild(e,t){let i;if(i="string"==typeof e?e:e.id,(t=t?this.nameTable[t.id]:this.nameTable[e.parentId])&&t.children){for(let e=0;e<t.children.length;e++)if(t.children[e]===i){t.children.splice(e,1);for(let e=0;e<t.wrapper.children.length;e++)t.wrapper.children[e].id===i&&t.wrapper.children.splice(e,1)}t.wrapper.measure(new nb),t.wrapper.arrange(t.wrapper.desiredSize)}}addChild(e,t,i){let n;const s=this.nameTable[e.id];if(s.children||(s.children=[]),s.children&&("string"==typeof t?this.nameTable[t]&&(n=t):(n=t.id=t.id||XP(),this.add(t)),n&&(!t.umlIndex||-1===t.umlIndex))){const t=this.nameTable[n];t.parentId=s.id,s.container&&"Stack"===s.container.type&&this.updateStackProperty(s,t),i?(s.children.splice(i,0,n),s.wrapper.children.splice(i,0,t.wrapper)):(s.children.push(n),s.wrapper.children.push(t.wrapper)),s.wrapper.measure(new nb),s.wrapper.arrange(s.wrapper.desiredSize),s.isLane||(this.nameTable[e.id].width=s.wrapper.actualSize.width,this.nameTable[e.id].height=s.wrapper.actualSize.height,this.nameTable[e.id].offsetX=s.wrapper.offsetX,this.nameTable[e.id].offsetY=s.wrapper.offsetY),void 0!==s.container&&(t.offsetX=t.wrapper.offsetX,t.offsetY=t.wrapper.offsetY),(!s.parentId||this.nameTable[s.parentId]&&"SwimLane"!==this.nameTable[s.parentId].shape.type)&&this.updateDiagramObject(s)}return n}clear(){this.clearObjects()}clearObjects(e){let t=[];e?t=e:(t=t.concat(this.nodes),t=t.concat(this.connectors)),this.diagramActions=this.diagramActions|Jb.Clear;for(const i of t)this.nameTable[i.id]&&this.remove(i);this.diagramActions=this.diagramActions&~Jb.Clear,this.spatialSearch=new uT(this.nameTable),this.initHistory()}startEditCommad(){let e;const t=this.selectedItems.nodes[0]?this.selectedItems.nodes[0]:void 0;if(t&&t instanceof pP)if(t.isLane&&t.parentId){const i=this.nameTable[t.parentId],n=i.shape.lanes,s=t.id.slice(i.id.length),r=s.substring(0,s.length-1);for(let o=0;o<n.length;o++)t.isLane&&r===n[o].id&&(e=this.nameTable[n[o].header.id])}else"SwimLane"===t.shape.type&&t.shape.header&&t.shape.hasHeader&&(e=this.nameTable[t.wrapper.children[0].rows[0].cells[0].children[0].id]);this.startTextEdit(e)}startTextEdit(e,t){if(!yx(this)&&!fx(this)||mx(this)){this.textEditing=!0;const i=this.scroller.transform,n=Sx(this)?i.scale:1,s=90;let r,o,a,l,h,c;if(e||(e=this.selectedItems.nodes[0]?this.selectedItems.nodes[0]:this.selectedItems.connectors[0]),e){e.shape&&"UmlClassifier"===e.shape.type&&(e=this.nameTable[e.children[0]]);let d=!1;if(this.bpmnModule&&(c=this.bpmnModule.getTextAnnotationWrapper(e,t),c&&(e=this.nameTable[e.id.split("_textannotation_")[0]])),c?d=!0:("Text"!==e.shape.type&&0===e.annotations.length&&(e.constraints&Vb.ReadOnly||(this.activeLabel.isGroup=!0,this.startGroupAction(),this.addLabels(e,[{id:XP(),content:""}]))),!t&&("Text"!==e.shape.type&&e.annotations.length>0||"Text"===e.shape.type)&&(t="Text"===e.shape.type?e.wrapper.children[0].id.split("_")[1]:e.annotations[0].id),t&&(c=this.getWrapper(e.wrapper,t))),e&&c&&!(c instanceof vw)&&(!function(e,t){let i=0;return i=t instanceof Vw?Ub.ReadOnly:Vb.ReadOnly,"Text"===t.shape.type?t.constraints&Vb.ReadOnly:t.constraints&i?e.constraints&Fb.InheritReadOnly?1:0:e.constraints&Fb.ReadOnly?1:0}(c,e)||d)){const d=c.style;let p;p=c.bounds.width<e.wrapper.bounds.width?c.bounds.width:e.wrapper.bounds.width,p=s>p?s:p;let u=document.getElementById(this.element.id+"_editTextBoxDiv"),g=document.getElementById(this.element.id+"_editBox");r=g?g.value:c.content,this.activeLabel.text=r,u||g||(u=kP("div",{}),g=kP("textarea",{}),this.diagramCanvas.appendChild(u),u.appendChild(g),g.appendChild(document.createTextNode(r))),o=xP(c.style,r,void 0,void 0,p),o.isEmpty()&&(o=new nb("Text"!==e.shape.type?hC(e,c.id.split(e.id+"_")[1]).width||50:e.width>50?50:e.width,c.style.fontSize)),e.parentId&&"UmlClassifier"===this.nameTable[e.parentId].shape.type?(o.width=e.wrapper.bounds.width-20,l=(e.wrapper.bounds.center.x+i.tx)*i.scale-o.width/2*n-2.5,h=(e.wrapper.bounds.center.y+i.ty)*i.scale-o.height/2*n-3,c.style.textAlign="Left"):(o.width=Math.max(o.width,50),l=(c.bounds.center.x+i.tx)*i.scale-o.width/2*n-2.5,h=(c.bounds.center.y+i.ty)*i.scale-o.height/2*n-3),a={id:this.element.id+"_editTextBoxDiv",style:"position: absolute;left:"+l+"px;top:"+h+"px;width:"+(o.width+1)*n+"px;height:"+o.height*n+"px; containerName:"+e.id+";"},FP(u,a),a={id:this.element.id+"_editBox",style:"width:"+(o.width+1)*n+"px;height:"+o.height*n+"px;resize: none;outline: none;overflow: hidden;;font-family:"+d.fontFamily+";font-size:"+d.fontSize*n+"px;text-align:"+c.style.textAlign.toLocaleLowerCase()+";",class:"e-diagram-text-edit"},FP(g,a),g.style.fontWeight=d.bold?"bold":"",g.style.fontStyle=d.italic?"italic":"",g.style.lineHeight=(1.2*d.fontSize+"px;").toString(),g.style.textDecoration=d.textDecoration?d.textDecoration:"",this.activeLabel.parentId=e.id,this.activeLabel.id=t,c.visible=!1,this.updateDiagramObject(e),this.diagramActions=this.diagramActions|Jb.TextEdit,this.isTriggerEvent||(xu.add(g,"input",this.eventHandler.inputChange,this.eventHandler),xu.add(g,"focusout",this.focusOutEdit,this),g.select())}}}}updateConnectorfixedUserHandles(e){if(e.fixedUserHandles.length){let t;for(const i of e.fixedUserHandles)t=this.getWrapper(e.wrapper,i.id),e.updateAnnotation(i,e.intermediatePoints,e.wrapper.bounds,t)}e.wrapper.measure(new nb(e.wrapper.width,e.wrapper.height)),e.wrapper.arrange(e.wrapper.desiredSize)}updateNodeExpand(e,t){for(let i=0;i<e.outEdges.length;i++){const n=this.nameTable[e.outEdges[i]],s=this.nameTable[n.targetID];n.visible=t,s&&(t||(this.updateElementVisibility(n.wrapper,n,!1),s.isExpanded=t),this.updateNodeExpand(s,s.isExpanded),s.visible=t,t||this.updateElementVisibility(s.wrapper,s,!1))}}updateConnectorAnnotation(e){if(e.annotations.length){let t;for(const i of e.annotations)t=this.getWrapper(e.wrapper,i.id),e.updateAnnotation(i,e.intermediatePoints,e.wrapper.bounds,t,this.diagramActions&Jb.Interactions)}e.wrapper.measure(new nb(e.wrapper.width,e.wrapper.height)),e.wrapper.arrange(e.wrapper.desiredSize)}removeChildrenFromLayout(e){const t=[];let i;for(let n=0;n<e.length;n++)i=e[n],i.parentId||i.processId||t.push(i);return t}doLayout(){let e,t=!1;const i="ComplexHierarchicalTree"===this.layout.type||"HierarchicalTree"===this.layout.type,n=this.isProtectedOnChange;this.protectPropertyChange(!0);const s=this.removeChildrenFromLayout(this.nodes),r=this.layout.enableRouting&&"ComplexHierarchicalTree"===this.layout.type,o={x:this.scroller.viewPortWidth,y:this.scroller.viewPortHeight};if("None"!==this.layout.type){if((r||"DifferentPoint"===this.layout.connectionPointOrigin&&this.lineDistributionModule&&i||"Linear"===this.layout.arrangement)&&this.lineDistributionModule.initLineDistribution(this.layout,this),this.organizationalChartModule)e=this.organizationalChartModule.updateLayout(s,this.nameTable,this.layout,o,this.dataSourceSettings.id,this.diagramActions),t=!0,this.layoutAnimateModule&&e.rootNode&&!this.diagramActions&&this.updateNodeExpand(e.rootNode,e.rootNode.isExpanded);else if(this.mindMapChartModule)s&&s.length>0&&this.mindMapChartModule.updateLayout(s,this.nameTable,this.layout,o,this.dataSourceSettings.id,this.dataSourceSettings.root),t=!0;else if(this.radialTreeModule)this.radialTreeModule.updateLayout(s,this.nameTable,this.layout,o),t=!0;else if(this.symmetricalLayoutModule)this.symmetricalLayoutModule.maxIteration=this.layout.maxIteration,this.symmetricalLayoutModule.springLength=this.layout.springLength,this.symmetricalLayoutModule.springFactor=this.layout.springFactor,this.symmetricalLayoutModule.updateLayout(s,this.connectors,this.symmetricalLayoutModule,this.nameTable,this.layout,o),t=!0;else if(this.complexHierarchicalTreeModule){const e=this.complexHierarchicalTreeModule.getLayoutNodesCollection(this.nodes);e.length>0&&this.complexHierarchicalTreeModule.doLayout(e,this.nameTable,this.layout,o,this.lineDistributionModule),t=!0}if(t){this.preventDiagramUpdate=!0;const e={},t=s;for(const i of t){const t=i;if(this.preventNodesUpdate||this.diagramActions&&this.diagramActions&Jb.PreventIconsUpdate||(this.updateIcon(t),this.updateDefaultLayoutIcons(t)),this.preventNodesUpdate=!0,this.nodePropertyChange(t,{},{offsetX:t.offsetX,offsetY:t.offsetY},!0),this.preventNodesUpdate=!1,t.wrapper.measure(new nb(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize),this.updateDiagramObject(t,!0),t.inEdges.length>0)for(let i=0;i<t.inEdges.length;i++){const n=this.nameTable[t.inEdges[i]];e[n.id]=n}if(t.outEdges.length>0)for(let i=0;i<t.outEdges.length;i++){const n=this.nameTable[t.outEdges[i]];e[n.id]=n}}for(const i of Object.keys(e)){r&&this.lineDistributionModule.resetConnectorSegments(this.nameTable[i]);const t=e[i],n=this.getPoints(t);r&&this.lineDistributionModule.resetRoutingSegments(t,this,n),sC(t,n),"Bpmn"===t.shape.type&&"Default"===t.shape.sequence&&this.commandHandler.updatePathElementOffset(t),t.wrapper.measure(new nb(void 0,void 0)),t.wrapper.arrange(t.wrapper.desiredSize),this.updateConnectorAnnotation(t),this.updateConnectorfixedUserHandles(t),this.updateQuad(t),this.updateDiagramObject(t,!0)}(r||"DifferentPoint"===this.layout.connectionPointOrigin&&this.lineDistributionModule&&i)&&this.lineDistributionModule.distributeLines(this.layout,this),this.preventDiagramUpdate=!1,this.updatePage(),this.diagramActions&Jb.Render&&"Canvas"!==this.mode||this.refreshDiagramLayer()}n||this.protectPropertyChange(n)}return t&&this.updateDiagramElementQuad(),!(this.blazorActions&_b.expandNode)||e}saveDiagram(){let e,t,i,n,s=[];for(let r=0;r<this.nodes.length;r++)if(e=this.nodes[r],"SwimLane"===e.shape.type){t=e.wrapper.children[0],i=t.childTable;for(const e of Object.keys(i))n=i[e],s=qS(n,s);for(let e=0;e<s.length;e++)this.nameTable[s[e]]&&(this.swimlaneChildTable[s[e]]=this.nameTable[s[e]].zIndex);this.swimlaneZIndexTable[e.id]=e.zIndex}return function(e){const t=function(e){let t,i,n,s,r=[];for(let o=0;o<e.length;o++)if(t=e[o],"SwimLane"===t.shape.type){i=t.wrapper.children[0],n=i.childTable;for(const e of Object.keys(n))s=n[e],r=qS(s,r)}return r}(e.nodes);let i=QP(e,e.getCustomProperty);return i.selectedItems.nodes=[],i.selectedItems.connectors=[],i.selectedItems.wrapper=null,e.serializationSettings.preventDefaults&&(i=ZS(i,e)),function(e,t){const i=t.nodes;if(i)for(let n=0;n<i.length;n++)-1!==e.indexOf(i[n].id)&&(i.splice(n,1),n--)}(t,i),JSON.stringify(i)}(this)}loadDiagram(e){return QS(e,this)}getDiagramContent(e){return this.printandExportModule?this.printandExportModule.getDiagramContent(e):""}exportImage(e,t){this.printandExportModule&&this.printandExportModule.exportImages(e,t)}printImage(e,t){this.printandExportModule&&(t.printOptions=!0,this.printandExportModule.exportImages(e,t))}setStackLimit(e){this.undoRedoModule&&e&&(this.historyManager.stackLimit=e,this.undoRedoModule.applyLimit(this.historyManager.currentEntry,e,this,!0))}clearHistory(){this.undoRedoModule&&this.undoRedoModule.clearHistory(this)}getDiagramBounds(){if(this.printandExportModule){const e=this.printandExportModule.getDiagramBounds("",{});return e.width=e.width>this.scrollSettings.viewPortWidth?e.width+(e.x>0?e.x:0):this.scrollSettings.viewPortWidth,e.height=e.height>this.scrollSettings.viewPortHeight?e.height+(e.y>0?e.y:0):this.scrollSettings.viewPortHeight,e.x=e.x>0?0:e.x,e.y=e.y>0?0:e.y,e}return new mb}exportDiagram(e){return this.printandExportModule?this.printandExportModule.exportDiagram(e):""}print(e){this.printandExportModule&&this.printandExportModule.print(e)}addPorts(e,t){let i;this.protectPropertyChange(!0),e=this.nameTable[e.id]||e,t.length>1&&this.startGroupAction();for(let n=0;n<t.length;n++)if(i=new fv(e,"ports",t[n],!0),e.ports.push(i),e.children?e.initPort(this.getDescription,e.wrapper.children[e.wrapper.children.length-1],i):e.wrapper.children.push(e.initPortWrapper(e.ports[e.ports.length-1])),!(this.diagramActions&Jb.UndoRedo||this.diagramActions&Jb.Group)){const t={type:"PortCollectionChanged",changeType:"Insert",undoObject:QP(i),redoObject:QP(e),category:"Internal"};this.addHistoryEntry(t)}t.length>1&&this.endGroupAction(),e.wrapper.measure(new nb(e.width,e.height)),e.wrapper.arrange(e.wrapper.desiredSize),this.updateDiagramObject(e),this.protectPropertyChange(!1)}addConstraints(e,t){return e|t}removeConstraints(e,t){return e&~t}addNodeLabels(e,t){this.addLabels(e,t)}addConnectorLabels(e,t){this.addLabels(e,t)}addLabels(e,t){this.protectPropertyChange(!0);const i=(e=this.nameTable[e.id]||e).wrapper;let n;t.length>1&&this.startGroupAction();for(let s=0;s<t.length;s++){if(e instanceof pP)if(n=new wv(e,"annotations",t[s],!0),e.annotations.push(n),e.children){const t=e;for(let i=0;i<t.wrapper.children.length;i++)t.wrapper.children[i].id===t.id+"group_container"&&t.wrapper.children[i].children.push(e.initAnnotationWrapper(e.annotations[e.annotations.length-1],this.element.id))}else i.children.push(e.initAnnotationWrapper(e.annotations[e.annotations.length-1],this.element.id));else if(e instanceof Vw){n=new xv(e,"annotations",t[s],!0),e.annotations.push(n);const r=i.children[0],o=new mb(r.offsetX-r.width/2,r.offsetY-r.height/2,r.width,r.height);i.children.push(e.getAnnotationElement(e.annotations[e.annotations.length-1],e.intermediatePoints,o,this.getDescription,this.element.id))}if(!(this.diagramActions&Jb.UndoRedo||this.diagramActions&Jb.Group)){const t={type:"LabelCollectionChanged",changeType:"Insert",undoObject:QP(n),redoObject:QP(e),category:"Internal"};this.addHistoryEntry(t)}}t.length>1&&this.endGroupAction(),e.wrapper.measure(new nb(i.width,i.height)),e.wrapper.arrange(i.desiredSize),this.updateDiagramObject(e),this.protectPropertyChange(!1)}addLanes(e,t,i){e=this.nameTable[e.id]||e;for(let n=0;n<t.length;n++)mS(this,e,t[n],i),void 0!==i&&(i+=1);this.updateDiagramElementQuad()}addPhases(e,t){e=this.nameTable[e.id]||e;for(let i=0;i<t.length;i++)yS(this,e,t[i]);this.updateDiagramElementQuad()}removeLane(e,t){OS(this,void 0,e,t),this.updateDiagramElementQuad()}removePhase(e,t){ES(this,void 0,e,t),this.updateDiagramElementQuad()}removelabelExtension(e,t,i,n){for(let s=0;s<n.children.length;s++){const r=n.children[s];if((r instanceof av||r instanceof vw)&&r.id.match("_"+t[i].id+"$")){for(let t=0;t<e.annotations.length;t++)if(r.id.match("_"+e.annotations[t].id+"$")){if(!(this.diagramActions&Jb.UndoRedo)){const i={type:"LabelCollectionChanged",changeType:"Remove",undoObject:QP(e.annotations[t]),redoObject:QP(e),category:"Internal"};this.addHistoryEntry(i)}e.annotations.splice(t,1)}if(n.children.splice(s,1),"SVG"===this.mode){let e=PP(r.id,this.element.id);if(e){const e=PP(r.id,this.element.id);e.parentNode.removeChild(e)}PP(r.id+"_text",this.element.id)&&(e=PP(r.id+"_text",this.element.id),e.parentNode.removeChild(e));const t=PP(r.id+"_html_element",this.element.id);t&&t.parentNode.removeChild(t)}else this.refreshCanvasLayers()}}}removeLabels(e,t){e=this.nameTable[e.id]||e,t.length>1&&this.startGroupAction();for(let i=t.length-1;i>=0;i--)if(e.children&&e.children.length>0)for(let n=0;n<e.wrapper.children.length;n++)this.removelabelExtension(e,t,i,e.wrapper.children[n]);else this.removelabelExtension(e,t,i,e.wrapper);t.length>1&&this.endGroupAction()}removePortsExtenion(e,t,i,n){for(let s=0;s<n.children.length;s++){const r=n.children[s];if(r instanceof dv&&r.id.match("_"+t[i].id+"$")){for(let t=0;t<e.ports.length;t++)if(r.id.match("_"+e.ports[t].id+"$")){if(!(this.diagramActions&Jb.UndoRedo)){const i={type:"PortCollectionChanged",changeType:"Remove",undoObject:QP(e.ports[t]),redoObject:QP(e),category:"Internal"};this.addHistoryEntry(i)}e.ports.splice(t,1)}if(n.children.splice(s,1),"SVG"===this.mode){const e=PP(r.id,this.element.id);e.parentNode.removeChild(e)}else this.refreshCanvasLayers()}}}removePorts(e,t){e=this.nameTable[e.id]||e,t.length>1&&this.startGroupAction();for(let i=t.length-1;i>=0;i--)if(e.children&&e.children.length>0)for(let n=0;n<e.wrapper.children.length;n++)this.removePortsExtenion(e,t,i,e.wrapper.children[n]);else this.removePortsExtenion(e,t,i,e.wrapper);t.length>1&&this.endGroupAction()}getSizeValue(e,t){let i;return i=e.toString().indexOf("px")>0?e.toString():e.toString().indexOf("%")>0?void 0!==t?"100%":e.toString():e.toString()+"px",t&&($w(this),i="calc("+i+" - "+t+"px)"),i}renderRulers(){this.rulerSettings.showRulers?(function(e){const t=$w(e),i=kP("div",{id:e.element.id+"_overlapRuler",style:"height:"+t.height+"px;width:"+t.width+"px;position:absolute;left:0;top:0",class:"e-ruler-overlap"});e.element.insertBefore(i,e.element.firstChild)}(this),Gw(this,!0),Gw(this,!1)):Zw(this)}intOffPageBackground(){let e=new nb;e=$w(this);const t=document.getElementById(this.element.id+"content"),i=this.getSizeValue(this.width,e.width),n=this.getSizeValue(this.height,e.height),s=this.rulerSettings.showRulers?"width:"+i+"; height:"+n+";top:"+e.height+"px;left:"+e.width+"px;overflow: scroll;position:absolute;overflow:auto;":"width:"+i+"; height:"+n+";position:absolute; left:0px;  top:0px;overflow: auto;",r={id:this.element.id+"content",tabindex:"0",style:s};t?(this.diagramCanvas=t,UP(this.diagramCanvas,s)):(this.diagramCanvas=kP("div",r),this.element.appendChild(this.diagramCanvas)),this.diagramCanvas.style.background=this.backgroundColor}initDiagram(){this.intOffPageBackground(),FP(this.element,{style:"width:"+this.getSizeValue(this.width)+"; height:"+this.getSizeValue(this.height)+";position:relative;overflow:hidden;"})}renderHiddenUserHandleTemplateLayer(e){const t=kP("div",{class:this.element.id+"_hiddenUserHandleTemplate",style:"width:"+e.width+"px; height:"+e.height+"px;visibility:hidden ;  overflow: hidden;"});this.element.appendChild(t)}renderBackgroundLayer(e,t){const i=this.createSvg(this.element.id+"_backgroundLayer_svg",e.width,e.height);UP(i,t);const n=jP("g",{id:this.element.id+"_backgroundImageLayer",class:"e-background-image-layer"});i.appendChild(n);const s=jP("g",{id:this.element.id+"_backgroundLayer",class:"e-background-layer"});i.appendChild(s),this.diagramCanvas.appendChild(i)}renderGridLayer(e,t){const i=this.createSvg(this.element.id+"_gridline_svg",e.width,e.height);i.setAttribute("class","e-grid-layer");const n=jP("g",{id:this.element.id+"_gridline"}),s=jP("rect",{id:this.element.id+"_grid_rect",x:"0",y:"0",width:"100%",height:"100%"});TC()?s.setAttribute("fill","url("+location.protocol+"//"+location.host+location.pathname+"#"+this.element.id+"_pattern)"):s.setAttribute("fill","url(#"+this.element.id+"_pattern)"),n.appendChild(s),i.appendChild(n),this.diagramCanvas.appendChild(i),WP(i,{style:t})}renderDiagramLayer(e,t){if(this.diagramLayerDiv=kP("div",{id:this.element.id+"_diagramLayer_div",style:"width:"+e.width+"px; height:"+e.height+"px;"+t}),"SVG"===this.mode){const t=this.createSvg(this.element.id+"_diagramLayer_svg",e.width,e.height);t.style["pointer-events"]="none",t.setAttribute("class","e-diagram-layer");const i=jP("g",{id:this.element.id+"_diagramLayer"}),n=jP("g",{});this.diagramLayer=i,t.style["pointer-events"]="all",n.appendChild(i),t.appendChild(n),this.diagramLayerDiv.appendChild(t)}else this.diagramLayer=cO.createCanvas(this.element.id+"_diagram",e.width,e.height),UP(this.diagramLayer,"position:absolute;left:0px;top:0px;"),this.diagramLayerDiv.appendChild(this.diagramLayer);this.diagramCanvas.appendChild(this.diagramLayerDiv)}initLayers(){const e="position:absolute;top:0px;left:0px;overflow:hidden;pointer-events:none;",t=document.getElementById(this.element.id).getBoundingClientRect(),i=function(){const e=kP("div",{style:"visibility:hidden; width: 100px"});document.body.appendChild(e);const t=e.getBoundingClientRect().width;e.style.overflow="scroll";const i=kP("div",{style:"width:100%"});e.appendChild(i);const n=i.getBoundingClientRect().width;return e.parentNode.removeChild(e),t-n}();this.scroller.scrollerWidth=i,this.scroller.setViewPortSize(t.width,t.height),this.renderRulers(),window.measureElement&&(window.measureElement=null,document.getElementById("measureElement").remove()),function(){if(window.measureElement)window.measureElement.usageCount+=1;else{const e=kP("div",{id:"measureElement",style:"visibility:hidden ; height: 0px ; width: 0px; overflow: hidden;"}),t=kP("span",{style:"display:inline-block ; line-height: normal"});e.appendChild(t);const i=kP("img",{alt:"measureElementImage",src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"});e.appendChild(i);const n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),e.appendChild(n);const s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("d",""),n.appendChild(s),document.createTextNode("");const r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),n.appendChild(r),window.measureElement=e,window.measureElement.usageCount=1,document.body.appendChild(e);const o="measureElementCount";window[o]?window[o]++:window[o]=1}}(),this.renderBackgroundLayer(t,e),this.renderGridLayer(t,e),this.renderDiagramLayer(t,e),this.renderHTMLLayer(t,e),this.renderPortsExpandLayer(t,e),this.renderNativeLayer(t,e),this.renderAdornerLayer(t,e),this.renderHiddenUserHandleTemplateLayer(t)}renderAdornerLayer(e,t){const i=kP("div",{id:this.element.id+"_diagramAdornerLayer",style:"width:"+e.width+"px;height:"+e.height+"px;"+t}),n=kP("div",{id:this.element.id+"_diagramUserHandleLayer",style:"width:"+e.width+"px;height:"+e.height+"px;"+t});n.setAttribute("class","e-userHandle-layer"),i.appendChild(n);const s=this.createSvg(this.element.id+"_diagramAdorner_svg",e.width,e.height);s.setAttribute("class","e-adorner-layer"),s.style["pointer-events"]="none",this.adornerLayer=jP("g",{id:this.element.id+"_diagramAdorner"}),this.adornerLayer.style[" pointer-events"]="all",s.appendChild(this.adornerLayer),i.appendChild(s),this.diagramCanvas.appendChild(i);const r=jP("g",{id:this.element.id+"_SelectorElement"});this.adornerLayer.appendChild(r),WP(s,{style:"pointer-events:none;"})}renderPortsExpandLayer(e,t){const i=this.createSvg(this.element.id+"_diagramPorts_svg",e.width,e.height);i.setAttribute("class","e-ports-expand-layer");const n=jP("g",{id:this.element.id+"_diagramPorts",class:"e-ports-layer",style:"pointer-events: all;"});i.appendChild(n);const s=jP("g",{id:this.element.id+"_diagramExpander",class:"e-expand-layer",style:"pointer-events: all;"});i.appendChild(s),this.diagramCanvas.appendChild(i),WP(i,{style:t})}renderHTMLLayer(e,t){this.htmlLayer=kP("div",{id:this.element.id+"_htmlLayer",style:"width:"+e.width+"px; height:"+e.height+"px;position:absolute;top:0px;left:0px;overflow:hidden;pointer-events:none;",class:"e-html-layer"});const i=kP("div",{id:this.element.id+"_htmlLayer_div",style:"position:absolute;top:0px;left:0px;pointer-events:all;"});this.htmlLayer.appendChild(i),this.diagramCanvas.appendChild(this.htmlLayer)}renderNativeLayer(e,t){const i=this.createSvg(this.element.id+"_nativeLayer_svg",e.width,e.height),n=jP("g",{id:this.element.id+"_nativeLayer",style:"pointer-events:all;"});i.appendChild(n),this.diagramLayerDiv.appendChild(i),WP(i,{class:"e-native-layer",style:t})}createSvg(e,t,i){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");return WP(n,{id:e,width:t,height:i}),n}updateBazorShape(){for(let e=0;e<this.nodes.length;e++){const t=this.nodes[e];switch(t.shape.type){case"Bpmn":t.shape.bpmnShape=t.shape.shape?t.shape.shape:t.shape.bpmnShape;break;case"UmlActivity":t.shape.umlActivityShape=t.shape.shape?t.shape.shape:t.shape.umlActivityShape;break;case"Flow":t.shape.flowShape=t.shape.shape?t.shape.shape:t.shape.flowShape;break;case"Basic":t.shape.basicShape=t.shape.shape?t.shape.shape:t.shape.basicShape;break;case"Text":t.shape.textContent=t.shape.content?t.shape.content:t.shape.textContent}}}initObjects(e){this.updateBazorShape(),this.isLoading||this.initData(),this.initLayerObjects(),this.updateBridging(e)}initLayerObjects(){const e=this.layers.length>1,t=[],i=(window&&window,{}),n={},s=[];for(const o of this.nodes)o.id=o.id||XP(),this.addToLayer(o,e),i[o.id]=o;for(const o of this.connectors)o.id=o.id||XP(),this.addToLayer(o,e),i[o.id]=o;for(const o of this.layers){for(const e of o.objects)if(i[e])if(i[e]instanceof Vw){const n=i[e];if(n.sourceID&&n.targetID){const s=i[n.sourceID],r=i[n.targetID];let a=!0;this.isLoading&&(s&&s.children&&s.children.length>0||r&&r.children&&r.children.length>0)&&(a=!1),s&&s.wrapper&&r&&r.wrapper&&a?this.initConnectors(i[e],o):t.push(i[e])}else this.initConnectors(i[e],o)}else i[e].children?s.push(e):i[e].shape instanceof iP&&i[e].shape.activity.subProcess.processes&&i[e].shape.activity.subProcess.processes.length>0?n[i[e].id]=e:this.initNodes(i[e],o);if(this.bpmnModule)for(const e of this.bpmnModule.textAnnotationConnectors)this.initConnectors(e,o,!1)}for(const o of Object.keys(n))this.initObject(i[o]),this.bpmnModule.updateDocks(i[o],this);const r=this.alignGroup(s,i);for(const o of r){const e=this.commandHandler.getObjectLayer(o);this.initNodes(i[o],e)}for(const o of t){const e=this.commandHandler.getObjectLayer(o.id);this.initConnectors(o,e)}}alignGroup(e,t){let i=[];const n=[];let s,r,o,a;for(o=0;o<e.length;o++){let l;if(s=e[o],r=t[s],r&&r.children.length)for(a=0;a<r.children.length;a++)l=r.children[a],e.indexOf(l)>-1&&-1===i.indexOf(l)&&-1===n.indexOf(l)&&i.splice(0,0,l);-1===i.indexOf(s)&&n.push(s)}return i=i.concat(n),i}addToLayer(e,t){let i;if(t&&(i=this.commandHandler.getObjectLayer(e.id)),t&&i||-1===this.activeLayer.objects.indexOf(e.id)&&this.activeLayer.objects.push(e.id),(e instanceof pP||e instanceof Vw)&&("SwimLane"!==e.shape.type||e.children&&e.children.length>0)){if(e.parentId){let t=this.swimlaneZIndexTable[e.parentId];t&&-1!==t&&(e.zIndex=this.swimlaneChildTable[e.id])}e instanceof Vw&&e.sourceID&&e.targetID&&this.findNodeInLane(e.sourceID)&&this.findNodeInLane(e.targetID)?-1!==this.activeLayer.objects.indexOf(e.sourceID)&&-1!==this.activeLayer.objects.indexOf(e.targetID)&&this.setZIndex(i||this.activeLayer,e):this.setZIndex(i||this.activeLayer,e)}}findNodeInLane(e){let t=!1;for(let i=0;i<this.nodes.length;i++)if("SwimLane"!==this.nodes[i].shape.type){if(this.nodes[i].id===e){t=!0;break}}else{let n=this.nodes[i].shape;if(n.lanes&&n.lanes.length>0)for(let i=0;i<n.lanes.length;i++)if(n.lanes[i].children&&n.lanes[i].children.length>0)for(let s=0;s<n.lanes[i].children.length;s++)if(n.lanes[i].children[s].id===e){t=!0;break}}return!!t}updateLayer(e){for(const t of Object.keys(e.layers)){const i=this.layers[t].objects;for(const n of i){const i=this.nameTable[n];void 0!==e.layers[t].visible?this.updateElementVisibility(i.wrapper,i,e.layers[t].visible):!0===e.layers[t].lock&&this.unSelect(i)}void 0!==e.layers[t].lock&&(this.layers[t].lock=e.layers[t].lock)}"SVG"!==this.mode&&this.refreshDiagramLayer()}updateScrollSettings(e){const t=-this.scroller.horizontalOffset+e.scrollSettings.horizontalOffset||0,i=this.scroller.verticalOffset-e.scrollSettings.verticalOffset||0,n={VerticalOffset:this.scrollSettings.verticalOffset,HorizontalOffset:this.scrollSettings.horizontalOffset,ViewportHeight:this.scrollSettings.viewPortHeight,ViewportWidth:this.scrollSettings.viewPortWidth,CurrentZoom:this.scroller.currentZoom};0===t&&0===i||this.pan(t,i);let s="Start";this.realActions&ev.PanInProgress&&(s="Progress"),this.triggerEvent(nv.scrollChange,{oldValue:n,newValue:{VerticalOffset:this.scrollSettings.verticalOffset,HorizontalOffset:this.scrollSettings.horizontalOffset,ViewportHeight:this.scrollSettings.viewPortHeight,ViewportWidth:this.scrollSettings.viewPortWidth,CurrentZoom:this.scroller.currentZoom},source:this,panState:s}),this.commandHandler.updatePanState(!0),"Canvas"===this.mode&&this.constraints&Gb.Virtualization&&this.refreshDiagramLayer()}initData(){const e=this.dataSourceSettings.dataManager||this.dataSourceSettings.dataSource;!this.dataBindingModule||this.realActions&ev.PreventDataInit||(e&&this.dataSourceSettings.connectionDataSource.dataManager?(this.nodes=this.generateData(this.dataSourceSettings.dataManager||this.dataSourceSettings.dataSource,!0),this.connectors=this.generateData(this.dataSourceSettings.connectionDataSource.dataManager,!1)):e&&e.dataSource&&(e.dataSource.url||"BlazorAdaptor"===e.adaptorName&&!e.dataSource.url)?this.dataBindingModule.initSource(this.dataSourceSettings,this):this.dataBindingModule.initData(this.dataSourceSettings,this))}generateData(e,t){const i=[];let n;for(n=0;n<e.length;n++){const s=this.makeData(e[n],!!t);!s||!s.id||DS(i,s.id)&&DS(i,s.id)||i.push(s)}return i}makeData(e,t){let i;const n=t?this.dataSourceSettings:this.dataSourceSettings.connectionDataSource,s={};if(s.id=e[n.id]?e[n.id]:XP(),n.sourceID&&(s.sourceID=e[n.sourceID]),n.targetID&&(s.targetID=e[n.targetID]),e[n.sourcePointX]&&e[n.sourcePointY]&&(s.sourcePoint={x:Number(e[n.sourcePointX]),y:Number(e[n.sourcePointY])}),e[n.targetPointX]&&e[n.targetPointY]&&(s.targetPoint={x:Number(e[n.targetPointX]),y:Number(e[n.targetPointY])}),n.crudAction.customFields&&n.crudAction.customFields.length>0)for(i=0;i<n.crudAction.customFields.length;i++)s[n.crudAction.customFields[i]]=e[n.crudAction.customFields[i]];return s}initNodes(e,t){this.preventDiagramUpdate=!0,this.initObject(e,t),this.preventDiagramUpdate=!1}initConnectors(e,t,i){this.preventDiagramUpdate=!0,this.initObject(e,t,i),this.updateEdges(e),this.preventDiagramUpdate=!1}setZIndex(e,t){const i=e;if(-1===t.zIndex){for(;i.zIndexTable[i.objectZIndex+1];)e.objectZIndex++;t.zIndex=++i.objectZIndex}else{const e=t.zIndex;if(i.zIndexTable[e]){const n=Object.keys(i.zIndexTable).length;for(let s=0;s<n;s++)if(s===e){for(let t=n;t>e;t--)i.zIndexTable[t]=i.zIndexTable[t-1],this.nameTable[i.zIndexTable[t]]&&(this.nameTable[i.zIndexTable[t]].zIndex=t);i.zIndexTable[s]=t.id}}}}initializeDiagramLayers(){for(let e=0;e<this.layers.length;e++)if(-1!==this.layers[e].zIndex){const t=this.layers[e];this.layers[e]=this.layers[this.layers[e].zIndex],this.layers[t.zIndex]=t}for(const e of this.layers)e.zIndex=-1!==e.zIndex?e.zIndex:this.layers.indexOf(e),this.layerZIndexTable[e.zIndex]=e.id;for(let e=0;e<this.layers.length;e++)for(let t=e+1;t<this.layers.length;t++)if(this.layers[e].zIndex>this.layers[t].zIndex){const i=this.layers[e];this.layers[e]=this.layers[t],this.layers[t]=i}0===this.layers.length&&this.commandHandler.addLayer({id:"default_layer",visible:!0,lock:!1,objects:[],zIndex:0,objectZIndex:-1,zIndexTable:{}},null,!0),this.setActiveLayer(this.layers[this.layers.length-1].id)}resetTool(){this.eventHandler.resetTool()}initObjectExtend(e,t,i){if(i){const i=this.commandHandler.checkBoundaryConstraints(void 0,void 0,e.wrapper.bounds);for(let n=0,s=Object.keys(t.zIndexTable);n<s.length;n++)t.zIndexTable[s[n]]&&t.zIndexTable[s[n]]===e.id&&delete t.zIndexTable[s[n]];if(t.zIndexTable[e.zIndex]=e.id,!i){const i=e instanceof pP?this.nodes:this.connectors;for(let t=0;t<=i.length;t++)i[t]&&e.id===i[t].id&&i.splice(t,1);delete t.zIndexTable[e.zIndex]}}}initObject(e,t,i=!0,n){if(void 0!==e){if(i&&(t||(this.addToLayer(e,!1),t=this.activeLayer),(e instanceof pP||e instanceof Vw)&&("SwimLane"!==e.shape.type||e.children&&e.children.length>0)&&this.setZIndex(t,e)),e instanceof pP){if(i){if("helper"!==e.id){const t=hO(this.getNodeDefaults);if(t){const i=t(e,this);if(i&&i.ports)for(let e=0;e<i.ports.length;e++)i.ports[e].inEdges=[],i.ports[e].outEdges=[];i&&i!==e&&KP(i,e)}}this.initNode(e,this.element.id)}}else if(e instanceof Vw){const t=hO(this.getConnectorDefaults);if(t){const i=t(e,this);i&&i!==e&&KP(i,e),e.segments.length&&e.type!==e.segments[0].type&&(e.segments=[])}const n=this.nameTable[e.sourceID],s=this.nameTable[e.targetID],r=this.getConnectedPort(n,e,!0),o=this.getConnectedPort(s,e),a=this.findInOutConnectPorts(n,!1),l=this.findInOutConnectPorts(s,!0);if((void 0!==n&&cx(n)||""!==e.sourcePortID&&dx(a))&&(e.sourceWrapper=this.getEndNodeWrapper(n,e,!0),e.sourcePortID&&r&&r.constraints&&!(r.constraints&sv.None)&&r.constraints&sv.OutConnect&&(e.sourcePortWrapper=this.getWrapper(n.wrapper,e.sourcePortID))),(void 0!==s&&lx(s)||""!==e.targetPortID&&hx(l))&&(e.targetWrapper=this.getEndNodeWrapper(s,e,!1),e.targetPortID&&o&&o.constraints&&!(o.constraints&sv.None)&&o.constraints&sv.InConnect&&(e.targetPortWrapper=this.getWrapper(s.wrapper,e.targetPortID))),!i){const t=e.getConnectorPoints(e.type);sC(e,t)}i&&e.init(this);for(let i=0;i<e.wrapper.children.length;i++)this.pathTable[e.wrapper.children[i].data]&&(e.wrapper.children[i].absoluteBounds=this.pathTable[e.wrapper.children[i].data].absoluteBounds);e.wrapper.measure(new nb(void 0,void 0)),e.wrapper.arrange(e.wrapper.desiredSize),e instanceof Vw&&"Bezier"===e.type&&(this.updateConnectorAnnotation(e),this.updateConnectorfixedUserHandles(e));for(let i=0;i<e.wrapper.children.length;i++)this.pathTable[e.wrapper.children[i].data]={},this.pathTable[e.wrapper.children[i].data].absoluteBounds=e.wrapper.children[i].absoluteBounds}if(e instanceof pP&&e.children&&e.container)for(let t=0;t<e.children.length;t++)this.nameTable[e.children[t]].offsetX=this.nameTable[e.children[t]].wrapper.offsetX,this.nameTable[e.children[t]].offsetY=this.nameTable[e.children[t]].wrapper.offsetY;if(this.bpmnModule&&e instanceof pP&&"Bpmn"===e.shape.type&&e.shape.annotations.length>0&&this.bpmnModule.updateQuad(e,this),this.initObjectExtend(e,t,i),this.nameTable[e.id]=e,e instanceof pP&&e.children){this.preventNodesUpdate=!0,this.preventConnectorsUpdate=!0,n||e.container||this.updateGroupOffset(e,!0),this.groupTable[e.id]=e.children;for(let t=0;t<e.children.length;t++){const i=this.nameTable[e.children[t]];i&&(i.parentId=e.id)}this.isLoading||!e.rotateAngle||e.container||this.commandHandler.rotateObjects(e,[e],e.rotateAngle,{x:e.offsetX,y:e.offsetY},!1),this.preventNodesUpdate=!1,this.preventConnectorsUpdate=!1}void 0===this.enterObject&&this.updateQuad(e)}!1===e.visible&&this.updateElementVisibility(e.wrapper,e,!1)}getConnectedPort(e,t,i){if(e&&e.ports)for(const n of e.ports){if(n.id===t.sourcePortID&&i)return n;if(n.id===t.targetPortID&&!i)return n}return null}scaleObject(e,t,i){const n=i?e.wrapper.actualSize.width:e.wrapper.actualSize.height,s=i?1+(t-n)/n:1,r=i?1:1+(t-n)/n;this.realActions|=ev.PreventDrag,this.scale(e,s,r,{x:.5,y:.5}),this.realActions&=~ev.PreventDrag}updateDefaultLayoutIcons(e){"OrganizationalChart"!==this.layout.type&&"HierarchicalTree"!==this.layout.type&&"ComplexHierarchicalTree"!==this.layout.type||(this.updateDefaultLayoutIcon(e,e.expandIcon),this.updateDefaultLayoutIcon(e,e.collapseIcon))}updateDefaultLayoutIcon(e,t){if("None"!==t.shape&&"Auto"===t.horizontalAlignment&&"Auto"===t.verticalAlignment&&.5===t.offset.x&&1===t.offset.y){const t=this.getWrapper(e.wrapper,"icon_content");let i,n;"TopToBottom"===this.layout.orientation||"BottomToTop"===this.layout.orientation?(i=.5,n="TopToBottom"===this.layout.orientation?1:0):"RightToLeft"!==this.layout.orientation&&"LeftToRight"!==this.layout.orientation||(i="LeftToRight"===this.layout.orientation?1:0,n=.5),t.setOffsetWithRespectToBounds(i,n,"Fraction"),t.horizontalAlignment="Center",t.verticalAlignment="Center",e.wrapper.measure(new nb(e.wrapper.width,e.wrapper.height)),e.wrapper.arrange(e.wrapper.desiredSize)}}updateGroupOffset(e,t){if(e.children&&e.children.length>0&&!e.container||e.processId){const t=this.nameTable[e.id];if(!(this.realActions&ev.PreventScale||this.realActions&ev.PreventDrag)){if(t.offsetX&&(this.realActions&ev.EnableGroupAction||!(this.diagramActions&Jb.UndoRedo||this.diagramActions&Jb.ToolAction||this.diagramActions&Jb.PublicMethod))){this.realActions|=ev.PreventScale;const i=t.offsetX-e.wrapper.offsetX;t.offsetX=e.wrapper.offsetX;const n=t.offsetY-e.wrapper.offsetY;t.offsetY=e.wrapper.offsetY,"None"===e.flip&&i+n!==0&&this.drag(t,i,n),this.realActions&=~ev.PreventScale}else t.offsetX=e.wrapper.offsetX;if(t.offsetY&&(this.realActions&ev.EnableGroupAction||!(this.diagramActions&Jb.UndoRedo||this.diagramActions&Jb.ToolAction||this.diagramActions&Jb.PublicMethod))){this.realActions|=ev.PreventScale;const i=t.offsetY-e.wrapper.offsetY;t.offsetY=e.wrapper.offsetY,"None"===e.flip&&this.drag(t,0,i),this.realActions&=~ev.PreventScale}else t.offsetY=e.wrapper.offsetY;this.diagramActions&&(t.width=e.wrapper.actualSize.width,t.height=e.wrapper.actualSize.height)}}t&&e.children&&e.children.length>0&&(void 0!==this.nameTable[e.id].width?this.scaleObject(e,this.nameTable[e.id].width,!0):this.nameTable[e.id].width=e.wrapper.actualSize.width,void 0!==this.nameTable[e.id].height?this.scaleObject(e,this.nameTable[e.id].height,!1):this.nameTable[e.id].height=e.wrapper.actualSize.height)}initNode(e,t,i){const n=e.initContainer(),s=new lv;let r,o;if(this.diagramSettings.inversedAlignment||(n.inversedAlignment=!1),n.children||(n.children=[]),e.children){n.measureChildren=!1,s.id=e.id+"group_container",s.style.fill="none",s.style.strokeColor="none",s.horizontalAlignment="Stretch",s.verticalAlignment="Stretch",n.style=e.style,s.children=[],s.preventContainer=!0,e.container&&(s.relativeMode="Object");let t=!!(e.ports&&e.ports.length>0);if(jp(e.container)&&!t&&n.children.push(s),e.container&&"Grid"===e.container.type)for(let i=0;i<e.children.length;i++){const t=new lv,s=this.nameTable[e.children[i]];t.children=[],t.children.push(s.wrapper),s&&n.addObject(s.wrapper,s.rowIndex,s.columnIndex,s.rowSpan,s.columnSpan)}else for(let i=0;i<e.children.length;i++)if(this.nameTable[e.children[i]]){const t=this.nameTable[e.children[i]];this.updateStackProperty(e,t,i),n.children.push(t.wrapper),n.elementActions=n.elementActions|Yb.ElementIsGroup,t.wrapper.flip="None"===t.wrapper.flip?e.wrapper.flip:t.wrapper.flip}(t||e.container&&"Grid"!==e.container.type)&&n.children.push(s)}else{const t=hO(this.setNodeTemplate);t&&"helper"!==e.id&&(r=t(e,this)),r||(r=e.init(this)),n.children.push(r)}o=hO(this.getDescription),(e.children?n:r).description=o||(e.annotations.length?e.annotations[0].content:e.id);const a=e.children?s:n;e.initAnnotations(this.getDescription,a,this.element.id,!!gx(this),this.annotationTemplate),e.initPorts(this.getDescription,a),e.initIcons(this.getDescription,this.layout,a,t);for(let l=0;l<e.fixedUserHandles.length;l++){const t=e.initfixedUserHandles(e.fixedUserHandles[l]);a.children.push(t)}if("SwimLane"===e.shape.type&&e.wrapper&&e.wrapper.children.length>0&&e.wrapper.children[0]instanceof Hx){if(this.setZIndex(this.activeLayer,e),this.connectors.length>0)for(let e=0;e<this.connectors.length;e++){let t=this.connectors[e];t.sourceID&&t.targetID&&-1===this.activeLayer.objects.indexOf(t.sourceID)&&-1===this.activeLayer.objects.indexOf(t.targetID)&&this.setZIndex(this.activeLayer,t)}sS(e),function(e,t){const i=t.wrapper.children[0],n=t.shape,s=n.padding,r=n.lanes;let o,a,l=i.bounds.y;const h=n.phaseSize>0?n.phases.length:0;let c,d,p,u,g,m;const f="Horizontal"===n.orientation,y=f?n.phases.length||1:r.length+1;let b=f?(n.header&&n.hasHeader?1:0)+(n.phases.length>0?1:0)+n.lanes.length:(n.header&&n.hasHeader?1:0)+n.phases.length;if(0===h&&!f&&n.lanes.length&&(b+=1),f?(o=(n.header&&n.hasHeader?1:0)+(h>0?1:0),a=0):(o=n.header&&n.hasHeader?1:0,a=h>0?1:0),r.length>0)for(l+=n.header&&n.hasHeader?n.header.height:0,u=0;u<r.length;u++){for(g=0;g<r[u].children.length;g++)if(c=r[u].children[g],c.offsetX=r[u].width,c.offsetY=r[u].height,e.initObject(c),e.nodes.push(c),d=c.wrapper,f){for(m=a;m<y;m++)if(p=i.rows[o].cells[m],d.margin.left<p.bounds.right-i.bounds.x){c.parentId=p.children[0].id,m>a?d.margin.left=d.margin.left-(p.bounds.left-i.bounds.left):p.children[0].children[1].actualSize.width+s>=d.margin.left&&(d.margin.left=p.children[0].children[1].actualSize.width+s),d.margin.left<s&&(d.margin.left=s),d.margin.top<s&&(d.margin.top=s),oS(d,c,e);break}}else for(let t=o;t<b;t++)if(p=i.rows[t].cells[a],d.margin.top<p.bounds.bottom-l){c.parentId=p.children[0].id,t>o?d.margin.top=d.margin.top-(p.bounds.top-l):p.children[0].children[1].actualSize.height+s>=d.margin.top&&(d.margin.top=p.children[0].children[1].actualSize.height+s),d.margin.left<s&&(d.margin.left=s),d.margin.top<s&&(d.margin.top=s),oS(d,c,e);break}f?o++:a++}i.measure(new nb(t.width,t.height)),i.arrange(i.desiredSize),function(e,t){const i=e.columnDefinitions(),n=e.rowDefinitions();let s,r,o,a,l,h,c=pS(t);"Vertical"===t.shape.orientation&&0===c&&(c=t.shape.header&&t.shape.hasHeader?1:0);const d=t.shape.padding;for(s=0;s<i.length;s++)e.updateColumnWidth(s,i[s].width,!0,d);for(s=c;s<n.length;s++)e.updateRowHeight(s,n[s].height,!0,d);for(r=0;r<n.length;r++)for(h=e.rows[r],s=0;s<i.length;s++)if(a=h.cells[s],a.children&&a.children.length>0)for(o=0;o<a.children.length;o++)l=a.children[o],l.maxWidth&&(l.maxWidth=a.actualSize.width),l.maxHeight&&(l.maxHeight=a.actualSize.height)}(i,t),t.width=t.wrapper.width=i.width,t.height=t.wrapper.height=i.height,gS(e,t),t.wrapper.measure(new nb(t.width,t.height)),t.wrapper.arrange(i.desiredSize),function(e){if("SwimLane"===e.shape.type){const t=e.shape.lanes;let i,n;for(let e=0;e<t.length;e++){i=t[e];for(let e=0;e<i.children.length;e++)n=i.children[e],n.offsetX=n.wrapper.offsetX,n.offsetY=n.wrapper.offsetY}}}(t),lS(t,e),aS(t)}(this,e),this.updateDiagramElementQuad()}else n.measure(new nb(e.width,e.height),e.id,this.onLoadImageSize.bind(this)),n instanceof Hx?n.arrange(n.desiredSize,!0):n.arrange(n.desiredSize);"None"!==e.wrapper.flip&&e.wrapper.elementActions&Yb.ElementIsGroup&&wC(e.wrapper,e.wrapper.offsetX,e.wrapper.offsetY,this,e.wrapper.flip),e instanceof pP&&e.container&&(e.width<n.outerBounds.width||e.height<n.outerBounds.height)&&n.bounds.x<=n.outerBounds.x&&n.bounds.y<=n.outerBounds.y&&(e.width=n.width=n.outerBounds.width,e.height=n.height=n.outerBounds.height,n.measure(new nb(e.width,e.height)),n.arrange(n.desiredSize)),e.container&&"Grid"===e.container.type&&e.children&&e.children.length>0&&this.updateChildPosition(e)}updateDiagramElementQuad(){for(let e=0;e<this.nodes.length;e++)this.nodes[e].wrapper&&this.nodes[e].wrapper instanceof ov&&this.updateQuad(this.nodes[e])}onLoadImageSize(e,t){const i=this.getObject(e),n=document.getElementById(e+"sf-imageNode");n&&n.parentNode.removeChild(n),this.nodePropertyChange(i,{},{width:t.width,height:t.height});const s={element:QP(i),size:t};this.triggerEvent(nv.onImageLoad,s)}updateChildPosition(e){for(let t=0;t<e.children.length;t++){const i=this.getObject(e.children[t]);i.offsetX=i.wrapper.offsetX,i.offsetY=i.wrapper.offsetY,i.children&&i.children.length>0&&this.updateChildPosition(i)}}canExecute(){return!0}updateStackProperty(e,t,i){e.container&&"Stack"===e.container.type&&(t.width||(t.wrapper.horizontalAlignment="Stretch",t.horizontalAlignment="Stretch"),t.height||(t.verticalAlignment="Stretch",t.wrapper.verticalAlignment="Stretch"),i&&"UmlClassifier"===e.shape.type&&(t.umlIndex=i))}initViews(){this.isLoading||(this.views.push(this.element.id),this.views[this.element.id]=this)}initCommands(){const e=this.commandManager.commands,t={copy:{execute:this.copyCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Qb.C,keyModifiers:$b.Control}},paste:{execute:this.pasteCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Qb.V,keyModifiers:$b.Control}},cut:{execute:this.cutCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Qb.X,keyModifiers:$b.Control}},delete:{execute:this.removeCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Qb.Delete}},selectAll:{execute:this.selectAll.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Qb.A,keyModifiers:$b.Control}},undo:{execute:this.undo.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Qb.Z,keyModifiers:$b.Control}},redo:{execute:this.redo.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Qb.Y,keyModifiers:$b.Control}},nudgeUp:{execute:this.nudgeCommand.bind(this,"Up"),canExecute:this.canExecute.bind(this),gesture:{key:Qb.Up},parameter:"up"},nudgeRight:{execute:this.nudgeCommand.bind(this,"Right"),canExecute:this.canExecute.bind(this),gesture:{key:Qb.Right},parameter:"right"},nudgeDown:{execute:this.nudgeCommand.bind(this,"Down"),canExecute:this.canExecute.bind(this),gesture:{key:Qb.Down},parameter:"down"},nudgeLeft:{execute:this.nudgeCommand.bind(this,"Left"),canExecute:this.canExecute.bind(this),gesture:{key:Qb.Left},parameter:"left"},startEdit:{execute:this.startEditCommad.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Qb.F2}},endEdit:{execute:this.endEditCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Qb.Escape}},focusToNextItem:{canExecute:this.canExecute.bind(this),gesture:{key:Qb.Tab}},focusToPreviousItem:{canExecute:this.canExecute.bind(this),gesture:{key:Qb.Tab,keyModifiers:$b.Control}},selectFocusedItem:{execute:this.startEditCommad.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:Qb.Enter}}};this.initCommandManager(e,t)}overrideCommands(e,t){let i;for(const n of Object.keys(t))if(i=t[n],e.gesture.key===i.gesture.key&&e.gesture.keyModifiers===i.gesture.keyModifiers){delete t[n];break}}initCommandManager(e,t){let i=0;if(e)for(i=0;i<e.length;i++)t[e[i].name]&&e[i]?(e[i].canExecute&&(t[e[i].name].canExecute=e[i].canExecute),e[i].execute&&(t[e[i].name].execute=e[i].execute),(e[i].gesture.key||e[i].gesture.keyModifiers)&&(t[e[i].name].gesture=e[i].gesture),""!==e[i].parameter&&(t[e[i].name].parameter=e[i].parameter)):(this.overrideCommands(e[i],t),t[e[i].name]={execute:e[i].execute,canExecute:e[i].canExecute,gesture:e[i].gesture,parameter:e[i].parameter});this.commands=t}updateNodeEdges(e){for(const t of e.inEdges)this.nameTable[t]&&(this.nameTable[t].targetID="");for(const t of e.outEdges)this.nameTable[t]&&(this.nameTable[t].sourceID="");e.inEdges=[],e.outEdges=[]}updateIconVisibility(e,t){for(let i=0;i<e.wrapper.children.length;i++){const n=e.wrapper.children[i];if(n.id){const i=n.id.split(e.id)[1];i&&i.match("^_icon")&&(n.visible=t,this.updateDiagramContainerVisibility(n,t))}}}updateEdges(e){if(void 0!==e.sourceID&&""!==e.sourceID){const t=this.nameTable[e.sourceID];t&&t.outEdges&&0===t.outEdges.length&&(t.outEdges=[]),t&&t.outEdges&&-1===t.outEdges.indexOf(e.id)&&t.outEdges.push(e.id),this.updatePortEdges(t,e,!1)}if(void 0!==e.targetID&&""!==e.targetID){const t=this.nameTable[e.targetID];t&&t.inEdges&&0===t.inEdges.length&&(t.inEdges=[]),t&&t.inEdges&&-1===t.inEdges.indexOf(e.id)&&t.inEdges.push(e.id),this.updatePortEdges(t,e,!0),t&&t.visible&&t.outEdges&&this.updateIconVisibility(t,0!==t.outEdges.length)}}updatePortEdges(e,t,i){if(e)for(let n=0;n<e.ports.length;n++){const s=e.ports[n];if(s.id===(i?t.targetPortID:t.sourcePortID)){const e=i?s.inEdges:s.outEdges;-1===e.indexOf(t.id)&&e.push(t.id)}}}refreshDiagram(){this.initLayerObjects(),this.doLayout(),this.updateBridging(),this.scroller.setSize(),this.addBlazorDiagramObjects(),this.updateFitToPage()}updateCanupdateStyle(e,t){for(let i=0;i<e.length;i++)e[i].children&&this.updateCanupdateStyle(e[i].children,t),e[i].canApplyStyle=t}getZindexPosition(e,t){let i,n,s=[];if(s=s.concat(this.nodes),s=s.concat(this.connectors),-1!==e.zIndex)for(let r=0;r<s.length;r++)if(s[r].zIndex>e.zIndex){"HTML"!==e.shape.type&&"Native"!==e.shape.type||(n="HTML"===e.shape.type?"html":"native"),i=OP(t,s[r].id,n);break}return i}updateDiagramObject(e,t,i){let n;for(const s of this.views)if(n=this.views[s],this.diagramActions&&"SVG"===n.mode){let s;if(this.layers.length>1&&(s=this.commandHandler.getObjectLayer(e.id)),void 0===s||s&&s.visible||i){const i=LP(this.element.id);window.domTable[n.element.id+"_diagramLayer"]||(window.domTable[n.element.id+"_diagramLayer"]=document.getElementById(n.element.id+"_diagramLayer"));const s=window.domTable[n.element.id+"_diagramLayer"];this.diagramActions&Jb.Interactions&&this.updateCanupdateStyle(e.wrapper.children,!0),this.diagramRenderer.updateNode(e.wrapper,s,i,void 0,t?void 0:this.getZindexPosition(e,n.element.id)),this.updateCanupdateStyle(e.wrapper.children,!0)}}}updateGridContainer(e){let t;const i=LP(this.element.id);for(const n of this.views)if(t=this.views[n],"SVG"===t.mode&&this.diagramActions){const n=document.getElementById(t.element.id+"_diagramLayer");this.diagramRenderer.updateNode(e,n,i,void 0)}else this.refreshCanvasDiagramLayer(t)}getObjectsOfLayer(e){const t=[];for(const i of e)this.nameTable[i]&&t.push(this.nameTable[i]);return t}refreshDiagramLayer(){let e;for(const t of this.views)switch(e=this.views[t],e.mode){case"SVG":this.refreshSvgDiagramLayer(e);break;case"Canvas":this.refreshCanvasLayers(e)}}refreshCanvasLayers(e){if(e)this.refreshCanvasDiagramLayer(e);else for(const t of this.views)this.refreshCanvasDiagramLayer(this.views[t])}renderBasicElement(e){const t=LP(e.element.id);for(let i=0;i<this.basicElements.length;i++){const n=this.basicElements[i];n instanceof ov&&(n.prevRotateAngle=0),n.measure(new nb(n.width,n.height)),n.arrange(n.desiredSize),e.diagramRenderer.renderElement(n,e.diagramLayer,t)}}refreshElements(t){if(!this.isDestroyed){this.clearCanvas(t),t instanceof e?(t.diagramLayer.getContext("2d").setTransform(t.scroller.currentZoom,0,0,t.scroller.currentZoom,0,0),t.diagramLayer.getContext("2d").scale(1.5,1.5)):document.getElementById(t.element.id+"_nativeLayer").children.length>0&&t.updateView(t);const i=LP(t.element.id);this.renderDiagramElements(t.diagramLayer,t.diagramRenderer,i);for(let e=0;e<this.basicElements.length;e++){const n=this.basicElements[e];n.measure(new nb(n.width,n.height)),n.arrange(n.desiredSize),t.diagramRenderer.renderElement(n,t.diagramLayer,i)}t instanceof e&&(t.diagramLayer.style.transform="scale("+2/3+")",t.diagramLayer.style.transformOrigin="0 0"),this.renderTimer=null}}refreshCanvasDiagramLayer(e){"SVG"===e.mode||this.isDestroyed||(this.basicElements.length>0&&this.renderBasicElement(e),!this.diagramActions||0==(this.diagramActions&Jb.Render)||Jb.ToolAction&this.diagramActions||gx(this)||1!==this.scroller.currentZoom?this.refreshElements(e):this.renderTimer||(this.renderTimer=setTimeout(()=>{this.refreshElements(e)},40)))}updatePortVisibility(e,t,i){let n;if(e instanceof pP&&(!this.drawingObject||!this.drawingObject.shape)&&ex(e)){const s=e.ports;let r=!1;for(let o=0;o<s.length;o++)n=this.getWrapper(e.wrapper,s[o].id),(t&Nb.Hover||t&Nb.Connect)&&lC(s[o],t)&&(n.visible=!i,r=!0);r&&this.updateDiagramObject(e)}}refreshSvgDiagramLayer(e){let t;const i=document.getElementById(e.element.id+"_diagramLayer"),n=LP(e.element.id);if(gx(this))this.scroller.virtualizeElements();else{for(let e=0;e<this.basicElements.length;e++)t=this.basicElements[e],t.measure(new nb(t.width,t.height)),t.arrange(t.desiredSize,!(this.diagramActions&Jb.Render)),this.diagramRenderer.renderElement(t,i,n);this.renderDiagramElements(i,this.diagramRenderer,n)}}removeVirtualObjects(e){if(this.deleteVirtualObject){for(let e=0;e<this.scroller.removeCollection.length;e++)this.removeElements(this.nameTable[this.scroller.removeCollection[e]]);this.deleteVirtualObject=!1}clearInterval(e)}updateTextElementValue(e){for(let t=0;t<e.wrapper.children.length;t++){const i=e.wrapper.children[t];i instanceof av&&(i.canMeasure=!0,i.measure(new nb(e.width,e.height)),i.arrange(i.desiredSize))}}updateVirtualObjects(e,t,i){const n=document.getElementById(this.element.id+"_diagramLayer"),s=LP(this.element.id);if("SVG"===this.mode){for(let t=0;t<e.length;t++){const i=this.scroller.removeCollection.indexOf(e[t]);i>=0&&this.scroller.removeCollection.splice(i,1);const r=this.nameTable[e[t]];this.updateTextElementValue(r),this.diagramRenderer.renderElement(r.wrapper,n,s,void 0,void 0,void 0,void 0,r.zIndex)}for(let e=0;e<i.length;e++)this.scroller.removeCollection.push(i[e]);1!==this.scroller.currentZoom&&this.eventHandler.updateVirtualization()}else this.diagramActions&&this.refreshDiagramLayer()}renderDiagramElements(e,t,i,n=!0,s,r){const o=this.scroller.getPageBounds();o.x*=this.scroller.currentZoom,o.y*=this.scroller.currentZoom,o.width*=this.scroller.currentZoom,o.height*=this.scroller.currentZoom;const a=-this.scroller.horizontalOffset-o.x,l=-this.scroller.verticalOffset-o.y;for(const h of Object.keys(this.layerZIndexTable)){const c=this.commandHandler.getLayer(this.layerZIndexTable[h]);let d,p;"Canvas"===this.mode&&gx(this)&&!this.diagramActions&&this.scroller.virtualizeElements();const u="Canvas"===this.mode&&gx(this)&&this.scroller.oldCollectionObjects.length>0?this.scroller.oldCollectionObjects:void 0;for(const h of Object.keys(u||c.zIndexTable)){const g=u?this.nameTable[u[h]]:this.nameTable[c.zIndexTable[h]];if(g&&!g.parentId&&c.visible&&(!g.processId||this.refreshing)){const h={tx:this.scroller.transform.tx,ty:this.scroller.transform.ty,scale:this.scroller.transform.scale};if(gx(this)){if(this.scroller.currentZoom<1){if(o.x<0||this.scroller.horizontalOffset<0){const e=this.scroller.verticalOffset<0?this.scroller.verticalOffset:0;d=(a>0?a:0)+"px",p=(this.realActions&ev.vScrollbarMoved?0:-e)+"px"}else d="0px",p="0px";this.realActions&ev.hScrollbarMoved&&(this.realActions=this.realActions&~ev.hScrollbarMoved),this.realActions&ev.vScrollbarMoved&&(this.realActions=this.realActions&~ev.vScrollbarMoved)}else d=(o.x<0?a:-this.scroller.horizontalOffset)+"px",p=(o.y<0?l:-this.scroller.verticalOffset)+"px";this.diagramLayer.style.left=d,this.diagramLayer.style.top=p,h.tx=this.scroller.horizontalOffset/h.scale,h.ty=this.scroller.verticalOffset/h.scale}let c=!0;if(s&&(c=!1),this.updateTextElementValue(g),this.refreshing&&g.shape.activity&&g.shape.activity.subProcess&&g.shape.activity.subProcess.processes){for(let e=0;e<g.shape.activity.subProcess.processes.length;e++)g.wrapper.children.push(this.nameTable[g.shape.activity.subProcess.processes[e]].wrapper);g.wrapper.measure(new nb(g.wrapper.bounds.width,g.wrapper.bounds.height)),g.wrapper.arrange(g.wrapper.desiredSize)}t.renderElement(g.wrapper,e,i,!t.isSvgMode&&n?h:void 0,void 0,void 0,c&&(!this.diagramActions||r))}}}}updateBridging(e){if(this.bridgingModule)for(let t=0;t<this.connectors.length;t++){const i=this.connectors[t];this.bridgingModule.updateBridging(i,this);const n=this.connectors[t].wrapper;if(n){const t=n.children[0],s=t.data;i.getSegmentElement(i,t,"ComplexHierarchicalTree"===this.layout.type||"HierarchicalTree"===this.layout.type?this.layout.orientation:void 0,void 0,!1),t.data!==s&&(n.measure(new nb),n.arrange(n.desiredSize),"SVG"!==this.mode||e||this.updateDiagramObject(i))}}}setCursor(e){this.diagramRenderer.setCursor(this.diagramCanvas,e)}clearCanvas(e){const t=e.contentWidth||e.diagramLayer.width/this.scroller.currentZoom,i=e.contentHeight||e.diagramLayer.height/this.scroller.currentZoom;"SVG"!==e.mode&&cO.getContext(e.diagramLayer).clearRect(0,0,t,i)}updateScrollOffset(){this.scroller.setScrollOffset(this.diagramCanvas.scrollLeft,this.diagramCanvas.scrollTop),qw(this),gx(this)&&this.scroller.virtualizeElements()}setOffset(e,t){window.domTable[this.element.id+"content"]||(window.domTable[this.element.id+"content"]=document.getElementById(this.element.id+"content"));const i=window.domTable[this.element.id+"content"];i&&(i.scrollLeft=e,i.scrollTop=t)}setSize(e,t){if(this.diagramLayer&&!this.preventDiagramUpdate){const i=$w(this);e-=i.width,t-=i.height;const n=this.spatialSearch.getPageBounds();n.x*=this.scroller.currentZoom,n.y*=this.scroller.currentZoom,n.width*=this.scroller.currentZoom,n.height*=this.scroller.currentZoom;const s="SVG"===this.mode?1:1.5,r="SVG"===this.mode?CP(this.element.id):this.diagramLayer,o="Canvas"===this.mode&&this.constraints&Gb.Virtualization?this.scroller.viewPortHeight:t;r.setAttribute("width",(s*("Canvas"===this.mode&&this.constraints&Gb.Virtualization?this.scroller.viewPortWidth:e)).toString()),r.setAttribute("height",(s*o).toString());const a=document.getElementById(this.element.id+"_diagramUserHandleLayer");a&&(a.style.width=e+"px",a.style.height=t+"px");const l={width:e.toString(),height:t.toString()};this.diagramLayerDiv.style.width=e+"px",this.diagramLayerDiv.style.height=t+"px",WP(DP(this.element.id),l),WP(function(e){let t=null;return t=PP(e).getElementsByClassName("e-ports-expand-layer")[0],t}(this.element.id),l);const h=TP(this.element.id);WP(h,l),h.parentNode.style.width=e+"px",h.parentNode.style.height=t+"px";const c=MP(this.element.id);WP(c,l),this.diagramRenderer.updateGrid(this.snapSettings,c,this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),WP(RP(this.element.id),l),this.htmlLayer.style.width=e+"px",this.htmlLayer.style.height=t+"px","SVG"===this.mode||gx(this)||this.refreshDiagramLayer(),"SVG"===this.mode&&gx(this)&&this.scroller.virtualizeElements()}}transformLayers(){const e=this.spatialSearch.getPageBounds();e.x*=this.scroller.currentZoom,e.y*=this.scroller.currentZoom,e.width*=this.scroller.currentZoom,e.height*=this.scroller.currentZoom,this.diagramRenderer.updateGrid(this.snapSettings,MP(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),this.diagramRenderer.transformLayers(this.scroller.transform,"SVG"===this.mode),this.diagramActions&Jb.DragUsingMouse||this.updateSelector(),this.renderPageBreaks(e)}removePageBreaks(){if(this.diagramLayer){const e=zP(this.element.id);if(e&&e.childNodes){const t=e.childNodes.length;for(let i=0;i<t;i++)e.removeChild(e.childNodes[0])}}}renderPageBreaks(e){this.removePageBreaks();const t=zP(this.element.id);if(t){let i=0;e=this.scroller.getPageBounds(!0);const n=(this.scroller.transform.tx+e.x)*this.scroller.currentZoom,s=(this.scroller.transform.ty+e.y)*this.scroller.currentZoom,r=e.height*this.scroller.currentZoom,o=e.width*this.scroller.currentZoom;if(pO.renderSvgBackGroundImage(this.pageSettings.background,this.element,n,s,o,r),this.diagramRenderer.drawRect(t,{id:t.id+"rect",x:n,y:s,height:r,width:o,angle:0,stroke:"",strokeWidth:1,fill:this.pageSettings.background.color,opacity:1,pivotX:0,pivotY:0,visible:!0,dashArray:"0"}),this.pageSettings.showPageBreaks){const n=this.scroller.getPageBreak(e);for(i=0;i<n.length;i++)this.diagramRenderer.drawLine(t,{class:"e-diagram-page-break",fill:"none",stroke:"#aaaaaa",strokeWidth:1,dashArray:"10 10",opacity:2,x:0,y:0,width:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,startPoint:{x:(n[i].x1+this.scroller.transform.tx)*this.scroller.currentZoom,y:(n[i].y1+this.scroller.transform.ty)*this.scroller.currentZoom},endPoint:{x:(n[i].x2+this.scroller.transform.tx)*this.scroller.currentZoom,y:(n[i].y2+this.scroller.transform.ty)*this.scroller.currentZoom},id:n[i].y1===n[i].y2?"HorizontalLines":"VerticalLines"})}}}validatePageSize(){let e=0;"Portrait"===this.pageSettings.orientation?this.pageSettings.width>this.pageSettings.height&&(e=this.pageSettings.height,this.pageSettings.height=this.pageSettings.width,this.pageSettings.width=e):this.pageSettings.height>this.pageSettings.width&&(e=this.pageSettings.width,this.pageSettings.width=this.pageSettings.height,this.pageSettings.height=e)}setOverview(e,t){if(e)e&&(this.views.push(e.id),this.views[e.id]=e,e.renderDocument(e),e.diagramRenderer.setLayers(),e.updateView(e),this.renderNodes(e));else{for(let n=0;n<this.views.length;n++)this.views[n]===t&&(e=this.views[t]);this.views[t]=void 0;const i=this.views.indexOf(t);this.views.splice(i,1)}}renderNodes(e){if(e){const t=new pO(e.id,new dO,!1),i=document.getElementById(e.element.id+"_diagramLayer"),n=LP(e.element.id);this.renderDiagramElements(i,e.diagramRenderer||t,n,void 0,void 0,!0)}}updateThumbConstraints(e,t,i){const n=e.length;for(let s=0;s<n;s++){const n=e[s];let r=!1,o=!1,a=t.thumbsConstraints;n instanceof pP?(r="Bpmn"===n.shape.type&&"Activity"===n.shape.shape&&!1===n.shape.activity.subProcess.collapsed||"TextAnnotation"===n.shape.shape,o="Bpmn"===n.shape.type&&"TextAnnotation"===n.shape.shape,ox(n)&&a&Xb.Rotate&&!r||(a&=~Xb.Rotate),px(n,"SouthEast")&&a&Xb.ResizeSouthEast&&!o||(a&=~Xb.ResizeSouthEast),px(n,"NorthWest")&&a&Xb.ResizeNorthWest&&!o||(a&=~Xb.ResizeNorthWest),px(n,"East")&&a&Xb.ResizeEast&&!o||(a&=~Xb.ResizeEast),px(n,"West")&&a&Xb.ResizeWest&&!o||(a&=~Xb.ResizeWest),px(n,"North")&&a&Xb.ResizeNorth&&!o||(a&=~Xb.ResizeNorth),px(n,"South")&&a&Xb.ResizeSouth&&!o||(a&=~Xb.ResizeSouth),px(n,"NorthEast")&&a&Xb.ResizeNorthEast&&!o||(a&=~Xb.ResizeNorthEast),px(n,"SouthWest")&&a&Xb.ResizeSouthWest&&!o||(a&=~Xb.ResizeSouthWest)):n instanceof Vw?(i||(a|=Xb.Default),nx(n)?a|=Xb.ConnectorSource:a&=~Xb.ConnectorSource,sx(n)?a|=Xb.ConnectorTarget:a&=~Xb.ConnectorTarget):(i||(a|=Xb.Default),px(n)||(a&=~(Xb.ResizeSouthEast|Xb.ResizeSouthWest|Xb.ResizeSouth|Xb.ResizeEast|Xb.ResizeWest|Xb.ResizeNorth|Xb.ResizeNorthEast|Xb.ResizeNorthWest)),ox(n)||(a&=~Xb.Rotate)),t.thumbsConstraints=a}}renderSelector(e,t){const i=this.isProtectedOnChange,n=new nb,s=this.selectedItems,r=this.diagramRenderer.rendererActions;let o,a;if(document.getElementsByClassName("blazor-inner-template"),this.diagramRenderer.rendererActions=this.currentSymbol?this.addConstraints(r,Kb.DrawSelectorBorder):this.removeConstraints(r,Kb.DrawSelectorBorder),this.clearSelectorLayer(),this.commandHandler.hasSelection()){if(1===s.nodes.length&&0===s.connectors.length&&(s.rotateAngle=s.nodes[0].rotateAngle,s.pivot=s.nodes[0].pivot),s.wrapper.measure(n),s.wrapper.arrange(s.wrapper.desiredSize),s.width=s.wrapper.actualSize.width,s.height=s.wrapper.actualSize.height,s.offsetX=s.wrapper.offsetX,s.offsetY=s.wrapper.offsetY,0!==s.rotateAngle){for(const e of s.nodes)e.offsetX=e.wrapper.offsetX,e.offsetY=e.wrapper.offsetY;for(const e of s.connectors);}this.spatialSearch.getPageBounds();const e=EP(this.element.id),i=IP(this.element.id);if(s.thumbsConstraints=Xb.Default,s.annotation?this.updateThumbConstraints([s.annotation],s):(this.updateThumbConstraints(s.nodes,s),this.updateThumbConstraints(s.connectors,s,!0)),s.annotation)this.renderSelectorForAnnotation(s,e);else if(s.nodes.length+s.connectors.length===1||this.nameTable.helper){if(s.nodes[0]instanceof pP){const i=s.nodes[0];Yx(this,i)&&(t||"UmlClassifier"===i.shape.type||i.parentId&&this.nameTable[i.parentId]&&"UmlClassifier"===this.nameTable[i.parentId].shape.type||((!i.container||"Canvas"!==i.container.type&&"Grid"!==i.container.type)&&(s.nodes[0].constraints&=~(Vb.Rotate|Vb.HideThumbs)),s.thumbsConstraints&=~Xb.Rotate));const n=!!t||!!(i.constraints&Vb.HideThumbs),r=!!("SwimLane"===i.shape.type||i.isLane||i.isPhase||t);this.diagramRenderer.renderResizeHandle(s.wrapper.children[0],e,s.thumbsConstraints,this.scroller.currentZoom,s.constraints,this.scroller.transform,void 0,ex(i),n,r)}else if(s.connectors[0]instanceof Vw&&Tx(this.diagramRenderer.rendererActions)){const t=s.connectors[0];this.diagramRenderer.renderEndPointHandle(t,e,s.thumbsConstraints,s.constraints,this.scroller.transform,void 0!==t.sourceWrapper,void 0!==t.targetWrapper,!(!this.connectorEditingToolModule||!rx(t)))}}else this.diagramRenderer.renderResizeHandle(s.wrapper,e,s.thumbsConstraints,this.scroller.currentZoom,s.constraints,this.scroller.transform,void 0,ex(s));if(!s.annotation&&!this.currentSymbol&&(this.diagramRenderer.renderUserHandler(s,e,this.scroller.transform,i),0))for(o=0;o<this.selectedItems.userHandles.length;o++)a=document.getElementById(this.selectedItems.userHandles[o].name+"_html_element"),a.style.display="block"}this.isProtectedOnChange=i}updateSelector(){const e=this.allowServerDataBinding;this.enableServerDataBinding(!1);const t=new nb,i=this.selectedItems,n=i.constraints;let s,r;if(document.getElementsByClassName("blazor-inner-template"),this.diagramActions&Jb.ToolAction||1!==this.selectedItems.nodes.length||(this.selectedItems.rotateAngle=this.selectedItems.nodes[0].rotateAngle,this.selectedItems.wrapper.rotateAngle=this.selectedItems.nodes[0].rotateAngle),void 0!==this.selectedItems&&(this.clearSelectorLayer(),null!==i.wrapper&&i.wrapper.children&&i.wrapper.children.length)){let e=!0,o=!0;if(IC(this,i)){let t=this.eventHandler.action,i=t.includes("Rotate"),n=t.includes("None")||t.includes("Select")||t.includes("Drag");(i||n)&&(o=!1),n||(e=!1)}if(e&&(i.wrapper.measure(t),i.wrapper.arrange(i.wrapper.desiredSize)),0!==i.rotateAngle||i.rotateAngle!==i.wrapper.prevRotateAngle)for(const t of i.nodes)t.offsetX=t.wrapper.offsetX,t.offsetY=t.wrapper.offsetY;i.width=i.wrapper.actualSize.width,i.height=i.wrapper.actualSize.height,i.offsetX=i.wrapper.offsetX,i.offsetY=i.wrapper.offsetY;const a=EP(this.element.id),l=IP(this.element.id),h=this.eventHandler.canHideResizers();if(i.thumbsConstraints=Xb.Default,i.annotation?this.updateThumbConstraints([i.annotation],i):(this.updateThumbConstraints(i.nodes,i),this.updateThumbConstraints(i.connectors,i,!0)),this.selectedItems.constraints&Wb.UserHandle&&!i.annotation&&!this.currentSymbol&&(this.diagramRenderer.renderUserHandler(i,a,this.scroller.transform,l),0))for(s=0;s<this.selectedItems.userHandles.length;s++)r=document.getElementById(this.selectedItems.userHandles[s].name+"_html_element"),r.style.display="block";if(i.annotation)this.renderSelectorForAnnotation(i,a);else if(i.nodes.length+i.connectors.length===1){if(i.connectors[0]instanceof Vw&&Tx(this.diagramRenderer.rendererActions)){const e=i.connectors[0];this.diagramRenderer.renderEndPointHandle(e,a,i.thumbsConstraints,n,this.scroller.transform,void 0!==e.sourceWrapper,void 0!==e.targetWrapper,!(!this.connectorEditingToolModule||!rx(e)))}else if(i.nodes[0]instanceof pP){const e=i.nodes[0];Yx(this,i.nodes[0])&&("UmlClassifier"===e.shape.type||e.parentId&&this.nameTable[e.parentId]&&"UmlClassifier"===this.nameTable[e.parentId].shape.type||((!e.container||"Canvas"!==e.container.type&&"Grid"!==e.container.type)&&(i.nodes[0].constraints&=~(Vb.HideThumbs|Vb.Rotate)),i.thumbsConstraints&=~Xb.Rotate));const t=!("SwimLane"!==e.shape.type&&!e.isLane&&!e.isPhase);this.diagramRenderer.renderResizeHandle(i.wrapper.children[0],a,i.thumbsConstraints,this.scroller.currentZoom,i.constraints,this.scroller.transform,h,ex(i.nodes[0]),!!(i.nodes[0].constraints&Vb.HideThumbs),t)}}else this.diagramActions&Jb.Interactions&&(this.diagramRenderer.rendererActions=this.diagramRenderer.rendererActions|Kb.PreventRenderSelector),IC(this,i)&&o||this.diagramRenderer.renderResizeHandle(i.wrapper,a,i.thumbsConstraints,this.scroller.currentZoom,i.constraints,this.scroller.transform,h,ex(i)),this.diagramRenderer.rendererActions=this.diagramRenderer.rendererActions&~Kb.PreventRenderSelector}this.enableServerDataBinding(e)}renderSelectorForAnnotation(e,t){this.diagramRenderer.renderResizeHandle(e.wrapper.children[0],t,e.thumbsConstraints,this.scroller.currentZoom,e.constraints,this.scroller.transform,void 0,ex(e.annotation))}drawSelectionRectangle(e,t,i,n){this.clearSelectorLayer(),this.diagramRenderer.drawSelectionRectangle(e,t,i,n,this.adornerLayer,this.scroller.transform)}renderHighlighter(e){const t=TP(this.element.id);this.diagramRenderer.renderHighlighter(e,t,this.scroller.transform)}clearHighlighter(){const e=TP(this.element.id),t=e.getElementById(e.id+"_highlighter");t&&t.parentNode.removeChild(t)}getNodesConnectors(e){for(let t=0;t<this.nodes.length;t++)e.push(this.nodes[t]);for(let t=0;t<this.connectors.length;t++)e.push(this.connectors[t]);return e}clearSelectorLayer(){const e=TP(this.element.id);let t;if(document.getElementsByClassName("blazor-inner-template"),this.currentSymbol){const t=e.getElementById("borderRect_symbol");t&&t.parentNode.removeChild(t)}else{const i=e.getElementById(this.adornerLayer.id+"_selected_region");i&&i.parentNode.removeChild(i),this.clearHighlighter();const n=EP(this.element.id).childNodes;let s;for(let e=n.length;e>0;e--)s=n[e-1],s.parentNode.removeChild(s);{const e=IP(this.element.id).childNodes;for(t=e.length;t>0;t--)e[t-1].parentNode.removeChild(e[t-1])}}}getWrapper(e,t){let i;t=e.id+"_"+t;const n=e instanceof lv?e:this.getPortContainer(this.nameTable[e.id]);for(let s=0;s<n.children.length;s++)t===n.children[s].id&&(i=n.children[s]);return i}getEndNodeWrapper(e,t,i){if("Bpmn"===e.shape.type&&e.wrapper.children[0]instanceof lv){if("Activity"===e.shape.shape){if(i&&"Transaction"===e.shape.activity.subProcess.type&&t.sourcePortID){const i=t.sourcePortID,n=e.wrapper.children[0].children[0].children[2];if(n.children)for(const t of n.children)if(t.visible&&t.id===e.id+"_"+i)return t.children[0]}return e.wrapper.children[0].children[0].children[0]}return e.wrapper.children[0].children[0]}return this.containsMargin(e.wrapper.children[0])||e.children?e.wrapper:e.wrapper.children[0]}containsMargin(e){return e.margin&&(0!==e.margin.left||0!==e.margin.top||0!==e.margin.right||0!==e.margin.bottom)}focusOutEdit(){this.endEdit()}endEditCommand(){this.endEdit(),this.textEditing=!1}endEdit(){return vT(this,void 0,void 0,function*(){if(this.diagramActions&Jb.TextEdit){let e,t;const i={};this.enableServerDataBinding(!1);const n=document.getElementById(this.element.id+"_editBox");{let s=n.value;xu.remove(n,"input",this.eventHandler.inputChange),xu.remove(n,"focusout",this.focusOutEdit);const r=document.getElementById(this.element.id+"_editTextBoxDiv");let o;o=this.nameTable[this.activeLabel.parentId];const a=hC(o,this.activeLabel.id);let l,h={oldValue:this.activeLabel.text,newValue:s,cancel:!1,element:o,annotation:a},c=!1;if(r.parentNode.removeChild(r),this.bpmnModule&&(o=this.bpmnModule.isBpmnTextAnnotation(this.activeLabel,this),l=this.bpmnModule.getTextAnnotationWrapper(o,this.activeLabel.id),c=!!o,c&&(r.textContent!==s||s!==this.activeLabel.text))&&(this.triggerEvent(nv.textEdit,h),h.cancel||this.bpmnModule.updateTextAnnotationContent(o,this.activeLabel,s,this)),!c){o=this.nameTable[this.activeLabel.parentId];const n=hC(o,this.activeLabel.id);!n||n instanceof VC?e={shape:{content:o.shape.content}}:(i[dC(o,n.id,!0)]={content:n.content},e={annotations:i});const a=this.eventHandler.isAddTextNode(o,!0);if(a||r.textContent===s&&s===this.activeLabel.text||this.triggerEvent(nv.textEdit,h),l||(l=this.getWrapper(o.wrapper,this.activeLabel.id)),n.content!==s&&!h.cancel){if(o.parentId&&"UmlClassifier"===this.nameTable[o.parentId].shape.type&&-1===s.indexOf("+")&&-1===s.indexOf("-")&&-1===s.indexOf("#")&&-1===s.indexOf("~")&&-1===o.id.indexOf("_umlClass_header")&&(s=" + "+s),(o.isLane||o.isPhase)&&this.protectPropertyChange(!0),n instanceof VC)t={shape:{content:s}};else{const e={};e[dC(o,n.id,!0)]={content:s},t={annotations:e}}const i=this.getIndex(o,o.id);if(i){const n={};n[i]=e;const s={};s[i]=t,yC(o)===pP?this.onPropertyChanged({nodes:s},{nodes:n}):this.onPropertyChanged({connectors:s},{connectors:n})}this.protectPropertyChange(!0),n.content=s,this.protectPropertyChange(!1),this.updateSelector(),(o.isLane||o.isPhase)&&this.protectPropertyChange(!1)}if(a&&(this.removeObjectsFromLayer(o),this.removeFromAQuad(o),delete this.nameTable[this.activeLabel.parentId],""!==s)){this.clearSelection();const e=QP(o);o=this.add(e),this.updateDiagramObject(o),this.commandHandler.oldSelectedObjects=xC(this),this.commandHandler.select(this.nameTable[o.id]),this.commandHandler.updateBlazorSelector()}}if(this.selectedItems.nodes.length){let e=this.nameTable[this.activeLabel.parentId],t=this.nameTable[e.parentId];if(t&&"SwimLane"===t.shape.type||"SwimLane"===e.shape.type){const i="LaneHeaderParent",n="PhaseHeaderParent";if("SwimLane"===e.shape.type&&(t=this.nameTable[this.activeLabel.parentId],e=o),e.isLane||e.isPhase){const s=e.isLane?t.shape.lanes:t.shape.phases;for(let t=0;t<s.length;t++)s[t].id===(e[i]||e[n])&&(s[t].header.annotation.content=e.annotations[0].content)}else e.isHeader&&t.shape.hasHeader&&(t.shape.header.annotation.content=e.annotations[0].content)}this.dataBind()}l.visible=!0,this.updateDiagramObject(o),this.diagramActions=this.diagramActions&~Jb.TextEdit,this.activeLabel.isGroup&&this.endGroupAction(),this.activeLabel={id:"",parentId:"",isGroup:!1,text:void 0},this.commandHandler.getBlazorOldValues(),this.enableServerDataBinding(!0)}}})}getIndex(e,t){const i=yC(e)===pP?this.nodes:this.connectors;for(let n=0;n<i.length;n++)if(i[n].id.toString()===t.toString())return n.toString();return null}getBlazorTextEditArgs(e){const t=yC(e.element)===Vw?{connectorId:e.element.id}:{nodeId:e.element.id},i={};return yC(e.element)===pP&&"Text"===e.element.shape.type?i.textNode=e.element.shape:i.annotationId=e.element.annotations[0].id,{oldValue:e.oldValue,newValue:e.newValue,cancel:e.cancel,element:t,annotation:i}}canLogChange(){return!(!(this.diagramActions&Jb.Render)||this.diagramActions&Jb.ToolAction||this.diagramActions&Jb.UndoRedo||this.diagramActions&Jb.PublicMethod)}modelChanged(e,t){return!!(e.connectors||t.connectors||e.nodes||t.connectors||e.pageSettings||t.pageSettings||e.bridgeDirection||t.bridgeDirection)}resetDiagramActions(e){const t=!!e;this.diagramActions&Jb.UndoRedo&&(!t||e===Jb.UndoRedo)&&(this.diagramActions=this.diagramActions&~Jb.UndoRedo),this.diagramActions&Jb.PublicMethod&&(!t||e===Jb.PublicMethod)&&(this.diagramActions=this.diagramActions&~Jb.PublicMethod)}removeNode(e,t){this.removeObjectsFromLayer(e),this.removeFromAQuad(this.nameTable[e.id]);const i=document.getElementById(e.id+"_groupElement");if(delete this.nameTable[e.id],e.children&&delete this.groupTable[e.id],this.nodes.splice(this.nodes.indexOf(e),1),i.children&&i.children.length>0){let e;for(let n=i.children.length-1;n>=0;n--){const s=i.children[n];t.length>0&&-1!==t.indexOf(s.id.split("_")[0])&&(i.parentNode.insertBefore(s,e||i),e=s)}}i&&i.parentNode.removeChild(i)}deleteGroup(e){let t=[];e.children&&(t=this.commandHandler.getChildren(e,[])),this.UpdateBlazorDiagramModelCollection(e);for(const i of t)this.nameTable[i.id]&&this.remove(i)}updateObject(e,t,i){if(!(this.diagramActions&Jb.ToolAction||this.commandHandler.checkBoundaryConstraints(void 0,void 0,e.wrapper.children[0].bounds)))if(e instanceof pP){const n=t;for(const t of Object.keys(i))switch(t){case"width":e.width=n.width;break;case"height":e.height=n.height;break;case"offsetX":e.offsetX=n.offsetX;break;case"offsetY":e.offsetY=n.offsetY;break;case"rotateAngle":e.rotateAngle=n.rotateAngle}this.nodePropertyChange(e,i,t)}else{for(const n of Object.keys(i)){const i=t,s=e.sourcePoint,r=e.targetPoint;switch(n){case"sourcePoint":s.x=i.sourcePoint.x||s.x,s.y=i.sourcePoint.y||s.y;break;case"targetPoint":r.x=i.targetPoint.x||r.x,r.y=i.targetPoint.y||r.y}}this.connectorPropertyChange(e,i,t)}}nodePropertyChangeExtend(e,t,i,n){return void 0!==i.style&&"Bpmn"!==e.shape.type&&(JS(i.style,e.wrapper.children[0]),n=!0),void 0!==i.shadow&&(this.updateShadow(e.shadow,i.shadow),n=!0),void 0!==i.constraints&&(t.constraints&Vb.Select&&!(i.constraints&Vb.Select)&&jO(this,e)?this.clearSelection():(this.updateThumbConstraints(this.selectedItems.nodes,this.selectedItems),this.updateSelector(),n=!0)),this.swimLaneNodePropertyChange(e,t,i,n),n}swimLaneNodePropertyChange(e,t,i,n){if("SwimLane"===e.shape.type&&!this.currentSymbol){if(t.shape){const n=i.shape,s=e.shape,r="Horizontal"===s.orientation,o=s.padding,a=t.shape,l=e.wrapper.children[0];let h,c,d;if(a.lanes||a.phases){if(a.lanes)for(const e of Object.keys(n.lanes)){const t=Number(e),i=a.lanes[t];let p;const u=n.lanes[t];if(u&&u.header&&(d=s.lanes[t].header.id,h=i.header,c=u.header,this.nodePropertyChange(this.nameTable[d],h,c)),i.children)for(const e of Object.keys(i.children)){d=s.lanes[t].children[Number(e)].id;const n=this.nameTable[d];h=i.children[Number(e)],c=u.children[Number(e)],this.nodePropertyChange(n,h,c)}i.width&&!r&&(p=s.phases&&s.phaseSize?t+1:t,l.updateColumnWidth(p,u.width,!0,o),this.updateDiagramElementQuad()),i.height&&r&&(p=s.header&&s.hasHeader?t+1:t,p+=s.phases&&s.phaseSize?1:0,l.updateRowHeight(p,u.height,!0,o),this.updateDiagramElementQuad())}if(n.phases)for(const t of Object.keys(n.phases)){const i=Number(t),p=n.phases[i];let u;const g=s.header&&s.hasHeader?1:0;p&&p.header&&(d=s.phases[i].header.id,h=a.phases[i].header,c=p.header,this.nodePropertyChange(this.nameTable[d],h,c)),p.offset&&(0===i?u=p.offset:(u=p.offset-s.phases[i-1].offset,u<=0&&(u=p.offset)),r?(l.updateColumnWidth(i,u,!0,o),uS(e,this,l.rows[g].cells[i],i)):l.updateRowHeight(g+i,u,!0,o))}}if(void 0!==n.phaseSize&&s.phases.length)if(0===n.phaseSize||0===a.phaseSize)if(a.phaseSize)r?(l.removeRow(s.header&&s.hasHeader?1:0),e.height=e.wrapper.height=l.height):(s.header&&s.hasHeader&&(l.rows[0].cells[1].children=l.rows[0].cells[0].children,l.rows[0].cells[1].columnSpan=l.rows[0].cells[0].columnSpan-1,l.rows[0].cells[0].children=[]),l.removeColumn(0));else{if(r){const t=new _x;t.height=n.phaseSize,l.addRow(s.header&&s.hasHeader?1:0,t,!0),e.height=e.wrapper.height+=n.phaseSize}else{const e=new Nx;e.width=n.phaseSize,l.addColumn(0,e,!0),s.header&&s.hasHeader&&(l.rows[0].cells[0].children=l.rows[0].cells[1].children,l.rows[0].cells[1].children=[],l.rows[0].cells[1].columnSpan=1,l.rows[0].cells[1].minWidth=void 0,l.rows[0].cells[0].columnSpan=s.lanes.length+1)}for(let t=0;t<s.phases.length;t++)""===s.phases[t].id&&(s.phases[t].id=XP()),Kx(l,this,e,s.header&&s.hasHeader?1:0,r,t)}else r?l.updateRowHeight(s.header&&s.hasHeader?1:0,n.phaseSize,!1):l.updateColumnWidth(0,n.phaseSize,!1);s.header&&s.hasHeader&&a.header&&this.nodePropertyChange(this.nameTable[l.rows[0].cells[0].children[0].id],a.header,n.header),e.height=e.wrapper.height=l.height,e.width=e.wrapper.width=l.width}else if(t.constraints){const n=i.constraints&Vb.Select;if((t.constraints&Vb.Select)!==n){const t=e.shape,i=this.nameTable[e.id+t.header.id];let s,r,o;if(i.constraints=n?i.constraints|Vb.Select:i.constraints&~Vb.Select,t.phaseSize>0)for(let l=0;l<t.phases.length;l++)s=this.nameTable[e.id+t.phases[l].id+"_header"],s.constraints=n?s.constraints|Vb.Select:s.constraints&~Vb.Select;const a=t.phases.length||1;for(let l=0;l<t.lanes.length;l++)for(let i=0;i<a;i++)r=this.nameTable[e.id+t.lanes[l].id+i],r.constraints=n?r.constraints|Vb.Select:r.constraints&~Vb.Select,0===i&&(o=this.nameTable[e.id+t.lanes[l].id+"_"+i+"_header"],o.constraints=n?o.constraints|Vb.Select:o.constraints&~Vb.Select)}}n=!0}return n}insertValue(e,t){if(!(this.blazorActions&_b.GroupClipboardInProcess)){let i;const n=t?this.oldNodeObjects:this.oldConnectorObjects;for(let t=0;t<n.length;t++)n[t].id===e.id&&(i=!0);i||(t?this.oldNodeObjects.push(e):this.oldConnectorObjects.push(e))}}nodePropertyChange(e,t,i,n,s,r){if(this.canEnableBlazorObject&&"helper"!==e.id){const t=QP(e);this.insertValue(t,!0)}const o=e.wrapper.outerBounds,a=e.wrapper.bounds;let l,h=!1;if(void 0!==i.width&&(e.children?e.container?e.wrapper.width=i.width:this.scaleObject(e,i.width,!0):(e.wrapper.children[0].width=i.width,l=!0,h=!0)),void 0!==i.height&&(e.children?e.container?e.wrapper.height=i.height:this.scaleObject(e,i.height,!1):(e.wrapper.children[0].height=i.height,l=!0,h=!0)),l=this.nodePropertyChangeExtend(e,t,i,l),void 0!==i.constraints&&ax(t)!==ax(i)&&(e.wrapper.children[0].shadow=ax(e)?e.shadow:null),void 0!==i.offsetX){if("None"!==e.wrapper.flip){if(e.offsetX!==e.wrapper.offsetX&&void 0!==t.offsetX){const n=i.offsetX-t.offsetX;e.wrapper.offsetX=e.wrapper.offsetX+n,this.updateFlipOffset(e.wrapper,n,0,e.wrapper.flip)}}else e.wrapper.offsetX=i.offsetX;l=!0,h=!0}if(void 0!==i.offsetY){if("None"!==e.wrapper.flip){if(e.offsetY!==e.wrapper.offsetY&&void 0!==t.offsetY){const n=i.offsetY-t.offsetY;e.wrapper.offsetY=e.wrapper.offsetY+n,this.updateFlipOffset(e.wrapper,0,n,e.wrapper.flip)}}else e.wrapper.offsetY=i.offsetY;l=!0,h=!0}if(void 0!==i.pivot&&(e.wrapper.pivot=i.pivot,l=!0),void 0!==i.minWidth&&(e.wrapper.minWidth=e.wrapper.children[0].minWidth=i.minWidth,l=!0,h=!0),void 0!==i.minHeight&&(e.wrapper.minHeight=e.wrapper.children[0].minHeight=i.minHeight,l=!0,h=!0),void 0!==i.maxWidth&&(e.wrapper.maxWidth=i.maxWidth,l=!0,h=!0),void 0!==i.maxHeight&&(e.wrapper.maxHeight=i.maxHeight,l=!0,h=!0),void 0!==i.flip)if(e.wrapper.flip=i.flip,l=!0,h=!0,e.wrapper.elementActions&Yb.ElementIsGroup){if(wC(e.wrapper,e.offsetX,e.offsetY,this,i.flip),e&&e.children)for(const c of e.children){const e=this.nameTable[c];e.wrapper.flip=i.flip,this.updatePorts(e,i.flip)}}else e.wrapper.children[0].flip=i.flip,this.updatePorts(e,i.flip);if(void 0!==i.rotateAngle&&e.constraints&Vb.Rotate&&(e.children&&s&&this.commandHandler.rotateObjects(e,[e],e.rotateAngle-e.wrapper.rotateAngle,{x:e.offsetX,y:e.offsetY},!1),e.wrapper.rotateAngle=i.rotateAngle,l=!0,h=!0),void 0!==i.backgroundColor&&(e.wrapper.style.fill=i.backgroundColor),void 0!==i.visible&&this.updateElementVisibility(e.wrapper,e,e.visible),void 0!==i.shape&&"Bpmn"!==e.shape.type&&(l=!0,function(e,t,i,n){let s=new rv;switch(e.shape.type){case"Path":const i=new dv;i.data=t.shape.data,s=i,eC(s,t,n);break;case"Image":const r=new pv;r.source=t.shape.source,r.imageAlign=t.shape.align,r.imageScale=t.shape.scale,s=r,eC(s,t,n);break;case"Text":s=new av,eC(s,t,n);break;case"Basic":const o="Rectangle"===t.shape.shape?new rv:new dv;o.data="Polygon"===t.shape.shape?ab(t.shape.points):hv(t.shape.shape),eC(s,t,n),"Rectangle"===t.shape.shape&&(o.cornerRadius=t.shape.cornerRadius),s=o;break;case"Flow":const a=new dv;a.data=Ov(t.shape.shape),s=a,eC(s,t,n);break;case"Native":const l=new uv(e.id,n.element.id);l.content=t.shape.content,l.scale=t.shape.scale,s=l,eC(s,t,n);break;case"HTML":let h=new vw(t.id,n.element.id);h.content=t.shape.content,s=h,eC(s,t,n)}void 0===e.shape.type||e.shape.type===i.shape.type?function(e,t,i,n){if(Object.keys(e.shape).length>0)if("Path"===t.shape.type&&void 0!==e.shape.data)t.wrapper.children[0].data=e.shape.data;else if("Text"===t.shape.type&&void 0!==e.shape.content)t.wrapper.children[0].content=e.shape.content;else if("Image"===t.shape.type&&void 0!==e.shape.source)t.wrapper.children[0].source=e.shape.source;else if("Native"===t.shape.type){let n;for(let s=0;s<i.views.length;s++)n=PP(t.wrapper.children[0].id+"_native_element",i.views[s]),void 0!==e.shape.content&&n&&(n.removeChild(n.children[0]),t.wrapper.children[0].content=e.shape.content,n.appendChild(BP(t.wrapper.children[0],!1)));t.wrapper.children[0].scale=e.shape.scale?e.shape.scale:t.wrapper.children[0].scale}else if("HTML"===t.shape.type){let n;for(let s=0;s<i.views.length;s++)n=PP(t.wrapper.children[0].id+"_html_element",i.views[s]),n&&(n.removeChild(n.children[0]),t.wrapper.children[0].content=e.shape.content,n.appendChild(BP(t.wrapper.children[0],!0)))}else if("Flow"===t.shape.type&&void 0!==e.shape.shape){t.shape.shape=e.shape.shape;const i=Ov(t.shape.shape.toString());t.wrapper.children[0].data=i}else if("UmlActivity"===t.shape.type&&void 0!==e.shape.shape)!function(e,t){e.shape.shape=t.shape.shape;const i=Dx(e.shape.shape.toString());"InitialNode"===e.shape.shape||"ForkNode"===e.shape.shape||"JoinNode"===e.shape.shape?e.wrapper.children[0].style.fill="black":"FinalNode"===e.shape.shape&&e instanceof pP&&(e.wrapper=tC(e)),i&&(e.wrapper.children[0].data=i)}(t,e);else if(void 0!==e.shape.cornerRadius)t.wrapper.children[0].cornerRadius=e.shape.cornerRadius;else if("Basic"===t.shape.type&&n&&"Rectangle"===n.shape.shape){const e=new dv,n=hv(t.shape.shape);e.data=n,eC(e,t,i)}else if(void 0!==e.shape.shape){t.shape.shape=e.shape.shape;const i=hv(t.shape.shape.toString());t.wrapper.children[0].data=i}t.wrapper.children[0].canMeasurePath=!0}(e,t,n,i):(s.width=t.wrapper.children[0].width,s.height=t.wrapper.children[0].height,t.shape instanceof VC&&(s.margin=t.shape.margin),s.style=t.style,t.wrapper.children[0]=s)}(i,e,t,this),h=!0),i.margin&&(l=!0,this.updateMargin(e,i),h=!0),!((void 0===i.shape||void 0!==i.shape.type)&&void 0===i.width&&void 0===i.height&&void 0===i.style||"Bpmn"!==e.shape.type||!this.bpmnModule)&&(l=!0,h=!0,this.bpmnModule.updateBPMN(i,t,e,this)),"UmlActivity"===e.shape.type&&("FinalNode"===e.shape.shape||!1)&&(l=!0,h=!0,this.updateUMLActivity(i,t,e,this)),(e.shape&&"UmlClassifier"===e.shape.type||e.parentId&&this.nameTable[e.parentId]&&"UmlClassifier"===this.nameTable[e.parentId].shape.type)&&(l=!0,h=!0),void 0!==i.ports)for(const c of Object.keys(i.ports)){const t=Number(c);l=!0,this.updatePort(i.ports[c],e.ports[t],e.wrapper),h=!0}if(void 0!==i.annotation||void 0!==i.annotations||void 0!==i.width)for(const c of Object.keys(i.annotations||e.annotations)){const t=Number(c);let n;l=!0,n=i.annotation?i.annotation:i.annotations?i.annotations[c]:e.annotations;const s=e.annotations[t];if(s){this.updateAnnotation(n,s,e.wrapper,e,!!e.width);const t=this.nameTable[e.parentId];if(t&&"SwimLane"===t.shape.type){const i="LaneHeaderParent",n="PhaseHeaderParent";if(e.isLane||e.isPhase){const s=e.isLane?t.shape.lanes:t.shape.phases;for(let t=0;t<s.length;t++)if(s[t].id===(e[i]||e[n])){s[t].header.annotation.content=e.annotations[0].content,s[t].header.annotation.style=e.annotations[0].style;break}}}}}if(void 0===i.expandIcon&&void 0===i.collapseIcon&&void 0===i.isExpanded||(this.updateIcon(e),this.updateDefaultLayoutIcons(e),void 0!==i.isExpanded&&this.commandHandler.expandNode(e,this),l=!0),void 0!==i.fixedUserHandles){let t,n,s;for(const r of Object.keys(i.fixedUserHandles))t=Number(r),l=!0,i.fixedUserHandles[t]&&(n=i.fixedUserHandles[t]),s=e.fixedUserHandles[t],s&&this.updateNodefixedUserHandle(n,s,e.wrapper,e)}if(void 0!==i.tooltip&&this.updateTooltip(e,i),l){if(void 0!==this.bpmnModule&&this.bpmnModule.updateTextAnnotationProp(e,{offsetX:t.offsetX||e.offsetX,offsetY:t.offsetY||e.offsetY},this),this.checkSelectedItem(e)&&e.wrapper.children[0]instanceof av&&e.wrapper.children[0].refreshTextElement(),e.wrapper.measure(new nb(e.wrapper.bounds.width,e.wrapper.bounds.height),e.id,this.onLoadImageSize.bind(this)),e.wrapper.arrange(e.wrapper.desiredSize),this.updateObject(e,t,i),!("SwimLane"!==e.shape.type||this.currentSymbol||this.diagramActions&Jb.ToolAction)){gS(this,e);const t=e.wrapper.children[0],i=e.shape,n=t.columnDefinitions().length;"Horizontal"===i.orientation&&uS(e,this,t.rows[i.header&&i.hasHeader?1:0].cells[n-1],n-1),e.wrapper.measure(new nb(e.wrapper.bounds.width,e.wrapper.bounds.height)),e.wrapper.arrange(e.wrapper.desiredSize)}if(this.diagramActions&Jb.ToolAction&&!(this.diagramActions&Jb.UndoRedo)||this.checkSelectedItem(e)&&this.updateSelector(),!1===o.equals(o,e.wrapper.outerBounds)&&this.updateQuad(e),n?e&&e.visible&&e.outEdges&&this.updateIconVisibility(e,0!==e.outEdges.length):this.commandHandler.connectorSegmentChange(e,a,void 0!==i.rotateAngle),void 0!==this.bpmnModule&&this.bpmnModule.updateDocks(e,this),i.annotations&&e.processId||this.updateGroupOffset(e),e.parentId&&this.nameTable[e.parentId]){const t=this.nameTable[e.parentId];t.wrapper.measure(new nb(t.wrapper.width,e.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize),t.offsetX=t.wrapper.offsetX,t.offsetY=t.wrapper.offsetY}if(!1===a.equals(a,e.wrapper.bounds)&&(this.updateGroupSize(e),e.children&&this.updateGroupOffset(e)),"SwimLane"===e.shape.type&&!this.currentSymbol&&this.diagramActions&Jb.Render&&hS(nS(this,e.wrapper.children[0]),this),!this.preventNodesUpdate&&((!gx(this)||gx(this)&&this.scroller.oldCollectionObjects.indexOf(e.id)>-1)&&(this.diagramActions&Jb.PreventZIndexOnDragging?this.updateDiagramObject(e,!0):this.updateDiagramObject(e)),!n&&h&&(this.lineRoutingModule&&this.diagramActions&&this.constraints&Gb.LineRouting&&"helper"!==e.id&&(this.diagramActions&Jb.ToolAction||this.lineRoutingModule.renderVirtualRegion(this,!0)),this.updateConnectorEdges(e),"helper"!==e.id&&!(this.diagramActions&Jb.ToolAction)))){const t=this.spatialSearch.findObjects(e.wrapper.outerBounds);for(let e=0;e<t.length;e++){const i=t[e];i instanceof Vw&&this.connectorPropertyChange(t[e],{},{sourceID:i.sourceID,targetID:i.targetID,sourcePortID:i.sourcePortID,targetPortID:i.targetPortID,sourcePoint:i.sourcePoint,targetPoint:i.targetPoint})}}"New"!==e.status&&this.diagramActions&&(e.status="Update")}if(!r){this.triggerEvent(nv.propertyChange,{element:e,cause:this.diagramActions,oldValue:t,newValue:i})}}updatePorts(e,t){if(e&&e.ports.length>0)for(const i of Object.keys(e.ports)){const n=Number(i),s=e.ports[n];let r=this.getWrapper(e.wrapper,s.id);r=vC(r,t,s),r.relativeMode="Point",r.measure(new nb(r.width,r.height)),r.arrange(r.desiredSize)}}updateFlipOffset(e,t,i,n){if(e.hasChildren())for(const s of e.children)"Horizontal"!==n&&"Both"!==n||(s.flipOffset.x=s.flipOffset.x+t),"Vertical"!==n&&"Both"!==n||(s.flipOffset.y=s.flipOffset.y+i),(s instanceof lv||s instanceof ov)&&this.updateFlipOffset(s,t,i,n)}updateUMLActivity(e,t,i,n){if(void 0!==e.width||void 0!==e.height){const t=i.wrapper.children[0].children[0];t.width=e.width,t.height=e.height;const n=i.wrapper.children[0].children[1];n.width=e.width/1.5,n.height=e.height/1.5}}updateConnectorProperties(e){this.preventConnectorsUpdate?-1===this.selectionConnectorsList.indexOf(e)&&this.selectionConnectorsList.push(e):this.connectorPropertyChange(e,{},{sourcePoint:e.sourcePoint,targetPoint:e.targetPoint,sourceID:e.sourceID,targetID:e.targetID,sourcePortID:e.sourcePortID,targetPortID:e.targetPortID},void 0,!0)}updateConnectorEdges(e){if(e.inEdges.length>0)for(let t=0;t<e.inEdges.length;t++)this.updateConnectorProperties(this.nameTable[e.inEdges[t]]);if(e.outEdges.length>0)for(let t=0;t<e.outEdges.length;t++)this.updateConnectorProperties(this.nameTable[e.outEdges[t]]);e.parentId&&this.nameTable[e.parentId]&&this.updateConnectorEdges(this.nameTable[e.parentId])}connectorProprtyChangeExtend(e,t,i,n){return void 0!==i.type&&i.type!==t.type&&e.segments.length>0&&void 0===i.segments&&(e.segments=[]),void 0!==i.shape&&void 0!==e.shape&&e.shape&&"Bpmn"===e.shape.type&&this.bpmnModule&&this.bpmnModule.updateBPMNConnector(e,t,i,this),void 0!==e.constraints?(this.updateThumbConstraints(this.selectedItems.connectors,this.selectedItems),!0):n}connectorPropertyChange(e,t,i,n,s){if(this.canEnableBlazorObject){const t=QP(e);this.insertValue(t,!1)}const r=e.wrapper.bounds;let o,a,l,h,c=!1,d=[];if(c=this.connectorProprtyChangeExtend(e,t,i,c),void 0!==i.visible&&this.updateElementVisibility(e.wrapper,e,e.visible),void 0!==i.sourcePoint||void 0!==i.targetPoint||void 0!==i.sourceID||void 0!==i.targetID||void 0!==i.targetPadding||void 0!==i.sourcePortID||void 0!==i.targetPortID||void 0!==i.sourcePadding||void 0!==i.type||void 0!==i.segments||void 0!==i.flip){if(void 0!==i.sourceID&&i.sourceID!==t.sourceID||i.sourcePortID){const n=this.nameTable[e.sourceID];if(a=this.findInOutConnectPorts(n,!1),(!n||cx(n)||""!==e.sourcePortID&&dx(a))&&(e.sourceWrapper=n?this.getEndNodeWrapper(n,e,!0):void 0,e.sourcePortID&&void 0===i.sourcePortID&&(e.sourcePortWrapper=n?this.getWrapper(n.wrapper,e.sourcePortID):void 0),this.removePortEdges(this.nameTable[t.sourceID]||n,t.sourcePortID||e.sourcePortID,e.id,!1)),void 0!==i.sourceID&&void 0!==t.sourceID&&""!==t.sourceID){const i=this.nameTable[t.sourceID];void 0!==i&&i.outEdges&&-1!==i.outEdges.indexOf(e.id)&&nC(i.outEdges,e.id)}this.updateEdges(e)}if(void 0!==i.targetID&&i.targetID!==t.targetID){const n=this.nameTable[i.targetID];if(o=this.findInOutConnectPorts(n,!0),(!n||lx(n)||""!==e.targetPortID&&hx(o))&&(e.targetWrapper=n?this.getEndNodeWrapper(n,e,!1):void 0,e.targetPortID&&void 0===i.targetPortID&&(e.targetPortWrapper=n?this.getWrapper(n.wrapper,e.targetPortID):void 0),this.removePortEdges(this.nameTable[t.targetID]||n,t.targetPortID||e.targetPortID,e.id,!0)),void 0!==t&&void 0!==t.targetID&&""!==t.targetID){const i=this.nameTable[t.targetID];void 0!==i&&i.inEdges&&-1!==i.inEdges.indexOf(e.id)&&nC(i.inEdges,e.id)}this.updateEdges(e)}if(void 0!==i.sourcePortID&&i.sourcePortID!==t.sourcePortID){e.sourceID&&this.nameTable[e.sourceID]&&(l=this.nameTable[e.sourceID].wrapper);const t=this.nameTable[e.sourceID];!t||cx(t)||""!==e.sourcePortID&&dx(a)?e.sourcePortWrapper=l?this.getWrapper(l,i.sourcePortID):void 0:""!==e.sourcePortID||cx(t)||(e.sourcePortWrapper=void 0)}if(void 0!==i.targetPortID&&i.targetPortID!==t.targetPortID){const t=this.nameTable[e.targetID];e.targetID&&this.nameTable[e.targetID]&&(h=this.nameTable[e.targetID].wrapper),!t||lx(t)||""!==e.targetPortID&&hx(o)?e.targetPortWrapper=h?this.getWrapper(h,i.targetPortID):void 0:""!==e.targetPortID||lx(t)||(e.targetPortWrapper=void 0)}void 0!==i.flip&&(e.flip=i.flip,bC(e)),"Orthogonal"===e.type&&this.lineRoutingModule&&this.diagramActions&&this.constraints&Gb.LineRouting&&!(this.diagramActions&Jb.ToolAction)&&(this.lineRoutingModule.renderVirtualRegion(this,!0),this.lineRoutingModule.refreshConnectorSegments(this,e,!1)),d=this.getPoints(e)}var p;void 0!==i.style&&JS(i.style,e.wrapper.children[0]),(d.length>0||void 0!==i.sourceDecorator||void 0!==i.targetDecorator&&(-1!==(p=Object.keys(i.targetDecorator)).indexOf("shape")||-1!==p.indexOf("pathData")||-1!==p.indexOf("width")||-1!==p.indexOf("height"))||void 0!==i.cornerRadius)&&(sC(e,d.length>0?d:e.intermediatePoints,this.diagramActions),void 0!==i.type&&(c=!0),d.length>0&&(e.wrapper.measure(new nb(e.wrapper.width,e.wrapper.height)),e.wrapper.arrange(e.wrapper.desiredSize),this.updateConnectorAnnotation(e),this.updateConnectorfixedUserHandles(e),this.updateObject(e,t,i))),(i.sourcePoint||i.targetPoint||i.segments)&&this.diagramActions===Jb.Render&&(c=!0),"Bpmn"===e.shape.type&&"Default"===e.shape.sequence&&this.commandHandler.updatePathElementOffset(e),n||this.updateBridging(),this.updateAnnotations(i,e),this.updatefixedUserHandle(i,e),e.wrapper.measure(new nb(e.wrapper.width,e.wrapper.height)),e.wrapper.arrange(e.wrapper.desiredSize),!1===r.equals(r,e.wrapper.bounds)&&(this.updateQuad(e),this.updateGroupSize(e)),!0!==c||!this.checkSelectedItem(e)||this.diagramActions&Jb.ToolAction&&!(this.diagramActions&Jb.UndoRedo)||this.updateSelector(),this.preventConnectorsUpdate||(!gx(this)||gx(this)&&this.scroller.oldCollectionObjects.indexOf(e.id)>-1)&&(this.diagramActions&Jb.PreventZIndexOnDragging?this.updateDiagramObject(e,!0):this.updateDiagramObject(e)),this.diagramActions&&"New"!==e.status&&(e.status="Update"),this.triggerPropertyChange(s,e,t,i)}removePortEdges(e,t,i,n){if(e)for(let s=0;s<e.ports.length;s++){const r=e.ports[s];r.id===t&&nC(n?r.inEdges:r.outEdges,i)}}getpropertyChangeArgs(e,t,i,n){return n.element={connector:e},n.oldValue={connector:t},n.newValue={connector:i},n}triggerPropertyChange(e,t,i,n){if(!e){this.triggerEvent(nv.propertyChange,{element:t,cause:this.diagramActions,oldValue:i,newValue:n})}}findInOutConnectPorts(e,t){let i={};return e&&(i=cC(e,t)),i}getPoints(e,t){return e.getConnectorPoints(e.type,t,"ComplexHierarchicalTree"===this.layout.type||"HierarchicalTree"===this.layout.type?this.layout.orientation:void 0,!!this.lineDistributionModule)}updateNodeProperty(e,t,i){if(void 0===t)this.updateElementVisibility(e,this.nameTable[e.id],t);else{e.style.opacity=i;for(let t=0;t<e.children.length;t++)e.children[t]instanceof ov&&this.updateNodeProperty(e.children[t],void 0,i),e.children[t].style.opacity=i}}checkSelectedItem(e){const t=this.selectedItems;let i=!1,n=[];return n=n.concat(t.nodes,t.connectors),n.length>0&&e.id===n[n.length-1].id&&(i=!0),i}updateDiagramContainerVisibility(e,t){if(e instanceof ov)for(let i=0;i<e.children.length;i++)this.updateDiagramContainerVisibility(e.children[i],t);e.visible=t}updateElementVisibility(e,t,i){if(void 0!==i){if(e.visible=i,t instanceof pP){if(t.children)for(const e of t.children)this.updateElementVisibility(this.nameTable[e].wrapper,this.nameTable[e],i);else e.children[0].visible=i,this.updateDiagramContainerVisibility(e.children[0],i),"Bpmn"===t.shape.type&&this.bpmnModule&&this.bpmnModule.updateElementVisibility(t,i,this);if(t.ports)for(const n of t.ports)n.visibility&Nb.Visible&&(this.getWrapper(e,n.id).visible=i);if(t.annotations)for(const n of t.annotations)this.getWrapper(e,n.id).visible=i}else for(let t=0;t<3;t++)e.children[t].visible=i;if(t.annotations)for(const n of t.annotations)this.getWrapper(e,n.id).visible=i;if(t.expandIcon||t.collapseIcon){const n=this.getWrapper(e,"icon_content");if(n){for(let e=0;e<n.children.length;e++)n.children[e].visible=i;n.visible=i}t&&t.visible&&t.outEdges&&this.updateIconVisibility(t,0!==t.outEdges.length)}!1===i&&this.unSelect(this.nameTable[e.id]),(t instanceof pP&&!this.preventNodesUpdate||t instanceof Vw&&!this.preventConnectorsUpdate)&&this.diagramActions&&this.updateDiagramObject(this.nameTable[e.id],void 0,!0)}}updateAnnotations(e,t){if(void 0!==e.annotations)for(const i of Object.keys(e.annotations)){const n=Number(i);this.updateAnnotation(e.annotations[i],t.annotations[n],t.wrapper,t)}}updatefixedUserHandle(e,t){if(void 0!==e.fixedUserHandles){let i,n,s;for(const r of Object.keys(e.fixedUserHandles))i=Number(r),n=e.fixedUserHandles[r],s=t.fixedUserHandles[i],this.updateConnectorfixedUserHandle(n,s,t.wrapper,t)}}updateConnectorfixedUserHandle(e,t,i,n,s){let r=!1;const o=this.getWrapper(i,t.id);void 0!==o&&(void 0!==e.width&&(o.width=e.width,r=!0),void 0!==e.height&&(o.height=e.height,r=!0),t instanceof Cw&&void 0!==e.offset&&n.updateAnnotation(t,n.intermediatePoints,n.wrapper.bounds,o),t instanceof Cw&&e.displacement&&(void 0===e.displacement.x&&void 0===e.displacement.y||(r=!0)),void 0!==e.fill&&(o.style.fill=e.fill),void 0!==e.handleStrokeColor&&(o.style.strokeColor=e.handleStrokeColor),void 0!==e.handleStrokeWidth&&(o.style.strokeWidth=e.handleStrokeWidth),void 0!==e.visibility&&(o.visible=e.visibility),void 0!==e.cornerRadius&&(o.cornerRadius=e.cornerRadius),this.updatefixedUserHandleContent(e,r,o,n,t,i),!0===r&&(o.measure(new nb(o.width,o.height)),o.arrange(o.desiredSize)))}updateAnnotation(e,t,i,n,s){let r=!1;const o=this.getWrapper(i,t.id);if(void 0!==o){if(void 0!==e.width&&void 0!==e.height&&(o.width=e.width,o.height=e.height,r=!0),void 0!==e.rotateAngle&&(o.rotateAngle=e.rotateAngle),!s||o instanceof vw||o.refreshTextElement(),t instanceof xv&&void 0!==e.segmentAngle&&(o.rotateAngle=t.rotateAngle),t instanceof wv&&void 0!==e.offset){const i=e.offset;r=!0,o.setOffsetWithRespectToBounds(void 0!==i.x?i.x:t.offset.x,void 0!==i.y?i.y:t.offset.y,"Fraction"),o.relativeMode="Point"}else t instanceof xv&&(void 0!==e.offset||void 0!==e.segmentAngle)&&n.updateAnnotation(t,n.intermediatePoints,n.wrapper.bounds,o);if(t instanceof xv&&e.displacement&&(void 0===e.displacement.x&&void 0===e.displacement.y||(r=!0)),void 0!==e.margin&&(r=!0,void 0!==e.margin.bottom&&(o.margin.bottom=e.margin.bottom),void 0!==e.margin.top&&(o.margin.top=e.margin.top),void 0!==e.margin.left&&(o.margin.left=e.margin.left),void 0!==e.margin.right&&(o.margin.right=e.margin.right)),(r||s)&&(o.width=t.width||n.width,t.template&&(o.width=o.width||o.actualSize.width,o.height=t.height||n.height||o.actualSize.height)),void 0!==e.horizontalAlignment&&(o.horizontalAlignment=e.horizontalAlignment,r=!0),void 0!==e.verticalAlignment&&(o.verticalAlignment=e.verticalAlignment,r=!0),void 0!==e.visibility&&(o.visible=!(!i.visible||!e.visibility)),void 0!==e.constraints){const t=!1;o.constraints&Fb.Select&&!(e.constraints&Fb.Select)&&jO(this,n,!1,o),o.constraints=e.constraints,t&&this.clearSelection()}void 0!==e.style&&JS(e.style,o),void 0!==e.hyperlink&&function(e,t,i){const n=t,s=n.hyperlink;for(const r of Object.keys(e))switch(r){case"color":n.style.color=s.color=e.color;break;case"content":n.content=s.content=e.content||s.link;break;case"link":const t=i.style;n.style.color=e.link?s.color:t.color,n.style.textDecoration=e.link?s.textDecoration:i.style.textDecoration,n.content=e.link?s.content||e.link:i.content,s.link=e.link;break;case"textDecoration":n.style.textDecoration=s.textDecoration=e.textDecoration}}(e.hyperlink,o,t),this.updateAnnotationContent(e,r,o,n,t,i),!0===r&&(o.measure(new nb(o.width,o.height)),o.arrange(o.desiredSize)),o instanceof vw||o.refreshTextElement()}}updatefixedUserHandleContent(e,t,i,n,s,r){void 0!==e&&this.updateConnectorfixedUserHandleWrapper(i,n,s,r)}updateConnectorfixedUserHandleWrapper(e,t,i,n){for(const s of this.views)NP(e.id+"_groupElement",s),NP(e.id+"_html_element",s);if(t instanceof Vw){const i=t.wrapper.children[0],n=new mb(i.offsetX-i.width/2,i.offsetY-i.height/2,i.width,i.height);e=t.getfixedUserHandle(t.fixedUserHandles[t.fixedUserHandles.length-1],t.intermediatePoints,n)}for(let s=0;s<n.children.length;s++)e.id===n.children[s].id&&n.children.splice(s,1,e)}updateAnnotationContent(e,t,i,n,s,r){void 0!==e.content&&(i&&(i.content="UmlActivity"===n.shape.type&&"StructuredNode"===n.shape.shape?"<<"+e.content+">>":e.content),i instanceof vw&&this.updateAnnotationWrapper(i,n,s,r)),void 0!==e.template&&(i.content=e.template,this.updateAnnotationWrapper(i,n,s,r))}updateAnnotationWrapper(e,t,i,n){for(const s of this.views)NP(e.id+"_groupElement",s),NP(e.id+"_html_element",s);if(t instanceof pP)e=t.initAnnotationWrapper(i,this.element.id);else if(t instanceof Vw){const i=t.wrapper.children[0],n=new mb(i.offsetX-i.width/2,i.offsetY-i.height/2,i.width,i.height);e=t.getAnnotationElement(t.annotations[t.annotations.length-1],t.intermediatePoints,n,this.getDescription,this.element.id)}for(let s=0;s<n.children.length;s++)e.id===n.children[s].id&&n.children.splice(s,1,e)}updateNodefixedUserHandle(e,t,i,n){let s=!1;const r=this.getWrapper(i,t.id);if(void 0!==r){if(void 0!==e.width&&(r.actualSize.width=e.width,s=!0),void 0!==e.height&&(r.height=e.height,s=!0),t instanceof Sw&&void 0!==e.offset){const i=e.offset;s=!0,r.setOffsetWithRespectToBounds(void 0!==i.x?i.x:t.offset.x,void 0!==i.y?i.y:t.offset.y,"Fraction"),r.relativeMode="Point"}void 0!==e.margin&&(s=!0,void 0!==e.margin.bottom&&(r.margin.bottom=e.margin.bottom),void 0!==e.margin.top&&(r.margin.top=e.margin.top),void 0!==e.margin.left&&(r.margin.left=e.margin.left),void 0!==e.margin.right&&(r.margin.right=e.margin.right)),void 0!==e.visibility&&(r.visible=e.visibility),void 0!==e.fill&&(r.style.fill=e.fill),void 0!==e.handleStrokeColor&&(r.style.strokeColor=e.handleStrokeColor),void 0!==e.handleStrokeWidth&&(r.style.strokeWidth=e.handleStrokeWidth),void 0!==e.cornerRadius&&(r.cornerRadius=e.cornerRadius),this.updatefixedUserHandleWrapper(r,n,t,i),!0===s&&(r.measure(new nb(r.width,r.height)),r.arrange(r.desiredSize))}}updatefixedUserHandleWrapper(e,t,i,n){for(const s of this.views)NP(e.id+"_groupElement",s),NP(e.id+"_html_element",s);t instanceof pP&&(e=t.initfixedUserHandles(i));for(let s=0;s<n.children.length;s++)e.id===n.children[s].id&&n.children.splice(s,1,e)}updatePort(e,t,i){let n=!1;const s=this.getWrapper(i,t.id);if(void 0!==s){if(void 0!==e.offset&&(n=!0,s.setOffsetWithRespectToBounds(void 0!==e.offset.x?e.offset.x:t.offset.x,void 0!==e.offset.y?e.offset.y:t.offset.y,"Fraction"),s.relativeMode="Point"),void 0!==e.width&&(n=!0,s.width=e.width),void 0!==e.height&&(n=!0,s.height=e.height),void 0!==e.visibility&&(s.visible=!(!i.visible||!lC(t,Nb.Visible))),void 0!==e.margin&&(n=!0,void 0!==e.margin.bottom&&(s.margin.bottom=e.margin.bottom),void 0!==e.margin.top&&(s.margin.top=e.margin.top),void 0!==e.margin.right&&(s.margin.right=e.margin.right),void 0!==e.margin.left&&(s.margin.left=e.margin.left)),void 0!==e.horizontalAlignment&&(n=!0,s.horizontalAlignment=e.horizontalAlignment),void 0!==e.verticalAlignment&&(n=!0,s.verticalAlignment=e.verticalAlignment),void 0!==e.style&&(void 0!==e.style.fill&&(s.style.fill=e.style.fill),void 0!==e.style.opacity&&(s.style.opacity=e.style.opacity),void 0!==e.style.strokeColor&&(s.style.strokeColor=e.style.strokeColor),void 0!==e.style.strokeWidth&&(s.style.strokeWidth=e.style.strokeWidth),void 0!==e.style.strokeDashArray&&(s.style.strokeDashArray=e.style.strokeDashArray)),void 0!==e.shape&&s){const t=Sv(e.shape);s.data=t,s.canMeasurePath=!0}void 0!==e.pathData&&(s.data=String(e.pathData),n=!0),!0===n&&(s.measure(new nb(s.width,s.height)),s.arrange(s.desiredSize))}}updateIcon(e){const t=this.getWrapper(e.wrapper,"icon_content"),i=this.diagramActions&Jb.Render?this.element.id:void 0;if(t){if("SVG"===this.mode){const t=PP(e.wrapper.id+"_icon_content",i);if(t){const e=PP(t.id+"_rect",i),n=PP(t.id+"_shape",i),s=PP(n.id+"_native_element",i);s&&s.parentNode.removeChild(s),n.parentNode.removeChild(n),e.parentNode.removeChild(e),t.parentNode.removeChild(t)}}const n=e.wrapper.children.indexOf(t);e.wrapper.children.splice(n,1)}const n=this.getPortContainer(e);e.initIcons(this.getDescription,this.layout,n,this.element.id)}getPortContainer(e){if(e.children)for(let t=0;t<e.wrapper.children.length;t++)if(e.wrapper.children[t].id===e.id+"group_container")return e.wrapper.children[t];return e.wrapper}updateTooltip(e,t){void 0!==t.tooltip.content&&(e.tooltip.content=t.tooltip.content),void 0!==t.tooltip.position&&(e.tooltip.position=t.tooltip.position),void 0!==t.tooltip.height&&(e.tooltip.height=t.tooltip.height),void 0!==t.tooltip.width&&(e.tooltip.width=t.tooltip.width),void 0!==t.tooltip.showTipPointer&&(e.tooltip.showTipPointer=t.tooltip.showTipPointer),void 0!==t.tooltip.relativeMode&&(e.tooltip.relativeMode=t.tooltip.relativeMode)}updateQuad(e){this.spatialSearch.updateQuad(e.wrapper)&&!this.preventDiagramUpdate&&this.updatePage()}removeFromAQuad(e){if(e.children){let t;const i=e.children;for(let e=0;e<i.length;e++)t=this.nameTable[i[e]],t&&this.removeFromAQuad(t)}this.spatialSearch.removeFromAQuad(e.wrapper),this.spatialSearch.updateBounds(e.wrapper)&&!this.preventDiagramUpdate&&this.updatePage()}updateGroupSize(e){let t;e.parentId&&(t=this.nameTable[e.parentId],t&&(t.parentId?this.updateGroupSize(t):(t.wrapper.measure(new nb),t.wrapper.arrange(t.wrapper.desiredSize),this.updateGroupOffset(t),this.updateDiagramObject(t))))}updatePage(){if(this.diagramActions&Jb.Render&&!(this.diagramActions&Jb.DragUsingMouse)){this.scroller.updateScrollOffsets(),this.scroller.setSize();for(const t of this.views){const i=this.views[t];i instanceof e||i.updateView(i)}}this.diagramActions&Jb.DragUsingMouse&&this.renderPageBreaks()}protectPropertyChange(e){this.isProtectedOnChange=e}getProtectPropertyChangeValue(){return this.isProtectedOnChange}enableServerDataBinding(e){}updateShadow(e,t){void 0!==t.angle&&(e.angle=t.angle),void 0!==t.color&&(e.color=t.color),void 0!==t.distance&&(e.distance=t.distance),void 0!==t.opacity&&(e.opacity=t.opacity)}updateMargin(e,t){void 0!==t.margin.top&&(e.margin.top=t.margin.top),void 0!==t.margin.bottom&&(e.margin.bottom=t.margin.bottom),void 0!==t.margin.left&&(e.margin.left=t.margin.left),void 0!==t.margin.right&&(e.margin.right=t.margin.right)}removePreviewChildren(e){if(e.children&&e.children.length&&e.shape&&"SwimLane"===e.shape.type){for(let i=0;i<e.children.length;i++){const t=e.children[i],n=this.nodes.indexOf(this.nameTable[t]);n>=0&&this.nodes.splice(n,1),delete this.nameTable[t]}const t=this.nodes.indexOf(this.nameTable[this.currentSymbol.id]);t>=0&&this.nodes.splice(t,1)}}initDroppables(){let e,t,i={},n={};this.droppable=new Mg(this.element),this.droppable.over=s=>{if(this.currentSymbol)s.event.touches&&s.event.touches.length&&this.eventHandler.mouseMove(s.event,s.event.touches);else{let r=null;if(!s.dragData&&"drag"===s.name){const e=document.getElementsByClassName("e-dragclone")[0];e&&(r=e)}if(s.dragData||r){let o,a;document.getElementById(this.element.id+"content").focus();const l=this.eventHandler.getMousePosition(s.event);let h;const c=r||s.dragData.helper,d=c.getAttribute("paletteId");let p,u,g,m;if(d){const r=document.getElementById(d).ej2_instances[0];this.droppable.sourceElement=r;const f="selectedSymbols",y="childTable";if(r){const d=r[f];this.allowServerDataBinding=!1,h=QP(r[f]),i=r[y];const b=d.wrapper.children[0].children[0];if(m=function(e,t,i){const n=EC(e,t,i,"width"),s=EC(e,t,i,"height");return new nb(n,s)}(r,h,b),r[f]instanceof pP){"TextAnnotation"===d.shape.shape?(h.offsetX=l.x+11+m.width*h.pivot.x,h.offsetY=l.y+11+m.height*h.pivot.y):(h.offsetX=l.x+5+m.width*h.pivot.x,h.offsetY=l.y+m.height*h.pivot.y);let s=new pP(this,"nodes",h,!0);"Bpmn"===s.shape.type&&s.shape.activity.subProcess.processes&&s.shape.activity.subProcess.processes.length&&(s.shape.activity.subProcess.processes=[]),p=s.dragSize,u=s.previewSize,g=r.symbolDragSize;const c=r.symbolPreview;if(s.width=p.width||g.width||u.width||c.width||s.width,s.height=p.height||g.height||u.height||c.height||s.height,"SwimLane"===s.shape.type){if(this.diagramActions|=Jb.PreventHistory,s.shape.isLane){s.children=[],e={id:"header"+XP()},"Horizontal"===s.shape.orientation?(e.width=s.shape.lanes[0].header.width,e.height=s.shape.lanes[0].height):(e.width=s.shape.lanes[0].width,e.height=s.shape.lanes[0].header.height),e.style=s.shape.lanes[0].header.style,e.offsetX=l.x+5+e.width/2,e.offsetY=l.y+e.height/2,this.diagramActions|=Jb.PreventCollectionChangeOnDragOver,e=this.add(e),t={id:"body"+XP()},"Horizontal"===s.shape.orientation?(t.width=s.shape.lanes[0].width-e.width,t.height=s.shape.lanes[0].height,t.offsetX=l.x+5+(s.shape.lanes[0].header.width+t.width/2),t.offsetY=l.y+t.height/2):(t.width=s.shape.lanes[0].width,t.height=s.shape.lanes[0].height-e.height,t.offsetX=l.x+5+t.width/2,t.offsetY=l.y+(s.shape.lanes[0].header.height+t.height/2)),t.style=s.shape.lanes[0].style,t=this.add(t);const i={id:"group"+XP(),children:[e.id,t.id]};i.shape=s.shape,i.width=s.shape.lanes[0].width,i.height=s.shape.lanes[0].height,i.previewSize=s.previewSize,i.dragSize=s.dragSize,i.addInfo=s.addInfo,s=this.add(i),this.diagramActions&=~Jb.PreventCollectionChangeOnDragOver}this.diagramActions&=~Jb.PreventHistory}if(s.shape.isPhase&&(a="Horizontal"===s.shape.orientation,a?(s.offsetX=l.x+5+(s.width||b.actualSize.width)/2,s.offsetY=l.y,s.shape.data="M20,"+s.height/2+" L"+(s.width-20)+","+s.height/2+"z",s.height=1):(s.offsetX=l.x+5,s.offsetY=l.y+(s.height||b.actualSize.height)/2,s.shape.data="M"+s.width/2+",20 L"+s.width/2+","+(s.height-20)+"z",s.width=1)),o=s,h.children){const e=h;n=this.getChildren(e,{},i),uC(e,-e.offsetX,-e.offsetY,n,!0,this)}}else if(r[f]instanceof Vw){o=new Vw(this,"connectors",h,!0);const e=mb.toBounds([o.sourcePoint,o.targetPoint]),t=l.x-e.left,i=l.y-e.top;o.sourcePoint.x+=t,o.sourcePoint.y+=i,o.targetPoint.x+=t,o.targetPoint.y+=i}o.shape.isLane||(o.id+=XP());let v={source:r,element:o,cancel:!1,diagram:this};if(this.enterObject=o,this.enterTable=n,this.triggerEvent(nv.dragEnter,v),o instanceof pP&&"SwimLane"===o.shape.type&&o.shape.isLane){const i=v.element,n=i.shape.lanes[0];a="Horizontal"===i.shape.orientation;const s=this.nameTable[o.children[0]],h=this.nameTable[o.children[1]];p=o.dragSize,u=o.previewSize,g=r.symbolDragSize,n.width=p.width||g.width||u.width||n.width,n.height=p.height||g.height||u.height||n.height,a?(e.width=n.header.width,e.height=n.height,t.width=n.width-e.width,t.height=n.height,t.offsetX=l.x+5+(n.header.width+h.width/2),t.offsetY=l.y+h.height/2):(e.width=n.width,e.height=n.header.height,t.width=n.width,t.height=n.height-e.height,t.offsetX=l.x+5+h.width/2,t.offsetY=l.y+(n.header.height+h.height/2)),e.offsetX=l.x+5+s.width/2,e.offsetY=l.y+s.height/2,o.width=n.width,o.height=n.height}o instanceof pP&&o.shape.isPhase&&(a?o.height=1:o.width=1),this.activeLayer.lock||v.cancel||(this.preventDiagramUpdate=!0,o.children&&this.findChild(o,n),this.preventDiagramUpdate=!0,-1!==o.zIndex&&(o.zIndex=-1),this.initObject(o,void 0,void 0,!0),this.currentSymbol=o,"SVG"!==this.mode&&this.refreshDiagramLayer(),this.commandHandler.oldSelectedObjects=xC(this),this.commandHandler.select(o),this.commandHandler.updateBlazorSelector(),this.eventHandler.mouseDown(s.event),this.eventHandler.mouseMove(s.event,s),this.preventDiagramUpdate=!1,this.updatePage(),c.style.opacity="0"),delete this.enterObject,delete this.enterTable}this.droppable[f]=c,this.allowServerDataBinding=!0}}}},this.droppable.drop=e=>vT(this,void 0,void 0,function*(){this.allowServerDataBinding=!1;const t="sourceElement";let i;if(this.currentSymbol){let n,s=!1;const r=this.currentSymbol instanceof Vw;let o;e.event.touches&&this.eventHandler.mouseUp(e.event),o={source:this.droppable[t],element:this.currentSymbol,target:this.eventHandler.hoverNode||this.eventHandler.lastObjectUnderMouse||this,cancel:!1,position:{x:this.currentSymbol.wrapper.offsetX,y:this.currentSymbol.wrapper.offsetY}},this.triggerEvent(nv.drop,o);const a="id",l=QP(this.currentSymbol);if(l.hasTarget=this.currentSymbol.hasTarget,this.removeFromAQuad(this.currentSymbol),this.removeObjectsFromLayer(this.nameTable[this.currentSymbol.id]),this.removeElements(this.currentSymbol),(this.currentSymbol.shape.isLane||this.currentSymbol.shape.isPhase)&&this.removeChildInNodes(this.currentSymbol),o.cancel&&GS(this.currentSymbol,this),this.currentSymbol.shape.isPhase&&(s=!0,n=this.currentSymbol.shape.orientation),this.removePreviewChildren(this.currentSymbol),delete this.nameTable[this.currentSymbol.id],this.currentSymbol=null,this.protectPropertyChange(!0),o.cancel)this.clearSelectorLayer();else{if(this.startGroupAction(),l&&(l.shape.isLane||s)&&(s&&(l.shape.isPhase=s,l.shape.orientation=n),this.eventHandler.addSwimLaneObject(l)),"Bpmn"===l.shape.type&&l.shape.annotation&&l.hasTarget){const e=l.shape.annotation.nodeId;l.shape.annotation.id=l.id,this.addTextAnnotation(l.shape.annotation,this.nameTable[e]),l.nodeId=""}l.shape.isLane||s||(l.children&&this.addChildNodes(l),o.target&&o.target instanceof pP&&!r&&Yx(this,o.target)&&ux(o.target)?qx(this,o.target,l):i=this.add(l,!0),(l||i)&&mx(this)&&this.select([this.nameTable[l[a]]]))}this.protectPropertyChange(!1);const h=this.nameTable[l[a]];l.hasTarget&&(l.nodeId=l.hasTarget,this.remove(l)),this.bpmnModule&&h instanceof pP&&l.processId&&(h.processId=l.processId,this.bpmnModule.dropBPMNchild(this.nameTable[h.processId],h,this)),o.cancel||this.endGroupAction(),"SVG"!==this.mode&&this.refreshDiagramLayer(),delete this.droppable[t]}else{this.triggerEvent(nv.drop,{source:e.droppedElement,element:void 0,target:this.eventHandler.hoverNode||this.eventHandler.lastObjectUnderMouse||this,cancel:!1,position:void 0})}if(this.droppable.selectedSymbols&&this.droppable.selectedSymbols.parentNode)Ru(this.droppable.selectedSymbols);else{const e=document.getElementsByClassName("e-dragclone");for(let t=0;t<e.length;t++)e[t].remove()}this.allowServerDataBinding=!0}),this.droppable.out=e=>{if(this.currentSymbol&&!this.eventHandler.focus){this.unSelect(this.currentSymbol),this.removeFromAQuad(this.currentSymbol),"SVG"!==this.mode&&"Native"===this.currentSymbol.shape.type&&this.removeElements(this.currentSymbol),this.removeObjectsFromLayer(this.nameTable[this.currentSymbol.id]),this.removePreviewChildren(this.currentSymbol),delete this.nameTable[this.currentSymbol.id],this.triggerEvent(nv.dragLeave,{element:this.currentSymbol,diagram:this}),"SVG"!==this.mode?this.refreshDiagramLayer():this.removeElements(this.currentSymbol),this.currentSymbol=null,this.droppable.selectedSymbols.style.opacity="1",delete this.droppable.sourceElement,this.diagramRenderer.rendererActions=this.removeConstraints(this.diagramRenderer.rendererActions,Kb.DrawSelectorBorder),this.previousSelectedObject&&this.select(this.previousSelectedObject,this.previousSelectedObject.length>1),this.previousSelectedObject=null}}}getBlazorDragLeaveEventArgs(e){return{diagramId:this.element.id,element:yC(e.element)===Vw?{connector:e.element}:{node:e.element}}}getDropEventArgs(e){if(this.eventHandler.lastObjectUnderMouse||this.eventHandler.hoverNode){const t=this.eventHandler.lastObjectUnderMouse||this.eventHandler.hoverNode;e.target=yC(t)===Vw?{connector:t}:{node:t}}else e.target.diagramId=this.element.id}removeChildInNodes(e){if(e){if(e.children)for(let i=0;i<e.children.length;i++)this.removeChildInNodes(this.nameTable[e.children[i]]);const t=this.nodes.indexOf(e);-1!==t&&this.nodes.splice(t,1)}}getBlazorDragEventArgs(e){return{source:e.source,element:yC(e.element)===Vw?{connector:e.element}:{node:e.element},cancel:e.cancel,diagramId:this.element.id}}findChild(e,t){let i,n;for(let s=0;s<e.children.length;s++)i=t[e.children[s]],i&&(i.children&&this.findChild(i,t),i.id=i.id+XP(),t[i.id]=i,e.children[s]=i.id,n=new pP(this,"nodes",i,!0),this.initObject(n,void 0,void 0,!0))}getChildren(e,t,i){let n;for(let s=0;s<e.children.length;s++)n=i[e.children[s]],n&&(n.children&&(t=this.getChildren(n,t,i)),t[n.id]=QP(n));return t}addChildNodes(e){let t;for(let i=0;i<e.children.length;i++)t=this.nameTable[e.children[i]],t&&(t.children&&this.addChildNodes(t),this.add(t,!0))}moveNode(e){const t=this.commandHandler.getObjectLayer(e.id),i=t.zIndex,n=t.objects.length;let s;for(let r=0;r<this.layers.length;r++)i===this.layers[r].zIndex&&(s=this.layers[r+1]);if(n>1)this.commandHandler.moveSvgNode(e.id,t.objects[n-2]),this.commandHandler.moveSvgNode(t.objects[n-2],e.id);else if(s){const i=this.commandHandler.getLayer(this.layerZIndexTable[s.zIndex]).objects[0];i?(this.commandHandler.moveSvgNode(e.id,i),this.commandHandler.updateNativeNodeIndex(e.id,i)):this.moveObjectsUp(e,t)}else this.moveObjectsUp(e,t)}moveObjectsUp(e,t){let i;for(let n=this.layers.length-1;n>=0;n--)if(i=this.layers[n],t.id!==i.id){const t=this.commandHandler.getLayer(this.layerZIndexTable[i.zIndex]).objects[i.objects.length-1];if(t){this.commandHandler.moveSvgNode(e.id,t),this.commandHandler.moveSvgNode(t,e.id);break}}}insertData(e){return this.crudOperation(e,"create",this.getNewUpdateNodes("New"))}updateData(e){return this.crudOperation(e,"update",this.getNewUpdateNodes("Update"))}removeData(e){return this.crudOperation(e,"destroy",this.getDeletedNodes())}crudOperation(e,t,i){if(e){const i=this.parameterMap(e,!(e instanceof Vw));if(i){const n=e instanceof Vw?this.dataSourceSettings.connectionDataSource.crudAction[t]:this.dataSourceSettings.crudAction[t];this.raiseAjaxPost(JSON.stringify(i),n)}return i}{const e=i;return this.processCrudCollection(e,this.dataSourceSettings.crudAction[t],this.dataSourceSettings.connectionDataSource.crudAction[t]),e}}processCrudCollection(e,t,i){if(e.nodes){const i=[];let n;for(n=0;n<e.nodes.length;n++)i.push(this.parameterMap(e.nodes[n],!0));i&&i.length>0&&this.raiseAjaxPost(JSON.stringify(i),t)}if(e.connectors){const t=[];let n;for(n=0;n<e.connectors.length;n++)t.push(this.parameterMap(e.connectors[n],!1));t&&t.length>0&&this.raiseAjaxPost(JSON.stringify(t),i)}}parameterMap(e,t){const i={};let n;const s=t?this.dataSourceSettings:this.dataSourceSettings.connectionDataSource;if(s.id&&(i[s.id]=e.id),s.sourcePointX&&s.sourcePointY&&(i[s.sourcePointX]=e.sourcePoint.x,i[s.sourcePointY]=e.sourcePoint.y),s.targetPointX&&s.targetPointY&&(i[s.targetPointX]=e.targetPoint.x,i[s.targetPointY]=e.targetPoint.y),s.sourceID&&(i[s.sourceID]=e.sourceID),s.targetID&&(i[s.targetID]=e.targetID),s.crudAction&&s.crudAction.customFields&&s.crudAction.customFields.length>0)for(n=0;n<s.crudAction.customFields.length;n++)i[s.crudAction.customFields[n]]=e[s.crudAction.customFields[n]];return i}getNewUpdateNodes(e){const t=[],i=[];for(const n in this.nameTable){const s=this.nameTable[n];s.status===e&&(s&&s instanceof Vw?(s.status="None",i.push(s)):(s.status="None",t.push(s)))}return{nodes:t,connectors:i}}getDeletedNodes(){const e=[],t=[];let i;for(i=0;i<this.crudDeleteNodes.length;i++){const n=this.crudDeleteNodes[i];n&&n.segments?t.push(n):n&&e.push(n)}return this.crudDeleteNodes=[],{nodes:e,connectors:t}}raiseAjaxPost(e,t){const i=new cu(t,"POST",!0,"application/json"),n=JSON.stringify(JSON.parse(e));i.send(n).then(),i.onSuccess=e=>{}}getHiddenItems(e){if(this.contextMenuModule){this.contextMenuModule.hiddenItems=[];for(const t of e.items)if(this.contextMenuModule.ensureItems(t,e.event),t.items&&t.items.length)for(const i of t.items)this.contextMenuModule.ensureItems(i,e.event);return this.contextMenuModule.hiddenItems}return[]}}return bT([ig("100%")],e.prototype,"width",void 0),bT([ig("SVG")],e.prototype,"mode",void 0),bT([ig("100%")],e.prototype,"height",void 0),bT([ng({},jx)],e.prototype,"contextMenuSettings",void 0),bT([ig(Gb.Default)],e.prototype,"constraints",void 0),bT([ig(qb.Default)],e.prototype,"tool",void 0),bT([ig("Top")],e.prototype,"bridgeDirection",void 0),bT([ig("transparent")],e.prototype,"backgroundColor",void 0),bT([ng({},xO)],e.prototype,"snapSettings",void 0),bT([ng({},PO)],e.prototype,"rulerSettings",void 0),bT([ng({},fO)],e.prototype,"pageSettings",void 0),bT([ng({},gT)],e.prototype,"serializationSettings",void 0),bT([rg([],pP)],e.prototype,"nodes",void 0),bT([ig()],e.prototype,"drawingObject",void 0),bT([rg([],Vw)],e.prototype,"connectors",void 0),bT([ig([])],e.prototype,"basicElements",void 0),bT([ng({},hw)],e.prototype,"tooltip",void 0),bT([ng({},DO)],e.prototype,"dataSourceSettings",void 0),bT([ig()],e.prototype,"addInfo",void 0),bT([ig()],e.prototype,"historyManager",void 0),bT([ig()],e.prototype,"nodeTemplate",void 0),bT([ig()],e.prototype,"annotationTemplate",void 0),bT([ig()],e.prototype,"userHandleTemplate",void 0),bT([ig()],e.prototype,"getNodeDefaults",void 0),bT([ig()],e.prototype,"nodeDefaults",void 0),bT([ig()],e.prototype,"getConnectorDefaults",void 0),bT([ig()],e.prototype,"connectorDefaults",void 0),bT([ig()],e.prototype,"setNodeTemplate",void 0),bT([ig()],e.prototype,"getDescription",void 0),bT([ig()],e.prototype,"getCustomProperty",void 0),bT([ig()],e.prototype,"getCustomTool",void 0),bT([ig()],e.prototype,"getCustomCursor",void 0),bT([rg([],fT)],e.prototype,"customCursor",void 0),bT([ig()],e.prototype,"updateSelection",void 0),bT([ng({},yT)],e.prototype,"diagramSettings",void 0),bT([ng({},bP)],e.prototype,"selectedItems",void 0),bT([ng({},yO)],e.prototype,"scrollSettings",void 0),bT([ng({},RO)],e.prototype,"layout",void 0),bT([ng({},kx)],e.prototype,"commandManager",void 0),bT([og()],e.prototype,"dataLoaded",void 0),bT([og()],e.prototype,"dragEnter",void 0),bT([og()],e.prototype,"dragLeave",void 0),bT([og()],e.prototype,"dragOver",void 0),bT([og()],e.prototype,"click",void 0),bT([og()],e.prototype,"historyChange",void 0),bT([og()],e.prototype,"historyStateChange",void 0),bT([og()],e.prototype,"doubleClick",void 0),bT([og()],e.prototype,"textEdit",void 0),bT([og()],e.prototype,"scrollChange",void 0),bT([og()],e.prototype,"selectionChange",void 0),bT([og()],e.prototype,"sizeChange",void 0),bT([og()],e.prototype,"connectionChange",void 0),bT([og()],e.prototype,"sourcePointChange",void 0),bT([og()],e.prototype,"targetPointChange",void 0),bT([og()],e.prototype,"propertyChange",void 0),bT([og()],e.prototype,"positionChange",void 0),bT([og()],e.prototype,"keyUp",void 0),bT([og()],e.prototype,"keyDown",void 0),bT([og()],e.prototype,"animationComplete",void 0),bT([og()],e.prototype,"rotateChange",void 0),bT([og()],e.prototype,"collectionChange",void 0),bT([og()],e.prototype,"fixedUserHandleClick",void 0),bT([og()],e.prototype,"onUserHandleMouseDown",void 0),bT([og()],e.prototype,"onUserHandleMouseUp",void 0),bT([og()],e.prototype,"onUserHandleMouseEnter",void 0),bT([og()],e.prototype,"onUserHandleMouseLeave",void 0),bT([og()],e.prototype,"segmentCollectionChange",void 0),bT([og()],e.prototype,"onImageLoad",void 0),bT([og()],e.prototype,"expandStateChange",void 0),bT([og()],e.prototype,"created",void 0),bT([og()],e.prototype,"mouseEnter",void 0),bT([og()],e.prototype,"mouseLeave",void 0),bT([og()],e.prototype,"mouseOver",void 0),bT([og()],e.prototype,"contextMenuOpen",void 0),bT([og()],e.prototype,"contextMenuBeforeItemRender",void 0),bT([og()],e.prototype,"contextMenuClick",void 0),bT([og()],e.prototype,"commandExecute",void 0),bT([rg([],lT)],e.prototype,"layers",void 0),bT([og()],e.prototype,"drop",void 0),e})();function xT(e,t,i){var n={};if(e&&e.length){for(var s=0,r=e;s<r.length;s++){var o=r[s];!0===i?(t.propCollection[o]=new xo(!1),t[o]=t.propCollection[o]):n[o]=new xo(!1)}!0!==i&&t.setProperties(n,!0)}}function ST(e,t,i){var n=Object.keys(e.registeredTemplate);if(n.length)for(var s=t&&t.filter(function(e){return!/\./g.test(e)}),r=0,o=s&&s||n;r<o.length;r++){var a=o[r];if(i&&i.length)for(var l=0;l<i.length;l++)for(var h=0;h<e.registeredTemplate.template.length;h++)e.registeredTemplate.template[h].rootNodes[0]===i[l]&&(p=e.registeredTemplate[a])[h].destroy();else if(e.registeredTemplate[a])for(var c=0,d=e.registeredTemplate[a];c<d.length;c++){var p;if(!(p=d[c]).destroyed){if(p._view){var u=p._view.renderer.parentNode(p.rootNodes[0]);if(!jp(u))for(h=0;h<p.rootNodes.length;h++)u.appendChild(p.rootNodes[h])}p.destroy()}}delete e.registeredTemplate[a]}for(var g=function(e){e.instance&&e.instance.clearTemplate(t&&t.filter(function(t){return!!new RegExp(e.name).test(t)}))},m=0,f=e.tagObjects;m<f.length;m++)g(f[m])}function CT(e,t,i){for(var n=e.replace(/\[/g,".").replace(/\]/g,"").split("."),s=i||{},r=0;r<n.length;r++){var o=n[r];r+1===n.length?s[o]=void 0===t?{}:t:void 0===s[o]&&(s[o]={}),s=s[o]}return s}var PT=/Ref$/,OT=function(){function e(){this.hasChanges=!1,this.propCollection={},this.dataSource={},this.tags=[],this.tagObjects=[]}return e.prototype.ngOnInit=function(){this.registeredTemplate={};for(var e=0,t=this.tags;e<t.length;e++){var i=t[e],n=Mp("child"+i.substring(0,1).toUpperCase()+i.substring(1),this);n&&this.tagObjects.push({instance:n,name:i})}for(var s=Object.keys(this),r=0,o=s=s.filter(function(e){return/Ref$/i.test(e)});r<o.length;r++){var a=o[r].replace("Ref","");Rp(a.replace("_","."),Mp(a,this),this.propCollection)}var l=Object.keys(this);if(this.directivePropList){for(var h=0;h<this.directivePropList.length;h++){var c=this.directivePropList[h];-1!==l.indexOf(c)&&Mp(c,this)&&Rp(c,Mp(c,this),this.propCollection)}this.hasChanges=!0}this.isInitChanges=!0},e.prototype.registerEvents=function(e){xT(e,this,!0)},e.prototype.ngOnChanges=function(e){for(var t=0,i=Object.keys(e);t<i.length;t++){var n=i[t];this.propCollection[n]=e[n].currentValue}this.isUpdated=!1,this.hasChanges=!0},e.prototype.clearTemplate=function(e){ST(this,e)},e.prototype.getProperties=function(){for(var e=0,t=this.tagObjects;e<t.length;e++){var i=t[e];this.propCollection[i.name]=i.instance.getProperties()}return this.propCollection},e.prototype.isChanged=function(){var e=this.hasChanges;if(!jp(this.propCollection[this.property]))for(var t=Object.keys(this.propCollection[this.property][0]),i=0;i<t.length;i++)if(!jp(this.propCollection[t[i]])){var n=Mp(t[i],this),s=this.propCollection[this.property][0][t[i]];jp(n)||this.propCollection[t[i]]===n||s===n||(Rp(t[i],n,this.propCollection[this.property][0]),Rp(t[i],n,this.propCollection),this.hasChanges=!0,this.isUpdated=!1)}for(var r=0,o=this.tagObjects;r<o.length;r++)e=e||o[r].instance.hasChanges;return e||this.hasChanges},e.prototype.ngAfterContentChecked=function(){if(this.hasChanges=this.isChanged(),this.isInitChanges||this.hasChanges)for(var e=Object.keys(this),t=0,i=e=e.filter(function(e){return PT.test(e)});t<i.length;t++){var n=i[t].replace("Ref","");Rp(n.replace("_","."),Mp(n,this),this.propCollection)}},e.prototype.ngAfterViewChecked=function(){this.isUpdated&&(this.hasChanges=!1)},e.prototype.ngAfterViewInit=function(){this.isInitChanges=!1},e.prototype.ngOnDestroy=function(){this.directivePropList=[]},e}(),TT=function(){function e(e){this.list=[],this.hasChanges=!1,this.propertyName=e}return e.prototype.ngOnInit=function(){this.isInitChanges=!0},e.prototype.ngAfterContentInit=function(){var e=this,t=0;this.list=this.children.map(function(i){return i.dirIndex=t++,i.property=e.propertyName,i}),this.hasChanges=!0},e.prototype.getProperties=function(){for(var e=[],t=0,i=this.list;t<i.length;t++)e.push(i[t].getProperties());return e},e.prototype.isChanged=function(){var e=this,t=!1,i=0,n=!1,s=this.children.map(function(e){return e});if(this.list.length===this.children.length)for(var r=0;r<this.list.length;r++)this.list[r].propCollection.dataSource&&(this.list[r].dataSource&&this.list[r].propCollection.dataSource!==this.list[r].dataSource&&(this.list[r].propCollection.dataSource=this.list[r].dataSource,this.list[r].hasChanges=!0),n=JSON.stringify(this.list[r].propCollection.dataSource)!==JSON.stringify(s[r].propCollection.dataSource));this.hasNewChildren=!(this.list.length===this.children.length&&!n)||null,this.hasNewChildren&&(this.list=this.children.map(function(t){return t.dirIndex=i++,t.property=e.propertyName,t}));for(var o=0,a=this.list;o<a.length;o++)t=t||a[o].hasChanges;return!!this.list.length&&t},e.prototype.clearTemplate=function(e){for(var t=this,i=0,n=this.list;i<n.length;i++)n[i].clearTemplate(e&&e.map(function(e){return new RegExp(t.propertyName).test(e)?e.replace(t.propertyName+".",""):e}))},e.prototype.ngAfterContentChecked=function(){this.hasChanges=this.isChanged();for(var e=0;e<this.list.length;e++)this.list[e].isUpdated=!0},e.prototype.ngAfterViewInit=function(){this.isInitChanges=!1},e.prototype.ngOnDestroy=function(){this.list=[]},e}(),ET=function(){function e(){this.isProtectedOnChange=!0,this.isFormInit=!0}return e.prototype.saveChanges=function(e,t,i){if(!this.isProtectedOnChange){this.oldProperties[e]=i,this.changedProperties[e]=t,this.finalUpdate();var n=setTimeout(this.dataBind.bind(this));this.finalUpdate=function(){clearTimeout(n)}}},e.prototype.ngOnInit=function(e){var t=e||this;t.registeredTemplate={},t.ngBoundedEvents={},t.isAngular=!0,t.isFormInit=!0,e&&(this.tags=e.tags),t.tags=this.tags||[],t.complexTemplate=this.complexTemplate||[],t.tagObjects=[],t.ngAttr=this.getAngularAttr(t.element),t.createElement=function(e,i){var n=t.srenderer?t.srenderer.createElement(e):Cu(e);return void 0===i||(n.innerHTML=i.innerHTML?i.innerHTML:"",void 0!==i.className&&(n.className=i.className),void 0!==i.id&&(n.id=i.id),void 0!==i.styles&&n.setAttribute("style",i.styles),void 0!==t.ngAttr&&n.setAttribute(t.ngAttr,""),void 0!==i.attrs&&zu(n,i.attrs)),n};for(var i=0,n=t.tags;i<n.length;i++){var s=n[i],r={instance:Mp("child"+s.substring(0,1).toUpperCase()+s.substring(1),t),name:s};t.tagObjects.push(r)}for(var o=Object.keys(t),a=0,l=o=o.filter(function(e){return/Ref$/i.test(e)&&/\_/i.test(e)});a<l.length;a++){var h=l[a].replace("Ref",""),c={};Rp(h.replace("_","."),Mp(h,t),c),t.setProperties(c,!0)}},e.prototype.getAngularAttr=function(e){for(var t,i=e.attributes,n=i.length,s=0;s<n;s++)/_ngcontent/g.test(i[s].name)&&(t=i[s].name);return t},e.prototype.ngAfterViewInit=function(e){var t=e||this;/ejs-tab|ejs-accordion/g.test(t.ngEle.nativeElement.outerHTML)&&(t.ngEle.nativeElement.style.visibility="hidden");for(var i=Object.keys(t),n=0,s=i=i.filter(function(e){return/Ref$/i.test(e)});n<s.length;n++){var r=s[n].replace("Ref","");Rp(r.replace("_","."),Mp(r+"Ref",t),t)}"btn"===t.getModuleName()?"undefined"!=typeof window&&document.body.contains(t.element)&&(t.appendTo(t.element),t.ngEle.nativeElement.style.visibility=""):setTimeout(function(){"undefined"!=typeof window&&document.body.contains(t.element)&&(t.appendTo(t.element),t.ngEle.nativeElement.style.visibility="")})},e.prototype.ngOnDestroy=function(e){var t=e||this;setTimeout(function(){"undefined"!=typeof window&&t.element.classList.contains("e-control")&&(t.destroy(),t.clearTemplate(null),t.ngBoundedEvents={},t.tagObjects={},t.ngEle=null)})},e.prototype.clearTemplate=function(e,t){ST(this,e,t)},e.prototype.ngAfterContentChecked=function(e){for(var t=e||this,i=0,n=t.tagObjects;i<n.length;i++){var s=n[i];if(!Hp(s.instance)&&(s.instance.isInitChanges||s.instance.hasChanges||s.instance.hasNewChildren))if(s.instance.isInitChanges){var r={},o=void 0;(x=Mp("instance.list",s))&&x.length&&(o=x[0].directivePropList);var a=!0;if(t.getModuleName&&"gantt"===t.getModuleName()&&(a=!1),o&&a&&-1===o.indexOf(s.instance.propertyName))for(var l=Object.keys(s.instance.list[0].propCollection),h=0;h<s.instance.list.length;h++){s.instance.list[h].propCollection[s.instance.propertyName]=[];for(var c={},d=0;d<l.length;d++)c[E=l[d]]=s.instance.list[h].propCollection[E];for(var p=0;p<s.instance.list[h].tags.length;p++){var u=s.instance.list[h].tags[p],g=Mp("child"+u.substring(0,1).toUpperCase()+u.substring(1),s.instance.list[h]);if(g){var m=s.instance.list[h]["child"+u.substring(0,1).toUpperCase()+u.substring(1)];if(m)for(var f=0;f<m.list.length;f++){var y=m.list[0].tags[0];if(y){var b=Mp("child"+y.substring(0,1).toUpperCase()+y.substring(1),m.list[f]);b&&m.list[f].tagObjects.push({instance:b,name:y})}}s.instance.list[h].tagObjects.push({instance:g,name:u})}}s.instance.list[h].propCollection[s.instance.propertyName].push(c)}r[s.name]=s.instance.getProperties(),t.setProperties(r,s.instance.isInitChanges)}else{t[s.name].length===s.instance.list.length&&"diagram"!==t.getModuleName()||(t[s.name]=s.instance.list);for(var v=0,w=s.instance.list;v<w.length;v++){var x,S=s.instance.list.indexOf(x=w[v]),C=Mp(s.name,t)[S],P=Object.keys(C);if(P=P.filter(function(e){return/Ref$/i.test(e)}),C.properties&&0!==Object.keys(C.properties).length&&/chart/.test(t.getModuleName()))for(var O=0,T=P;O<T.length;O++){var E;E=(E=T[O]).replace(/Ref/,""),C.properties[E]=C.properties[E]?C.properties[E]:C.propCollection[E]}Hp(C)||Hp(C.setProperties)||(/diagram|DashboardLayout/.test(t.getModuleName())?C.setProperties(x.getProperties(),!0):C.setProperties(x.getProperties())),x.isUpdated=!0}}}},e.prototype.registerEvents=function(e){xT(e,this)},e.prototype.twoWaySetter=function(e,t){var i=Mp(t,this.properties);i!==e&&(this.saveChanges(t,e,i),Rp(t,jp(e)?null:e,this.properties),Mp(t+"Change",this).emit(e))},e.prototype.addTwoWay=function(e){for(var t=this,i=function(e){Mp(e,n),Object.defineProperty(n,e,{get:function(){return Mp(e,t.properties)},set:function(i){return t.twoWaySetter(i,e)}}),Rp(e+"Change",new xo,n)},n=this,s=0,r=e;s<r.length;s++)i(r[s])},e.prototype.addEventListener=function(e,t){var i=Mp(e,this);Hp(i)||(this.ngBoundedEvents[e]||(this.ngBoundedEvents[e]=new Map),this.ngBoundedEvents[e].set(t,i.subscribe(t)))},e.prototype.removeEventListener=function(e,t){Hp(Mp(e,this))||this.ngBoundedEvents[e].get(t).unsubscribe()},e.prototype.trigger=function(e,t,i){var n=Mp(e,this),s=this.isProtectedOnChange;this.isProtectedOnChange=!1,t&&(t.name=e),Hp(n)||n.next(t);var r=Mp("local"+e.charAt(0).toUpperCase()+e.slice(1),this);Hp(r)||r.call(this,t),this.isProtectedOnChange=s,i&&(this.preventChange=this.isPreventChange,i.call(this,t)),this.isPreventChange=!1},e}(),AT=hm.compile;function IT(e){return function(t,i){var n={set:DT(i),get:MT(i,e),enumerable:!0,configurable:!0};Object.defineProperty(t,i,n)}}function DT(e){return function(t){void 0!==t&&(Rp(e+"Ref",t,this),"string"!=typeof t?(t.elementRef.nativeElement._viewContainerRef=this.viewContainerRef,t.elementRef.nativeElement.propName=e):this.saveChanges&&(this.saveChanges(e,t,void 0),this.dataBind()))}}function MT(e,t){return function(){return Mp(e+"Ref",this)||t}}hm.compile=function(e,t){if("string"==typeof e)return AT(e,t);var i=e.elementRef.nativeElement._viewContainerRef,n=e.elementRef.nativeElement.propName;return function(t,s,r){var o=i||s.viewContainerRef,a=o.createEmbeddedView(e,{$implicit:t});a.markForCheck();var l=s&&s.registeredTemplate?s.registeredTemplate:Mp("currentInstance.registeredTemplate",o);return void 0===l[r=r&&s.registeredTemplate?r:n]&&(l[r]=[]),l[r].push(a),a.rootNodes}};const RT=["annotationTemplate"],zT=["nodeTemplate"],LT=["userHandleTemplate"];let kT=["addInfo","id","lock","objects","visible","zIndex"],jT=[],HT=(()=>{class e extends OT{constructor(e){super(),this.viewContainerRef=e,CT("currentInstance",this,this.viewContainerRef),this.registerEvents(jT),this.directivePropList=kT}}return e.\u0275fac=function(t){return new(t||e)(qs(so))},e.\u0275dir=Ye({type:e,selectors:[["e-layer"]],inputs:{addInfo:"addInfo",id:"id",lock:"lock",objects:"objects",visible:"visible",zIndex:"zIndex"},features:[Ns]}),e})(),_T=(()=>{class e extends TT{constructor(){super("layers")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ye({type:e,selectors:[["e-layers"]],contentQueries:function(e,t,i){if(1&e&&Lo(i,HT,4),2&e){let e;zo(e=ko())&&(t.children=e)}},features:[Ns]}),e})(),NT=["action","cursor"],BT=[],WT=(()=>{class e extends OT{constructor(e){super(),this.viewContainerRef=e,CT("currentInstance",this,this.viewContainerRef),this.registerEvents(BT),this.directivePropList=NT}}return e.\u0275fac=function(t){return new(t||e)(qs(so))},e.\u0275dir=Ye({type:e,selectors:[["e-cursormap"]],inputs:{action:"action",cursor:"cursor"},features:[Ns]}),e})(),UT=(()=>{class e extends TT{constructor(){super("customcursor")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ye({type:e,selectors:[["e-cursormaps"]],contentQueries:function(e,t,i){if(1&e&&Lo(i,WT,4),2&e){let e;zo(e=ko())&&(t.children=e)}},features:[Ns]}),e})(),FT=["alignment","cornerRadius","displacement","fill","handleStrokeColor","handleStrokeWidth","height","iconStrokeColor","iconStrokeWidth","id","offset","padding","pathData","visibility","width"],VT=[],YT=(()=>{class e extends OT{constructor(e){super(),this.viewContainerRef=e,CT("currentInstance",this,this.viewContainerRef),this.registerEvents(VT),this.directivePropList=FT}}return e.\u0275fac=function(t){return new(t||e)(qs(so))},e.\u0275dir=Ye({type:e,selectors:[["e-connector-fixeduserhandle"]],inputs:{alignment:"alignment",cornerRadius:"cornerRadius",displacement:"displacement",fill:"fill",handleStrokeColor:"handleStrokeColor",handleStrokeWidth:"handleStrokeWidth",height:"height",iconStrokeColor:"iconStrokeColor",iconStrokeWidth:"iconStrokeWidth",id:"id",offset:"offset",padding:"padding",pathData:"pathData",visibility:"visibility",width:"width"},features:[Ns]}),e})(),XT=(()=>{class e extends TT{constructor(){super("fixeduserhandles")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ye({type:e,selectors:[["e-connector-fixeduserhandles"]],contentQueries:function(e,t,i){if(1&e&&Lo(i,YT,4),2&e){let e;zo(e=ko())&&(t.children=e)}},features:[Ns]}),e})(),GT=["addInfo","alignment","annotationType","constraints","content","displacement","dragLimit","height","horizontalAlignment","hyperlink","id","margin","offset","rotateAngle","segmentAngle","style","template","type","verticalAlignment","visibility","width"],qT=[],ZT=(()=>{class e extends OT{constructor(e){super(),this.viewContainerRef=e,CT("currentInstance",this,this.viewContainerRef),this.registerEvents(qT),this.directivePropList=GT}}return e.\u0275fac=function(t){return new(t||e)(qs(so))},e.\u0275dir=Ye({type:e,selectors:[["e-connector-annotation"]],inputs:{addInfo:"addInfo",alignment:"alignment",annotationType:"annotationType",constraints:"constraints",content:"content",displacement:"displacement",dragLimit:"dragLimit",height:"height",horizontalAlignment:"horizontalAlignment",hyperlink:"hyperlink",id:"id",margin:"margin",offset:"offset",rotateAngle:"rotateAngle",segmentAngle:"segmentAngle",style:"style",template:"template",type:"type",verticalAlignment:"verticalAlignment",visibility:"visibility",width:"width"},features:[Ns]}),e})(),$T=(()=>{class e extends TT{constructor(){super("annotations")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ye({type:e,selectors:[["e-connector-annotations"]],contentQueries:function(e,t,i){if(1&e&&Lo(i,ZT,4),2&e){let e;zo(e=ko())&&(t.children=e)}},features:[Ns]}),e})(),QT=["addInfo","annotations","bridgeSpace","connectionPadding","constraints","cornerRadius","dragSize","excludeFromLayout","fixedUserHandles","flip","hitPadding","id","margin","previewSize","segments","shape","sourceDecorator","sourceID","sourcePadding","sourcePoint","sourcePortID","style","symbolInfo","targetDecorator","targetID","targetPadding","targetPoint","targetPortID","tooltip","type","visible","wrapper","zIndex"],JT=[],KT=(()=>{class e extends OT{constructor(e){super(),this.viewContainerRef=e,this.tags=["fixedUserHandles","annotations"],CT("currentInstance",this,this.viewContainerRef),this.registerEvents(JT),this.directivePropList=QT}}return e.\u0275fac=function(t){return new(t||e)(qs(so))},e.\u0275dir=Ye({type:e,selectors:[["e-connector"]],contentQueries:function(e,t,i){if(1&e&&(Lo(i,XT,5),Lo(i,$T,5)),2&e){let e;zo(e=ko())&&(t.childFixedUserHandles=e.first),zo(e=ko())&&(t.childAnnotations=e.first)}},inputs:{addInfo:"addInfo",annotations:"annotations",bridgeSpace:"bridgeSpace",connectionPadding:"connectionPadding",constraints:"constraints",cornerRadius:"cornerRadius",dragSize:"dragSize",excludeFromLayout:"excludeFromLayout",fixedUserHandles:"fixedUserHandles",flip:"flip",hitPadding:"hitPadding",id:"id",margin:"margin",previewSize:"previewSize",segments:"segments",shape:"shape",sourceDecorator:"sourceDecorator",sourceID:"sourceID",sourcePadding:"sourcePadding",sourcePoint:"sourcePoint",sourcePortID:"sourcePortID",style:"style",symbolInfo:"symbolInfo",targetDecorator:"targetDecorator",targetID:"targetID",targetPadding:"targetPadding",targetPoint:"targetPoint",targetPortID:"targetPortID",tooltip:"tooltip",type:"type",visible:"visible",wrapper:"wrapper",zIndex:"zIndex"},features:[Ns]}),e})(),eE=(()=>{class e extends TT{constructor(){super("connectors")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ye({type:e,selectors:[["e-connectors"]],contentQueries:function(e,t,i){if(1&e&&Lo(i,KT,4),2&e){let e;zo(e=ko())&&(t.children=e)}},features:[Ns]}),e})(),tE=["cornerRadius","fill","handleStrokeColor","handleStrokeWidth","height","iconStrokeColor","iconStrokeWidth","id","margin","offset","padding","pathData","visibility","width"],iE=[],nE=(()=>{class e extends OT{constructor(e){super(),this.viewContainerRef=e,CT("currentInstance",this,this.viewContainerRef),this.registerEvents(iE),this.directivePropList=tE}}return e.\u0275fac=function(t){return new(t||e)(qs(so))},e.\u0275dir=Ye({type:e,selectors:[["e-node-fixeduserhandle"]],inputs:{cornerRadius:"cornerRadius",fill:"fill",handleStrokeColor:"handleStrokeColor",handleStrokeWidth:"handleStrokeWidth",height:"height",iconStrokeColor:"iconStrokeColor",iconStrokeWidth:"iconStrokeWidth",id:"id",margin:"margin",offset:"offset",padding:"padding",pathData:"pathData",visibility:"visibility",width:"width"},features:[Ns]}),e})(),sE=(()=>{class e extends TT{constructor(){super("fixeduserhandles")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ye({type:e,selectors:[["e-node-fixeduserhandles"]],contentQueries:function(e,t,i){if(1&e&&Lo(i,nE,4),2&e){let e;zo(e=ko())&&(t.children=e)}},features:[Ns]}),e})(),rE=["addInfo","annotationType","constraints","content","dragLimit","height","horizontalAlignment","hyperlink","id","margin","offset","rotateAngle","style","template","type","verticalAlignment","visibility","width"],oE=[],aE=(()=>{class e extends OT{constructor(e){super(),this.viewContainerRef=e,CT("currentInstance",this,this.viewContainerRef),this.registerEvents(oE),this.directivePropList=rE}}return e.\u0275fac=function(t){return new(t||e)(qs(so))},e.\u0275dir=Ye({type:e,selectors:[["e-node-annotation"]],inputs:{addInfo:"addInfo",annotationType:"annotationType",constraints:"constraints",content:"content",dragLimit:"dragLimit",height:"height",horizontalAlignment:"horizontalAlignment",hyperlink:"hyperlink",id:"id",margin:"margin",offset:"offset",rotateAngle:"rotateAngle",style:"style",template:"template",type:"type",verticalAlignment:"verticalAlignment",visibility:"visibility",width:"width"},features:[Ns]}),e})(),lE=(()=>{class e extends TT{constructor(){super("annotations")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ye({type:e,selectors:[["e-node-annotations"]],contentQueries:function(e,t,i){if(1&e&&Lo(i,aE,4),2&e){let e;zo(e=ko())&&(t.children=e)}},features:[Ns]}),e})(),hE=["addInfo","constraints","height","horizontalAlignment","id","inEdges","margin","offset","outEdges","pathData","shape","style","verticalAlignment","visibility","width"],cE=[],dE=(()=>{class e extends OT{constructor(e){super(),this.viewContainerRef=e,CT("currentInstance",this,this.viewContainerRef),this.registerEvents(cE),this.directivePropList=hE}}return e.\u0275fac=function(t){return new(t||e)(qs(so))},e.\u0275dir=Ye({type:e,selectors:[["e-node-port"]],inputs:{addInfo:"addInfo",constraints:"constraints",height:"height",horizontalAlignment:"horizontalAlignment",id:"id",inEdges:"inEdges",margin:"margin",offset:"offset",outEdges:"outEdges",pathData:"pathData",shape:"shape",style:"style",verticalAlignment:"verticalAlignment",visibility:"visibility",width:"width"},features:[Ns]}),e})(),pE=(()=>{class e extends TT{constructor(){super("ports")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ye({type:e,selectors:[["e-node-ports"]],contentQueries:function(e,t,i){if(1&e&&Lo(i,dE,4),2&e){let e;zo(e=ko())&&(t.children=e)}},features:[Ns]}),e})(),uE=["addInfo","annotations","backgroundColor","borderColor","borderWidth","branch","children","collapseIcon","columnIndex","columnSpan","columns","constraints","container","data","dragSize","excludeFromLayout","expandIcon","fixedUserHandles","flip","height","horizontalAlignment","id","isExpanded","layoutInfo","margin","maxHeight","maxWidth","minHeight","minWidth","offsetX","offsetY","pivot","ports","previewSize","rotateAngle","rowIndex","rowSpan","rows","shadow","shape","style","symbolInfo","tooltip","verticalAlignment","visible","width","wrapper","zIndex"],gE=[],mE=(()=>{class e extends OT{constructor(e){super(),this.viewContainerRef=e,this.tags=["fixedUserHandles","annotations","ports"],CT("currentInstance",this,this.viewContainerRef),this.registerEvents(gE),this.directivePropList=uE}}return e.\u0275fac=function(t){return new(t||e)(qs(so))},e.\u0275dir=Ye({type:e,selectors:[["e-node"]],contentQueries:function(e,t,i){if(1&e&&(Lo(i,sE,5),Lo(i,lE,5),Lo(i,pE,5)),2&e){let e;zo(e=ko())&&(t.childFixedUserHandles=e.first),zo(e=ko())&&(t.childAnnotations=e.first),zo(e=ko())&&(t.childPorts=e.first)}},inputs:{addInfo:"addInfo",annotations:"annotations",backgroundColor:"backgroundColor",borderColor:"borderColor",borderWidth:"borderWidth",branch:"branch",children:"children",collapseIcon:"collapseIcon",columnIndex:"columnIndex",columnSpan:"columnSpan",columns:"columns",constraints:"constraints",container:"container",data:"data",dragSize:"dragSize",excludeFromLayout:"excludeFromLayout",expandIcon:"expandIcon",fixedUserHandles:"fixedUserHandles",flip:"flip",height:"height",horizontalAlignment:"horizontalAlignment",id:"id",isExpanded:"isExpanded",layoutInfo:"layoutInfo",margin:"margin",maxHeight:"maxHeight",maxWidth:"maxWidth",minHeight:"minHeight",minWidth:"minWidth",offsetX:"offsetX",offsetY:"offsetY",pivot:"pivot",ports:"ports",previewSize:"previewSize",rotateAngle:"rotateAngle",rowIndex:"rowIndex",rowSpan:"rowSpan",rows:"rows",shadow:"shadow",shape:"shape",style:"style",symbolInfo:"symbolInfo",tooltip:"tooltip",verticalAlignment:"verticalAlignment",visible:"visible",width:"width",wrapper:"wrapper",zIndex:"zIndex"},features:[Ns]}),e})(),fE=(()=>{class e extends TT{constructor(){super("nodes")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Ye({type:e,selectors:[["e-nodes"]],contentQueries:function(e,t,i){if(1&e&&Lo(i,mE,4),2&e){let e;zo(e=ko())&&(t.children=e)}},features:[Ns]}),e})();var yE=function(e,t,i,n){var s,r=arguments.length,o=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,i,o):s(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},bE=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const vE=["animationComplete","click","collectionChange","commandExecute","connectionChange","contextMenuBeforeItemRender","contextMenuClick","contextMenuOpen","created","dataLoaded","doubleClick","dragEnter","dragLeave","dragOver","drop","expandStateChange","fixedUserHandleClick","historyChange","historyStateChange","keyDown","keyUp","mouseEnter","mouseLeave","mouseOver","onImageLoad","onUserHandleMouseDown","onUserHandleMouseEnter","onUserHandleMouseLeave","onUserHandleMouseUp","positionChange","propertyChange","rotateChange","scrollChange","segmentCollectionChange","selectionChange","sizeChange","sourcePointChange","targetPointChange","textEdit"],wE=[""];let xE=(()=>{let e=class extends wT{constructor(e,t,i,n){super(),this.ngEle=e,this.srenderer=t,this.viewContainerRef=i,this.injector=n,this.tags=["layers","customCursor","connectors","nodes"],this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[];try{let e=this.injector.get("DiagramsHierarchicalTree");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(s){}try{let e=this.injector.get("DiagramsMindMap");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(r){}try{let e=this.injector.get("DiagramsRadialTree");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(o){}try{let e=this.injector.get("DiagramsComplexHierarchicalTree");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(a){}try{let e=this.injector.get("DiagramsDataBinding");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(l){}try{let e=this.injector.get("DiagramsSnapping");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(h){}try{let e=this.injector.get("DiagramsPrintAndExport");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(c){}try{let e=this.injector.get("DiagramsBpmnDiagrams");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(d){}try{let e=this.injector.get("DiagramsSymmetricLayout");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(p){}try{let e=this.injector.get("DiagramsConnectorBridging");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(u){}try{let e=this.injector.get("DiagramsUndoRedo");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(g){}try{let e=this.injector.get("DiagramsLayoutAnimation");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(m){}try{let e=this.injector.get("DiagramsDiagramContextMenu");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(f){}try{let e=this.injector.get("DiagramsLineRouting");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(y){}try{let e=this.injector.get("DiagramsConnectorEditing");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(b){}try{let e=this.injector.get("DiagramsBlazorTooltip");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(v){}try{let e=this.injector.get("DiagramsLineDistribution");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(w){}this.registerEvents(vE),this.addTwoWay.call(this,wE),CT("currentInstance",this,this.viewContainerRef),this.context=new ET}ngOnInit(){this.context.ngOnInit(this)}ngAfterViewInit(){this.context.ngAfterViewInit(this)}ngOnDestroy(){this.context.ngOnDestroy(this)}ngAfterContentChecked(){this.tagObjects[0].instance=this.childLayers,this.childCustomCursor&&(this.tagObjects[1].instance=this.childCustomCursor),this.childConnectors&&(this.tagObjects[2].instance=this.childConnectors),this.childNodes&&(this.tagObjects[3].instance=this.childNodes),this.context.ngAfterContentChecked(this)}};return e.\u0275fac=function(t){return new(t||e)(qs(wr),qs(Cr),qs(so),qs(Hs))},e.\u0275cmp=Ne({type:e,selectors:[["ejs-diagram"]],contentQueries:function(e,t,i){if(1&e&&(Lo(i,RT,5),Lo(i,zT,5),Lo(i,LT,5),Lo(i,_T,5),Lo(i,UT,5),Lo(i,eE,5),Lo(i,fE,5)),2&e){let e;zo(e=ko())&&(t.annotationTemplate=e.first),zo(e=ko())&&(t.nodeTemplate=e.first),zo(e=ko())&&(t.userHandleTemplate=e.first),zo(e=ko())&&(t.childLayers=e.first),zo(e=ko())&&(t.childCustomCursor=e.first),zo(e=ko())&&(t.childConnectors=e.first),zo(e=ko())&&(t.childNodes=e.first)}},inputs:{addInfo:"addInfo",annotationTemplate:"annotationTemplate",backgroundColor:"backgroundColor",bridgeDirection:"bridgeDirection",commandManager:"commandManager",connectorDefaults:"connectorDefaults",connectors:"connectors",constraints:"constraints",contextMenuSettings:"contextMenuSettings",customCursor:"customCursor",dataSourceSettings:"dataSourceSettings",diagramSettings:"diagramSettings",drawingObject:"drawingObject",enablePersistence:"enablePersistence",enableRtl:"enableRtl",getConnectorDefaults:"getConnectorDefaults",getCustomCursor:"getCustomCursor",getCustomProperty:"getCustomProperty",getCustomTool:"getCustomTool",getDescription:"getDescription",getNodeDefaults:"getNodeDefaults",height:"height",historyManager:"historyManager",layers:"layers",layout:"layout",locale:"locale",mode:"mode",nodeDefaults:"nodeDefaults",nodeTemplate:"nodeTemplate",nodes:"nodes",pageSettings:"pageSettings",rulerSettings:"rulerSettings",scrollSettings:"scrollSettings",selectedItems:"selectedItems",serializationSettings:"serializationSettings",setNodeTemplate:"setNodeTemplate",snapSettings:"snapSettings",tool:"tool",tooltip:"tooltip",updateSelection:"updateSelection",userHandleTemplate:"userHandleTemplate",width:"width"},outputs:{animationComplete:"animationComplete",click:"click",collectionChange:"collectionChange",commandExecute:"commandExecute",connectionChange:"connectionChange",contextMenuBeforeItemRender:"contextMenuBeforeItemRender",contextMenuClick:"contextMenuClick",contextMenuOpen:"contextMenuOpen",created:"created",dataLoaded:"dataLoaded",doubleClick:"doubleClick",dragEnter:"dragEnter",dragLeave:"dragLeave",dragOver:"dragOver",drop:"drop",expandStateChange:"expandStateChange",fixedUserHandleClick:"fixedUserHandleClick",historyChange:"historyChange",historyStateChange:"historyStateChange",keyDown:"keyDown",keyUp:"keyUp",mouseEnter:"mouseEnter",mouseLeave:"mouseLeave",mouseOver:"mouseOver",onImageLoad:"onImageLoad",onUserHandleMouseDown:"onUserHandleMouseDown",onUserHandleMouseEnter:"onUserHandleMouseEnter",onUserHandleMouseLeave:"onUserHandleMouseLeave",onUserHandleMouseUp:"onUserHandleMouseUp",positionChange:"positionChange",propertyChange:"propertyChange",rotateChange:"rotateChange",scrollChange:"scrollChange",segmentCollectionChange:"segmentCollectionChange",selectionChange:"selectionChange",sizeChange:"sizeChange",sourcePointChange:"sourcePointChange",targetPointChange:"targetPointChange",textEdit:"textEdit"},features:[Ns],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),yE([IT(),bE("design:type",Object)],e.prototype,"annotationTemplate",void 0),yE([IT(),bE("design:type",Object)],e.prototype,"nodeTemplate",void 0),yE([IT(),bE("design:type",Object)],e.prototype,"userHandleTemplate",void 0),e=yE([(t=[ET],function(e){!function(e,t){t.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(i){e.prototype.hasOwnProperty(i)&&!t.isFormBase||(e.prototype[i]=t.prototype[i])})})}(e,t)}),bE("design:paramtypes",[wr,Cr,so,Hs])],e),e;var t})(),SE=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Fe({type:e}),e.\u0275inj=he({imports:[[rl]]}),e})();const CE=["diagram"];let PE=(()=>{class e{constructor(){this.title="Digram",this.width=0,this.height=0}getNodeDefaults(e){return e.style.fill="#ffffff",e.style.strokeColor="black",e}created(e){this.drawingshape={type:"Basic",shape:"Rectangle"},this.node={shape:this.drawingshape},this.diagram.drawingObject=this.node,this.diagram.tool=qb.DrawOnce,this.diagram.dataBind()}createdStar(e){this.node={id:"Path",style:{fill:"#fbe172"},annotations:[{content:"Path"}],shape:{type:"Path",data:"M13.560 67.524 L 21.941 41.731 L 0.000 25.790 L 27.120 25.790 L 35.501 0.000 L 43.882 25.790 L 71.000 25.790 L 49.061 41.731 L 57.441 67.524 L 35.501 51.583 z"}},this.diagram.drawingObject=this.node,this.diagram.tool=qb.DrawOnce,this.diagram.dataBind()}createdArow(e){this.connectors={id:"connector1",type:"Straight",segments:[{type:"polyline"}]},this.diagram.drawingObject=this.connectors,this.diagram.tool=qb.DrawOnce,this.diagram.dataBind()}createdText(e){this.node={shape:{type:"Text"}},this.diagram.drawingObject=this.node,this.diagram.tool=qb.DrawOnce,this.diagram.dataBind()}createdPolygon(e){this.drawingshape={type:"Basic",shape:"Polygon"},this.node={shape:this.drawingshape},this.diagram.drawingObject=this.node,this.diagram.tool=qb.DrawOnce,this.diagram.dataBind()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Ne({type:e,selectors:[["app-root"]],viewQuery:function(e,t){if(1&e&&function(e,t,i){const n=Ct();n.firstCreatePass&&Ho(n,new To(e,5,void 0),-1),jo(n,St(),5)}(CE),2&e){let e;zo(e=ko())&&(t.diagram=e.first)}},decls:40,vars:1,consts:[["role","banner",1,"toolbar"],["width","40","alt","Angular Logo","src","data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNTAgMjUwIj4KICAgIDxwYXRoIGZpbGw9IiNERDAwMzEiIGQ9Ik0xMjUgMzBMMzEuOSA2My4ybDE0LjIgMTIzLjFMMTI1IDIzMGw3OC45LTQzLjcgMTQuMi0xMjMuMXoiIC8+CiAgICA8cGF0aCBmaWxsPSIjQzMwMDJGIiBkPSJNMTI1IDMwdjIyLjItLjFWMjMwbDc4LjktNDMuNyAxNC4yLTEyMy4xTDEyNSAzMHoiIC8+CiAgICA8cGF0aCAgZmlsbD0iI0ZGRkZGRiIgZD0iTTEyNSA1Mi4xTDY2LjggMTgyLjZoMjEuN2wxMS43LTI5LjJoNDkuNGwxMS43IDI5LjJIMTgzTDEyNSA1Mi4xem0xNyA4My4zaC0zNGwxNy00MC45IDE3IDQwLjl6IiAvPgogIDwvc3ZnPg=="],[1,"spacer"],["role","main",1,"content"],[1,"row"],[1,"col-1"],[1,"btn","btn-light",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-square-fill"],["d","M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2z"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-star"],["d","M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.565.565 0 0 0-.163-.505L1.71 6.745l4.052-.576a.525.525 0 0 0 .393-.288L8 2.223l1.847 3.658a.525.525 0 0 0 .393.288l4.052.575-2.906 2.77a.565.565 0 0 0-.163.506l.694 3.957-3.686-1.894a.503.503 0 0 0-.461 0z"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-arrow-right"],["fill-rule","evenodd","d","M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-file-text"],["d","M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zM5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1H5zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1H5z"],["d","M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1z"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-octagon"],["d","M4.54.146A.5.5 0 0 1 4.893 0h6.214a.5.5 0 0 1 .353.146l4.394 4.394a.5.5 0 0 1 .146.353v6.214a.5.5 0 0 1-.146.353l-4.394 4.394a.5.5 0 0 1-.353.146H4.893a.5.5 0 0 1-.353-.146L.146 11.46A.5.5 0 0 1 0 11.107V4.893a.5.5 0 0 1 .146-.353L4.54.146zM5.1 1 1 5.1v5.8L5.1 15h5.8l4.1-4.1V5.1L10.9 1H5.1z"],[1,"col-11"],["id","diagram","width","100%","height","580px",3,"getNodeDefaults","created"],["diagram",""],["id","clouds","xmlns","http://www.w3.org/2000/svg","width","2611.084","height","485.677","viewBox","0 0 2611.084 485.677"],["id","Path_39","data-name","Path 39","d","M2379.709,863.793c10-93-77-171-168-149-52-114-225-105-264,15-75,3-140,59-152,133-30,2.83-66.725,9.829-93.5,26.25-26.771-16.421-63.5-23.42-93.5-26.25-12-74-77-130-152-133-39-120-212-129-264-15-54.084-13.075-106.753,9.173-138.488,48.9-31.734-39.726-84.4-61.974-138.487-48.9-52-114-225-105-264,15a162.027,162.027,0,0,0-103.147,43.044c-30.633-45.365-87.1-72.091-145.206-58.044-52-114-225-105-264,15-75,3-140,59-152,133-53,5-127,23-130,83-2,42,35,72,70,86,49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33,61.112,8.015,113.854-5.72,150.492-29.764a165.62,165.62,0,0,0,110.861-3.236c47,94,178,113,251,33,31.385,4.116,60.563,2.495,86.487-3.311,25.924,5.806,55.1,7.427,86.488,3.311,73,80,204,61,251-33a165.625,165.625,0,0,0,120,0c51,13,108,15,157-5a147.188,147.188,0,0,0,33.5-18.694,147.217,147.217,0,0,0,33.5,18.694c49,20,106,18,157,5a165.625,165.625,0,0,0,120,0c47,94,178,113,251,33C2446.709,1093.793,2554.709,922.793,2379.709,863.793Z","transform","translate(142.69 -634.312)","fill","#eee"],[1,"footer",2,"text-align","center"],["href","https://bayanalmouslly.github.io/Portfolio/",1,"btn"]],template:function(e,t){1&e&&(Qs(0,"div",0),Ks(1,"img",1),Qs(2,"span"),rr(3,"Welcome"),Js(),Ks(4,"div",2),Js(),Qs(5,"div",3),Qs(6,"div",4),Qs(7,"div",5),Qs(8,"a",6),ir("click",function(e){return t.created(e)}),Vt(),Qs(9,"svg",7),Ks(10,"path",8),Js(),Js(),Yt(),Ks(11,"br"),Qs(12,"a",6),ir("click",function(e){return t.createdStar(e)}),Vt(),Qs(13,"svg",9),Ks(14,"path",10),Js(),Js(),Yt(),Ks(15,"br"),Qs(16,"a",6),ir("click",function(e){return t.createdArow(e)}),Vt(),Qs(17,"svg",11),Ks(18,"path",12),Js(),Js(),Yt(),Ks(19,"br"),Qs(20,"a",6),ir("click",function(e){return t.createdText(e)}),Vt(),Qs(21,"svg",13),Ks(22,"path",14),Ks(23,"path",15),Js(),Js(),Yt(),Ks(24,"br"),Qs(25,"a",6),ir("click",function(e){return t.createdPolygon(e)}),Vt(),Qs(26,"svg",16),Ks(27,"path",17),Js(),Js(),Js(),Yt(),Qs(28,"div",18),Qs(29,"ejs-diagram",19,20),ir("created",function(e){return t.created(e)}),Js(),Js(),Js(),Ks(31,"router-outlet"),Vt(),Qs(32,"svg",21),Qs(33,"title"),rr(34,"Gray Clouds Background"),Js(),Ks(35,"path",22),Js(),Yt(),Qs(36,"footer",23),rr(37," created by "),Qs(38,"a",24),rr(39,"Bayan Almoussly"),Js(),Js(),Js()),2&e&&(29,Wn(Ct(),St(),Ut()+29,At()),Zs("getNodeDefaults",t.getNodeDefaults))},directives:[xE,lp],styles:["",'[_nghost-%COMP%] {\n    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";\n    font-size: 14px;\n    color: #333;\n    box-sizing: border-box;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n\n  h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%] {\n    margin: 8px 0;\n  }\n\n  p[_ngcontent-%COMP%] {\n    margin: 0;\n  }\n\n  .spacer[_ngcontent-%COMP%] {\n    flex: 1;\n  }\n\n  .toolbar[_ngcontent-%COMP%] {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 60px;\n    display: flex;\n    align-items: center;\n    background-color: #1976d2;\n    color: white;\n    font-weight: 600;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\n    margin: 0 16px;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   #twitter-logo[_ngcontent-%COMP%] {\n    height: 40px;\n    margin: 0 8px;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   #youtube-logo[_ngcontent-%COMP%] {\n    height: 40px;\n    margin: 0 16px;\n  }\n\n  .toolbar[_ngcontent-%COMP%]   #twitter-logo[_ngcontent-%COMP%]:hover, .toolbar[_ngcontent-%COMP%]   #youtube-logo[_ngcontent-%COMP%]:hover {\n    opacity: 0.8;\n  }\n\n  .content[_ngcontent-%COMP%] {\n    display: flex;\n    margin: 82px auto 32px;\n    padding: 0 16px;\n    max-width: 960px;\n    flex-direction: column;\n    \n  }\n\n  svg.material-icons[_ngcontent-%COMP%] {\n    height: 24px;\n    width: auto;\n  }\n\n  svg.material-icons[_ngcontent-%COMP%]:not(:last-child) {\n    margin-right: 8px;\n  }\n\n  .card[_ngcontent-%COMP%]   svg.material-icons[_ngcontent-%COMP%]   path[_ngcontent-%COMP%] {\n    fill: #888;\n  }\n\n  .card-container[_ngcontent-%COMP%] {\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: center;\n    margin-top: 16px;\n  }\n\n  .card[_ngcontent-%COMP%] {\n    border-radius: 4px;\n    border: 1px solid #eee;\n    background-color: #fafafa;\n    height: 40px;\n    width: 200px;\n    margin: 0 8px 16px;\n    padding: 16px;\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    align-items: center;\n    transition: all 0.2s ease-in-out;\n    line-height: 24px;\n  }\n\n  .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:not(:last-child) {\n    margin-right: 0;\n  }\n\n  .card.card-small[_ngcontent-%COMP%] {\n    height: 16px;\n    width: 168px;\n  }\n\n  .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:not(.highlight-card) {\n    cursor: pointer;\n  }\n\n  .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:not(.highlight-card):hover {\n    transform: translateY(-3px);\n    box-shadow: 0 4px 17px rgba(0, 0, 0, 0.35);\n  }\n\n  .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:not(.highlight-card):hover   .material-icons[_ngcontent-%COMP%]   path[_ngcontent-%COMP%] {\n    fill: rgb(105, 103, 103);\n  }\n\n  .card.highlight-card[_ngcontent-%COMP%] {\n    background-color: #1976d2;\n    color: white;\n    font-weight: 600;\n    border: none;\n    width: auto;\n    min-width: 30%;\n    position: relative;\n  }\n\n  .card.card.highlight-card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\n    margin-left: 60px;\n  }\n\n  svg#rocket[_ngcontent-%COMP%] {\n    width: 80px;\n    position: absolute;\n    left: -10px;\n    top: -24px;\n  }\n\n  svg#rocket-smoke[_ngcontent-%COMP%] {\n    height: calc(100vh - 95px);\n    position: absolute;\n    top: 10px;\n    right: 180px;\n    z-index: -10;\n  }\n\n  a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:visited, a[_ngcontent-%COMP%]:hover {\n    color: #1976d2;\n    text-decoration: none;\n  }\n\n  a[_ngcontent-%COMP%]:hover {\n    color: #125699;\n  }\n\n  .terminal[_ngcontent-%COMP%] {\n    position: relative;\n    width: 80%;\n    max-width: 600px;\n    border-radius: 6px;\n    padding-top: 45px;\n    margin-top: 8px;\n    overflow: hidden;\n    background-color: rgb(15, 15, 16);\n  }\n\n  .terminal[_ngcontent-%COMP%]::before {\n    content: "\\2022 \\2022 \\2022";\n    position: absolute;\n    top: 0;\n    left: 0;\n    height: 4px;\n    background: rgb(58, 58, 58);\n    color: #c2c3c4;\n    width: 100%;\n    font-size: 2rem;\n    line-height: 0;\n    padding: 14px 0;\n    text-indent: 4px;\n  }\n\n  .terminal[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%] {\n    font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, monospace;\n    color: white;\n    padding: 0 1rem 1rem;\n    margin: 0;\n  }\n\n  .circle-link[_ngcontent-%COMP%] {\n    height: 40px;\n    width: 40px;\n    border-radius: 40px;\n    margin: 8px;\n    background-color: white;\n    border: 1px solid #eeeeee;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    cursor: pointer;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\n    transition: 1s ease-out;\n  }\n\n  .circle-link[_ngcontent-%COMP%]:hover {\n    transform: translateY(-0.25rem);\n    box-shadow: 0px 3px 15px rgba(0, 0, 0, 0.2);\n  }\n\n  footer[_ngcontent-%COMP%] {\n    margin-top: 8px;\n    display: flex;\n    align-items: center;\n    line-height: 20px;\n  }\n\n  footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    display: flex;\n    align-items: center;\n  }\n\n  .github-star-badge[_ngcontent-%COMP%] {\n    color: #24292e;\n    display: flex;\n    align-items: center;\n    font-size: 12px;\n    padding: 3px 10px;\n    border: 1px solid rgba(27, 31, 35, .2);\n    border-radius: 3px;\n    background-image: linear-gradient(-180deg, #fafbfc, #eff3f6 90%);\n    margin-left: 4px;\n    font-weight: 600;\n    font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol;\n  }\n\n  .github-star-badge[_ngcontent-%COMP%]:hover {\n    background-image: linear-gradient(-180deg, #f0f3f6, #e6ebf1 90%);\n    border-color: rgba(27, 31, 35, .35);\n    background-position: -.5em;\n  }\n\n  .github-star-badge[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%] {\n    height: 16px;\n    width: 16px;\n    margin-right: 4px;\n  }\n\n  svg#clouds[_ngcontent-%COMP%] {\n    position: fixed;\n    bottom: -160px;\n    left: -230px;\n    z-index: -10;\n    width: 1920px;\n  }\n\n\n  \n  @media screen and (max-width: 767px) {\n\n    .card-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:not(.circle-link), .terminal[_ngcontent-%COMP%] {\n      width: 100%;\n    }\n\n    .card[_ngcontent-%COMP%]:not(.highlight-card) {\n      height: 16px;\n      margin: 8px 0;\n    }\n\n    .card.highlight-card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\n      margin-left: 72px;\n    }\n\n    svg#rocket-smoke[_ngcontent-%COMP%] {\n      right: 120px;\n      transform: rotate(-5deg);\n    }\n  }\n\n  @media screen and (max-width: 575px) {\n    svg#rocket-smoke[_ngcontent-%COMP%] {\n      display: none;\n      visibility: hidden;\n    }\n  }']}),e})(),OE=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Fe({type:e,bootstrap:[PE]}),e.\u0275inj=he({providers:[],imports:[[_l,SE,Ap]]}),e})();(function(){if(va)throw new Error("Cannot enable prod mode after platform setup.");ba=!1})(),jl().bootstrapModule(OE).catch(e=>console.error(e))}},e=>{"use strict";e(e.s=884)}]);